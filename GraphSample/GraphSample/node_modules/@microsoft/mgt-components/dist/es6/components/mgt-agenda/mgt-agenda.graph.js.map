{"version":3,"file":"mgt-agenda.graph.js","sourceRoot":"src/","sources":["components/mgt-agenda/mgt-agenda.graph.ts"],"names":[],"mappings":"AAAA;;;;;GAKG;;;;;;;;;;AAEH,OAAO,EAAE,iBAAiB,EAAU,UAAU,EAAE,MAAM,wBAAwB,CAAC;AAG/E;;;;;;;;;GASG;AACH,MAAM,UAAgB,qBAAqB,CACzC,KAAa,EACb,aAAmB,EACnB,WAAiB,EACjB,OAAgB;;QAEhB,MAAM,MAAM,GAAG,gBAAgB,CAAC;QAEhC,MAAM,GAAG,GAAG,iBAAiB,aAAa,CAAC,WAAW,EAAE,EAAE,CAAC;QAC3D,MAAM,GAAG,GAAG,eAAe,WAAW,CAAC,WAAW,EAAE,EAAE,CAAC;QAEvD,IAAI,GAAW,CAAC;QAEhB,IAAI,OAAO,EAAE;YACX,GAAG,GAAG,UAAU,OAAO,WAAW,CAAC;SACpC;aAAM;YACL,GAAG,GAAG,IAAI,CAAC;SACZ;QAED,GAAG,IAAI,iBAAiB,GAAG,IAAI,GAAG,EAAE,CAAC;QAErC,IAAI,OAAO,GAAG,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,iBAAiB,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;QAE7F,OAAO,iBAAiB,CAAC,MAAM,CAAuB,KAAK,EAAE,OAAO,CAAC,CAAC;IACxE,CAAC;CAAA","sourcesContent":["/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { GraphPageIterator, IGraph, prepScopes } from '@microsoft/mgt-element';\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\n\n/**\n * returns Calender events iterator associated with either the logged in user or a specific groupId\n *\n * @param {Date} startDateTime\n * @param {Date} endDateTime\n * @param {string} [groupId]\n * @param {string} preferredTimezone\n * @returns {(Promise<Event[]>)}\n * @memberof Graph\n */\nexport async function getEventsPageIterator(\n  graph: IGraph,\n  startDateTime: Date,\n  endDateTime: Date,\n  groupId?: string\n): Promise<GraphPageIterator<MicrosoftGraph.Event>> {\n  const scopes = 'calendars.read';\n\n  const sdt = `startdatetime=${startDateTime.toISOString()}`;\n  const edt = `enddatetime=${endDateTime.toISOString()}`;\n\n  let uri: string;\n\n  if (groupId) {\n    uri = `groups/${groupId}/calendar`;\n  } else {\n    uri = 'me';\n  }\n\n  uri += `/calendarview?${sdt}&${edt}`;\n\n  let request = graph.api(uri).middlewareOptions(prepScopes(scopes)).orderby('start/dateTime');\n\n  return GraphPageIterator.create<MicrosoftGraph.Event>(graph, request);\n}\n"]}