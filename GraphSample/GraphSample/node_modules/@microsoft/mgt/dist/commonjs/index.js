"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(t,r){return t(r={exports:{}},r.exports),r.exports}var r,o,check=function(t){return t&&t.Math==Math&&t},i=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof t&&t)||function(){return this}()||Function("return this")(),fails=function(t){try{return!!t()}catch(t){return!0}},s=!fails((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),l=!fails((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),u=Function.prototype.call,h=l?u.bind(u):function(){return u.apply(u,arguments)},m={}.propertyIsEnumerable,v=Object.getOwnPropertyDescriptor,C=v&&!m.call({1:2},1)?function propertyIsEnumerable(t){var r=v(this,t);return!!r&&r.enumerable}:m,_={f:C},createPropertyDescriptor=function(t,r){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:r}},k=Function.prototype,E=k.call,R=l&&k.bind.bind(E,E),N=l?R:function(t){return function(){return E.apply(t,arguments)}},M=N({}.toString),B=N("".slice),classofRaw=function(t){return B(M(t),8,-1)},H=Object,$=N("".split),q=fails((function(){return!H("z").propertyIsEnumerable(0)}))?function(t){return"String"==classofRaw(t)?$(t,""):H(t)}:H,isNullOrUndefined=function(t){return null==t},j=TypeError,requireObjectCoercible=function(t){if(isNullOrUndefined(t))throw j("Can't call method on "+t);return t},toIndexedObject=function(t){return q(requireObjectCoercible(t))},z="object"==typeof document&&document.all,V={all:z,IS_HTMLDDA:void 0===z&&void 0!==z},K=V.all,W=V.IS_HTMLDDA?function(t){return"function"==typeof t||t===K}:function(t){return"function"==typeof t},X=V.all,Z=V.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:W(t)||t===X}:function(t){return"object"==typeof t?null!==t:W(t)},getBuiltIn=function(t,r){return arguments.length<2?(o=i[t],W(o)?o:void 0):i[t]&&i[t][r];var o},re=N({}.isPrototypeOf),oe="undefined"!=typeof navigator&&String(navigator.userAgent)||"",ne=i.process,ae=i.Deno,le=ne&&ne.versions||ae&&ae.version,de=le&&le.v8;de&&(o=(r=de.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&oe&&(!(r=oe.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=oe.match(/Chrome\/(\d+)/))&&(o=+r[1]);var me=o,we=!!Object.getOwnPropertySymbols&&!fails((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&me&&me<41})),_e=we&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Te=Object,Ee=_e?function(t){return"symbol"==typeof t}:function(t){var r=getBuiltIn("Symbol");return W(r)&&re(r.prototype,Te(t))},xe=String,tryToString=function(t){try{return xe(t)}catch(t){return"Object"}},Ie=TypeError,aCallable=function(t){if(W(t))return t;throw Ie(tryToString(t)+" is not a function")},getMethod$1=function(t,r){var o=t[r];return isNullOrUndefined(o)?void 0:aCallable(o)},Fe=TypeError,ordinaryToPrimitive=function(t,r){var o,i;if("string"===r&&W(o=t.toString)&&!Z(i=h(o,t)))return i;if(W(o=t.valueOf)&&!Z(i=h(o,t)))return i;if("string"!==r&&W(o=t.toString)&&!Z(i=h(o,t)))return i;throw Fe("Can't convert object to primitive value")},He=Object.defineProperty,defineGlobalProperty=function(t,r){try{He(i,t,{value:r,configurable:!0,writable:!0})}catch(o){i[t]=r}return r},qe="__core-js_shared__",Ge=i[qe]||defineGlobalProperty(qe,{}),Ve=createCommonjsModule((function(t){(t.exports=function(t,r){return Ge[t]||(Ge[t]=void 0!==r?r:{})})("versions",[]).push({version:"3.30.1",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE",source:"https://github.com/zloirock/core-js"})})),We=Object,toObject=function(t){return We(requireObjectCoercible(t))},et=N({}.hasOwnProperty),tt=Object.hasOwn||function hasOwn(t,r){return et(toObject(t),r)},rt=0,ot=Math.random(),nt=N(1..toString),uid=function(t){return"Symbol("+(void 0===t?"":t)+")_"+nt(++rt+ot,36)},it=i.Symbol,st=Ve("wks"),ct=_e?it.for||it:it&&it.withoutSetter||uid,wellKnownSymbol=function(t){return tt(st,t)||(st[t]=we&&tt(it,t)?it[t]:ct("Symbol."+t)),st[t]},lt=TypeError,dt=wellKnownSymbol("toPrimitive"),toPrimitive=function(t,r){if(!Z(t)||Ee(t))return t;var o,i=getMethod$1(t,dt);if(i){if(void 0===r&&(r="default"),o=h(i,t,r),!Z(o)||Ee(o))return o;throw lt("Can't convert object to primitive value")}return void 0===r&&(r="number"),ordinaryToPrimitive(t,r)},toPropertyKey=function(t){var r=toPrimitive(t,"string");return Ee(r)?r:r+""},ut=i.document,ht=Z(ut)&&Z(ut.createElement),documentCreateElement=function(t){return ht?ut.createElement(t):{}},pt=!s&&!fails((function(){return 7!=Object.defineProperty(documentCreateElement("div"),"a",{get:function(){return 7}}).a})),ft=Object.getOwnPropertyDescriptor,gt={f:s?ft:function getOwnPropertyDescriptor(t,r){if(t=toIndexedObject(t),r=toPropertyKey(r),pt)try{return ft(t,r)}catch(t){}if(tt(t,r))return createPropertyDescriptor(!h(_.f,t,r),t[r])}},mt=s&&fails((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),vt=String,yt=TypeError,anObject=function(t){if(Z(t))return t;throw yt(vt(t)+" is not an object")},bt=TypeError,wt=Object.defineProperty,Ct=Object.getOwnPropertyDescriptor,_t="enumerable",kt="configurable",St="writable",Tt={f:s?mt?function defineProperty(t,r,o){if(anObject(t),r=toPropertyKey(r),anObject(o),"function"==typeof t&&"prototype"===r&&"value"in o&&St in o&&!o[St]){var i=Ct(t,r);i&&i[St]&&(t[r]=o.value,o={configurable:kt in o?o[kt]:i[kt],enumerable:_t in o?o[_t]:i[_t],writable:!1})}return wt(t,r,o)}:wt:function defineProperty(t,r,o){if(anObject(t),r=toPropertyKey(r),anObject(o),pt)try{return wt(t,r,o)}catch(t){}if("get"in o||"set"in o)throw bt("Accessors not supported");return"value"in o&&(t[r]=o.value),t}},Et=s?function(t,r,o){return Tt.f(t,r,createPropertyDescriptor(1,o))}:function(t,r,o){return t[r]=o,t},xt=Function.prototype,It=s&&Object.getOwnPropertyDescriptor,At=tt(xt,"name"),Pt={EXISTS:At,PROPER:At&&"something"===function something(){}.name,CONFIGURABLE:At&&(!s||s&&It(xt,"name").configurable)},Rt=N(Function.toString);W(Ge.inspectSource)||(Ge.inspectSource=function(t){return Rt(t)});var Ot,Nt,Mt,Dt=Ge.inspectSource,Ft=i.WeakMap,Lt=W(Ft)&&/native code/.test(String(Ft)),Ut=Ve("keys"),sharedKey=function(t){return Ut[t]||(Ut[t]=uid(t))},Bt={},Ht="Object already initialized",$t=i.TypeError,qt=i.WeakMap;if(Lt||Ge.state){var jt=Ge.state||(Ge.state=new qt);jt.get=jt.get,jt.has=jt.has,jt.set=jt.set,Ot=function(t,r){if(jt.has(t))throw $t(Ht);return r.facade=t,jt.set(t,r),r},Nt=function(t){return jt.get(t)||{}},Mt=function(t){return jt.has(t)}}else{var zt=sharedKey("state");Bt[zt]=!0,Ot=function(t,r){if(tt(t,zt))throw $t(Ht);return r.facade=t,Et(t,zt,r),r},Nt=function(t){return tt(t,zt)?t[zt]:{}},Mt=function(t){return tt(t,zt)}}var Gt={set:Ot,get:Nt,has:Mt,enforce:function(t){return Mt(t)?Nt(t):Ot(t,{})},getterFor:function(t){return function(r){var o;if(!Z(r)||(o=Nt(r)).type!==t)throw $t("Incompatible receiver, "+t+" required");return o}}},Vt=createCommonjsModule((function(t){var r=Pt.CONFIGURABLE,o=Gt.enforce,i=Gt.get,l=String,u=Object.defineProperty,h=N("".slice),m=N("".replace),v=N([].join),C=s&&!fails((function(){return 8!==u((function(){}),"length",{value:8}).length})),_=String(String).split("String"),k=t.exports=function(t,i,k){"Symbol("===h(l(i),0,7)&&(i="["+m(l(i),/^Symbol\(([^)]*)\)/,"$1")+"]"),k&&k.getter&&(i="get "+i),k&&k.setter&&(i="set "+i),(!tt(t,"name")||r&&t.name!==i)&&(s?u(t,"name",{value:i,configurable:!0}):t.name=i),C&&k&&tt(k,"arity")&&t.length!==k.arity&&u(t,"length",{value:k.arity});try{k&&tt(k,"constructor")&&k.constructor?s&&u(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var E=o(t);return tt(E,"source")||(E.source=v(_,"string"==typeof i?i:"")),t};Function.prototype.toString=k((function toString(){return W(this)&&i(this).source||Dt(this)}),"toString")})),defineBuiltIn=function(t,r,o,i){i||(i={});var s=i.enumerable,l=void 0!==i.name?i.name:r;if(W(o)&&Vt(o,l,i),i.global)s?t[r]=o:defineGlobalProperty(r,o);else{try{i.unsafe?t[r]&&(s=!0):delete t[r]}catch(t){}s?t[r]=o:Tt.f(t,r,{value:o,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},Kt=Math.ceil,Wt=Math.floor,Qt=Math.trunc||function trunc(t){var r=+t;return(r>0?Wt:Kt)(r)},toIntegerOrInfinity=function(t){var r=+t;return r!=r||0===r?0:Qt(r)},Yt=Math.max,Jt=Math.min,toAbsoluteIndex=function(t,r){var o=toIntegerOrInfinity(t);return o<0?Yt(o+r,0):Jt(o,r)},Xt=Math.min,toLength=function(t){return t>0?Xt(toIntegerOrInfinity(t),9007199254740991):0},lengthOfArrayLike=function(t){return toLength(t.length)},createMethod$7=function(t){return function(r,o,i){var s,l=toIndexedObject(r),u=lengthOfArrayLike(l),h=toAbsoluteIndex(i,u);if(t&&o!=o){for(;u>h;)if((s=l[h++])!=s)return!0}else for(;u>h;h++)if((t||h in l)&&l[h]===o)return t||h||0;return!t&&-1}},Zt={includes:createMethod$7(!0),indexOf:createMethod$7(!1)},er=Zt.indexOf,tr=N([].push),objectKeysInternal=function(t,r){var o,i=toIndexedObject(t),s=0,l=[];for(o in i)!tt(Bt,o)&&tt(i,o)&&tr(l,o);for(;r.length>s;)tt(i,o=r[s++])&&(~er(l,o)||tr(l,o));return l},rr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],or=rr.concat("length","prototype"),nr={f:Object.getOwnPropertyNames||function getOwnPropertyNames(t){return objectKeysInternal(t,or)}},ir={f:Object.getOwnPropertySymbols},sr=N([].concat),ar=getBuiltIn("Reflect","ownKeys")||function ownKeys(t){var r=nr.f(anObject(t)),o=ir.f;return o?sr(r,o(t)):r},copyConstructorProperties$1=function(t,r,o){for(var i=ar(r),s=Tt.f,l=gt.f,u=0;u<i.length;u++){var h=i[u];tt(t,h)||o&&tt(o,h)||s(t,h,l(r,h))}},cr=/#|\.prototype\./,isForced=function(t,r){var o=dr[lr(t)];return o==hr||o!=ur&&(W(r)?fails(r):!!r)},lr=isForced.normalize=function(t){return String(t).replace(cr,".").toLowerCase()},dr=isForced.data={},ur=isForced.NATIVE="N",hr=isForced.POLYFILL="P",pr=isForced,fr=gt.f,_export=function(t,r){var o,s,l,u,h,m=t.target,v=t.global,C=t.stat;if(o=v?i:C?i[m]||defineGlobalProperty(m,{}):(i[m]||{}).prototype)for(s in r){if(u=r[s],l=t.dontCallGetSet?(h=fr(o,s))&&h.value:o[s],!pr(v?s:m+(C?".":"#")+s,t.forced)&&void 0!==l){if(typeof u==typeof l)continue;copyConstructorProperties$1(u,l)}(t.sham||l&&l.sham)&&Et(u,"sham",!0),defineBuiltIn(o,s,u,t)}},gr={};gr[wellKnownSymbol("toStringTag")]="z";var mr,vr="[object z]"===String(gr),yr=wellKnownSymbol("toStringTag"),br=Object,wr="Arguments"==classofRaw(function(){return arguments}()),Cr=vr?classofRaw:function(t){var r,o,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(o=function(t,r){try{return t[r]}catch(t){}}(r=br(t),yr))?o:wr?classofRaw(r):"Object"==(i=classofRaw(r))&&W(r.callee)?"Arguments":i},_r=String,toString_1=function(t){if("Symbol"===Cr(t))throw TypeError("Cannot convert a Symbol value to a string");return _r(t)},kr=Object.keys||function keys(t){return objectKeysInternal(t,rr)},Sr=s&&!mt?Object.defineProperties:function defineProperties(t,r){anObject(t);for(var o,i=toIndexedObject(r),s=kr(r),l=s.length,u=0;l>u;)Tt.f(t,o=s[u++],i[o]);return t},Tr={f:Sr},Er=getBuiltIn("document","documentElement"),xr="prototype",Ir="script",Ar=sharedKey("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(t){return"<"+Ir+">"+t+"</"+Ir+">"},NullProtoObjectViaActiveX=function(t){t.write(scriptTag("")),t.close();var r=t.parentWindow.Object;return t=null,r},NullProtoObject=function(){try{mr=new ActiveXObject("htmlfile")}catch(t){}var t,r,o;NullProtoObject="undefined"!=typeof document?document.domain&&mr?NullProtoObjectViaActiveX(mr):(r=documentCreateElement("iframe"),o="java"+Ir+":",r.style.display="none",Er.appendChild(r),r.src=String(o),(t=r.contentWindow.document).open(),t.write(scriptTag("document.F=Object")),t.close(),t.F):NullProtoObjectViaActiveX(mr);for(var i=rr.length;i--;)delete NullProtoObject[xr][rr[i]];return NullProtoObject()};Bt[Ar]=!0;var Pr=Object.create||function create(t,r){var o;return null!==t?(EmptyConstructor[xr]=anObject(t),o=new EmptyConstructor,EmptyConstructor[xr]=null,o[Ar]=t):o=NullProtoObject(),void 0===r?o:Tr.f(o,r)},createProperty=function(t,r,o){var i=toPropertyKey(r);i in t?Tt.f(t,i,createPropertyDescriptor(0,o)):t[i]=o},Rr=Array,Or=Math.max,arraySliceSimple=function(t,r,o){for(var i=lengthOfArrayLike(t),s=toAbsoluteIndex(r,i),l=toAbsoluteIndex(void 0===o?i:o,i),u=Rr(Or(l-s,0)),h=0;s<l;s++,h++)createProperty(u,h,t[s]);return u.length=h,u},Nr=nr.f,Mr="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Dr={f:function getOwnPropertyNames(t){return Mr&&"Window"==classofRaw(t)?function(t){try{return Nr(t)}catch(t){return arraySliceSimple(Mr)}}(t):Nr(toIndexedObject(t))}},defineBuiltInAccessor=function(t,r,o){return o.get&&Vt(o.get,r,{getter:!0}),o.set&&Vt(o.set,r,{setter:!0}),Tt.f(t,r,o)},Fr={f:wellKnownSymbol},Lr=i,Ur=Tt.f,wellKnownSymbolDefine=function(t){var r=Lr.Symbol||(Lr.Symbol={});tt(r,t)||Ur(r,t,{value:Fr.f(t)})},symbolDefineToPrimitive=function(){var t=getBuiltIn("Symbol"),r=t&&t.prototype,o=r&&r.valueOf,i=wellKnownSymbol("toPrimitive");r&&!r[i]&&defineBuiltIn(r,i,(function(t){return h(o,this)}),{arity:1})},Br=Tt.f,Hr=wellKnownSymbol("toStringTag"),setToStringTag=function(t,r,o){t&&!o&&(t=t.prototype),t&&!tt(t,Hr)&&Br(t,Hr,{configurable:!0,value:r})},functionUncurryThisClause=function(t){if("Function"===classofRaw(t))return N(t)},$r=functionUncurryThisClause(functionUncurryThisClause.bind),functionBindContext=function(t,r){return aCallable(t),void 0===r?t:l?$r(t,r):function(){return t.apply(r,arguments)}},qr=Array.isArray||function isArray(t){return"Array"==classofRaw(t)},noop=function(){},jr=[],zr=getBuiltIn("Reflect","construct"),Gr=/^\s*(?:class|function)\b/,Vr=N(Gr.exec),Kr=!Gr.exec(noop),Wr=function isConstructor(t){if(!W(t))return!1;try{return zr(noop,jr,t),!0}catch(t){return!1}},Qr=function isConstructor(t){if(!W(t))return!1;switch(Cr(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Kr||!!Vr(Gr,Dt(t))}catch(t){return!0}};Qr.sham=!0;var Yr=!zr||fails((function(){var t;return Wr(Wr.call)||!Wr(Object)||!Wr((function(){t=!0}))||t}))?Qr:Wr,Jr=wellKnownSymbol("species"),Xr=Array,arraySpeciesCreate=function(t,r){return new(function(t){var r;return qr(t)&&(r=t.constructor,(Yr(r)&&(r===Xr||qr(r.prototype))||Z(r)&&null===(r=r[Jr]))&&(r=void 0)),void 0===r?Xr:r}(t))(0===r?0:r)},Zr=N([].push),createMethod$6=function(t){var r=1==t,o=2==t,i=3==t,s=4==t,l=6==t,u=7==t,h=5==t||l;return function(m,v,C,_){for(var k,E,R=toObject(m),N=q(R),M=functionBindContext(v,C),B=lengthOfArrayLike(N),H=0,$=_||arraySpeciesCreate,j=r?$(m,B):o||u?$(m,0):void 0;B>H;H++)if((h||H in N)&&(E=M(k=N[H],H,R),t))if(r)j[H]=E;else if(E)switch(t){case 3:return!0;case 5:return k;case 6:return H;case 2:Zr(j,k)}else switch(t){case 4:return!1;case 7:Zr(j,k)}return l?-1:i||s?s:j}},eo={forEach:createMethod$6(0),map:createMethod$6(1),filter:createMethod$6(2),some:createMethod$6(3),every:createMethod$6(4),find:createMethod$6(5),findIndex:createMethod$6(6),filterReject:createMethod$6(7)},to=eo.forEach,ro=sharedKey("hidden"),oo="Symbol",no="prototype",io=Gt.set,so=Gt.getterFor(oo),ao=Object[no],co=i.Symbol,lo=co&&co[no],uo=i.TypeError,ho=i.QObject,po=gt.f,fo=Tt.f,go=Dr.f,mo=_.f,vo=N([].push),yo=Ve("symbols"),bo=Ve("op-symbols"),wo=Ve("wks"),Co=!ho||!ho[no]||!ho[no].findChild,_o=s&&fails((function(){return 7!=Pr(fo({},"a",{get:function(){return fo(this,"a",{value:7}).a}})).a}))?function(t,r,o){var i=po(ao,r);i&&delete ao[r],fo(t,r,o),i&&t!==ao&&fo(ao,r,i)}:fo,wrap$1=function(t,r){var o=yo[t]=Pr(lo);return io(o,{type:oo,tag:t,description:r}),s||(o.description=r),o},ko=function defineProperty(t,r,o){t===ao&&ko(bo,r,o),anObject(t);var i=toPropertyKey(r);return anObject(o),tt(yo,i)?(o.enumerable?(tt(t,ro)&&t[ro][i]&&(t[ro][i]=!1),o=Pr(o,{enumerable:createPropertyDescriptor(0,!1)})):(tt(t,ro)||fo(t,ro,createPropertyDescriptor(1,{})),t[ro][i]=!0),_o(t,i,o)):fo(t,i,o)},So=function defineProperties(t,r){anObject(t);var o=toIndexedObject(r),i=kr(o).concat($getOwnPropertySymbols(o));return to(i,(function(r){s&&!h(To,o,r)||ko(t,r,o[r])})),t},To=function propertyIsEnumerable(t){var r=toPropertyKey(t),o=h(mo,this,r);return!(this===ao&&tt(yo,r)&&!tt(bo,r))&&(!(o||!tt(this,r)||!tt(yo,r)||tt(this,ro)&&this[ro][r])||o)},Eo=function getOwnPropertyDescriptor(t,r){var o=toIndexedObject(t),i=toPropertyKey(r);if(o!==ao||!tt(yo,i)||tt(bo,i)){var s=po(o,i);return!s||!tt(yo,i)||tt(o,ro)&&o[ro][i]||(s.enumerable=!0),s}},xo=function getOwnPropertyNames(t){var r=go(toIndexedObject(t)),o=[];return to(r,(function(t){tt(yo,t)||tt(Bt,t)||vo(o,t)})),o},$getOwnPropertySymbols=function(t){var r=t===ao,o=go(r?bo:toIndexedObject(t)),i=[];return to(o,(function(t){!tt(yo,t)||r&&!tt(ao,t)||vo(i,yo[t])})),i};we||(lo=(co=function Symbol(){if(re(lo,this))throw uo("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?toString_1(arguments[0]):void 0,r=uid(t),setter=function(t){this===ao&&h(setter,bo,t),tt(this,ro)&&tt(this[ro],r)&&(this[ro][r]=!1),_o(this,r,createPropertyDescriptor(1,t))};return s&&Co&&_o(ao,r,{configurable:!0,set:setter}),wrap$1(r,t)})[no],defineBuiltIn(lo,"toString",(function toString(){return so(this).tag})),defineBuiltIn(co,"withoutSetter",(function(t){return wrap$1(uid(t),t)})),_.f=To,Tt.f=ko,Tr.f=So,gt.f=Eo,nr.f=Dr.f=xo,ir.f=$getOwnPropertySymbols,Fr.f=function(t){return wrap$1(wellKnownSymbol(t),t)},s&&(defineBuiltInAccessor(lo,"description",{configurable:!0,get:function description(){return so(this).description}}),defineBuiltIn(ao,"propertyIsEnumerable",To,{unsafe:!0}))),_export({global:!0,constructor:!0,wrap:!0,forced:!we,sham:!we},{Symbol:co}),to(kr(wo),(function(t){wellKnownSymbolDefine(t)})),_export({target:oo,stat:!0,forced:!we},{useSetter:function(){Co=!0},useSimple:function(){Co=!1}}),_export({target:"Object",stat:!0,forced:!we,sham:!s},{create:function create(t,r){return void 0===r?Pr(t):So(Pr(t),r)},defineProperty:ko,defineProperties:So,getOwnPropertyDescriptor:Eo}),_export({target:"Object",stat:!0,forced:!we},{getOwnPropertyNames:xo}),symbolDefineToPrimitive(),setToStringTag(co,oo),Bt[ro]=!0;var Io=we&&!!Symbol.for&&!!Symbol.keyFor,Ao=Ve("string-to-symbol-registry"),Po=Ve("symbol-to-string-registry");_export({target:"Symbol",stat:!0,forced:!Io},{for:function(t){var r=toString_1(t);if(tt(Ao,r))return Ao[r];var o=getBuiltIn("Symbol")(r);return Ao[r]=o,Po[o]=r,o}});var Ro=Ve("symbol-to-string-registry");_export({target:"Symbol",stat:!0,forced:!Io},{keyFor:function keyFor(t){if(!Ee(t))throw TypeError(tryToString(t)+" is not a symbol");if(tt(Ro,t))return Ro[t]}});var Oo=Function.prototype,No=Oo.apply,Mo=Oo.call,Do="object"==typeof Reflect&&Reflect.apply||(l?Mo.bind(No):function(){return Mo.apply(No,arguments)}),Fo=N([].slice),Lo=N([].push),Uo=String,Bo=getBuiltIn("JSON","stringify"),Ho=N(/./.exec),$o=N("".charAt),qo=N("".charCodeAt),jo=N("".replace),zo=N(1..toString),Go=/[\uD800-\uDFFF]/g,Vo=/^[\uD800-\uDBFF]$/,Ko=/^[\uDC00-\uDFFF]$/,Wo=!we||fails((function(){var t=getBuiltIn("Symbol")();return"[null]"!=Bo([t])||"{}"!=Bo({a:t})||"{}"!=Bo(Object(t))})),Qo=fails((function(){return'"\\udf06\\ud834"'!==Bo("\udf06\ud834")||'"\\udead"'!==Bo("\udead")})),stringifyWithSymbolsFix=function(t,r){var o=Fo(arguments),i=function(t){if(W(t))return t;if(qr(t)){for(var r=t.length,o=[],i=0;i<r;i++){var s=t[i];"string"==typeof s?Lo(o,s):"number"!=typeof s&&"Number"!=classofRaw(s)&&"String"!=classofRaw(s)||Lo(o,toString_1(s))}var l=o.length,u=!0;return function(t,r){if(u)return u=!1,r;if(qr(this))return r;for(var i=0;i<l;i++)if(o[i]===t)return r}}}(r);if(W(i)||void 0!==t&&!Ee(t))return o[1]=function(t,r){if(W(i)&&(r=h(i,this,Uo(t),r)),!Ee(r))return r},Do(Bo,null,o)},fixIllFormed=function(t,r,o){var i=$o(o,r-1),s=$o(o,r+1);return Ho(Vo,t)&&!Ho(Ko,s)||Ho(Ko,t)&&!Ho(Vo,i)?"\\u"+zo(qo(t,0),16):t};Bo&&_export({target:"JSON",stat:!0,arity:3,forced:Wo||Qo},{stringify:function stringify(t,r,o){var i=Fo(arguments),s=Do(Wo?stringifyWithSymbolsFix:Bo,null,i);return Qo&&"string"==typeof s?jo(s,Go,fixIllFormed):s}});var Yo=!we||fails((function(){ir.f(1)}));_export({target:"Object",stat:!0,forced:Yo},{getOwnPropertySymbols:function getOwnPropertySymbols(t){var r=ir.f;return r?r(toObject(t)):[]}});var Jo=i.Symbol,Xo=Jo&&Jo.prototype;if(s&&W(Jo)&&(!("description"in Xo)||void 0!==Jo().description)){var Zo={},en=function Symbol(){var t=arguments.length<1||void 0===arguments[0]?void 0:toString_1(arguments[0]),r=re(Xo,this)?new Jo(t):void 0===t?Jo():Jo(t);return""===t&&(Zo[r]=!0),r};copyConstructorProperties$1(en,Jo),en.prototype=Xo,Xo.constructor=en;var tn="Symbol(test)"==String(Jo("test")),rn=N(Xo.valueOf),on=N(Xo.toString),nn=/^Symbol\((.*)\)[^)]+$/,sn=N("".replace),an=N("".slice);defineBuiltInAccessor(Xo,"description",{configurable:!0,get:function description(){var t=rn(this);if(tt(Zo,t))return"";var r=on(t),o=tn?an(r,7,-1):sn(r,nn,"$1");return""===o?void 0:o}}),_export({global:!0,constructor:!0,forced:!0},{Symbol:en})}wellKnownSymbolDefine("asyncIterator"),wellKnownSymbolDefine("hasInstance"),wellKnownSymbolDefine("isConcatSpreadable"),wellKnownSymbolDefine("iterator"),wellKnownSymbolDefine("match"),wellKnownSymbolDefine("matchAll"),wellKnownSymbolDefine("replace"),wellKnownSymbolDefine("search"),wellKnownSymbolDefine("species"),wellKnownSymbolDefine("split"),wellKnownSymbolDefine("toPrimitive"),symbolDefineToPrimitive(),wellKnownSymbolDefine("toStringTag"),setToStringTag(getBuiltIn("Symbol"),"Symbol"),wellKnownSymbolDefine("unscopables");var cn=String,ln=TypeError,aPossiblePrototype=function(t){if("object"==typeof t||W(t))return t;throw ln("Can't set "+cn(t)+" as a prototype")},dn=Object.setPrototypeOf||("__proto__"in{}?function(){var t,r=!1,o={};try{t=function(t,r,o){try{return N(aCallable(Object.getOwnPropertyDescriptor(t,r)[o]))}catch(t){}}(Object.prototype,"__proto__","set"),t(o,[]),r=o instanceof Array}catch(t){}return function setPrototypeOf(o,i){return anObject(o),aPossiblePrototype(i),r?t(o,i):o.__proto__=i,o}}():void 0),un=Tt.f,proxyAccessor=function(t,r,o){o in t||un(t,o,{configurable:!0,get:function(){return r[o]},set:function(t){r[o]=t}})},inheritIfRequired=function(t,r,o){var i,s;return dn&&W(i=r.constructor)&&i!==o&&Z(s=i.prototype)&&s!==o.prototype&&dn(t,s),t},normalizeStringArgument=function(t,r){return void 0===t?arguments.length<2?"":r:toString_1(t)},installErrorCause=function(t,r){Z(r)&&"cause"in r&&Et(t,"cause",r.cause)},hn=Error,pn=N("".replace),fn=String(hn("zxcasd").stack),gn=/\n\s*at [^:]*:[^\n]*/,mn=gn.test(fn),errorStackClear=function(t,r){if(mn&&"string"==typeof t&&!hn.prepareStackTrace)for(;r--;)t=pn(t,gn,"");return t},vn=!fails((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",createPropertyDescriptor(1,7)),7!==t.stack)})),yn=Error.captureStackTrace,errorStackInstall=function(t,r,o,i){vn&&(yn?yn(t,r):Et(t,"stack",errorStackClear(o,i)))},wrapErrorConstructorWithCause=function(t,r,o,i){var l="stackTraceLimit",u=i?2:1,h=t.split("."),m=h[h.length-1],v=getBuiltIn.apply(null,h);if(v){var C=v.prototype;if(tt(C,"cause")&&delete C.cause,!o)return v;var _=getBuiltIn("Error"),k=r((function(t,r){var o=normalizeStringArgument(i?r:t,void 0),s=i?new v(t):new v;return void 0!==o&&Et(s,"message",o),errorStackInstall(s,k,s.stack,2),this&&re(C,this)&&inheritIfRequired(s,this,k),arguments.length>u&&installErrorCause(s,arguments[u]),s}));k.prototype=C,"Error"!==m?dn?dn(k,_):copyConstructorProperties$1(k,_,{name:!0}):s&&l in v&&(proxyAccessor(k,v,l),proxyAccessor(k,v,"prepareStackTrace")),copyConstructorProperties$1(k,v);try{C.name!==m&&Et(C,"name",m),C.constructor=k}catch(t){}return k}},bn="WebAssembly",wn=i[bn],Cn=7!==Error("e",{cause:7}).cause,exportGlobalErrorCauseWrapper=function(t,r){var o={};o[t]=wrapErrorConstructorWithCause(t,r,Cn),_export({global:!0,constructor:!0,arity:1,forced:Cn},o)},exportWebAssemblyErrorCauseWrapper=function(t,r){if(wn&&wn[t]){var o={};o[t]=wrapErrorConstructorWithCause(bn+"."+t,r,Cn),_export({target:bn,stat:!0,constructor:!0,arity:1,forced:Cn},o)}};exportGlobalErrorCauseWrapper("Error",(function(t){return function Error(r){return Do(t,this,arguments)}})),exportGlobalErrorCauseWrapper("EvalError",(function(t){return function EvalError(r){return Do(t,this,arguments)}})),exportGlobalErrorCauseWrapper("RangeError",(function(t){return function RangeError(r){return Do(t,this,arguments)}})),exportGlobalErrorCauseWrapper("ReferenceError",(function(t){return function ReferenceError(r){return Do(t,this,arguments)}})),exportGlobalErrorCauseWrapper("SyntaxError",(function(t){return function SyntaxError(r){return Do(t,this,arguments)}})),exportGlobalErrorCauseWrapper("TypeError",(function(t){return function TypeError(r){return Do(t,this,arguments)}})),exportGlobalErrorCauseWrapper("URIError",(function(t){return function URIError(r){return Do(t,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("CompileError",(function(t){return function CompileError(r){return Do(t,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("LinkError",(function(t){return function LinkError(r){return Do(t,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("RuntimeError",(function(t){return function RuntimeError(r){return Do(t,this,arguments)}}));var _n=Error.prototype.toString,kn=fails((function(){if(s){var t=Pr(Object.defineProperty({},"name",{get:function(){return this===t}}));if("true"!==_n.call(t))return!0}return"2: 1"!==_n.call({message:1,name:2})||"Error"!==_n.call({})}))?function toString(){var t=anObject(this),r=normalizeStringArgument(t.name,"Error"),o=normalizeStringArgument(t.message);return r?o?r+": "+o:r:o}:_n,Sn=Error.prototype;Sn.toString!==kn&&defineBuiltIn(Sn,"toString",kn);var Tn=!fails((function(){function F(){}return F.prototype.constructor=null,Object.getPrototypeOf(new F)!==F.prototype})),En=sharedKey("IE_PROTO"),xn=Object,In=xn.prototype,An=Tn?xn.getPrototypeOf:function(t){var r=toObject(t);if(tt(r,En))return r[En];var o=r.constructor;return W(o)&&r instanceof o?o.prototype:r instanceof xn?In:null},Pn={},Rn=wellKnownSymbol("iterator"),On=Array.prototype,isArrayIteratorMethod=function(t){return void 0!==t&&(Pn.Array===t||On[Rn]===t)},Nn=wellKnownSymbol("iterator"),getIteratorMethod=function(t){if(!isNullOrUndefined(t))return getMethod$1(t,Nn)||getMethod$1(t,"@@iterator")||Pn[Cr(t)]},Mn=TypeError,getIterator=function(t,r){var o=arguments.length<2?getIteratorMethod(t):r;if(aCallable(o))return anObject(h(o,t));throw Mn(tryToString(t)+" is not iterable")},iteratorClose=function(t,r,o){var i,s;anObject(t);try{if(!(i=getMethod$1(t,"return"))){if("throw"===r)throw o;return o}i=h(i,t)}catch(t){s=!0,i=t}if("throw"===r)throw o;if(s)throw i;return anObject(i),o},Dn=TypeError,Result=function(t,r){this.stopped=t,this.result=r},Fn=Result.prototype,iterate=function(t,r,o){var i,s,l,u,m,v,C,_=o&&o.that,k=!(!o||!o.AS_ENTRIES),E=!(!o||!o.IS_RECORD),R=!(!o||!o.IS_ITERATOR),N=!(!o||!o.INTERRUPTED),M=functionBindContext(r,_),stop=function(t){return i&&iteratorClose(i,"normal",t),new Result(!0,t)},callFn=function(t){return k?(anObject(t),N?M(t[0],t[1],stop):M(t[0],t[1])):N?M(t,stop):M(t)};if(E)i=t.iterator;else if(R)i=t;else{if(!(s=getIteratorMethod(t)))throw Dn(tryToString(t)+" is not iterable");if(isArrayIteratorMethod(s)){for(l=0,u=lengthOfArrayLike(t);u>l;l++)if((m=callFn(t[l]))&&re(Fn,m))return m;return new Result(!1)}i=getIterator(t,s)}for(v=E?t.next:i.next;!(C=h(v,i)).done;){try{m=callFn(C.value)}catch(t){iteratorClose(i,"throw",t)}if("object"==typeof m&&m&&re(Fn,m))return m}return new Result(!1)},Ln=wellKnownSymbol("toStringTag"),Un=Error,Bn=[].push,Hn=function AggregateError(t,r){var o,i=re($n,this);dn?o=dn(Un(),i?An(this):$n):(o=i?this:Pr($n),Et(o,Ln,"Error")),void 0!==r&&Et(o,"message",normalizeStringArgument(r)),errorStackInstall(o,Hn,o.stack,1),arguments.length>2&&installErrorCause(o,arguments[2]);var s=[];return iterate(t,Bn,{that:s}),Et(o,"errors",s),o};dn?dn(Hn,Un):copyConstructorProperties$1(Hn,Un,{name:!0});var $n=Hn.prototype=Pr(Un.prototype,{constructor:createPropertyDescriptor(1,Hn),message:createPropertyDescriptor(1,""),name:createPropertyDescriptor(1,"AggregateError")});_export({global:!0,constructor:!0,arity:2},{AggregateError:Hn});var qn="AggregateError",jn=getBuiltIn(qn),zn=!fails((function(){return 1!==jn([1]).errors[0]}))&&fails((function(){return 7!==jn([1],qn,{cause:7}).cause}));_export({global:!0,constructor:!0,arity:2,forced:zn},{AggregateError:wrapErrorConstructorWithCause(qn,(function(t){return function AggregateError(r,o){return Do(t,this,arguments)}}),zn,!0)});var Gn=Tt.f,Vn=wellKnownSymbol("unscopables"),Kn=Array.prototype;null==Kn[Vn]&&Gn(Kn,Vn,{configurable:!0,value:Pr(null)});var addToUnscopables=function(t){Kn[Vn][t]=!0};_export({target:"Array",proto:!0},{at:function at(t){var r=toObject(this),o=lengthOfArrayLike(r),i=toIntegerOrInfinity(t),s=i>=0?i:o+i;return s<0||s>=o?void 0:r[s]}}),addToUnscopables("at");var Wn=TypeError,doesNotExceedSafeInteger=function(t){if(t>9007199254740991)throw Wn("Maximum allowed index exceeded");return t},Qn=wellKnownSymbol("species"),arrayMethodHasSpeciesSupport=function(t){return me>=51||!fails((function(){var r=[];return(r.constructor={})[Qn]=function(){return{foo:1}},1!==r[t](Boolean).foo}))},Yn=wellKnownSymbol("isConcatSpreadable"),Jn=me>=51||!fails((function(){var t=[];return t[Yn]=!1,t.concat()[0]!==t})),isConcatSpreadable=function(t){if(!Z(t))return!1;var r=t[Yn];return void 0!==r?!!r:qr(t)},Xn=!Jn||!arrayMethodHasSpeciesSupport("concat");_export({target:"Array",proto:!0,arity:1,forced:Xn},{concat:function concat(t){var r,o,i,s,l,u=toObject(this),h=arraySpeciesCreate(u,0),m=0;for(r=-1,i=arguments.length;r<i;r++)if(isConcatSpreadable(l=-1===r?u:arguments[r]))for(s=lengthOfArrayLike(l),doesNotExceedSafeInteger(m+s),o=0;o<s;o++,m++)o in l&&createProperty(h,m,l[o]);else doesNotExceedSafeInteger(m+1),createProperty(h,m++,l);return h.length=m,h}});var Zn=TypeError,deletePropertyOrThrow=function(t,r){if(!delete t[r])throw Zn("Cannot delete property "+tryToString(r)+" of "+tryToString(t))},ci=Math.min,hi=[].copyWithin||function copyWithin(t,r){var o=toObject(this),i=lengthOfArrayLike(o),s=toAbsoluteIndex(t,i),l=toAbsoluteIndex(r,i),u=arguments.length>2?arguments[2]:void 0,h=ci((void 0===u?i:toAbsoluteIndex(u,i))-l,i-s),m=1;for(l<s&&s<l+h&&(m=-1,l+=h-1,s+=h-1);h-- >0;)l in o?o[s]=o[l]:deletePropertyOrThrow(o,s),s+=m,l+=m;return o};_export({target:"Array",proto:!0},{copyWithin:hi}),addToUnscopables("copyWithin");var arrayMethodIsStrict=function(t,r){var o=[][t];return!!o&&fails((function(){o.call(null,r||function(){return 1},1)}))},pi=eo.every,yi=arrayMethodIsStrict("every");_export({target:"Array",proto:!0,forced:!yi},{every:function every(t){return pi(this,t,arguments.length>1?arguments[1]:void 0)}});var Ci=function fill(t){for(var r=toObject(this),o=lengthOfArrayLike(r),i=arguments.length,s=toAbsoluteIndex(i>1?arguments[1]:void 0,o),l=i>2?arguments[2]:void 0,u=void 0===l?o:toAbsoluteIndex(l,o);u>s;)r[s++]=t;return r};_export({target:"Array",proto:!0},{fill:Ci}),addToUnscopables("fill");var _i=eo.filter,Ii=arrayMethodHasSpeciesSupport("filter");_export({target:"Array",proto:!0,forced:!Ii},{filter:function filter(t){return _i(this,t,arguments.length>1?arguments[1]:void 0)}});var Ai=eo.find,Ri="find",Di=!0;Ri in[]&&Array(1)[Ri]((function(){Di=!1})),_export({target:"Array",proto:!0,forced:Di},{find:function find(t){return Ai(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables(Ri);var Fi=eo.findIndex,Ki="findIndex",Qi=!0;Ki in[]&&Array(1)[Ki]((function(){Qi=!1})),_export({target:"Array",proto:!0,forced:Qi},{findIndex:function findIndex(t){return Fi(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables(Ki);var createMethod$5=function(t){var r=1==t;return function(o,i,s){for(var l,u=toObject(o),h=q(u),m=functionBindContext(i,s),v=lengthOfArrayLike(h);v-- >0;)if(m(l=h[v],v,u))switch(t){case 0:return l;case 1:return v}return r?-1:void 0}},Ji={findLast:createMethod$5(0),findLastIndex:createMethod$5(1)},es=Ji.findLast;_export({target:"Array",proto:!0},{findLast:function findLast(t){return es(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("findLast");var ts=Ji.findLastIndex;_export({target:"Array",proto:!0},{findLastIndex:function findLastIndex(t){return ts(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("findLastIndex");var flattenIntoArray=function(t,r,o,i,s,l,u,h){for(var m,v,C=s,_=0,k=!!u&&functionBindContext(u,h);_<i;)_ in o&&(m=k?k(o[_],_,r):o[_],l>0&&qr(m)?(v=lengthOfArrayLike(m),C=flattenIntoArray(t,r,m,v,C,l-1)-1):(doesNotExceedSafeInteger(C+1),t[C]=m),C++),_++;return C},rs=flattenIntoArray;_export({target:"Array",proto:!0},{flat:function flat(){var t=arguments.length?arguments[0]:void 0,r=toObject(this),o=lengthOfArrayLike(r),i=arraySpeciesCreate(r,0);return i.length=rs(i,r,r,o,0,void 0===t?1:toIntegerOrInfinity(t)),i}}),_export({target:"Array",proto:!0},{flatMap:function flatMap(t){var r,o=toObject(this),i=lengthOfArrayLike(o);return aCallable(t),(r=arraySpeciesCreate(o,0)).length=rs(r,o,o,i,0,1,t,arguments.length>1?arguments[1]:void 0),r}});var os=eo.forEach,ns=arrayMethodIsStrict("forEach")?[].forEach:function forEach(t){return os(this,t,arguments.length>1?arguments[1]:void 0)};_export({target:"Array",proto:!0,forced:[].forEach!=ns},{forEach:ns});var callWithSafeIterationClosing=function(t,r,o,i){try{return i?r(anObject(o)[0],o[1]):r(o)}catch(r){iteratorClose(t,"throw",r)}},ss=Array,as=function from(t){var r=toObject(t),o=Yr(this),i=arguments.length,s=i>1?arguments[1]:void 0,l=void 0!==s;l&&(s=functionBindContext(s,i>2?arguments[2]:void 0));var u,m,v,C,_,k,E=getIteratorMethod(r),R=0;if(!E||this===ss&&isArrayIteratorMethod(E))for(u=lengthOfArrayLike(r),m=o?new this(u):ss(u);u>R;R++)k=l?s(r[R],R):r[R],createProperty(m,R,k);else for(_=(C=getIterator(r,E)).next,m=o?new this:[];!(v=h(_,C)).done;R++)k=l?callWithSafeIterationClosing(C,s,[v.value,R],!0):v.value,createProperty(m,R,k);return m.length=R,m},cs=wellKnownSymbol("iterator"),ls=!1;try{var ds=0,us={next:function(){return{done:!!ds++}},return:function(){ls=!0}};us[cs]=function(){return this},Array.from(us,(function(){throw 2}))}catch(t){}var checkCorrectnessOfIteration=function(t,r){if(!r&&!ls)return!1;var o=!1;try{var i={};i[cs]=function(){return{next:function(){return{done:o=!0}}}},t(i)}catch(t){}return o},hs=!checkCorrectnessOfIteration((function(t){Array.from(t)}));_export({target:"Array",stat:!0,forced:hs},{from:as});var ps=Zt.includes,fs=fails((function(){return!Array(1).includes()}));_export({target:"Array",proto:!0,forced:fs},{includes:function includes(t){return ps(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("includes");var gs=Zt.indexOf,ms=functionUncurryThisClause([].indexOf),vs=!!ms&&1/ms([1],1,-0)<0,ys=vs||!arrayMethodIsStrict("indexOf");_export({target:"Array",proto:!0,forced:ys},{indexOf:function indexOf(t){var r=arguments.length>1?arguments[1]:void 0;return vs?ms(this,t,r)||0:gs(this,t,r)}}),_export({target:"Array",stat:!0},{isArray:qr});var bs,ws,Cs,_s=wellKnownSymbol("iterator"),ks=!1;[].keys&&("next"in(Cs=[].keys())?(ws=An(An(Cs)))!==Object.prototype&&(bs=ws):ks=!0);var Ss=!Z(bs)||fails((function(){var t={};return bs[_s].call(t)!==t}));Ss&&(bs={}),W(bs[_s])||defineBuiltIn(bs,_s,(function(){return this}));var Ts={IteratorPrototype:bs,BUGGY_SAFARI_ITERATORS:ks},Es=Ts.IteratorPrototype,returnThis$1=function(){return this},iteratorCreateConstructor=function(t,r,o,i){var s=r+" Iterator";return t.prototype=Pr(Es,{next:createPropertyDescriptor(+!i,o)}),setToStringTag(t,s,!1),Pn[s]=returnThis$1,t},xs=Pt.PROPER,Is=Pt.CONFIGURABLE,As=Ts.IteratorPrototype,Ps=Ts.BUGGY_SAFARI_ITERATORS,Rs=wellKnownSymbol("iterator"),Os="keys",Ns="values",Ms="entries",returnThis=function(){return this},iteratorDefine=function(t,r,o,i,s,l,u){iteratorCreateConstructor(o,r,i);var m,v,C,getIterationMethod=function(t){if(t===s&&N)return N;if(!Ps&&t in E)return E[t];switch(t){case Os:return function keys(){return new o(this,t)};case Ns:return function values(){return new o(this,t)};case Ms:return function entries(){return new o(this,t)}}return function(){return new o(this)}},_=r+" Iterator",k=!1,E=t.prototype,R=E[Rs]||E["@@iterator"]||s&&E[s],N=!Ps&&R||getIterationMethod(s),M="Array"==r&&E.entries||R;if(M&&(m=An(M.call(new t)))!==Object.prototype&&m.next&&(An(m)!==As&&(dn?dn(m,As):W(m[Rs])||defineBuiltIn(m,Rs,returnThis)),setToStringTag(m,_,!0)),xs&&s==Ns&&R&&R.name!==Ns&&(Is?Et(E,"name",Ns):(k=!0,N=function values(){return h(R,this)})),s)if(v={values:getIterationMethod(Ns),keys:l?N:getIterationMethod(Os),entries:getIterationMethod(Ms)},u)for(C in v)(Ps||k||!(C in E))&&defineBuiltIn(E,C,v[C]);else _export({target:r,proto:!0,forced:Ps||k},v);return E[Rs]!==N&&defineBuiltIn(E,Rs,N,{name:s}),Pn[r]=N,v},createIterResultObject=function(t,r){return{value:t,done:r}},Ds=Tt.f,Fs="Array Iterator",Ls=Gt.set,Us=Gt.getterFor(Fs),Bs=iteratorDefine(Array,"Array",(function(t,r){Ls(this,{type:Fs,target:toIndexedObject(t),index:0,kind:r})}),(function(){var t=Us(this),r=t.target,o=t.kind,i=t.index++;return!r||i>=r.length?(t.target=void 0,createIterResultObject(void 0,!0)):createIterResultObject("keys"==o?i:"values"==o?r[i]:[i,r[i]],!1)}),"values"),Hs=Pn.Arguments=Pn.Array;if(addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries"),s&&"values"!==Hs.name)try{Ds(Hs,"name",{value:"values"})}catch(t){}var $s=N([].join),qs=q!=Object||!arrayMethodIsStrict("join",",");_export({target:"Array",proto:!0,forced:qs},{join:function join(t){return $s(toIndexedObject(this),void 0===t?",":t)}});var js=Math.min,zs=[].lastIndexOf,Gs=!!zs&&1/[1].lastIndexOf(1,-0)<0,Vs=arrayMethodIsStrict("lastIndexOf"),Ks=Gs||!Vs?function lastIndexOf(t){if(Gs)return Do(zs,this,arguments)||0;var r=toIndexedObject(this),o=lengthOfArrayLike(r),i=o-1;for(arguments.length>1&&(i=js(i,toIntegerOrInfinity(arguments[1]))),i<0&&(i=o+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:zs;_export({target:"Array",proto:!0,forced:Ks!==[].lastIndexOf},{lastIndexOf:Ks});var Ws=eo.map,Qs=arrayMethodHasSpeciesSupport("map");_export({target:"Array",proto:!0,forced:!Qs},{map:function map(t){return Ws(this,t,arguments.length>1?arguments[1]:void 0)}});var Ys=Array,Js=fails((function(){function F(){}return!(Ys.of.call(F)instanceof F)}));_export({target:"Array",stat:!0,forced:Js},{of:function of(){for(var t=0,r=arguments.length,o=new(Yr(this)?this:Ys)(r);r>t;)createProperty(o,t,arguments[t++]);return o.length=r,o}});var Xs=TypeError,Zs=Object.getOwnPropertyDescriptor,ea=s&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,r){if(qr(t)&&!Zs(t,"length").writable)throw Xs("Cannot set read only .length");return t.length=r}:function(t,r){return t.length=r},oa=fails((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}();_export({target:"Array",proto:!0,arity:1,forced:oa},{push:function push(t){var r=toObject(this),o=lengthOfArrayLike(r),i=arguments.length;doesNotExceedSafeInteger(o+i);for(var s=0;s<i;s++)r[o]=arguments[s],o++;return ea(r,o),o}});var na=TypeError,createMethod$4=function(t){return function(r,o,i,s){aCallable(o);var l=toObject(r),u=q(l),h=lengthOfArrayLike(l),m=t?h-1:0,v=t?-1:1;if(i<2)for(;;){if(m in u){s=u[m],m+=v;break}if(m+=v,t?m<0:h<=m)throw na("Reduce of empty array with no initial value")}for(;t?m>=0:h>m;m+=v)m in u&&(s=o(s,u[m],m,l));return s}},aa={left:createMethod$4(!1),right:createMethod$4(!0)},ca="undefined"!=typeof process&&"process"==classofRaw(process),la=aa.left,ha=!ca&&me>79&&me<83||!arrayMethodIsStrict("reduce");_export({target:"Array",proto:!0,forced:ha},{reduce:function reduce(t){var r=arguments.length;return la(this,t,r,r>1?arguments[1]:void 0)}});var pa=aa.right,ga=!ca&&me>79&&me<83||!arrayMethodIsStrict("reduceRight");_export({target:"Array",proto:!0,forced:ga},{reduceRight:function reduceRight(t){return pa(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var ma=N([].reverse),va=[1,2];_export({target:"Array",proto:!0,forced:String(va)===String(va.reverse())},{reverse:function reverse(){return qr(this)&&(this.length=this.length),ma(this)}});var _a=arrayMethodHasSpeciesSupport("slice"),Ta=wellKnownSymbol("species"),Fa=Array,Ua=Math.max;_export({target:"Array",proto:!0,forced:!_a},{slice:function slice(t,r){var o,i,s,l=toIndexedObject(this),u=lengthOfArrayLike(l),h=toAbsoluteIndex(t,u),m=toAbsoluteIndex(void 0===r?u:r,u);if(qr(l)&&(o=l.constructor,(Yr(o)&&(o===Fa||qr(o.prototype))||Z(o)&&null===(o=o[Ta]))&&(o=void 0),o===Fa||void 0===o))return Fo(l,h,m);for(i=new(void 0===o?Fa:o)(Ua(m-h,0)),s=0;h<m;h++,s++)h in l&&createProperty(i,s,l[h]);return i.length=s,i}});var $a=eo.some,qa=arrayMethodIsStrict("some");_export({target:"Array",proto:!0,forced:!qa},{some:function some(t){return $a(this,t,arguments.length>1?arguments[1]:void 0)}});var Ka=Math.floor,mergeSort=function(t,r){var o=t.length,i=Ka(o/2);return o<8?insertionSort(t,r):merge(t,mergeSort(arraySliceSimple(t,0,i),r),mergeSort(arraySliceSimple(t,i),r),r)},insertionSort=function(t,r){for(var o,i,s=t.length,l=1;l<s;){for(i=l,o=t[l];i&&r(t[i-1],o)>0;)t[i]=t[--i];i!==l++&&(t[i]=o)}return t},merge=function(t,r,o,i){for(var s=r.length,l=o.length,u=0,h=0;u<s||h<l;)t[u+h]=u<s&&h<l?i(r[u],o[h])<=0?r[u++]:o[h++]:u<s?r[u++]:o[h++];return t},Wa=mergeSort,tc=oe.match(/firefox\/(\d+)/i),rc=!!tc&&+tc[1],oc=/MSIE|Trident/.test(oe),nc=oe.match(/AppleWebKit\/(\d+)\./),ic=!!nc&&+nc[1],sc=[],ac=N(sc.sort),cc=N(sc.push),dc=fails((function(){sc.sort(void 0)})),uc=fails((function(){sc.sort(null)})),hc=arrayMethodIsStrict("sort"),pc=!fails((function(){if(me)return me<70;if(!(rc&&rc>3)){if(oc)return!0;if(ic)return ic<603;var t,r,o,i,s="";for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:o=3;break;case 68:case 71:o=4;break;default:o=2}for(i=0;i<47;i++)sc.push({k:r+i,v:o})}for(sc.sort((function(t,r){return r.v-t.v})),i=0;i<sc.length;i++)r=sc[i].k.charAt(0),s.charAt(s.length-1)!==r&&(s+=r);return"DGBEFHACIJK"!==s}}));_export({target:"Array",proto:!0,forced:dc||!uc||!hc||!pc},{sort:function sort(t){void 0!==t&&aCallable(t);var r=toObject(this);if(pc)return void 0===t?ac(r):ac(r,t);var o,i,s=[],l=lengthOfArrayLike(r);for(i=0;i<l;i++)i in r&&cc(s,r[i]);for(Wa(s,function(t){return function(r,o){return void 0===o?-1:void 0===r?1:void 0!==t?+t(r,o)||0:toString_1(r)>toString_1(o)?1:-1}}(t)),o=lengthOfArrayLike(s),i=0;i<o;)r[i]=s[i++];for(;i<l;)deletePropertyOrThrow(r,i++);return r}});var fc=wellKnownSymbol("species"),setSpecies=function(t){var r=getBuiltIn(t);s&&r&&!r[fc]&&defineBuiltInAccessor(r,fc,{configurable:!0,get:function(){return this}})};setSpecies("Array");var gc=arrayMethodHasSpeciesSupport("splice"),mc=Math.max,vc=Math.min;_export({target:"Array",proto:!0,forced:!gc},{splice:function splice(t,r){var o,i,s,l,u,h,m=toObject(this),v=lengthOfArrayLike(m),C=toAbsoluteIndex(t,v),_=arguments.length;for(0===_?o=i=0:1===_?(o=0,i=v-C):(o=_-2,i=vc(mc(toIntegerOrInfinity(r),0),v-C)),doesNotExceedSafeInteger(v+o-i),s=arraySpeciesCreate(m,i),l=0;l<i;l++)(u=C+l)in m&&createProperty(s,l,m[u]);if(s.length=i,o<i){for(l=C;l<v-i;l++)h=l+o,(u=l+i)in m?m[h]=m[u]:deletePropertyOrThrow(m,h);for(l=v;l>v-i+o;l--)deletePropertyOrThrow(m,l-1)}else if(o>i)for(l=v-i;l>C;l--)h=l+o-1,(u=l+i-1)in m?m[h]=m[u]:deletePropertyOrThrow(m,h);for(l=0;l<o;l++)m[l+C]=arguments[l+2];return ea(m,v-i+o),s}});var arrayToReversed=function(t,r){for(var o=lengthOfArrayLike(t),i=new r(o),s=0;s<o;s++)i[s]=t[o-s-1];return i},yc=Array;_export({target:"Array",proto:!0},{toReversed:function toReversed(){return arrayToReversed(toIndexedObject(this),yc)}}),addToUnscopables("toReversed");var bc,arrayFromConstructorAndList=function(t,r){for(var o=0,i=lengthOfArrayLike(r),s=new t(i);i>o;)s[o]=r[o++];return s},wc=Array,Cc=N((bc="Array",i[bc].prototype).sort);_export({target:"Array",proto:!0},{toSorted:function toSorted(t){void 0!==t&&aCallable(t);var r=toIndexedObject(this),o=arrayFromConstructorAndList(wc,r);return Cc(o,t)}}),addToUnscopables("toSorted");var _c=Array,kc=Math.max,Sc=Math.min;_export({target:"Array",proto:!0},{toSpliced:function toSpliced(t,r){var o,i,s,l,u=toIndexedObject(this),h=lengthOfArrayLike(u),m=toAbsoluteIndex(t,h),v=arguments.length,C=0;for(0===v?o=i=0:1===v?(o=0,i=h-m):(o=v-2,i=Sc(kc(toIntegerOrInfinity(r),0),h-m)),s=doesNotExceedSafeInteger(h+o-i),l=_c(s);C<m;C++)l[C]=u[C];for(;C<m+o;C++)l[C]=arguments[C-m+2];for(;C<s;C++)l[C]=u[C+i-o];return l}}),addToUnscopables("toSpliced"),addToUnscopables("flat"),addToUnscopables("flatMap");var Ec=1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();_export({target:"Array",proto:!0,arity:1,forced:Ec},{unshift:function unshift(t){var r=toObject(this),o=lengthOfArrayLike(r),i=arguments.length;if(i){doesNotExceedSafeInteger(o+i);for(var s=o;s--;){var l=s+i;s in r?r[l]=r[s]:deletePropertyOrThrow(r,l)}for(var u=0;u<i;u++)r[u]=arguments[u]}return ea(r,o+i)}});var xc=RangeError,arrayWith=function(t,r,o,i){var s=lengthOfArrayLike(t),l=toIntegerOrInfinity(o),u=l<0?s+l:l;if(u>=s||u<0)throw xc("Incorrect index");for(var h=new r(s),m=0;m<s;m++)h[m]=m===u?i:t[m];return h},Ic=Array;_export({target:"Array",proto:!0},{with:function(t,r){return arrayWith(toIndexedObject(this),Ic,t,r)}});var Ac="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,defineBuiltIns=function(t,r,o){for(var i in r)defineBuiltIn(t,i,r[i],o);return t},Pc=TypeError,anInstance=function(t,r){if(re(r,t))return t;throw Pc("Incorrect invocation")},Rc=RangeError,toIndex=function(t){if(void 0===t)return 0;var r=toIntegerOrInfinity(t),o=toLength(r);if(r!==o)throw Rc("Wrong length or index");return o},Oc=Array,Dc=Math.abs,Uc=Math.pow,Bc=Math.floor,Hc=Math.log,qc=Math.LN2,ieee754_pack=function(t,r,o){var i,s,l,u=Oc(o),h=8*o-r-1,m=(1<<h)-1,v=m>>1,C=23===r?Uc(2,-24)-Uc(2,-77):0,_=t<0||0===t&&1/t<0?1:0,k=0;for((t=Dc(t))!=t||t===1/0?(s=t!=t?1:0,i=m):(i=Bc(Hc(t)/qc),t*(l=Uc(2,-i))<1&&(i--,l*=2),(t+=i+v>=1?C/l:C*Uc(2,1-v))*l>=2&&(i++,l/=2),i+v>=m?(s=0,i=m):i+v>=1?(s=(t*l-1)*Uc(2,r),i+=v):(s=t*Uc(2,v-1)*Uc(2,r),i=0));r>=8;)u[k++]=255&s,s/=256,r-=8;for(i=i<<r|s,h+=r;h>0;)u[k++]=255&i,i/=256,h-=8;return u[--k]|=128*_,u},ieee754_unpack=function(t,r){var o,i=t.length,s=8*i-r-1,l=(1<<s)-1,u=l>>1,h=s-7,m=i-1,v=t[m--],C=127&v;for(v>>=7;h>0;)C=256*C+t[m--],h-=8;for(o=C&(1<<-h)-1,C>>=-h,h+=r;h>0;)o=256*o+t[m--],h-=8;if(0===C)C=1-u;else{if(C===l)return o?NaN:v?-1/0:1/0;o+=Uc(2,r),C-=u}return(v?-1:1)*o*Uc(2,C-r)},jc=nr.f,zc=Pt.PROPER,Gc=Pt.CONFIGURABLE,Kc="ArrayBuffer",Qc="DataView",el="prototype",tl="Wrong index",rl=Gt.getterFor(Kc),ol=Gt.getterFor(Qc),nl=Gt.set,il=i[Kc],sl=il,al=sl&&sl[el],cl=i[Qc],ll=cl&&cl[el],dl=Object.prototype,ul=i.Array,hl=i.RangeError,pl=N(Ci),fl=N([].reverse),gl=ieee754_pack,ml=ieee754_unpack,packInt8=function(t){return[255&t]},packInt16=function(t){return[255&t,t>>8&255]},packInt32=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},unpackInt32=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},packFloat32=function(t){return gl(t,23,4)},packFloat64=function(t){return gl(t,52,8)},addGetter=function(t,r,o){defineBuiltInAccessor(t[el],r,{configurable:!0,get:function(){return o(this)[r]}})},get$1=function(t,r,o,i){var s=toIndex(o),l=ol(t);if(s+r>l.byteLength)throw hl(tl);var u=l.bytes,h=s+l.byteOffset,m=arraySliceSimple(u,h,h+r);return i?m:fl(m)},set$2=function(t,r,o,i,s,l){var u=toIndex(o),h=ol(t);if(u+r>h.byteLength)throw hl(tl);for(var m=h.bytes,v=u+h.byteOffset,C=i(+s),_=0;_<r;_++)m[v+_]=C[l?_:r-_-1]};if(Ac){var vl=zc&&il.name!==Kc;if(fails((function(){il(1)}))&&fails((function(){new il(-1)}))&&!fails((function(){return new il,new il(1.5),new il(NaN),1!=il.length||vl&&!Gc})))vl&&Gc&&Et(il,"name",Kc);else{(sl=function ArrayBuffer(t){return anInstance(this,al),new il(toIndex(t))})[el]=al;for(var yl,bl=jc(il),wl=0;bl.length>wl;)(yl=bl[wl++])in sl||Et(sl,yl,il[yl]);al.constructor=sl}dn&&An(ll)!==dl&&dn(ll,dl);var Cl=new cl(new sl(2)),_l=N(ll.setInt8);Cl.setInt8(0,2147483648),Cl.setInt8(1,2147483649),!Cl.getInt8(0)&&Cl.getInt8(1)||defineBuiltIns(ll,{setInt8:function setInt8(t,r){_l(this,t,r<<24>>24)},setUint8:function setUint8(t,r){_l(this,t,r<<24>>24)}},{unsafe:!0})}else al=(sl=function ArrayBuffer(t){anInstance(this,al);var r=toIndex(t);nl(this,{type:Kc,bytes:pl(ul(r),0),byteLength:r}),s||(this.byteLength=r,this.detached=!1)})[el],ll=(cl=function DataView(t,r,o){anInstance(this,ll),anInstance(t,al);var i=rl(t),l=i.byteLength,u=toIntegerOrInfinity(r);if(u<0||u>l)throw hl("Wrong offset");if(u+(o=void 0===o?l-u:toLength(o))>l)throw hl("Wrong length");nl(this,{type:Qc,buffer:t,byteLength:o,byteOffset:u,bytes:i.bytes}),s||(this.buffer=t,this.byteLength=o,this.byteOffset=u)})[el],s&&(addGetter(sl,"byteLength",rl),addGetter(cl,"buffer",ol),addGetter(cl,"byteLength",ol),addGetter(cl,"byteOffset",ol)),defineBuiltIns(ll,{getInt8:function getInt8(t){return get$1(this,1,t)[0]<<24>>24},getUint8:function getUint8(t){return get$1(this,1,t)[0]},getInt16:function getInt16(t){var r=get$1(this,2,t,arguments.length>1?arguments[1]:void 0);return(r[1]<<8|r[0])<<16>>16},getUint16:function getUint16(t){var r=get$1(this,2,t,arguments.length>1?arguments[1]:void 0);return r[1]<<8|r[0]},getInt32:function getInt32(t){return unpackInt32(get$1(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function getUint32(t){return unpackInt32(get$1(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function getFloat32(t){return ml(get$1(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function getFloat64(t){return ml(get$1(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function setInt8(t,r){set$2(this,1,t,packInt8,r)},setUint8:function setUint8(t,r){set$2(this,1,t,packInt8,r)},setInt16:function setInt16(t,r){set$2(this,2,t,packInt16,r,arguments.length>2?arguments[2]:void 0)},setUint16:function setUint16(t,r){set$2(this,2,t,packInt16,r,arguments.length>2?arguments[2]:void 0)},setInt32:function setInt32(t,r){set$2(this,4,t,packInt32,r,arguments.length>2?arguments[2]:void 0)},setUint32:function setUint32(t,r){set$2(this,4,t,packInt32,r,arguments.length>2?arguments[2]:void 0)},setFloat32:function setFloat32(t,r){set$2(this,4,t,packFloat32,r,arguments.length>2?arguments[2]:void 0)},setFloat64:function setFloat64(t,r){set$2(this,8,t,packFloat64,r,arguments.length>2?arguments[2]:void 0)}});setToStringTag(sl,Kc),setToStringTag(cl,Qc);var kl={ArrayBuffer:sl,DataView:cl},Sl="ArrayBuffer",Tl=kl[Sl],El=i[Sl];_export({global:!0,constructor:!0,forced:El!==Tl},{ArrayBuffer:Tl}),setSpecies(Sl);var xl,Il,Al,Pl=Gt.enforce,Rl=Gt.get,Ol=i.Int8Array,Nl=Ol&&Ol.prototype,Ml=i.Uint8ClampedArray,Dl=Ml&&Ml.prototype,Fl=Ol&&An(Ol),Ll=Nl&&An(Nl),Ul=Object.prototype,Bl=i.TypeError,Hl=wellKnownSymbol("toStringTag"),$l=uid("TYPED_ARRAY_TAG"),ql="TypedArrayConstructor",jl=Ac&&!!dn&&"Opera"!==Cr(i.opera),zl=!1,Gl={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Vl={BigInt64Array:8,BigUint64Array:8},getTypedArrayConstructor$4=function(t){var r=An(t);if(Z(r)){var o=Rl(r);return o&&tt(o,ql)?o[ql]:getTypedArrayConstructor$4(r)}},isTypedArray=function(t){if(!Z(t))return!1;var r=Cr(t);return tt(Gl,r)||tt(Vl,r)};for(xl in Gl)(Al=(Il=i[xl])&&Il.prototype)?Pl(Al)[ql]=Il:jl=!1;for(xl in Vl)(Al=(Il=i[xl])&&Il.prototype)&&(Pl(Al)[ql]=Il);if((!jl||!W(Fl)||Fl===Function.prototype)&&(Fl=function TypedArray(){throw Bl("Incorrect invocation")},jl))for(xl in Gl)i[xl]&&dn(i[xl],Fl);if((!jl||!Ll||Ll===Ul)&&(Ll=Fl.prototype,jl))for(xl in Gl)i[xl]&&dn(i[xl].prototype,Ll);if(jl&&An(Dl)!==Ll&&dn(Dl,Ll),s&&!tt(Ll,Hl))for(xl in zl=!0,defineBuiltInAccessor(Ll,Hl,{configurable:!0,get:function(){return Z(this)?this[$l]:void 0}}),Gl)i[xl]&&Et(i[xl],$l,xl);var Kl={NATIVE_ARRAY_BUFFER_VIEWS:jl,TYPED_ARRAY_TAG:zl&&$l,aTypedArray:function(t){if(isTypedArray(t))return t;throw Bl("Target is not a typed array")},aTypedArrayConstructor:function(t){if(W(t)&&(!dn||re(Fl,t)))return t;throw Bl(tryToString(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,r,o,l){if(s){if(o)for(var u in Gl){var h=i[u];if(h&&tt(h.prototype,t))try{delete h.prototype[t]}catch(o){try{h.prototype[t]=r}catch(t){}}}Ll[t]&&!o||defineBuiltIn(Ll,t,o?r:jl&&Nl[t]||r,l)}},exportTypedArrayStaticMethod:function(t,r,o){var l,u;if(s){if(dn){if(o)for(l in Gl)if((u=i[l])&&tt(u,t))try{delete u[t]}catch(t){}if(Fl[t]&&!o)return;try{return defineBuiltIn(Fl,t,o?r:jl&&Fl[t]||r)}catch(t){}}for(l in Gl)!(u=i[l])||u[t]&&!o||defineBuiltIn(u,t,r)}},getTypedArrayConstructor:getTypedArrayConstructor$4,isView:function isView(t){if(!Z(t))return!1;var r=Cr(t);return"DataView"===r||tt(Gl,r)||tt(Vl,r)},isTypedArray:isTypedArray,TypedArray:Fl,TypedArrayPrototype:Ll};_export({target:"ArrayBuffer",stat:!0,forced:!Kl.NATIVE_ARRAY_BUFFER_VIEWS},{isView:Kl.isView});var Wl=TypeError,aConstructor=function(t){if(Yr(t))return t;throw Wl(tryToString(t)+" is not a constructor")},Ql=wellKnownSymbol("species"),speciesConstructor=function(t,r){var o,i=anObject(t).constructor;return void 0===i||isNullOrUndefined(o=anObject(i)[Ql])?r:aConstructor(o)},Yl=kl.ArrayBuffer,Jl=kl.DataView,Xl=Jl.prototype,Zl=functionUncurryThisClause(Yl.prototype.slice),td=functionUncurryThisClause(Xl.getUint8),od=functionUncurryThisClause(Xl.setUint8),sd=fails((function(){return!new Yl(2).slice(1,void 0).byteLength}));_export({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:sd},{slice:function slice(t,r){if(Zl&&void 0===r)return Zl(anObject(this),t);for(var o=anObject(this).byteLength,i=toAbsoluteIndex(t,o),s=toAbsoluteIndex(void 0===r?o:r,o),l=new(speciesConstructor(this,Yl))(toLength(s-i)),u=new Jl(this),h=new Jl(l),m=0;i<s;)od(h,m++,td(u,i++));return l}}),_export({global:!0,constructor:!0,forced:!Ac},{DataView:kl.DataView});var pd=fails((function(){return 120!==new Date(16e11).getYear()})),fd=N(Date.prototype.getFullYear);_export({target:"Date",proto:!0,forced:pd},{getYear:function getYear(){return fd(this)-1900}});var gd=Date,vd=N(gd.prototype.getTime);_export({target:"Date",stat:!0},{now:function now(){return vd(new gd)}});var wd=Date.prototype,Cd=N(wd.getTime),_d=N(wd.setFullYear);_export({target:"Date",proto:!0},{setYear:function setYear(t){Cd(this);var r=toIntegerOrInfinity(t);return _d(this,0<=r&&r<=99?r+1900:r)}}),_export({target:"Date",proto:!0},{toGMTString:Date.prototype.toUTCString});var Sd=RangeError,Td=function repeat(t){var r=toString_1(requireObjectCoercible(this)),o="",i=toIntegerOrInfinity(t);if(i<0||i==1/0)throw Sd("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))1&i&&(o+=r);return o},Ed=N(Td),xd=N("".slice),Id=Math.ceil,createMethod$3=function(t){return function(r,o,i){var s,l,u=toString_1(requireObjectCoercible(r)),h=toLength(o),m=u.length,v=void 0===i?" ":toString_1(i);return h<=m||""==v?u:((l=Ed(v,Id((s=h-m)/v.length))).length>s&&(l=xd(l,0,s)),t?u+l:l+u)}},Ad={start:createMethod$3(!1),end:createMethod$3(!0)},Pd=Ad.start,Od=RangeError,Nd=isFinite,Md=Math.abs,Fd=Date.prototype,Ld=Fd.toISOString,Bd=N(Fd.getTime),Hd=N(Fd.getUTCDate),Qd=N(Fd.getUTCFullYear),Yd=N(Fd.getUTCHours),Jd=N(Fd.getUTCMilliseconds),Zd=N(Fd.getUTCMinutes),eu=N(Fd.getUTCMonth),tu=N(Fd.getUTCSeconds),ru=fails((function(){return"0385-07-25T07:06:39.999Z"!=Ld.call(new Date(-50000000000001))}))||!fails((function(){Ld.call(new Date(NaN))}))?function toISOString(){if(!Nd(Bd(this)))throw Od("Invalid time value");var t=this,r=Qd(t),o=Jd(t),i=r<0?"-":r>9999?"+":"";return i+Pd(Md(r),i?6:4,0)+"-"+Pd(eu(t)+1,2,0)+"-"+Pd(Hd(t),2,0)+"T"+Pd(Yd(t),2,0)+":"+Pd(Zd(t),2,0)+":"+Pd(tu(t),2,0)+"."+Pd(o,3,0)+"Z"}:Ld;_export({target:"Date",proto:!0,forced:Date.prototype.toISOString!==ru},{toISOString:ru});var ou=fails((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}));_export({target:"Date",proto:!0,arity:1,forced:ou},{toJSON:function toJSON(t){var r=toObject(this),o=toPrimitive(r,"number");return"number"!=typeof o||isFinite(o)?r.toISOString():null}});var nu=TypeError,iu=wellKnownSymbol("toPrimitive"),su=Date.prototype;tt(su,iu)||defineBuiltIn(su,iu,(function(t){if(anObject(this),"string"===t||"default"===t)t="string";else if("number"!==t)throw nu("Incorrect hint");return ordinaryToPrimitive(this,t)}));var au=Date.prototype,cu="Invalid Date",lu="toString",du=N(au[lu]),uu=N(au.getTime);String(new Date(NaN))!=cu&&defineBuiltIn(au,lu,(function toString(){var t=uu(this);return t==t?du(this):cu}));var hu=N("".charAt),pu=N("".charCodeAt),fu=N(/./.exec),gu=N(1..toString),mu=N("".toUpperCase),vu=/[\w*+\-./@]/,hex$1=function(t,r){for(var o=gu(t,16);o.length<r;)o="0"+o;return o};_export({global:!0},{escape:function escape(t){for(var r,o,i=toString_1(t),s="",l=i.length,u=0;u<l;)r=hu(i,u++),fu(vu,r)?s+=r:s+=(o=pu(r,0))<256?"%"+hex$1(o,2):"%u"+mu(hex$1(o,4));return s}});var yu=Function,bu=N([].concat),wu=N([].join),Cu={},_u=l?yu.bind:function bind(t){var r=aCallable(this),o=r.prototype,i=Fo(arguments,1),s=function bound(){var o=bu(i,Fo(arguments));return this instanceof s?function(t,r,o){if(!tt(Cu,r)){for(var i=[],s=0;s<r;s++)i[s]="a["+s+"]";Cu[r]=yu("C,a","return new C("+wu(i,",")+")")}return Cu[r](t,o)}(r,o.length,o):r.apply(t,o)};return Z(o)&&(s.prototype=o),s};_export({target:"Function",proto:!0,forced:Function.bind!==_u},{bind:_u});var ku=wellKnownSymbol("hasInstance"),Su=Function.prototype;ku in Su||Tt.f(Su,ku,{value:Vt((function(t){if(!W(this)||!Z(t))return!1;var r=this.prototype;if(!Z(r))return t instanceof this;for(;t=An(t);)if(r===t)return!0;return!1}),ku)});var Tu=Pt.EXISTS,Eu=Function.prototype,xu=N(Eu.toString),Iu=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Au=N(Iu.exec);s&&!Tu&&defineBuiltInAccessor(Eu,"name",{configurable:!0,get:function(){try{return Au(Iu,xu(this))[1]}catch(t){return""}}}),_export({global:!0,forced:i.globalThis!==i},{globalThis:i}),setToStringTag(i.JSON,"JSON",!0);var Pu=fails((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Ru=Object.isExtensible,Ou=fails((function(){Ru(1)}))||Pu?function isExtensible(t){return!!Z(t)&&((!Pu||"ArrayBuffer"!=classofRaw(t))&&(!Ru||Ru(t)))}:Ru,Nu=!fails((function(){return Object.isExtensible(Object.preventExtensions({}))})),Mu=createCommonjsModule((function(t){var r=Tt.f,o=!1,i=uid("meta"),s=0,setMetadata=function(t){r(t,i,{value:{objectID:"O"+s++,weakData:{}}})},l=t.exports={enable:function(){l.enable=function(){},o=!0;var t=nr.f,r=N([].splice),s={};s[i]=1,t(s).length&&(nr.f=function(o){for(var s=t(o),l=0,u=s.length;l<u;l++)if(s[l]===i){r(s,l,1);break}return s},_export({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Dr.f}))},fastKey:function(t,r){if(!Z(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!tt(t,i)){if(!Ou(t))return"F";if(!r)return"E";setMetadata(t)}return t[i].objectID},getWeakData:function(t,r){if(!tt(t,i)){if(!Ou(t))return!0;if(!r)return!1;setMetadata(t)}return t[i].weakData},onFreeze:function(t){return Nu&&o&&Ou(t)&&!tt(t,i)&&setMetadata(t),t}};Bt[i]=!0}));Mu.enable,Mu.fastKey,Mu.getWeakData,Mu.onFreeze;var collection=function(t,r,o){var s=-1!==t.indexOf("Map"),l=-1!==t.indexOf("Weak"),u=s?"set":"add",h=i[t],m=h&&h.prototype,v=h,C={},fixMethod=function(t){var r=N(m[t]);defineBuiltIn(m,t,"add"==t?function add(t){return r(this,0===t?0:t),this}:"delete"==t?function(t){return!(l&&!Z(t))&&r(this,0===t?0:t)}:"get"==t?function get(t){return l&&!Z(t)?void 0:r(this,0===t?0:t)}:"has"==t?function has(t){return!(l&&!Z(t))&&r(this,0===t?0:t)}:function set(t,o){return r(this,0===t?0:t,o),this})};if(pr(t,!W(h)||!(l||m.forEach&&!fails((function(){(new h).entries().next()})))))v=o.getConstructor(r,t,s,u),Mu.enable();else if(pr(t,!0)){var _=new v,k=_[u](l?{}:-0,1)!=_,E=fails((function(){_.has(1)})),R=checkCorrectnessOfIteration((function(t){new h(t)})),M=!l&&fails((function(){for(var t=new h,r=5;r--;)t[u](r,r);return!t.has(-0)}));R||((v=r((function(t,r){anInstance(t,m);var o=inheritIfRequired(new h,t,v);return isNullOrUndefined(r)||iterate(r,o[u],{that:o,AS_ENTRIES:s}),o}))).prototype=m,m.constructor=v),(E||M)&&(fixMethod("delete"),fixMethod("has"),s&&fixMethod("get")),(M||k)&&fixMethod(u),l&&m.clear&&delete m.clear}return C[t]=v,_export({global:!0,constructor:!0,forced:v!=h},C),setToStringTag(v,t),l||o.setStrong(v,t,s),v},Du=Mu.fastKey,Fu=Gt.set,Lu=Gt.getterFor,Uu={getConstructor:function(t,r,o,i){var l=t((function(t,l){anInstance(t,u),Fu(t,{type:r,index:Pr(null),first:void 0,last:void 0,size:0}),s||(t.size=0),isNullOrUndefined(l)||iterate(l,t[i],{that:t,AS_ENTRIES:o})})),u=l.prototype,h=Lu(r),define=function(t,r,o){var i,l,u=h(t),m=getEntry(t,r);return m?m.value=o:(u.last=m={index:l=Du(r,!0),key:r,value:o,previous:i=u.last,next:void 0,removed:!1},u.first||(u.first=m),i&&(i.next=m),s?u.size++:t.size++,"F"!==l&&(u.index[l]=m)),t},getEntry=function(t,r){var o,i=h(t),s=Du(r);if("F"!==s)return i.index[s];for(o=i.first;o;o=o.next)if(o.key==r)return o};return defineBuiltIns(u,{clear:function clear(){for(var t=h(this),r=t.index,o=t.first;o;)o.removed=!0,o.previous&&(o.previous=o.previous.next=void 0),delete r[o.index],o=o.next;t.first=t.last=void 0,s?t.size=0:this.size=0},delete:function(t){var r=this,o=h(r),i=getEntry(r,t);if(i){var l=i.next,u=i.previous;delete o.index[i.index],i.removed=!0,u&&(u.next=l),l&&(l.previous=u),o.first==i&&(o.first=l),o.last==i&&(o.last=u),s?o.size--:r.size--}return!!i},forEach:function forEach(t){for(var r,o=h(this),i=functionBindContext(t,arguments.length>1?arguments[1]:void 0);r=r?r.next:o.first;)for(i(r.value,r.key,this);r&&r.removed;)r=r.previous},has:function has(t){return!!getEntry(this,t)}}),defineBuiltIns(u,o?{get:function get(t){var r=getEntry(this,t);return r&&r.value},set:function set(t,r){return define(this,0===t?0:t,r)}}:{add:function add(t){return define(this,t=0===t?0:t,t)}}),s&&defineBuiltInAccessor(u,"size",{configurable:!0,get:function(){return h(this).size}}),l},setStrong:function(t,r,o){var i=r+" Iterator",s=Lu(r),l=Lu(i);iteratorDefine(t,r,(function(t,r){Fu(this,{type:i,target:t,state:s(t),kind:r,last:void 0})}),(function(){for(var t=l(this),r=t.kind,o=t.last;o&&o.removed;)o=o.previous;return t.target&&(t.last=o=o?o.next:t.state.first)?createIterResultObject("keys"==r?o.key:"values"==r?o.value:[o.key,o.value],!1):(t.target=void 0,createIterResultObject(void 0,!0))}),o?"entries":"values",!o,!0),setSpecies(r)}};collection("Map",(function(t){return function Map(){return t(this,arguments.length?arguments[0]:void 0)}}),Uu);var Bu=Math.log,Hu=Math.log1p||function log1p(t){var r=+t;return r>-1e-8&&r<1e-8?r-r*r/2:Bu(1+r)},$u=Math.acosh,qu=Math.log,ju=Math.sqrt,zu=Math.LN2,Gu=!$u||710!=Math.floor($u(Number.MAX_VALUE))||$u(1/0)!=1/0;_export({target:"Math",stat:!0,forced:Gu},{acosh:function acosh(t){var r=+t;return r<1?NaN:r>94906265.62425156?qu(r)+zu:Hu(r-1+ju(r-1)*ju(r+1))}});var Vu=Math.asinh,Ku=Math.log,Wu=Math.sqrt;var Qu=!(Vu&&1/Vu(0)>0);_export({target:"Math",stat:!0,forced:Qu},{asinh:function asinh(t){var r=+t;return isFinite(r)&&0!=r?r<0?-asinh(-r):Ku(r+Wu(r*r+1)):r}});var Yu=Math.atanh,Ju=Math.log,Xu=!(Yu&&1/Yu(-0)<0);_export({target:"Math",stat:!0,forced:Xu},{atanh:function atanh(t){var r=+t;return 0==r?r:Ju((1+r)/(1-r))/2}});var Zu=Math.sign||function sign(t){var r=+t;return 0==r||r!=r?r:r<0?-1:1},wh=Math.abs,Ch=Math.pow;_export({target:"Math",stat:!0},{cbrt:function cbrt(t){var r=+t;return Zu(r)*Ch(wh(r),1/3)}});var _h=Math.floor,Sh=Math.log,Th=Math.LOG2E;_export({target:"Math",stat:!0},{clz32:function clz32(t){var r=t>>>0;return r?31-_h(Sh(r+.5)*Th):32}});var Eh=Math.expm1,xh=Math.exp,Ih=!Eh||Eh(10)>22025.465794806718||Eh(10)<22025.465794806718||-2e-17!=Eh(-2e-17)?function expm1(t){var r=+t;return 0==r?r:r>-1e-6&&r<1e-6?r+r*r/2:xh(r)-1}:Eh,Ah=Math.cosh,Ph=Math.abs,Rh=Math.E,Oh=!Ah||Ah(710)===1/0;_export({target:"Math",stat:!0,forced:Oh},{cosh:function cosh(t){var r=Ih(Ph(t)-1)+1;return(r+1/(r*Rh*Rh))*(Rh/2)}}),_export({target:"Math",stat:!0,forced:Ih!=Math.expm1},{expm1:Ih});var Nh=Math.abs,Dh=Math.pow,Fh=Dh(2,-52),Lh=Dh(2,-23),Uh=Dh(2,127)*(2-Lh),Bh=Dh(2,-126),Hh=Math.fround||function fround(t){var r,o,i=+t,s=Nh(i),l=Zu(i);return s<Bh?l*function(t){return t+1/Fh-1/Fh}(s/Bh/Lh)*Bh*Lh:(o=(r=(1+Lh/Fh)*s)-(r-s))>Uh||o!=o?l*(1/0):l*o};_export({target:"Math",stat:!0},{fround:Hh});var qh=Math.hypot,Vh=Math.abs,Kh=Math.sqrt,Qh=!!qh&&qh(1/0,NaN)!==1/0;_export({target:"Math",stat:!0,arity:2,forced:Qh},{hypot:function hypot(t,r){for(var o,i,s=0,l=0,u=arguments.length,h=0;l<u;)h<(o=Vh(arguments[l++]))?(s=s*(i=h/o)*i+1,h=o):s+=o>0?(i=o/h)*i:o;return h===1/0?1/0:h*Kh(s)}});var Jh=Math.imul,Zh=fails((function(){return-5!=Jh(4294967295,5)||2!=Jh.length}));_export({target:"Math",stat:!0,forced:Zh},{imul:function imul(t,r){var o=65535,i=+t,s=+r,l=o&i,u=o&s;return 0|l*u+((o&i>>>16)*u+l*(o&s>>>16)<<16>>>0)}});var ep=Math.log,tp=Math.LOG10E,rp=Math.log10||function log10(t){return ep(t)*tp};_export({target:"Math",stat:!0},{log10:rp}),_export({target:"Math",stat:!0},{log1p:Hu});var op=Math.log,np=Math.LN2;_export({target:"Math",stat:!0},{log2:function log2(t){return op(t)/np}}),_export({target:"Math",stat:!0},{sign:Zu});var ip=Math.abs,sp=Math.exp,ap=Math.E,cp=fails((function(){return-2e-17!=Math.sinh(-2e-17)}));_export({target:"Math",stat:!0,forced:cp},{sinh:function sinh(t){var r=+t;return ip(r)<1?(Ih(r)-Ih(-r))/2:(sp(r-1)-sp(-r-1))*(ap/2)}});var lp=Math.exp;_export({target:"Math",stat:!0},{tanh:function tanh(t){var r=+t,o=Ih(r),i=Ih(-r);return o==1/0?1:i==1/0?-1:(o-i)/(lp(r)+lp(-r))}}),setToStringTag(Math,"Math",!0),_export({target:"Math",stat:!0},{trunc:Qt});var dp=N(1..valueOf),up="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",hp=N("".replace),pp=RegExp("^["+up+"]+"),fp=RegExp("(^|[^"+up+"])["+up+"]+$"),createMethod$2=function(t){return function(r){var o=toString_1(requireObjectCoercible(r));return 1&t&&(o=hp(o,pp,"")),2&t&&(o=hp(o,fp,"$1")),o}},gp={start:createMethod$2(1),end:createMethod$2(2),trim:createMethod$2(3)},mp=nr.f,vp=gt.f,yp=Tt.f,bp=gp.trim,wp="Number",Cp=i[wp];Lr[wp];var _p=Cp.prototype,kp=i.TypeError,Sp=N("".slice),Tp=N("".charCodeAt),toNumber$1=function(t){var r,o,i,s,l,u,h,m,v=toPrimitive(t,"number");if(Ee(v))throw kp("Cannot convert a Symbol value to a number");if("string"==typeof v&&v.length>2)if(v=bp(v),43===(r=Tp(v,0))||45===r){if(88===(o=Tp(v,2))||120===o)return NaN}else if(48===r){switch(Tp(v,1)){case 66:case 98:i=2,s=49;break;case 79:case 111:i=8,s=55;break;default:return+v}for(u=(l=Sp(v,2)).length,h=0;h<u;h++)if((m=Tp(l,h))<48||m>s)return NaN;return parseInt(l,i)}return+v},Ep=pr(wp,!Cp(" 0o1")||!Cp("0b1")||Cp("+0x1")),xp=function Number(t){var r,o=arguments.length<1?0:Cp(function(t){var r=toPrimitive(t,"number");return"bigint"==typeof r?r:toNumber$1(r)}(t));return re(_p,r=this)&&fails((function(){dp(r)}))?inheritIfRequired(Object(o),this,xp):o};xp.prototype=_p,Ep&&(_p.constructor=xp),_export({global:!0,constructor:!0,wrap:!0,forced:Ep},{Number:xp});Ep&&function(t,r){for(var o,i=s?mp(r):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),l=0;i.length>l;l++)tt(r,o=i[l])&&!tt(t,o)&&yp(t,o,vp(r,o))}(Lr[wp],Cp),_export({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{EPSILON:Math.pow(2,-52)});var Ip=i.isFinite,Ap=Number.isFinite||function isFinite(t){return"number"==typeof t&&Ip(t)};_export({target:"Number",stat:!0},{isFinite:Ap});var Pp=Math.floor,Rp=Number.isInteger||function isInteger(t){return!Z(t)&&isFinite(t)&&Pp(t)===t};_export({target:"Number",stat:!0},{isInteger:Rp}),_export({target:"Number",stat:!0},{isNaN:function isNaN(t){return t!=t}});var Op=Math.abs;_export({target:"Number",stat:!0},{isSafeInteger:function isSafeInteger(t){return Rp(t)&&Op(t)<=9007199254740991}}),_export({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991}),_export({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MIN_SAFE_INTEGER:-9007199254740991});var Np=gp.trim,Mp=N("".charAt),Dp=i.parseFloat,Fp=i.Symbol,Lp=Fp&&Fp.iterator,Up=1/Dp(up+"-0")!=-1/0||Lp&&!fails((function(){Dp(Object(Lp))}))?function parseFloat(t){var r=Np(toString_1(t)),o=Dp(r);return 0===o&&"-"==Mp(r,0)?-0:o}:Dp;_export({target:"Number",stat:!0,forced:Number.parseFloat!=Up},{parseFloat:Up});var Bp=gp.trim,Hp=i.parseInt,$p=i.Symbol,qp=$p&&$p.iterator,jp=/^[+-]?0x/i,zp=N(jp.exec),Gp=8!==Hp(up+"08")||22!==Hp(up+"0x16")||qp&&!fails((function(){Hp(Object(qp))}))?function parseInt(t,r){var o=Bp(toString_1(t));return Hp(o,r>>>0||(zp(jp,o)?16:10))}:Hp;_export({target:"Number",stat:!0,forced:Number.parseInt!=Gp},{parseInt:Gp});var Vp=RangeError,Kp=String,Wp=isFinite,Qp=Math.abs,Yp=Math.floor,Jp=Math.pow,Xp=Math.round,Zp=N(1..toExponential),ef=N(Td),tf=N("".slice),rf="-6.9000e-11"===Zp(-69e-12,4)&&"1.25e+0"===Zp(1.255,2)&&"1.235e+4"===Zp(12345,3)&&"3e+1"===Zp(25,0),nf=!rf||!(fails((function(){Zp(1,1/0)}))&&fails((function(){Zp(1,-1/0)})))||!!fails((function(){Zp(1/0,1/0),Zp(NaN,1/0)}));_export({target:"Number",proto:!0,forced:nf},{toExponential:function toExponential(t){var r=dp(this);if(void 0===t)return Zp(r);var o=toIntegerOrInfinity(t);if(!Wp(r))return String(r);if(o<0||o>20)throw Vp("Incorrect fraction digits");if(rf)return Zp(r,o);var i="",s="",l=0,u="",h="";if(r<0&&(i="-",r=-r),0===r)l=0,s=ef("0",o+1);else{var m=rp(r);l=Yp(m);var v=0,C=Jp(10,l-o);2*r>=(2*(v=Xp(r/C))+1)*C&&(v+=1),v>=Jp(10,o+1)&&(v/=10,l+=1),s=Kp(v)}return 0!==o&&(s=tf(s,0,1)+"."+tf(s,1)),0===l?(u="+",h="0"):(u=l>0?"+":"-",h=Kp(Qp(l))),i+(s+="e"+u+h)}});var sf=RangeError,af=String,df=Math.floor,uf=N(Td),hf=N("".slice),ff=N(1..toFixed),pow$1=function(t,r,o){return 0===r?o:r%2==1?pow$1(t,r-1,o*t):pow$1(t*t,r/2,o)},multiply$1=function(t,r,o){for(var i=-1,s=o;++i<6;)s+=r*t[i],t[i]=s%1e7,s=df(s/1e7)},divide=function(t,r){for(var o=6,i=0;--o>=0;)i+=t[o],t[o]=df(i/r),i=i%r*1e7},dataToString=function(t){for(var r=6,o="";--r>=0;)if(""!==o||0===r||0!==t[r]){var i=af(t[r]);o=""===o?i:o+uf("0",7-i.length)+i}return o},gf=fails((function(){return"0.000"!==ff(8e-5,3)||"1"!==ff(.9,0)||"1.25"!==ff(1.255,2)||"1000000000000000128"!==ff(0xde0b6b3a7640080,0)}))||!fails((function(){ff({})}));_export({target:"Number",proto:!0,forced:gf},{toFixed:function toFixed(t){var r,o,i,s,l=dp(this),u=toIntegerOrInfinity(t),h=[0,0,0,0,0,0],m="",v="0";if(u<0||u>20)throw sf("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return af(l);if(l<0&&(m="-",l=-l),l>1e-21)if(o=(r=function(t){for(var r=0,o=t;o>=4096;)r+=12,o/=4096;for(;o>=2;)r+=1,o/=2;return r}(l*pow$1(2,69,1))-69)<0?l*pow$1(2,-r,1):l/pow$1(2,r,1),o*=4503599627370496,(r=52-r)>0){for(multiply$1(h,0,o),i=u;i>=7;)multiply$1(h,1e7,0),i-=7;for(multiply$1(h,pow$1(10,i,1),0),i=r-1;i>=23;)divide(h,1<<23),i-=23;divide(h,1<<i),multiply$1(h,1,1),divide(h,2),v=dataToString(h)}else multiply$1(h,0,o),multiply$1(h,1<<-r,0),v=dataToString(h)+uf("0",u);return v=u>0?m+((s=v.length)<=u?"0."+uf("0",u-s)+v:hf(v,0,s-u)+"."+hf(v,s-u)):m+v}});var vf=N(1..toPrecision),bf=fails((function(){return"1"!==vf(1,void 0)}))||!fails((function(){vf({})}));_export({target:"Number",proto:!0,forced:bf},{toPrecision:function toPrecision(t){return void 0===t?vf(dp(this)):vf(dp(this),t)}});var wf=Object.assign,Cf=Object.defineProperty,_f=N([].concat),Sf=!wf||fails((function(){if(s&&1!==wf({b:1},wf(Cf({},"a",{enumerable:!0,get:function(){Cf(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},r={},o=Symbol(),i="abcdefghijklmnopqrst";return t[o]=7,i.split("").forEach((function(t){r[t]=t})),7!=wf({},t)[o]||kr(wf({},r)).join("")!=i}))?function assign(t,r){for(var o=toObject(t),i=arguments.length,l=1,u=ir.f,m=_.f;i>l;)for(var v,C=q(arguments[l++]),k=u?_f(kr(C),u(C)):kr(C),E=k.length,R=0;E>R;)v=k[R++],s&&!h(m,C,v)||(o[v]=C[v]);return o}:wf;_export({target:"Object",stat:!0,arity:2,forced:Object.assign!==Sf},{assign:Sf}),_export({target:"Object",stat:!0,sham:!s},{create:Pr});var Ef=!fails((function(){if(!(ic&&ic<535)){var t=Math.random();__defineSetter__.call(null,t,(function(){})),delete i[t]}}));s&&_export({target:"Object",proto:!0,forced:Ef},{__defineGetter__:function __defineGetter__(t,r){Tt.f(toObject(this),t,{get:aCallable(r),enumerable:!0,configurable:!0})}});var xf=Tr.f;_export({target:"Object",stat:!0,forced:Object.defineProperties!==xf,sham:!s},{defineProperties:xf});var Af=Tt.f;_export({target:"Object",stat:!0,forced:Object.defineProperty!==Af,sham:!s},{defineProperty:Af}),s&&_export({target:"Object",proto:!0,forced:Ef},{__defineSetter__:function __defineSetter__(t,r){Tt.f(toObject(this),t,{set:aCallable(r),enumerable:!0,configurable:!0})}});var Pf=_.f,Rf=N(Pf),Mf=N([].push),createMethod$1=function(t){return function(r){for(var o,i=toIndexedObject(r),l=kr(i),u=l.length,h=0,m=[];u>h;)o=l[h++],s&&!Rf(i,o)||Mf(m,t?[o,i[o]]:i[o]);return m}},Df={entries:createMethod$1(!0),values:createMethod$1(!1)},Ff=Df.entries;_export({target:"Object",stat:!0},{entries:function entries(t){return Ff(t)}});var Lf=Mu.onFreeze,Bf=Object.freeze,Hf=fails((function(){Bf(1)}));_export({target:"Object",stat:!0,forced:Hf,sham:!Nu},{freeze:function freeze(t){return Bf&&Z(t)?Bf(Lf(t)):t}}),_export({target:"Object",stat:!0},{fromEntries:function fromEntries(t){var r={};return iterate(t,(function(t,o){createProperty(r,t,o)}),{AS_ENTRIES:!0}),r}});var Gf=gt.f,Yf=!s||fails((function(){Gf(1)}));_export({target:"Object",stat:!0,forced:Yf,sham:!s},{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(t,r){return Gf(toIndexedObject(t),r)}}),_export({target:"Object",stat:!0,sham:!s},{getOwnPropertyDescriptors:function getOwnPropertyDescriptors(t){for(var r,o,i=toIndexedObject(t),s=gt.f,l=ar(i),u={},h=0;l.length>h;)void 0!==(o=s(i,r=l[h++]))&&createProperty(u,r,o);return u}});var Xf=Dr.f,Zf=fails((function(){return!Object.getOwnPropertyNames(1)}));_export({target:"Object",stat:!0,forced:Zf},{getOwnPropertyNames:Xf});var eg=fails((function(){An(1)}));_export({target:"Object",stat:!0,forced:eg,sham:!Tn},{getPrototypeOf:function getPrototypeOf(t){return An(toObject(t))}}),_export({target:"Object",stat:!0},{hasOwn:tt});var tg=Object.is||function is(t,r){return t===r?0!==t||1/t==1/r:t!=t&&r!=r};_export({target:"Object",stat:!0},{is:tg}),_export({target:"Object",stat:!0,forced:Object.isExtensible!==Ou},{isExtensible:Ou});var rg=Object.isFrozen,og=Pu||fails((function(){rg(1)}));_export({target:"Object",stat:!0,forced:og},{isFrozen:function isFrozen(t){return!Z(t)||(!(!Pu||"ArrayBuffer"!=classofRaw(t))||!!rg&&rg(t))}});var ng=Object.isSealed,ig=Pu||fails((function(){ng(1)}));_export({target:"Object",stat:!0,forced:ig},{isSealed:function isSealed(t){return!Z(t)||(!(!Pu||"ArrayBuffer"!=classofRaw(t))||!!ng&&ng(t))}});var sg=fails((function(){kr(1)}));_export({target:"Object",stat:!0,forced:sg},{keys:function keys(t){return kr(toObject(t))}});var cg=gt.f;s&&_export({target:"Object",proto:!0,forced:Ef},{__lookupGetter__:function __lookupGetter__(t){var r,o=toObject(this),i=toPropertyKey(t);do{if(r=cg(o,i))return r.get}while(o=An(o))}});var lg=gt.f;s&&_export({target:"Object",proto:!0,forced:Ef},{__lookupSetter__:function __lookupSetter__(t){var r,o=toObject(this),i=toPropertyKey(t);do{if(r=lg(o,i))return r.set}while(o=An(o))}});var ug=Mu.onFreeze,hg=Object.preventExtensions,pg=fails((function(){hg(1)}));_export({target:"Object",stat:!0,forced:pg,sham:!Nu},{preventExtensions:function preventExtensions(t){return hg&&Z(t)?hg(ug(t)):t}});var fg=Object.getPrototypeOf,gg=Object.setPrototypeOf,mg=Object.prototype,vg="__proto__";if(s&&fg&&gg&&!(vg in mg))try{defineBuiltInAccessor(mg,vg,{configurable:!0,get:function __proto__(){return fg(toObject(this))},set:function __proto__(t){var r=requireObjectCoercible(this);(Z(t)||null===t)&&Z(r)&&gg(r,t)}})}catch(t){}var yg=Mu.onFreeze,wg=Object.seal,Cg=fails((function(){wg(1)}));_export({target:"Object",stat:!0,forced:Cg,sham:!Nu},{seal:function seal(t){return wg&&Z(t)?wg(yg(t)):t}}),_export({target:"Object",stat:!0},{setPrototypeOf:dn});var _g=vr?{}.toString:function toString(){return"[object "+Cr(this)+"]"};vr||defineBuiltIn(Object.prototype,"toString",_g,{unsafe:!0});var kg=Df.values;_export({target:"Object",stat:!0},{values:function values(t){return kg(t)}}),_export({global:!0,forced:parseFloat!=Up},{parseFloat:Up}),_export({global:!0,forced:parseInt!=Gp},{parseInt:Gp});var Eg,xg,Ig,Ag,Pg=TypeError,validateArgumentsLength=function(t,r){if(t<r)throw Pg("Not enough arguments");return t},Ng=/(?:ipad|iphone|ipod).*applewebkit/i.test(oe),Mg=i.setImmediate,Dg=i.clearImmediate,Fg=i.process,Lg=i.Dispatch,Ug=i.Function,Bg=i.MessageChannel,Hg=i.String,qg=0,jg={},zg="onreadystatechange";fails((function(){Eg=i.location}));var run=function(t){if(tt(jg,t)){var r=jg[t];delete jg[t],r()}},runner=function(t){return function(){run(t)}},eventListener=function(t){run(t.data)},globalPostMessageDefer=function(t){i.postMessage(Hg(t),Eg.protocol+"//"+Eg.host)};Mg&&Dg||(Mg=function setImmediate(t){validateArgumentsLength(arguments.length,1);var r=W(t)?t:Ug(t),o=Fo(arguments,1);return jg[++qg]=function(){Do(r,void 0,o)},xg(qg),qg},Dg=function clearImmediate(t){delete jg[t]},ca?xg=function(t){Fg.nextTick(runner(t))}:Lg&&Lg.now?xg=function(t){Lg.now(runner(t))}:Bg&&!Ng?(Ag=(Ig=new Bg).port2,Ig.port1.onmessage=eventListener,xg=functionBindContext(Ag.postMessage,Ag)):i.addEventListener&&W(i.postMessage)&&!i.importScripts&&Eg&&"file:"!==Eg.protocol&&!fails(globalPostMessageDefer)?(xg=globalPostMessageDefer,i.addEventListener("message",eventListener,!1)):xg=zg in documentCreateElement("script")?function(t){Er.appendChild(documentCreateElement("script"))[zg]=function(){Er.removeChild(this),run(t)}}:function(t){setTimeout(runner(t),0)});var Gg={set:Mg,clear:Dg},Queue=function(){this.head=null,this.tail=null};Queue.prototype={add:function(t){var r={item:t,next:null},o=this.tail;o?o.next=r:this.head=r,this.tail=r},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var Kg,Jg,em,tm,rm,om=Queue,nm=/ipad|iphone|ipod/i.test(oe)&&"undefined"!=typeof Pebble,im=/web0s(?!.*chrome)/i.test(oe),sm=gt.f,am=Gg.set,cm=i.MutationObserver||i.WebKitMutationObserver,lm=i.document,dm=i.process,um=i.Promise,hm=sm(i,"queueMicrotask"),pm=hm&&hm.value;if(!pm){var fm=new om,flush=function(){var t,r;for(ca&&(t=dm.domain)&&t.exit();r=fm.get();)try{r()}catch(t){throw fm.head&&Kg(),t}t&&t.enter()};Ng||ca||im||!cm||!lm?!nm&&um&&um.resolve?((tm=um.resolve(void 0)).constructor=um,rm=functionBindContext(tm.then,tm),Kg=function(){rm(flush)}):ca?Kg=function(){dm.nextTick(flush)}:(am=functionBindContext(am,i),Kg=function(){am(flush)}):(Jg=!0,em=lm.createTextNode(""),new cm(flush).observe(em,{characterData:!0}),Kg=function(){em.data=Jg=!Jg}),pm=function(t){fm.head||Kg(),fm.add(t)}}var gm=pm,perform=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},mm=i.Promise,vm="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,ym=!vm&&!ca&&"object"==typeof window&&"object"==typeof document;mm&&mm.prototype;var bm,wm,Cm,_m=wellKnownSymbol("species"),km=!1,Sm=W(i.PromiseRejectionEvent),Tm=pr("Promise",(function(){var t=Dt(mm),r=t!==String(mm);if(!r&&66===me)return!0;if(!me||me<51||!/native code/.test(t)){var o=new mm((function(t){t(1)})),FakePromise=function(t){t((function(){}),(function(){}))};if((o.constructor={})[_m]=FakePromise,!(km=o.then((function(){}))instanceof FakePromise))return!0}return!r&&(ym||vm)&&!Sm})),Em={CONSTRUCTOR:Tm,REJECTION_EVENT:Sm,SUBCLASSING:km},xm=TypeError,PromiseCapability=function(t){var r,o;this.promise=new t((function(t,i){if(void 0!==r||void 0!==o)throw xm("Bad Promise constructor");r=t,o=i})),this.resolve=aCallable(r),this.reject=aCallable(o)},Im={f:function(t){return new PromiseCapability(t)}},Am=Gg.set,Pm="Promise",Rm=Em.CONSTRUCTOR,Om=Em.REJECTION_EVENT,Nm=Em.SUBCLASSING,Mm=Gt.getterFor(Pm),Dm=Gt.set,Fm=mm&&mm.prototype,Lm=mm,Um=Fm,Bm=i.TypeError,Hm=i.document,$m=i.process,qm=Im.f,jm=qm,zm=!!(Hm&&Hm.createEvent&&i.dispatchEvent),Gm="unhandledrejection",isThenable=function(t){var r;return!(!Z(t)||!W(r=t.then))&&r},callReaction=function(t,r){var o,i,s,l=r.value,u=1==r.state,m=u?t.ok:t.fail,v=t.resolve,C=t.reject,_=t.domain;try{m?(u||(2===r.rejection&&onHandleUnhandled(r),r.rejection=1),!0===m?o=l:(_&&_.enter(),o=m(l),_&&(_.exit(),s=!0)),o===t.promise?C(Bm("Promise-chain cycle")):(i=isThenable(o))?h(i,o,v,C):v(o)):C(l)}catch(t){_&&!s&&_.exit(),C(t)}},notify=function(t,r){t.notified||(t.notified=!0,gm((function(){for(var o,i=t.reactions;o=i.get();)callReaction(o,t);t.notified=!1,r&&!t.rejection&&onUnhandled(t)})))},dispatchEvent=function(t,r,o){var s,l;zm?((s=Hm.createEvent("Event")).promise=r,s.reason=o,s.initEvent(t,!1,!0),i.dispatchEvent(s)):s={promise:r,reason:o},!Om&&(l=i["on"+t])?l(s):t===Gm&&function(t,r){try{1==arguments.length?console.error(t):console.error(t,r)}catch(t){}}("Unhandled promise rejection",o)},onUnhandled=function(t){h(Am,i,(function(){var r,o=t.facade,i=t.value;if(isUnhandled(t)&&(r=perform((function(){ca?$m.emit("unhandledRejection",i,o):dispatchEvent(Gm,o,i)})),t.rejection=ca||isUnhandled(t)?2:1,r.error))throw r.value}))},isUnhandled=function(t){return 1!==t.rejection&&!t.parent},onHandleUnhandled=function(t){h(Am,i,(function(){var r=t.facade;ca?$m.emit("rejectionHandled",r):dispatchEvent("rejectionhandled",r,t.value)}))},bind=function(t,r,o){return function(i){t(r,i,o)}},internalReject=function(t,r,o){t.done||(t.done=!0,o&&(t=o),t.value=r,t.state=2,notify(t,!0))},internalResolve=function(t,r,o){if(!t.done){t.done=!0,o&&(t=o);try{if(t.facade===r)throw Bm("Promise can't be resolved itself");var i=isThenable(r);i?gm((function(){var o={done:!1};try{h(i,r,bind(internalResolve,o,t),bind(internalReject,o,t))}catch(r){internalReject(o,r,t)}})):(t.value=r,t.state=1,notify(t,!1))}catch(r){internalReject({done:!1},r,t)}}};if(Rm&&(Lm=function Promise(t){anInstance(this,Um),aCallable(t),h(bm,this);var r=Mm(this);try{t(bind(internalResolve,r),bind(internalReject,r))}catch(t){internalReject(r,t)}},Um=Lm.prototype,(bm=function Promise(t){Dm(this,{type:Pm,done:!1,notified:!1,parent:!1,reactions:new om,rejection:!1,state:0,value:void 0})}).prototype=defineBuiltIn(Um,"then",(function then(t,r){var o=Mm(this),i=qm(speciesConstructor(this,Lm));return o.parent=!0,i.ok=!W(t)||t,i.fail=W(r)&&r,i.domain=ca?$m.domain:void 0,0==o.state?o.reactions.add(i):gm((function(){callReaction(i,o)})),i.promise})),wm=function(){var t=new bm,r=Mm(t);this.promise=t,this.resolve=bind(internalResolve,r),this.reject=bind(internalReject,r)},Im.f=qm=function(t){return t===Lm||undefined===t?new wm(t):jm(t)},W(mm)&&Fm!==Object.prototype)){Cm=Fm.then,Nm||defineBuiltIn(Fm,"then",(function then(t,r){var o=this;return new Lm((function(t,r){h(Cm,o,t,r)})).then(t,r)}),{unsafe:!0});try{delete Fm.constructor}catch(t){}dn&&dn(Fm,Um)}_export({global:!0,constructor:!0,wrap:!0,forced:Rm},{Promise:Lm}),setToStringTag(Lm,Pm,!1),setSpecies(Pm);var Vm=Em.CONSTRUCTOR||!checkCorrectnessOfIteration((function(t){mm.all(t).then(void 0,(function(){}))}));_export({target:"Promise",stat:!0,forced:Vm},{all:function all(t){var r=this,o=Im.f(r),i=o.resolve,s=o.reject,l=perform((function(){var o=aCallable(r.resolve),l=[],u=0,m=1;iterate(t,(function(t){var v=u++,C=!1;m++,h(o,r,t).then((function(t){C||(C=!0,l[v]=t,--m||i(l))}),s)})),--m||i(l)}));return l.error&&s(l.value),o.promise}});var Km=Em.CONSTRUCTOR,Wm=mm&&mm.prototype;if(_export({target:"Promise",proto:!0,forced:Km,real:!0},{catch:function(t){return this.then(void 0,t)}}),W(mm)){var Qm=getBuiltIn("Promise").prototype.catch;Wm.catch!==Qm&&defineBuiltIn(Wm,"catch",Qm,{unsafe:!0})}_export({target:"Promise",stat:!0,forced:Vm},{race:function race(t){var r=this,o=Im.f(r),i=o.reject,s=perform((function(){var s=aCallable(r.resolve);iterate(t,(function(t){h(s,r,t).then(o.resolve,i)}))}));return s.error&&i(s.value),o.promise}}),_export({target:"Promise",stat:!0,forced:Em.CONSTRUCTOR},{reject:function reject(t){var r=Im.f(this);return h(r.reject,void 0,t),r.promise}});var promiseResolve=function(t,r){if(anObject(t),Z(r)&&r.constructor===t)return r;var o=Im.f(t);return(0,o.resolve)(r),o.promise},Ym=Em.CONSTRUCTOR;getBuiltIn("Promise"),_export({target:"Promise",stat:!0,forced:Ym},{resolve:function resolve(t){return promiseResolve(this,t)}}),_export({target:"Promise",stat:!0,forced:Vm},{allSettled:function allSettled(t){var r=this,o=Im.f(r),i=o.resolve,s=o.reject,l=perform((function(){var o=aCallable(r.resolve),s=[],l=0,u=1;iterate(t,(function(t){var m=l++,v=!1;u++,h(o,r,t).then((function(t){v||(v=!0,s[m]={status:"fulfilled",value:t},--u||i(s))}),(function(t){v||(v=!0,s[m]={status:"rejected",reason:t},--u||i(s))}))})),--u||i(s)}));return l.error&&s(l.value),o.promise}});var Jm="No one promise resolved";_export({target:"Promise",stat:!0,forced:Vm},{any:function any(t){var r=this,o=getBuiltIn("AggregateError"),i=Im.f(r),s=i.resolve,l=i.reject,u=perform((function(){var i=aCallable(r.resolve),u=[],m=0,v=1,C=!1;iterate(t,(function(t){var _=m++,k=!1;v++,h(i,r,t).then((function(t){k||C||(C=!0,s(t))}),(function(t){k||C||(k=!0,u[_]=t,--v||l(new o(u,Jm)))}))})),--v||l(new o(u,Jm))}));return u.error&&l(u.value),i.promise}});var Xm=mm&&mm.prototype,Zm=!!mm&&fails((function(){Xm.finally.call({then:function(){}},(function(){}))}));if(_export({target:"Promise",proto:!0,real:!0,forced:Zm},{finally:function(t){var r=speciesConstructor(this,getBuiltIn("Promise")),o=W(t);return this.then(o?function(o){return promiseResolve(r,t()).then((function(){return o}))}:t,o?function(o){return promiseResolve(r,t()).then((function(){throw o}))}:t)}}),W(mm)){var ev=getBuiltIn("Promise").prototype.finally;Xm.finally!==ev&&defineBuiltIn(Xm,"finally",ev,{unsafe:!0})}var tv=!fails((function(){Reflect.apply((function(){}))}));_export({target:"Reflect",stat:!0,forced:tv},{apply:function apply(t,r,o){return Do(aCallable(t),r,anObject(o))}});var rv=getBuiltIn("Reflect","construct"),ov=Object.prototype,nv=[].push,iv=fails((function(){function F(){}return!(rv((function(){}),[],F)instanceof F)})),sv=!fails((function(){rv((function(){}))})),av=iv||sv;_export({target:"Reflect",stat:!0,forced:av,sham:av},{construct:function construct(t,r){aConstructor(t),anObject(r);var o=arguments.length<3?t:aConstructor(arguments[2]);if(sv&&!iv)return rv(t,r,o);if(t==o){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return Do(nv,i,r),new(Do(_u,t,i))}var s=o.prototype,l=Pr(Z(s)?s:ov),u=Do(t,l,r);return Z(u)?u:l}});var cv=fails((function(){Reflect.defineProperty(Tt.f({},1,{value:1}),1,{value:2})}));_export({target:"Reflect",stat:!0,forced:cv,sham:!s},{defineProperty:function defineProperty(t,r,o){anObject(t);var i=toPropertyKey(r);anObject(o);try{return Tt.f(t,i,o),!0}catch(t){return!1}}});var lv=gt.f;_export({target:"Reflect",stat:!0},{deleteProperty:function deleteProperty(t,r){var o=lv(anObject(t),r);return!(o&&!o.configurable)&&delete t[r]}});var isDataDescriptor=function(t){return void 0!==t&&(tt(t,"value")||tt(t,"writable"))};_export({target:"Reflect",stat:!0},{get:function get(t,r){var o,i,s=arguments.length<3?t:arguments[2];return anObject(t)===s?t[r]:(o=gt.f(t,r))?isDataDescriptor(o)?o.value:void 0===o.get?void 0:h(o.get,s):Z(i=An(t))?get(i,r,s):void 0}}),_export({target:"Reflect",stat:!0,sham:!s},{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(t,r){return gt.f(anObject(t),r)}}),_export({target:"Reflect",stat:!0,sham:!Tn},{getPrototypeOf:function getPrototypeOf(t){return An(anObject(t))}}),_export({target:"Reflect",stat:!0},{has:function has(t,r){return r in t}}),_export({target:"Reflect",stat:!0},{isExtensible:function isExtensible(t){return anObject(t),Ou(t)}}),_export({target:"Reflect",stat:!0},{ownKeys:ar}),_export({target:"Reflect",stat:!0,sham:!Nu},{preventExtensions:function preventExtensions(t){anObject(t);try{var r=getBuiltIn("Object","preventExtensions");return r&&r(t),!0}catch(t){return!1}}});var dv=fails((function(){var Constructor=function(){},t=Tt.f(new Constructor,"a",{configurable:!0});return!1!==Reflect.set(Constructor.prototype,"a",1,t)}));_export({target:"Reflect",stat:!0,forced:dv},{set:function set(t,r,o){var i,s,l,u=arguments.length<4?t:arguments[3],m=gt.f(anObject(t),r);if(!m){if(Z(s=An(t)))return set(s,r,o,u);m=createPropertyDescriptor(0)}if(isDataDescriptor(m)){if(!1===m.writable||!Z(u))return!1;if(i=gt.f(u,r)){if(i.get||i.set||!1===i.writable)return!1;i.value=o,Tt.f(u,r,i)}else Tt.f(u,r,createPropertyDescriptor(0,o))}else{if(void 0===(l=m.set))return!1;h(l,u,o)}return!0}}),dn&&_export({target:"Reflect",stat:!0},{setPrototypeOf:function setPrototypeOf(t,r){anObject(t),aPossiblePrototype(r);try{return dn(t,r),!0}catch(t){return!1}}}),_export({global:!0},{Reflect:{}}),setToStringTag(i.Reflect,"Reflect",!0);var uv=wellKnownSymbol("match"),isRegexp=function(t){var r;return Z(t)&&(void 0!==(r=t[uv])?!!r:"RegExp"==classofRaw(t))},regexpFlags=function(){var t=anObject(this),r="";return t.hasIndices&&(r+="d"),t.global&&(r+="g"),t.ignoreCase&&(r+="i"),t.multiline&&(r+="m"),t.dotAll&&(r+="s"),t.unicode&&(r+="u"),t.unicodeSets&&(r+="v"),t.sticky&&(r+="y"),r},hv=RegExp.prototype,regexpGetFlags=function(t){var r=t.flags;return void 0!==r||"flags"in hv||tt(t,"flags")||!re(hv,t)?r:h(regexpFlags,t)},pv=i.RegExp,fv=fails((function(){var t=pv("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),gv=fv||fails((function(){return!pv("a","y").sticky})),mv=fv||fails((function(){var t=pv("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),vv={BROKEN_CARET:mv,MISSED_STICKY:gv,UNSUPPORTED_Y:fv},yv=i.RegExp,bv=fails((function(){var t=yv(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)})),wv=i.RegExp,Cv=fails((function(){var t=wv("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),_v=nr.f,kv=Gt.enforce,Sv=wellKnownSymbol("match"),Tv=i.RegExp,Ev=Tv.prototype,xv=i.SyntaxError,Iv=N(Ev.exec),Av=N("".charAt),Pv=N("".replace),Rv=N("".indexOf),Ov=N("".slice),Nv=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Mv=/a/g,Dv=/a/g,Fv=new Tv(Mv)!==Mv,Lv=vv.MISSED_STICKY,Uv=vv.UNSUPPORTED_Y,Bv=s&&(!Fv||Lv||bv||Cv||fails((function(){return Dv[Sv]=!1,Tv(Mv)!=Mv||Tv(Dv)==Dv||"/a/i"!=Tv(Mv,"i")})));if(pr("RegExp",Bv)){for(var Hv=function RegExp(t,r){var o,i,s,l,u,h,m=re(Ev,this),v=isRegexp(t),C=void 0===r,_=[],k=t;if(!m&&v&&C&&t.constructor===Hv)return t;if((v||re(Ev,t))&&(t=t.source,C&&(r=regexpGetFlags(k))),t=void 0===t?"":toString_1(t),r=void 0===r?"":toString_1(r),k=t,bv&&"dotAll"in Mv&&(i=!!r&&Rv(r,"s")>-1)&&(r=Pv(r,/s/g,"")),o=r,Lv&&"sticky"in Mv&&(s=!!r&&Rv(r,"y")>-1)&&Uv&&(r=Pv(r,/y/g,"")),Cv&&(l=function(t){for(var r,o=t.length,i=0,s="",l=[],u={},h=!1,m=!1,v=0,C="";i<=o;i++){if("\\"===(r=Av(t,i)))r+=Av(t,++i);else if("]"===r)h=!1;else if(!h)switch(!0){case"["===r:h=!0;break;case"("===r:Iv(Nv,Ov(t,i+1))&&(i+=2,m=!0),s+=r,v++;continue;case">"===r&&m:if(""===C||tt(u,C))throw new xv("Invalid capture group name");u[C]=!0,l[l.length]=[C,v],m=!1,C="";continue}m?C+=r:s+=r}return[s,l]}(t),t=l[0],_=l[1]),u=inheritIfRequired(Tv(t,r),m?this:Ev,Hv),(i||s||_.length)&&(h=kv(u),i&&(h.dotAll=!0,h.raw=Hv(function(t){for(var r,o=t.length,i=0,s="",l=!1;i<=o;i++)"\\"!==(r=Av(t,i))?l||"."!==r?("["===r?l=!0:"]"===r&&(l=!1),s+=r):s+="[\\s\\S]":s+=r+Av(t,++i);return s}(t),o)),s&&(h.sticky=!0),_.length&&(h.groups=_)),t!==k)try{Et(u,"source",""===k?"(?:)":k)}catch(t){}return u},$v=_v(Tv),qv=0;$v.length>qv;)proxyAccessor(Hv,Tv,$v[qv++]);Ev.constructor=Hv,Hv.prototype=Ev,defineBuiltIn(i,"RegExp",Hv,{constructor:!0})}setSpecies("RegExp");var jv=Gt.get,zv=RegExp.prototype,Gv=TypeError;s&&bv&&defineBuiltInAccessor(zv,"dotAll",{configurable:!0,get:function dotAll(){if(this!==zv){if("RegExp"===classofRaw(this))return!!jv(this).dotAll;throw Gv("Incompatible receiver, RegExp required")}}});var Vv=Gt.get,Kv=Ve("native-string-replace",String.prototype.replace),Wv=RegExp.prototype.exec,Qv=Wv,Yv=N("".charAt),Jv=N("".indexOf),Xv=N("".replace),Zv=N("".slice),ey=function(){var t=/a/,r=/b*/g;return h(Wv,t,"a"),h(Wv,r,"a"),0!==t.lastIndex||0!==r.lastIndex}(),ty=vv.BROKEN_CARET,ry=void 0!==/()??/.exec("")[1];(ey||ry||ty||bv||Cv)&&(Qv=function exec(t){var r,o,i,s,l,u,m,v=this,C=Vv(v),_=toString_1(t),k=C.raw;if(k)return k.lastIndex=v.lastIndex,r=h(Qv,k,_),v.lastIndex=k.lastIndex,r;var E=C.groups,R=ty&&v.sticky,N=h(regexpFlags,v),M=v.source,B=0,H=_;if(R&&(N=Xv(N,"y",""),-1===Jv(N,"g")&&(N+="g"),H=Zv(_,v.lastIndex),v.lastIndex>0&&(!v.multiline||v.multiline&&"\n"!==Yv(_,v.lastIndex-1))&&(M="(?: "+M+")",H=" "+H,B++),o=new RegExp("^(?:"+M+")",N)),ry&&(o=new RegExp("^"+M+"$(?!\\s)",N)),ey&&(i=v.lastIndex),s=h(Wv,R?o:v,H),R?s?(s.input=Zv(s.input,B),s[0]=Zv(s[0],B),s.index=v.lastIndex,v.lastIndex+=s[0].length):v.lastIndex=0:ey&&s&&(v.lastIndex=v.global?s.index+s[0].length:i),ry&&s&&s.length>1&&h(Kv,s[0],o,(function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(s[l]=void 0)})),s&&E)for(s.groups=u=Pr(null),l=0;l<E.length;l++)u[(m=E[l])[0]]=s[m[1]];return s});var oy=Qv;_export({target:"RegExp",proto:!0,forced:/./.exec!==oy},{exec:oy});var ny=i.RegExp,iy=ny.prototype,sy=s&&fails((function(){var t=!0;try{ny(".","d")}catch(r){t=!1}var r={},o="",i=t?"dgimsy":"gimsy",addGetter=function(t,i){Object.defineProperty(r,t,{get:function(){return o+=i,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var l in t&&(s.hasIndices="d"),s)addGetter(l,s[l]);return Object.getOwnPropertyDescriptor(iy,"flags").get.call(r)!==i||o!==i}));sy&&defineBuiltInAccessor(iy,"flags",{configurable:!0,get:regexpFlags});var ay=vv.MISSED_STICKY,cy=Gt.get,ly=RegExp.prototype,dy=TypeError;s&&ay&&defineBuiltInAccessor(ly,"sticky",{configurable:!0,get:function sticky(){if(this!==ly){if("RegExp"===classofRaw(this))return!!cy(this).sticky;throw dy("Incompatible receiver, RegExp required")}}});var uy,hy,py=(uy=!1,(hy=/[ac]/).exec=function(){return uy=!0,/./.exec.apply(this,arguments)},!0===hy.test("abc")&&uy),fy=/./.test;_export({target:"RegExp",proto:!0,forced:!py},{test:function(t){var r=anObject(this),o=toString_1(t),i=r.exec;if(!W(i))return h(fy,r,o);var s=h(i,r,o);return null!==s&&(anObject(s),!0)}});var gy=Pt.PROPER,my="toString",vy=RegExp.prototype[my],yy=fails((function(){return"/a/b"!=vy.call({source:"a",flags:"b"})})),by=gy&&vy.name!=my;(yy||by)&&defineBuiltIn(RegExp.prototype,my,(function toString(){var t=anObject(this);return"/"+toString_1(t.source)+"/"+toString_1(regexpGetFlags(t))}),{unsafe:!0}),collection("Set",(function(t){return function Set(){return t(this,arguments.length?arguments[0]:void 0)}}),Uu);var wy=N("".charAt),Cy=fails((function(){return"\ud842"!=="ð ®·".at(-2)}));_export({target:"String",proto:!0,forced:Cy},{at:function at(t){var r=toString_1(requireObjectCoercible(this)),o=r.length,i=toIntegerOrInfinity(t),s=i>=0?i:o+i;return s<0||s>=o?void 0:wy(r,s)}});var _y=N("".charAt),ky=N("".charCodeAt),Sy=N("".slice),createMethod=function(t){return function(r,o){var i,s,l=toString_1(requireObjectCoercible(r)),u=toIntegerOrInfinity(o),h=l.length;return u<0||u>=h?t?"":void 0:(i=ky(l,u))<55296||i>56319||u+1===h||(s=ky(l,u+1))<56320||s>57343?t?_y(l,u):i:t?Sy(l,u,u+2):s-56320+(i-55296<<10)+65536}},Ty={codeAt:createMethod(!1),charAt:createMethod(!0)},Ey=Ty.codeAt;_export({target:"String",proto:!0},{codePointAt:function codePointAt(t){return Ey(this,t)}});var xy=TypeError,notARegexp=function(t){if(isRegexp(t))throw xy("The method doesn't accept regular expressions");return t},Iy=wellKnownSymbol("match"),correctIsRegexpLogic=function(t){var r=/./;try{"/./"[t](r)}catch(o){try{return r[Iy]=!1,"/./"[t](r)}catch(t){}}return!1},Ay=gt.f,Py=functionUncurryThisClause("".endsWith),Ry=functionUncurryThisClause("".slice),Oy=Math.min,Ny=correctIsRegexpLogic("endsWith"),My=!Ny&&!!function(){var t=Ay(String.prototype,"endsWith");return t&&!t.writable}();_export({target:"String",proto:!0,forced:!My&&!Ny},{endsWith:function endsWith(t){var r=toString_1(requireObjectCoercible(this));notARegexp(t);var o=arguments.length>1?arguments[1]:void 0,i=r.length,s=void 0===o?i:Oy(toLength(o),i),l=toString_1(t);return Py?Py(r,l,s):Ry(r,s-l.length,s)===l}});var Dy=RangeError,Fy=String.fromCharCode,Ly=String.fromCodePoint,Uy=N([].join),By=!!Ly&&1!=Ly.length;_export({target:"String",stat:!0,arity:1,forced:By},{fromCodePoint:function fromCodePoint(t){for(var r,o=[],i=arguments.length,s=0;i>s;){if(r=+arguments[s++],toAbsoluteIndex(r,1114111)!==r)throw Dy(r+" is not a valid code point");o[s]=r<65536?Fy(r):Fy(55296+((r-=65536)>>10),r%1024+56320)}return Uy(o,"")}});var Hy=N("".indexOf);_export({target:"String",proto:!0,forced:!correctIsRegexpLogic("includes")},{includes:function includes(t){return!!~Hy(toString_1(requireObjectCoercible(this)),toString_1(notARegexp(t)),arguments.length>1?arguments[1]:void 0)}});var $y=Ty.charAt,qy="String Iterator",jy=Gt.set,zy=Gt.getterFor(qy);iteratorDefine(String,"String",(function(t){jy(this,{type:qy,string:toString_1(t),index:0})}),(function next(){var t,r=zy(this),o=r.string,i=r.index;return i>=o.length?createIterResultObject(void 0,!0):(t=$y(o,i),r.index+=t.length,createIterResultObject(t,!1))}));var Gy=wellKnownSymbol("species"),Vy=RegExp.prototype,fixRegexpWellKnownSymbolLogic=function(t,r,o,i){var s=wellKnownSymbol(t),l=!fails((function(){var r={};return r[s]=function(){return 7},7!=""[t](r)})),u=l&&!fails((function(){var r=!1,o=/a/;return"split"===t&&((o={}).constructor={},o.constructor[Gy]=function(){return o},o.flags="",o[s]=/./[s]),o.exec=function(){return r=!0,null},o[s](""),!r}));if(!l||!u||o){var h=functionUncurryThisClause(/./[s]),m=r(s,""[t],(function(t,r,o,i,s){var u=functionUncurryThisClause(t),m=r.exec;return m===oy||m===Vy.exec?l&&!s?{done:!0,value:h(r,o,i)}:{done:!0,value:u(o,r,i)}:{done:!1}}));defineBuiltIn(String.prototype,t,m[0]),defineBuiltIn(Vy,s,m[1])}i&&Et(Vy[s],"sham",!0)},Ky=Ty.charAt,advanceStringIndex=function(t,r,o){return r+(o?Ky(t,r).length:1)},Wy=TypeError,regexpExecAbstract=function(t,r){var o=t.exec;if(W(o)){var i=h(o,t,r);return null!==i&&anObject(i),i}if("RegExp"===classofRaw(t))return h(oy,t,r);throw Wy("RegExp#exec called on incompatible receiver")};fixRegexpWellKnownSymbolLogic("match",(function(t,r,o){return[function match(r){var o=requireObjectCoercible(this),i=isNullOrUndefined(r)?void 0:getMethod$1(r,t);return i?h(i,r,o):new RegExp(r)[t](toString_1(o))},function(t){var i=anObject(this),s=toString_1(t),l=o(r,i,s);if(l.done)return l.value;if(!i.global)return regexpExecAbstract(i,s);var u=i.unicode;i.lastIndex=0;for(var h,m=[],v=0;null!==(h=regexpExecAbstract(i,s));){var C=toString_1(h[0]);m[v]=C,""===C&&(i.lastIndex=advanceStringIndex(s,toLength(i.lastIndex),u)),v++}return 0===v?null:m}]}));var Qy=wellKnownSymbol("matchAll"),Yy="RegExp String",Jy=Yy+" Iterator",Xy=Gt.set,Zy=Gt.getterFor(Jy),eb=RegExp.prototype,tb=TypeError,rb=functionUncurryThisClause("".indexOf),ob=functionUncurryThisClause("".matchAll),nb=!!ob&&!fails((function(){ob("a",/./)})),ab=iteratorCreateConstructor((function RegExpStringIterator(t,r,o,i){Xy(this,{type:Jy,regexp:t,string:r,global:o,unicode:i,done:!1})}),Yy,(function next(){var t=Zy(this);if(t.done)return createIterResultObject(void 0,!0);var r=t.regexp,o=t.string,i=regexpExecAbstract(r,o);return null===i?(t.done=!0,createIterResultObject(void 0,!0)):t.global?(""===toString_1(i[0])&&(r.lastIndex=advanceStringIndex(o,toLength(r.lastIndex),t.unicode)),createIterResultObject(i,!1)):(t.done=!0,createIterResultObject(i,!1))})),$matchAll=function(t){var r,o,i,s=anObject(this),l=toString_1(t),u=speciesConstructor(s,RegExp),h=toString_1(regexpGetFlags(s));return r=new u(u===RegExp?s.source:s,h),o=!!~rb(h,"g"),i=!!~rb(h,"u"),r.lastIndex=toLength(s.lastIndex),new ab(r,l,o,i)};_export({target:"String",proto:!0,forced:nb},{matchAll:function matchAll(t){var r,o,i,s=requireObjectCoercible(this);if(isNullOrUndefined(t)){if(nb)return ob(s,t)}else{if(isRegexp(t)&&(r=toString_1(requireObjectCoercible(regexpGetFlags(t))),!~rb(r,"g")))throw tb("`.matchAll` does not allow non-global regexes");if(nb)return ob(s,t);if(i=getMethod$1(t,Qy))return h(i,t,s)}return o=toString_1(s),new RegExp(t,"g")[Qy](o)}}),Qy in eb||defineBuiltIn(eb,Qy,$matchAll);var cb=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(oe),db=Ad.end;_export({target:"String",proto:!0,forced:cb},{padEnd:function padEnd(t){return db(this,t,arguments.length>1?arguments[1]:void 0)}});var ub=Ad.start;_export({target:"String",proto:!0,forced:cb},{padStart:function padStart(t){return ub(this,t,arguments.length>1?arguments[1]:void 0)}});var hb=N([].push),pb=N([].join);_export({target:"String",stat:!0},{raw:function raw(t){var r=toIndexedObject(toObject(t).raw),o=lengthOfArrayLike(r);if(!o)return"";for(var i=arguments.length,s=[],l=0;;){if(hb(s,toString_1(r[l++])),l===o)return pb(s,"");l<i&&hb(s,toString_1(arguments[l]))}}}),_export({target:"String",proto:!0},{repeat:Td});var fb=Math.floor,gb=N("".charAt),mb=N("".replace),vb=N("".slice),yb=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,bb=/\$([$&'`]|\d{1,2})/g,getSubstitution=function(t,r,o,i,s,l){var u=o+t.length,h=i.length,m=bb;return void 0!==s&&(s=toObject(s),m=yb),mb(l,m,(function(l,m){var v;switch(gb(m,0)){case"$":return"$";case"&":return t;case"`":return vb(r,0,o);case"'":return vb(r,u);case"<":v=s[vb(m,1,-1)];break;default:var C=+m;if(0===C)return l;if(C>h){var _=fb(C/10);return 0===_?l:_<=h?void 0===i[_-1]?gb(m,1):i[_-1]+gb(m,1):l}v=i[C-1]}return void 0===v?"":v}))},wb=wellKnownSymbol("replace"),_b=Math.max,kb=Math.min,Sb=N([].concat),Tb=N([].push),Eb=N("".indexOf),xb=N("".slice),Ib="$0"==="a".replace(/./,"$0"),Ab=!!/./[wb]&&""===/./[wb]("a","$0"),Pb=!fails((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}));fixRegexpWellKnownSymbolLogic("replace",(function(t,r,o){var i=Ab?"$":"$0";return[function replace(t,o){var i=requireObjectCoercible(this),s=isNullOrUndefined(t)?void 0:getMethod$1(t,wb);return s?h(s,t,i,o):h(r,toString_1(i),t,o)},function(t,s){var l=anObject(this),u=toString_1(t);if("string"==typeof s&&-1===Eb(s,i)&&-1===Eb(s,"$<")){var h=o(r,l,u,s);if(h.done)return h.value}var m=W(s);m||(s=toString_1(s));var v=l.global;if(v){var C=l.unicode;l.lastIndex=0}for(var _=[];;){var k=regexpExecAbstract(l,u);if(null===k)break;if(Tb(_,k),!v)break;""===toString_1(k[0])&&(l.lastIndex=advanceStringIndex(u,toLength(l.lastIndex),C))}for(var E,R="",N=0,M=0;M<_.length;M++){for(var B=toString_1((k=_[M])[0]),H=_b(kb(toIntegerOrInfinity(k.index),u.length),0),$=[],q=1;q<k.length;q++)Tb($,void 0===(E=k[q])?E:String(E));var j=k.groups;if(m){var z=Sb([B],$,H,u);void 0!==j&&Tb(z,j);var V=toString_1(Do(s,void 0,z))}else V=getSubstitution(B,u,H,$,j,s);H>=N&&(R+=xb(u,N,H)+V,N=H+B.length)}return R+xb(u,N)}]}),!Pb||!Ib||Ab);var Rb=wellKnownSymbol("replace"),Ob=TypeError,Mb=N("".indexOf);N("".replace);var Db=N("".slice),Fb=Math.max,stringIndexOf=function(t,r,o){return o>t.length?-1:""===r?o:Mb(t,r,o)};_export({target:"String",proto:!0},{replaceAll:function replaceAll(t,r){var o,i,s,l,u,m,v,C,_=requireObjectCoercible(this),k=0,E=0,R="";if(!isNullOrUndefined(t)){if(isRegexp(t)&&(o=toString_1(requireObjectCoercible(regexpGetFlags(t))),!~Mb(o,"g")))throw Ob("`.replaceAll` does not allow non-global regexes");if(i=getMethod$1(t,Rb))return h(i,t,_,r)}for(s=toString_1(_),l=toString_1(t),(u=W(r))||(r=toString_1(r)),m=l.length,v=Fb(1,m),k=stringIndexOf(s,l,0);-1!==k;)C=u?toString_1(r(l,k,s)):getSubstitution(l,s,k,[],void 0,r),R+=Db(s,E,k)+C,E=k+m,k=stringIndexOf(s,l,k+v);return E<s.length&&(R+=Db(s,E)),R}}),fixRegexpWellKnownSymbolLogic("search",(function(t,r,o){return[function search(r){var o=requireObjectCoercible(this),i=isNullOrUndefined(r)?void 0:getMethod$1(r,t);return i?h(i,r,o):new RegExp(r)[t](toString_1(o))},function(t){var i=anObject(this),s=toString_1(t),l=o(r,i,s);if(l.done)return l.value;var u=i.lastIndex;tg(u,0)||(i.lastIndex=0);var h=regexpExecAbstract(i,s);return tg(i.lastIndex,u)||(i.lastIndex=u),null===h?-1:h.index}]}));var Lb=vv.UNSUPPORTED_Y,Ub=4294967295,Bb=Math.min,qb=[].push,zb=N(/./.exec),Gb=N(qb),Kb=N("".slice),Wb=!fails((function(){var t=/(?:)/,r=t.exec;t.exec=function(){return r.apply(this,arguments)};var o="ab".split(t);return 2!==o.length||"a"!==o[0]||"b"!==o[1]}));fixRegexpWellKnownSymbolLogic("split",(function(t,r,o){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,o){var i=toString_1(requireObjectCoercible(this)),s=void 0===o?Ub:o>>>0;if(0===s)return[];if(void 0===t)return[i];if(!isRegexp(t))return h(r,i,t,s);for(var l,u,m,v=[],C=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),_=0,k=new RegExp(t.source,C+"g");(l=h(oy,k,i))&&!((u=k.lastIndex)>_&&(Gb(v,Kb(i,_,l.index)),l.length>1&&l.index<i.length&&Do(qb,v,arraySliceSimple(l,1)),m=l[0].length,_=u,v.length>=s));)k.lastIndex===l.index&&k.lastIndex++;return _===i.length?!m&&zb(k,"")||Gb(v,""):Gb(v,Kb(i,_)),v.length>s?arraySliceSimple(v,0,s):v}:"0".split(void 0,0).length?function(t,o){return void 0===t&&0===o?[]:h(r,this,t,o)}:r,[function split(r,o){var s=requireObjectCoercible(this),l=isNullOrUndefined(r)?void 0:getMethod$1(r,t);return l?h(l,r,s,o):h(i,toString_1(s),r,o)},function(t,s){var l=anObject(this),u=toString_1(t),h=o(i,l,u,s,i!==r);if(h.done)return h.value;var m=speciesConstructor(l,RegExp),v=l.unicode,C=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(Lb?"g":"y"),_=new m(Lb?"^(?:"+l.source+")":l,C),k=void 0===s?Ub:s>>>0;if(0===k)return[];if(0===u.length)return null===regexpExecAbstract(_,u)?[u]:[];for(var E=0,R=0,N=[];R<u.length;){_.lastIndex=Lb?0:R;var M,B=regexpExecAbstract(_,Lb?Kb(u,R):u);if(null===B||(M=Bb(toLength(_.lastIndex+(Lb?R:0)),u.length))===E)R=advanceStringIndex(u,R,v);else{if(Gb(N,Kb(u,E,R)),N.length===k)return N;for(var H=1;H<=B.length-1;H++)if(Gb(N,B[H]),N.length===k)return N;R=E=M}}return Gb(N,Kb(u,E)),N}]}),!Wb,Lb);var Qb=gt.f,Yb=functionUncurryThisClause("".startsWith),Jb=functionUncurryThisClause("".slice),Xb=Math.min,Zb=correctIsRegexpLogic("startsWith"),ew=!Zb&&!!function(){var t=Qb(String.prototype,"startsWith");return t&&!t.writable}();_export({target:"String",proto:!0,forced:!ew&&!Zb},{startsWith:function startsWith(t){var r=toString_1(requireObjectCoercible(this));notARegexp(t);var o=toLength(Xb(arguments.length>1?arguments[1]:void 0,r.length)),i=toString_1(t);return Yb?Yb(r,i,o):Jb(r,o,o+i.length)===i}});var tw=N("".slice),rw=Math.max,ow=Math.min,nw=!"".substr||"b"!=="ab".substr(-1);_export({target:"String",proto:!0,forced:nw},{substr:function substr(t,r){var o,i,s=toString_1(requireObjectCoercible(this)),l=s.length,u=toIntegerOrInfinity(t);return u===1/0&&(u=0),u<0&&(u=rw(l+u,0)),(o=void 0===r?l:toIntegerOrInfinity(r))<=0||o===1/0||u>=(i=ow(u+o,l))?"":tw(s,u,i)}});var iw=Pt.PROPER,stringTrimForced=function(t){return fails((function(){return!!up[t]()||"âÂá "!=="âÂá "[t]()||iw&&up[t].name!==t}))},sw=gp.trim;_export({target:"String",proto:!0,forced:stringTrimForced("trim")},{trim:function trim(){return sw(this)}});var aw=gp.end,cw=stringTrimForced("trimEnd")?function trimEnd(){return aw(this)}:"".trimEnd;_export({target:"String",proto:!0,name:"trimEnd",forced:"".trimRight!==cw},{trimRight:cw}),_export({target:"String",proto:!0,name:"trimEnd",forced:"".trimEnd!==cw},{trimEnd:cw});var lw=gp.start,dw=stringTrimForced("trimStart")?function trimStart(){return lw(this)}:"".trimStart;_export({target:"String",proto:!0,name:"trimStart",forced:"".trimLeft!==dw},{trimLeft:dw}),_export({target:"String",proto:!0,name:"trimStart",forced:"".trimStart!==dw},{trimStart:dw});var uw=/"/g,hw=N("".replace),createHtml=function(t,r,o,i){var s=toString_1(requireObjectCoercible(t)),l="<"+r;return""!==o&&(l+=" "+o+'="'+hw(toString_1(i),uw,"&quot;")+'"'),l+">"+s+"</"+r+">"},stringHtmlForced=function(t){return fails((function(){var r=""[t]('"');return r!==r.toLowerCase()||r.split('"').length>3}))};_export({target:"String",proto:!0,forced:stringHtmlForced("anchor")},{anchor:function anchor(t){return createHtml(this,"a","name",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("big")},{big:function big(){return createHtml(this,"big","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("blink")},{blink:function blink(){return createHtml(this,"blink","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("bold")},{bold:function bold(){return createHtml(this,"b","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("fixed")},{fixed:function fixed(){return createHtml(this,"tt","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("fontcolor")},{fontcolor:function fontcolor(t){return createHtml(this,"font","color",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("fontsize")},{fontsize:function fontsize(t){return createHtml(this,"font","size",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("italics")},{italics:function italics(){return createHtml(this,"i","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("link")},{link:function link(t){return createHtml(this,"a","href",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("small")},{small:function small(){return createHtml(this,"small","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("strike")},{strike:function strike(){return createHtml(this,"strike","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("sub")},{sub:function sub(){return createHtml(this,"sub","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("sup")},{sup:function sup(){return createHtml(this,"sup","","")}});var pw=Kl.NATIVE_ARRAY_BUFFER_VIEWS,fw=i.ArrayBuffer,gw=i.Int8Array,mw=!pw||!fails((function(){gw(1)}))||!fails((function(){new gw(-1)}))||!checkCorrectnessOfIteration((function(t){new gw,new gw(null),new gw(1.5),new gw(t)}),!0)||fails((function(){return 1!==new gw(new fw(2),1,void 0).length})),vw=RangeError,yw=RangeError,toOffset=function(t,r){var o=function(t){var r=toIntegerOrInfinity(t);if(r<0)throw vw("The argument can't be less than 0");return r}(t);if(o%r)throw yw("Wrong offset");return o},isBigIntArray=function(t){var r=Cr(t);return"BigInt64Array"==r||"BigUint64Array"==r},bw=TypeError,toBigInt=function(t){var r=toPrimitive(t,"number");if("number"==typeof r)throw bw("Can't convert number to bigint");return BigInt(r)},ww=Kl.aTypedArrayConstructor,Cw=function from(t){var r,o,i,s,l,u,m,v,C=aConstructor(this),_=toObject(t),k=arguments.length,E=k>1?arguments[1]:void 0,R=void 0!==E,N=getIteratorMethod(_);if(N&&!isArrayIteratorMethod(N))for(v=(m=getIterator(_,N)).next,_=[];!(u=h(v,m)).done;)_.push(u.value);for(R&&k>2&&(E=functionBindContext(E,arguments[2])),o=lengthOfArrayLike(_),i=new(ww(C))(o),s=isBigIntArray(i),r=0;o>r;r++)l=R?E(_[r],r):_[r],i[r]=s?toBigInt(l):+l;return i},_w=createCommonjsModule((function(t){var r=nr.f,o=eo.forEach,l=Gt.get,u=Gt.set,m=Gt.enforce,v=Tt.f,C=gt.f,_=Math.round,k=i.RangeError,E=kl.ArrayBuffer,R=E.prototype,N=kl.DataView,M=Kl.NATIVE_ARRAY_BUFFER_VIEWS,B=Kl.TYPED_ARRAY_TAG,H=Kl.TypedArray,$=Kl.TypedArrayPrototype,q=Kl.aTypedArrayConstructor,j=Kl.isTypedArray,z="BYTES_PER_ELEMENT",V="Wrong length",fromList=function(t,r){q(t);for(var o=0,i=r.length,s=new t(i);i>o;)s[o]=r[o++];return s},addGetter=function(t,r){defineBuiltInAccessor(t,r,{configurable:!0,get:function(){return l(this)[r]}})},isArrayBuffer=function(t){var r;return re(R,t)||"ArrayBuffer"==(r=Cr(t))||"SharedArrayBuffer"==r},isTypedArrayIndex=function(t,r){return j(t)&&!Ee(r)&&r in t&&Rp(+r)&&r>=0},K=function getOwnPropertyDescriptor(t,r){return r=toPropertyKey(r),isTypedArrayIndex(t,r)?createPropertyDescriptor(2,t[r]):C(t,r)},W=function defineProperty(t,r,o){return r=toPropertyKey(r),!(isTypedArrayIndex(t,r)&&Z(o)&&tt(o,"value"))||tt(o,"get")||tt(o,"set")||o.configurable||tt(o,"writable")&&!o.writable||tt(o,"enumerable")&&!o.enumerable?v(t,r,o):(t[r]=o.value,t)};s?(M||(gt.f=K,Tt.f=W,addGetter($,"buffer"),addGetter($,"byteOffset"),addGetter($,"byteLength"),addGetter($,"length")),_export({target:"Object",stat:!0,forced:!M},{getOwnPropertyDescriptor:K,defineProperty:W}),t.exports=function(t,s,C){var R=t.match(/\d+/)[0]/8,q=t+(C?"Clamped":"")+"Array",K="get"+t,W="set"+t,X=i[q],re=X,oe=re&&re.prototype,ne={},addElement=function(t,r){v(t,r,{get:function(){return function(t,r){var o=l(t);return o.view[K](r*R+o.byteOffset,!0)}(this,r)},set:function(t){return function(t,r,o){var i=l(t);C&&(o=(o=_(o))<0?0:o>255?255:255&o),i.view[W](r*R+i.byteOffset,o,!0)}(this,r,t)},enumerable:!0})};M?mw&&(re=s((function(t,r,o,i){return anInstance(t,oe),inheritIfRequired(Z(r)?isArrayBuffer(r)?void 0!==i?new X(r,toOffset(o,R),i):void 0!==o?new X(r,toOffset(o,R)):new X(r):j(r)?fromList(re,r):h(Cw,re,r):new X(toIndex(r)),t,re)})),dn&&dn(re,H),o(r(X),(function(t){t in re||Et(re,t,X[t])})),re.prototype=oe):(re=s((function(t,r,o,i){anInstance(t,oe);var s,l,m,v=0,C=0;if(Z(r)){if(!isArrayBuffer(r))return j(r)?fromList(re,r):h(Cw,re,r);s=r,C=toOffset(o,R);var _=r.byteLength;if(void 0===i){if(_%R)throw k(V);if((l=_-C)<0)throw k(V)}else if((l=toLength(i)*R)+C>_)throw k(V);m=l/R}else m=toIndex(r),s=new E(l=m*R);for(u(t,{buffer:s,byteOffset:C,byteLength:l,length:m,view:new N(s)});v<m;)addElement(t,v++)})),dn&&dn(re,H),oe=re.prototype=Pr($)),oe.constructor!==re&&Et(oe,"constructor",re),m(oe).TypedArrayConstructor=re,B&&Et(oe,B,q);var ae=re!=X;ne[q]=re,_export({global:!0,constructor:!0,forced:ae,sham:!M},ne),z in re||Et(re,z,R),z in oe||Et(oe,z,R),setSpecies(q)}):t.exports=function(){}}));_w("Float32",(function(t){return function Float32Array(r,o,i){return t(this,r,o,i)}})),_w("Float64",(function(t){return function Float64Array(r,o,i){return t(this,r,o,i)}})),_w("Int8",(function(t){return function Int8Array(r,o,i){return t(this,r,o,i)}})),_w("Int16",(function(t){return function Int16Array(r,o,i){return t(this,r,o,i)}})),_w("Int32",(function(t){return function Int32Array(r,o,i){return t(this,r,o,i)}})),_w("Uint8",(function(t){return function Uint8Array(r,o,i){return t(this,r,o,i)}})),_w("Uint8",(function(t){return function Uint8ClampedArray(r,o,i){return t(this,r,o,i)}}),!0),_w("Uint16",(function(t){return function Uint16Array(r,o,i){return t(this,r,o,i)}})),_w("Uint32",(function(t){return function Uint32Array(r,o,i){return t(this,r,o,i)}}));var kw=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("at",(function at(t){var r=kw(this),o=lengthOfArrayLike(r),i=toIntegerOrInfinity(t),s=i>=0?i:o+i;return s<0||s>=o?void 0:r[s]}));var Sw=N(hi),Tw=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("copyWithin",(function copyWithin(t,r){return Sw(Tw(this),t,r,arguments.length>2?arguments[2]:void 0)}));var Ew=eo.every,xw=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("every",(function every(t){return Ew(xw(this),t,arguments.length>1?arguments[1]:void 0)}));var Iw=Kl.aTypedArray,Aw=Kl.exportTypedArrayMethod,Pw=N("".slice);Aw("fill",(function fill(t){var r=arguments.length;Iw(this);var o="Big"===Pw(Cr(this),0,3)?toBigInt(t):+t;return h(Ci,this,o,r>1?arguments[1]:void 0,r>2?arguments[2]:void 0)}),fails((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var Rw=Kl.aTypedArrayConstructor,Ow=Kl.getTypedArrayConstructor,typedArraySpeciesConstructor=function(t){return Rw(speciesConstructor(t,Ow(t)))},Nw=eo.filter,Mw=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("filter",(function filter(t){return function(t,r){return arrayFromConstructorAndList(typedArraySpeciesConstructor(t),r)}(this,Nw(Mw(this),t,arguments.length>1?arguments[1]:void 0))}));var Dw=eo.find,Fw=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("find",(function find(t){return Dw(Fw(this),t,arguments.length>1?arguments[1]:void 0)}));var Lw=eo.findIndex,Uw=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("findIndex",(function findIndex(t){return Lw(Uw(this),t,arguments.length>1?arguments[1]:void 0)}));var Bw=Ji.findLast,Hw=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("findLast",(function findLast(t){return Bw(Hw(this),t,arguments.length>1?arguments[1]:void 0)}));var $w=Ji.findLastIndex,qw=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("findLastIndex",(function findLastIndex(t){return $w(qw(this),t,arguments.length>1?arguments[1]:void 0)}));var jw=eo.forEach,zw=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("forEach",(function forEach(t){jw(zw(this),t,arguments.length>1?arguments[1]:void 0)})),(0,Kl.exportTypedArrayStaticMethod)("from",Cw,mw);var Gw=Zt.includes,Vw=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("includes",(function includes(t){return Gw(Vw(this),t,arguments.length>1?arguments[1]:void 0)}));var Kw=Zt.indexOf,Ww=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("indexOf",(function indexOf(t){return Kw(Ww(this),t,arguments.length>1?arguments[1]:void 0)}));var Qw=wellKnownSymbol("iterator"),Yw=i.Uint8Array,Jw=N(Bs.values),Xw=N(Bs.keys),Zw=N(Bs.entries),eC=Kl.aTypedArray,tC=Kl.exportTypedArrayMethod,rC=Yw&&Yw.prototype,oC=!fails((function(){rC[Qw].call([1])})),nC=!!rC&&rC.values&&rC[Qw]===rC.values&&"values"===rC.values.name,iC=function values(){return Jw(eC(this))};tC("entries",(function entries(){return Zw(eC(this))}),oC),tC("keys",(function keys(){return Xw(eC(this))}),oC),tC("values",iC,oC||!nC,{name:"values"}),tC(Qw,iC,oC||!nC,{name:"values"});var sC=Kl.aTypedArray,aC=Kl.exportTypedArrayMethod,cC=N([].join);aC("join",(function join(t){return cC(sC(this),t)}));var lC=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("lastIndexOf",(function lastIndexOf(t){var r=arguments.length;return Do(Ks,lC(this),r>1?[t,arguments[1]]:[t])}));var dC=eo.map,uC=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("map",(function map(t){return dC(uC(this),t,arguments.length>1?arguments[1]:void 0,(function(t,r){return new(typedArraySpeciesConstructor(t))(r)}))}));var hC=Kl.aTypedArrayConstructor;(0,Kl.exportTypedArrayStaticMethod)("of",(function of(){for(var t=0,r=arguments.length,o=new(hC(this))(r);r>t;)o[t]=arguments[t++];return o}),mw);var pC=aa.left,fC=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("reduce",(function reduce(t){var r=arguments.length;return pC(fC(this),t,r,r>1?arguments[1]:void 0)}));var gC=aa.right,mC=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("reduceRight",(function reduceRight(t){var r=arguments.length;return gC(mC(this),t,r,r>1?arguments[1]:void 0)}));var vC=Kl.aTypedArray,yC=Kl.exportTypedArrayMethod,bC=Math.floor;yC("reverse",(function reverse(){for(var t,r=this,o=vC(r).length,i=bC(o/2),s=0;s<i;)t=r[s],r[s++]=r[--o],r[o]=t;return r}));var wC=i.RangeError,CC=i.Int8Array,_C=CC&&CC.prototype,kC=_C&&_C.set,SC=Kl.aTypedArray,TC=Kl.exportTypedArrayMethod,EC=!fails((function(){var t=new Uint8ClampedArray(2);return h(kC,t,{length:1,0:3},1),3!==t[1]})),xC=EC&&Kl.NATIVE_ARRAY_BUFFER_VIEWS&&fails((function(){var t=new CC(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));TC("set",(function set(t){SC(this);var r=toOffset(arguments.length>1?arguments[1]:void 0,1),o=toObject(t);if(EC)return h(kC,this,o,r);var i=this.length,s=lengthOfArrayLike(o),l=0;if(s+r>i)throw wC("Wrong length");for(;l<s;)this[r+l]=o[l++]}),!EC||xC);var IC=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("slice",(function slice(t,r){for(var o=Fo(IC(this),t,r),i=typedArraySpeciesConstructor(this),s=0,l=o.length,u=new i(l);l>s;)u[s]=o[s++];return u}),fails((function(){new Int8Array(1).slice()})));var AC=eo.some,PC=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("some",(function some(t){return AC(PC(this),t,arguments.length>1?arguments[1]:void 0)}));var RC=Kl.aTypedArray,OC=Kl.exportTypedArrayMethod,NC=i.Uint16Array,MC=NC&&functionUncurryThisClause(NC.prototype.sort),DC=!(!MC||fails((function(){MC(new NC(2),null)}))&&fails((function(){MC(new NC(2),{})}))),FC=!!MC&&!fails((function(){if(me)return me<74;if(rc)return rc<67;if(oc)return!0;if(ic)return ic<602;var t,r,o=new NC(516),i=Array(516);for(t=0;t<516;t++)r=t%4,o[t]=515-t,i[t]=t-2*r+3;for(MC(o,(function(t,r){return(t/4|0)-(r/4|0)})),t=0;t<516;t++)if(o[t]!==i[t])return!0}));OC("sort",(function sort(t){return void 0!==t&&aCallable(t),FC?MC(this,t):Wa(RC(this),function(t){return function(r,o){return void 0!==t?+t(r,o)||0:o!=o?-1:r!=r?1:0===r&&0===o?1/r>0&&1/o<0?1:-1:r>o}}(t))}),!FC||DC);var LC=Kl.aTypedArray;(0,Kl.exportTypedArrayMethod)("subarray",(function subarray(t,r){var o=LC(this),i=o.length,s=toAbsoluteIndex(t,i);return new(typedArraySpeciesConstructor(o))(o.buffer,o.byteOffset+s*o.BYTES_PER_ELEMENT,toLength((void 0===r?i:toAbsoluteIndex(r,i))-s))}));var UC=i.Int8Array,BC=Kl.aTypedArray,HC=Kl.exportTypedArrayMethod,$C=[].toLocaleString,qC=!!UC&&fails((function(){$C.call(new UC(1))}));HC("toLocaleString",(function toLocaleString(){return Do($C,qC?Fo(BC(this)):BC(this),Fo(arguments))}),fails((function(){return[1,2].toLocaleString()!=new UC([1,2]).toLocaleString()}))||!fails((function(){UC.prototype.toLocaleString.call([1,2])})));var jC=Kl.aTypedArray,zC=Kl.getTypedArrayConstructor;(0,Kl.exportTypedArrayMethod)("toReversed",(function toReversed(){return arrayToReversed(jC(this),zC(this))}));var GC=Kl.aTypedArray,VC=Kl.getTypedArrayConstructor,KC=Kl.exportTypedArrayMethod,WC=N(Kl.TypedArrayPrototype.sort);KC("toSorted",(function toSorted(t){void 0!==t&&aCallable(t);var r=GC(this),o=arrayFromConstructorAndList(VC(r),r);return WC(o,t)}));var QC=Kl.exportTypedArrayMethod,YC=i.Uint8Array,JC=YC&&YC.prototype||{},XC=[].toString,ZC=N([].join);fails((function(){XC.call({})}))&&(XC=function toString(){return ZC(this)});var e_=JC.toString!=XC;QC("toString",XC,e_);var t_=Kl.aTypedArray,r_=Kl.getTypedArrayConstructor,o_=Kl.exportTypedArrayMethod,n_=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(t){return 8===t}}();o_("with",{with:function(t,r){var o=t_(this),i=toIntegerOrInfinity(t),s=isBigIntArray(o)?toBigInt(r):+r;return arrayWith(o,r_(o),i,s)}}.with,!n_);var i_=String.fromCharCode,s_=N("".charAt),a_=N(/./.exec),c_=N("".slice),l_=/^[\da-f]{2}$/i,d_=/^[\da-f]{4}$/i;_export({global:!0},{unescape:function unescape(t){for(var r,o,i=toString_1(t),s="",l=i.length,u=0;u<l;){if("%"===(r=s_(i,u++)))if("u"===s_(i,u)){if(o=c_(i,u+1,u+5),a_(d_,o)){s+=i_(parseInt(o,16)),u+=5;continue}}else if(o=c_(i,u,u+2),a_(l_,o)){s+=i_(parseInt(o,16)),u+=2;continue}s+=r}return s}});var u_=Mu.getWeakData,h_=Gt.set,p_=Gt.getterFor,f_=eo.find,g_=eo.findIndex,m_=N([].splice),v_=0,uncaughtFrozenStore=function(t){return t.frozen||(t.frozen=new UncaughtFrozenStore)},UncaughtFrozenStore=function(){this.entries=[]},findUncaughtFrozen=function(t,r){return f_(t.entries,(function(t){return t[0]===r}))};UncaughtFrozenStore.prototype={get:function(t){var r=findUncaughtFrozen(this,t);if(r)return r[1]},has:function(t){return!!findUncaughtFrozen(this,t)},set:function(t,r){var o=findUncaughtFrozen(this,t);o?o[1]=r:this.entries.push([t,r])},delete:function(t){var r=g_(this.entries,(function(r){return r[0]===t}));return~r&&m_(this.entries,r,1),!!~r}};var y_,b_={getConstructor:function(t,r,o,i){var s=t((function(t,s){anInstance(t,l),h_(t,{type:r,id:v_++,frozen:void 0}),isNullOrUndefined(s)||iterate(s,t[i],{that:t,AS_ENTRIES:o})})),l=s.prototype,u=p_(r),define=function(t,r,o){var i=u(t),s=u_(anObject(r),!0);return!0===s?uncaughtFrozenStore(i).set(r,o):s[i.id]=o,t};return defineBuiltIns(l,{delete:function(t){var r=u(this);if(!Z(t))return!1;var o=u_(t);return!0===o?uncaughtFrozenStore(r).delete(t):o&&tt(o,r.id)&&delete o[r.id]},has:function has(t){var r=u(this);if(!Z(t))return!1;var o=u_(t);return!0===o?uncaughtFrozenStore(r).has(t):o&&tt(o,r.id)}}),defineBuiltIns(l,o?{get:function get(t){var r=u(this);if(Z(t)){var o=u_(t);return!0===o?uncaughtFrozenStore(r).get(t):o?o[r.id]:void 0}},set:function set(t,r){return define(this,t,r)}}:{add:function add(t){return define(this,t,!0)}}),s}},w_=Gt.enforce,C_=Object,k_=Array.isArray,S_=C_.isExtensible,T_=C_.isFrozen,E_=C_.isSealed,x_=C_.freeze,I_=C_.seal,A_={},P_={},R_=!i.ActiveXObject&&"ActiveXObject"in i,wrapper=function(t){return function WeakMap(){return t(this,arguments.length?arguments[0]:void 0)}},O_=collection("WeakMap",wrapper,b_),N_=O_.prototype,M_=N(N_.set);if(Lt)if(R_){y_=b_.getConstructor(wrapper,"WeakMap",!0),Mu.enable();var D_=N(N_.delete),F_=N(N_.has),L_=N(N_.get);defineBuiltIns(N_,{delete:function(t){if(Z(t)&&!S_(t)){var r=w_(this);return r.frozen||(r.frozen=new y_),D_(this,t)||r.frozen.delete(t)}return D_(this,t)},has:function has(t){if(Z(t)&&!S_(t)){var r=w_(this);return r.frozen||(r.frozen=new y_),F_(this,t)||r.frozen.has(t)}return F_(this,t)},get:function get(t){if(Z(t)&&!S_(t)){var r=w_(this);return r.frozen||(r.frozen=new y_),F_(this,t)?L_(this,t):r.frozen.get(t)}return L_(this,t)},set:function set(t,r){if(Z(t)&&!S_(t)){var o=w_(this);o.frozen||(o.frozen=new y_),F_(this,t)?M_(this,t,r):o.frozen.set(t,r)}else M_(this,t,r);return this}})}else Nu&&fails((function(){var t=x_([]);return M_(new O_,t,1),!T_(t)}))&&defineBuiltIns(N_,{set:function set(t,r){var o;return k_(t)&&(T_(t)?o=A_:E_(t)&&(o=P_)),M_(this,t,r),o==A_&&x_(t),o==P_&&I_(t),this}});collection("WeakSet",(function(t){return function WeakSet(){return t(this,arguments.length?arguments[0]:void 0)}}),b_);for(var U_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",B_={},H_=0;H_<66;H_++)B_[U_.charAt(H_)]=H_;var $_={itoc:U_,ctoi:B_},q_=$_.ctoi,j_=/[^\d+/a-z]/i,z_=/[\t\n\f\r ]+/g,G_=/[=]{1,2}$/,V_=getBuiltIn("atob"),K_=String.fromCharCode,W_=N("".charAt),Q_=N("".replace),Y_=N(j_.exec),J_=fails((function(){return""!==V_(" ")})),X_=!fails((function(){V_("a")})),Z_=!J_&&!X_&&!fails((function(){V_()})),ek=!J_&&!X_&&1!==V_.length;_export({global:!0,bind:!0,enumerable:!0,forced:J_||X_||Z_||ek},{atob:function atob(t){if(validateArgumentsLength(arguments.length,1),Z_||ek)return h(V_,i,t);var r,o,s=Q_(toString_1(t),z_,""),l="",u=0,m=0;if(s.length%4==0&&(s=Q_(s,G_,"")),s.length%4==1||Y_(j_,s))throw new(getBuiltIn("DOMException"))("The string is not correctly encoded","InvalidCharacterError");for(;r=W_(s,u++);)tt(q_,r)&&(o=m%4?64*o+q_[r]:q_[r],m++%4&&(l+=K_(255&o>>(-2*m&6))));return l}});var tk=$_.itoc,rk=getBuiltIn("btoa"),ok=N("".charAt),nk=N("".charCodeAt),ik=!!rk&&!fails((function(){rk()})),sk=!!rk&&fails((function(){return"bnVsbA=="!==rk(null)})),ak=!!rk&&1!==rk.length;_export({global:!0,bind:!0,enumerable:!0,forced:ik||sk||ak},{btoa:function btoa(t){if(validateArgumentsLength(arguments.length,1),ik||sk||ak)return h(rk,i,toString_1(t));for(var r,o,s=toString_1(t),l="",u=0,m=tk;ok(s,u)||(m="=",u%1);){if((o=nk(s,u+=3/4))>255)throw new(getBuiltIn("DOMException"))("The string contains characters outside of the Latin1 range","InvalidCharacterError");l+=ok(m,63&(r=r<<8|o)>>8-u%1*8)}return l}});var ck={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},lk=documentCreateElement("span").classList,dk=lk&&lk.constructor&&lk.constructor.prototype,uk=dk===Object.prototype?void 0:dk,handlePrototype$1=function(t){if(t&&t.forEach!==ns)try{Et(t,"forEach",ns)}catch(r){t.forEach=ns}};for(var hk in ck)ck[hk]&&handlePrototype$1(i[hk]&&i[hk].prototype);handlePrototype$1(uk);var pk=wellKnownSymbol("iterator"),fk=wellKnownSymbol("toStringTag"),gk=Bs.values,handlePrototype=function(t,r){if(t){if(t[pk]!==gk)try{Et(t,pk,gk)}catch(r){t[pk]=gk}if(t[fk]||Et(t,fk,r),ck[r])for(var o in Bs)if(t[o]!==Bs[o])try{Et(t,o,Bs[o])}catch(r){t[o]=Bs[o]}}};for(var mk in ck)handlePrototype(i[mk]&&i[mk].prototype,mk);handlePrototype(uk,"DOMTokenList");var vk={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}},yk=Tt.f,bk="DOMException",wk="DATA_CLONE_ERR",Ck=getBuiltIn("Error"),_k=getBuiltIn(bk)||function(){try{var t=getBuiltIn("MessageChannel")||function(t){try{if(ca)return Function('return require("'+t+'")')()}catch(t){}}("worker_threads").MessageChannel;(new t).port1.postMessage(new WeakMap)}catch(t){if(t.name==wk&&25==t.code)return t.constructor}}(),kk=_k&&_k.prototype,Sk=Ck.prototype,Tk=Gt.set,Ek=Gt.getterFor(bk),xk="stack"in Ck(bk),codeFor=function(t){return tt(vk,t)&&vk[t].m?vk[t].c:0},Ik=function DOMException(){anInstance(this,Ak);var t=arguments.length,r=normalizeStringArgument(t<1?void 0:arguments[0]),o=normalizeStringArgument(t<2?void 0:arguments[1],"Error"),i=codeFor(o);if(Tk(this,{type:bk,name:o,message:r,code:i}),s||(this.name=o,this.message=r,this.code=i),xk){var l=Ck(r);l.name=bk,yk(this,"stack",createPropertyDescriptor(1,errorStackClear(l.stack,1)))}},Ak=Ik.prototype=Pr(Sk),createGetterDescriptor=function(t){return{enumerable:!0,configurable:!0,get:t}},getterFor=function(t){return createGetterDescriptor((function(){return Ek(this)[t]}))};s&&(defineBuiltInAccessor(Ak,"code",getterFor("code")),defineBuiltInAccessor(Ak,"message",getterFor("message")),defineBuiltInAccessor(Ak,"name",getterFor("name"))),yk(Ak,"constructor",createPropertyDescriptor(1,Ik));var Pk=fails((function(){return!(new _k instanceof Ck)})),Rk=Pk||fails((function(){return Sk.toString!==kn||"2: 1"!==String(new _k(1,2))})),Ok=Pk||fails((function(){return 25!==new _k(1,"DataCloneError").code}));Pk||25!==_k[wk]||kk[wk];_export({global:!0,constructor:!0,forced:Pk},{DOMException:Pk?Ik:_k});var Nk=getBuiltIn(bk),Mk=Nk.prototype;for(var Dk in Rk&&_k===Nk&&defineBuiltIn(Mk,"toString",kn),Ok&&s&&_k===Nk&&defineBuiltInAccessor(Mk,"code",createGetterDescriptor((function(){return codeFor(anObject(this).name)}))),vk)if(tt(vk,Dk)){var Fk=vk[Dk],Lk=Fk.s,Uk=createPropertyDescriptor(6,Fk.c);tt(Nk,Lk)||yk(Nk,Lk,Uk),tt(Mk,Lk)||yk(Mk,Lk,Uk)}var Bk=Tt.f,Hk="DOMException",$k=getBuiltIn("Error"),qk=getBuiltIn(Hk),jk=function DOMException(){anInstance(this,zk);var t=arguments.length,r=normalizeStringArgument(t<1?void 0:arguments[0]),o=normalizeStringArgument(t<2?void 0:arguments[1],"Error"),i=new qk(r,o),s=$k(r);return s.name=Hk,Bk(i,"stack",createPropertyDescriptor(1,errorStackClear(s.stack,1))),inheritIfRequired(i,this,jk),i},zk=jk.prototype=qk.prototype,Gk="stack"in $k(Hk),Vk="stack"in new qk(1,2),Kk=qk&&s&&Object.getOwnPropertyDescriptor(i,Hk),Wk=!(!Kk||Kk.writable&&Kk.configurable),Qk=Gk&&!Wk&&!Vk;_export({global:!0,constructor:!0,forced:Qk},{DOMException:Qk?jk:qk});var Yk=getBuiltIn(Hk),Jk=Yk.prototype;if(Jk.constructor!==Yk)for(var Xk in Bk(Jk,"constructor",createPropertyDescriptor(1,Yk)),vk)if(tt(vk,Xk)){var Zk=vk[Xk],eS=Zk.s;tt(Yk,eS)||Bk(Yk,eS,createPropertyDescriptor(6,Zk.c))}var tS="DOMException";setToStringTag(getBuiltIn(tS),tS);var rS=Gg.clear;_export({global:!0,bind:!0,enumerable:!0,forced:i.clearImmediate!==rS},{clearImmediate:rS});var oS="function"==typeof Bun&&Bun&&"string"==typeof Bun.version,nS=i.Function,iS=/MSIE .\./.test(oe)||oS&&function(){var t=i.Bun.version.split(".");return t.length<3||0==t[0]&&(t[1]<3||3==t[1]&&0==t[2])}(),schedulersFix=function(t,r){var o=r?2:1;return iS?function(i,s){var l=validateArgumentsLength(arguments.length,1)>o,u=W(i)?i:nS(i),h=l?Fo(arguments,o):[],m=l?function(){Do(u,this,h)}:u;return r?t(m,s):t(m)}:t},sS=Gg.set,aS=i.setImmediate?schedulersFix(sS,!1):sS;_export({global:!0,bind:!0,enumerable:!0,forced:i.setImmediate!==aS},{setImmediate:aS});var cS=i.process;_export({global:!0,enumerable:!0,dontCallGetSet:!0},{queueMicrotask:function queueMicrotask(t){validateArgumentsLength(arguments.length,1),aCallable(t);var r=ca&&cS.domain;gm(r?r.bind(t):t)}});var lS=TypeError,dS=Object.defineProperty,uS=i.self!==i;try{if(s){var hS=Object.getOwnPropertyDescriptor(i,"self");!uS&&hS&&hS.get&&hS.enumerable||defineBuiltInAccessor(i,"self",{get:function self(){return i},set:function self(t){if(this!==i)throw lS("Illegal invocation");dS(i,"self",{value:t,writable:!0,configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}else _export({global:!0,simple:!0,forced:uS},{self:i})}catch(t){}var pS,fS=Map.prototype,gS={Map:Map,set:N(fS.set),get:N(fS.get),has:N(fS.has),remove:N(fS.delete),proto:fS},mS=Set.prototype,vS={Set:Set,add:N(mS.add),has:N(mS.has),remove:N(mS.delete),proto:mS},yS=i.structuredClone,bS=!!yS&&!fails((function(){if(vm&&me>92||ca&&me>94||ym&&me>97)return!1;var t=new ArrayBuffer(8),r=yS(t,{transfer:[t]});return 0!=t.byteLength||8!=r.byteLength})),wS=i.Object,CS=i.Array,_S=i.Date,kS=i.Error,SS=i.EvalError,TS=i.RangeError,ES=i.ReferenceError,xS=i.SyntaxError,IS=i.TypeError,AS=i.URIError,PS=i.PerformanceMark,RS=i.WebAssembly,OS=RS&&RS.CompileError||kS,NS=RS&&RS.LinkError||kS,MS=RS&&RS.RuntimeError||kS,DS=getBuiltIn("DOMException"),FS=gS.Map,LS=gS.has,US=gS.get,BS=gS.set,HS=vS.Set,$S=vS.add,qS=getBuiltIn("Object","keys"),jS=N([].push),zS=N((!0).valueOf),GS=N(1..valueOf),VS=N("".valueOf),KS=N(_S.prototype.getTime),WS=uid("structuredClone"),QS="DataCloneError",YS="Transferring",checkBasicSemantic=function(t){return!fails((function(){var r=new i.Set([7]),o=t(r),s=t(wS(7));return o==r||!o.has(7)||"object"!=typeof s||7!=s}))&&t},checkErrorsCloning=function(t,r){return!fails((function(){var o=new r,i=t({a:o,b:o});return!(i&&i.a===i.b&&i.a instanceof r&&i.a.stack===o.stack)}))},JS=i.structuredClone,XS=!checkErrorsCloning(JS,kS)||!checkErrorsCloning(JS,DS)||(pS=JS,!!fails((function(){var t=pS(new i.AggregateError([1],WS,{cause:3}));return"AggregateError"!=t.name||1!=t.errors[0]||t.message!=WS||3!=t.cause}))),ZS=!JS&&checkBasicSemantic((function(t){return new PS(WS,{detail:t}).detail})),eT=checkBasicSemantic(JS)||ZS,throwUncloneable=function(t){throw new DS("Uncloneable type: "+t,QS)},throwUnpolyfillable=function(t,r){throw new DS((r||"Cloning")+" of "+t+" cannot be properly polyfilled in this engine",QS)},structuredCloneInternal=function(t,r){if(Ee(t)&&throwUncloneable("Symbol"),!Z(t))return t;if(r){if(LS(r,t))return US(r,t)}else r=new FS;var o,s,l,u,h,m,v,C,_,k,E,R=Cr(t),N=!1;switch(R){case"Array":l=CS(lengthOfArrayLike(t)),N=!0;break;case"Object":l={},N=!0;break;case"Map":l=new FS,N=!0;break;case"Set":l=new HS,N=!0;break;case"RegExp":l=new RegExp(t.source,regexpGetFlags(t));break;case"Error":switch(s=t.name){case"AggregateError":l=getBuiltIn("AggregateError")([]);break;case"EvalError":l=SS();break;case"RangeError":l=TS();break;case"ReferenceError":l=ES();break;case"SyntaxError":l=xS();break;case"TypeError":l=IS();break;case"URIError":l=AS();break;case"CompileError":l=OS();break;case"LinkError":l=NS();break;case"RuntimeError":l=MS();break;default:l=kS()}N=!0;break;case"DOMException":l=new DS(t.message,t.name),N=!0;break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":o=i[R],Z(o)||throwUnpolyfillable(R),l=new o(structuredCloneInternal(t.buffer,r),t.byteOffset,"DataView"===R?t.byteLength:t.length);break;case"DOMQuad":try{l=new DOMQuad(structuredCloneInternal(t.p1,r),structuredCloneInternal(t.p2,r),structuredCloneInternal(t.p3,r),structuredCloneInternal(t.p4,r))}catch(r){eT?l=eT(t):throwUnpolyfillable(R)}break;case"FileList":if(u=function(){var t;try{t=new i.DataTransfer}catch(r){try{t=new i.ClipboardEvent("").clipboardData}catch(t){}}return t&&t.items&&t.files?t:null}()){for(h=0,m=lengthOfArrayLike(t);h<m;h++)u.items.add(structuredCloneInternal(t[h],r));l=u.files}else eT?l=eT(t):throwUnpolyfillable(R);break;case"ImageData":try{l=new ImageData(structuredCloneInternal(t.data,r),t.width,t.height,{colorSpace:t.colorSpace})}catch(r){eT?l=eT(t):throwUnpolyfillable(R)}break;default:if(eT)l=eT(t);else switch(R){case"BigInt":l=wS(t.valueOf());break;case"Boolean":l=wS(zS(t));break;case"Number":l=wS(GS(t));break;case"String":l=wS(VS(t));break;case"Date":l=new _S(KS(t));break;case"ArrayBuffer":(o=i.DataView)||"function"==typeof t.slice||throwUnpolyfillable(R);try{if("function"!=typeof t.slice||t.resizable){m=t.byteLength,E="maxByteLength"in t?{maxByteLength:t.maxByteLength}:void 0,l=new ArrayBuffer(m,E),_=new o(t),k=new o(l);for(h=0;h<m;h++)k.setUint8(h,_.getUint8(h))}else l=t.slice(0)}catch(t){throw new DS("ArrayBuffer is detached",QS)}break;case"SharedArrayBuffer":l=t;break;case"Blob":try{l=t.slice(0,t.size,t.type)}catch(t){throwUnpolyfillable(R)}break;case"DOMPoint":case"DOMPointReadOnly":o=i[R];try{l=o.fromPoint?o.fromPoint(t):new o(t.x,t.y,t.z,t.w)}catch(t){throwUnpolyfillable(R)}break;case"DOMRect":case"DOMRectReadOnly":o=i[R];try{l=o.fromRect?o.fromRect(t):new o(t.x,t.y,t.width,t.height)}catch(t){throwUnpolyfillable(R)}break;case"DOMMatrix":case"DOMMatrixReadOnly":o=i[R];try{l=o.fromMatrix?o.fromMatrix(t):new o(t)}catch(t){throwUnpolyfillable(R)}break;case"AudioData":case"VideoFrame":W(t.clone)||throwUnpolyfillable(R);try{l=t.clone()}catch(t){throwUncloneable(R)}break;case"File":try{l=new File([t],t.name,t)}catch(t){throwUnpolyfillable(R)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":throwUnpolyfillable(R);default:throwUncloneable(R)}}if(BS(r,t,l),N)switch(R){case"Array":case"Object":for(v=qS(t),h=0,m=lengthOfArrayLike(v);h<m;h++)C=v[h],createProperty(l,C,structuredCloneInternal(t[C],r));break;case"Map":t.forEach((function(t,o){BS(l,structuredCloneInternal(o,r),structuredCloneInternal(t,r))}));break;case"Set":t.forEach((function(t){$S(l,structuredCloneInternal(t,r))}));break;case"Error":Et(l,"message",structuredCloneInternal(t.message,r)),tt(t,"cause")&&Et(l,"cause",structuredCloneInternal(t.cause,r)),"AggregateError"==s&&(l.errors=structuredCloneInternal(t.errors,r));case"DOMException":vn&&Et(l,"stack",structuredCloneInternal(t.stack,r))}return l};_export({global:!0,enumerable:!0,sham:!bS,forced:XS},{structuredClone:function structuredClone(t){var r,o=validateArgumentsLength(arguments.length,1)>1&&!isNullOrUndefined(arguments[1])?anObject(arguments[1]):void 0,s=o?o.transfer:void 0;return void 0!==s&&function(t,r){if(!Z(t))throw IS("Transfer option cannot be converted to a sequence");var o=[];iterate(t,(function(t){jS(o,anObject(t))}));var s,l,u,h,m,v,C=0,_=lengthOfArrayLike(o);if(bS)for(h=JS(o,{transfer:o});C<_;)BS(r,o[C],h[C++]);else for(;C<_;){if(s=o[C++],LS(r,s))throw new DS("Duplicate transferable",QS);switch(l=Cr(s)){case"ImageBitmap":u=i.OffscreenCanvas,Yr(u)||throwUnpolyfillable(l,YS);try{(v=new u(s.width,s.height)).getContext("bitmaprenderer").transferFromImageBitmap(s),m=v.transferToImageBitmap()}catch(t){}break;case"AudioData":case"VideoFrame":W(s.clone)&&W(s.close)||throwUnpolyfillable(l,YS);try{m=s.clone(),s.close()}catch(t){}break;case"ArrayBuffer":W(s.transfer)||throwUnpolyfillable(l,YS),m=s.transfer();break;case"MediaSourceHandle":case"MessagePort":case"OffscreenCanvas":case"ReadableStream":case"TransformStream":case"WritableStream":throwUnpolyfillable(l,YS)}if(void 0===m)throw new DS("This object cannot be transferred: "+l,QS);BS(r,s,m)}}(s,r=new FS),structuredCloneInternal(t,r)}});var tT=schedulersFix(i.setInterval,!0);_export({global:!0,bind:!0,forced:i.setInterval!==tT},{setInterval:tT});var rT=schedulersFix(i.setTimeout,!0);_export({global:!0,bind:!0,forced:i.setTimeout!==rT},{setTimeout:rT});var oT=wellKnownSymbol("iterator"),nT=!fails((function(){var t=new URL("b?a=1&b=2&c=3","http://a"),r=t.searchParams,o="";return t.pathname="c%20d",r.forEach((function(t,i){r.delete("b"),o+=i+t})),!r.size&&!s||!r.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==r.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!r[oT]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://ÑÐµÑÑ").host||"#%D0%B1"!==new URL("http://a#Ð±").hash||"a1c3"!==o||"x"!==new URL("http://x",void 0).host})),iT=2147483647,sT=/[^\0-\u007E]/,aT=/[.\u3002\uFF0E\uFF61]/g,cT="Overflow: input needs wider integers to process",lT=RangeError,dT=N(aT.exec),uT=Math.floor,hT=String.fromCharCode,pT=N("".charCodeAt),fT=N([].join),gT=N([].push),mT=N("".replace),vT=N("".split),yT=N("".toLowerCase),digitToBasic=function(t){return t+22+75*(t<26)},adapt=function(t,r,o){var i=0;for(t=o?uT(t/700):t>>1,t+=uT(t/r);t>455;)t=uT(t/35),i+=36;return uT(i+36*t/(t+38))},encode=function(t){var r=[];t=function(t){for(var r=[],o=0,i=t.length;o<i;){var s=pT(t,o++);if(s>=55296&&s<=56319&&o<i){var l=pT(t,o++);56320==(64512&l)?gT(r,((1023&s)<<10)+(1023&l)+65536):(gT(r,s),o--)}else gT(r,s)}return r}(t);var o,i,s=t.length,l=128,u=0,h=72;for(o=0;o<t.length;o++)(i=t[o])<128&&gT(r,hT(i));var m=r.length,v=m;for(m&&gT(r,"-");v<s;){var C=iT;for(o=0;o<t.length;o++)(i=t[o])>=l&&i<C&&(C=i);var _=v+1;if(C-l>uT((iT-u)/_))throw lT(cT);for(u+=(C-l)*_,l=C,o=0;o<t.length;o++){if((i=t[o])<l&&++u>iT)throw lT(cT);if(i==l){for(var k=u,E=36;;){var R=E<=h?1:E>=h+26?26:E-h;if(k<R)break;var N=k-R,M=36-R;gT(r,hT(digitToBasic(R+N%M))),k=uT(N/M),E+=36}gT(r,hT(digitToBasic(k))),h=adapt(u,_,v==m),u=0,v++}}u++,l++}return fT(r,"")},bT=wellKnownSymbol("iterator"),wT="URLSearchParams",CT=wT+"Iterator",_T=Gt.set,kT=Gt.getterFor(wT),ST=Gt.getterFor(CT),TT=Object.getOwnPropertyDescriptor,safeGetBuiltIn=function(t){if(!s)return i[t];var r=TT(i,t);return r&&r.value},ET=safeGetBuiltIn("fetch"),xT=safeGetBuiltIn("Request"),IT=safeGetBuiltIn("Headers"),AT=xT&&xT.prototype,PT=IT&&IT.prototype,RT=i.RegExp,OT=i.TypeError,NT=i.decodeURIComponent,MT=i.encodeURIComponent,DT=N("".charAt),FT=N([].join),LT=N([].push),UT=N("".replace),BT=N([].shift),HT=N([].splice),$T=N("".split),qT=N("".slice),jT=/\+/g,zT=Array(4),percentSequence=function(t){return zT[t-1]||(zT[t-1]=RT("((?:%[\\da-f]{2}){"+t+"})","gi"))},percentDecode=function(t){try{return NT(t)}catch(r){return t}},deserialize=function(t){var r=UT(t,jT," "),o=4;try{return NT(r)}catch(t){for(;o;)r=UT(r,percentSequence(o--),percentDecode);return r}},GT=/[!'()~]|%20/g,VT={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},replacer=function(t){return VT[t]},serialize=function(t){return UT(MT(t),GT,replacer)},KT=iteratorCreateConstructor((function Iterator(t,r){_T(this,{type:CT,iterator:getIterator(kT(t).entries),kind:r})}),"Iterator",(function next(){var t=ST(this),r=t.kind,o=t.iterator.next(),i=o.value;return o.done||(o.value="keys"===r?i.key:"values"===r?i.value:[i.key,i.value]),o}),!0),URLSearchParamsState=function(t){this.entries=[],this.url=null,void 0!==t&&(Z(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===DT(t,0)?qT(t,1):t:toString_1(t)))};URLSearchParamsState.prototype={type:wT,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var r,o,i,s,l,u,m,v=getIteratorMethod(t);if(v)for(o=(r=getIterator(t,v)).next;!(i=h(o,r)).done;){if(l=(s=getIterator(anObject(i.value))).next,(u=h(l,s)).done||(m=h(l,s)).done||!h(l,s).done)throw OT("Expected sequence with length 2");LT(this.entries,{key:toString_1(u.value),value:toString_1(m.value)})}else for(var C in t)tt(t,C)&&LT(this.entries,{key:C,value:toString_1(t[C])})},parseQuery:function(t){if(t)for(var r,o,i=$T(t,"&"),s=0;s<i.length;)(r=i[s++]).length&&(o=$T(r,"="),LT(this.entries,{key:deserialize(BT(o)),value:deserialize(FT(o,"="))}))},serialize:function(){for(var t,r=this.entries,o=[],i=0;i<r.length;)t=r[i++],LT(o,serialize(t.key)+"="+serialize(t.value));return FT(o,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var WT=function URLSearchParams(){anInstance(this,QT);var t=_T(this,new URLSearchParamsState(arguments.length>0?arguments[0]:void 0));s||(this.length=t.entries.length)},QT=WT.prototype;if(defineBuiltIns(QT,{append:function append(t,r){validateArgumentsLength(arguments.length,2);var o=kT(this);LT(o.entries,{key:toString_1(t),value:toString_1(r)}),s||this.length++,o.updateURL()},delete:function(t){validateArgumentsLength(arguments.length,1);for(var r=kT(this),o=r.entries,i=toString_1(t),l=0;l<o.length;)o[l].key===i?HT(o,l,1):l++;s||(this.length=o.length),r.updateURL()},get:function get(t){validateArgumentsLength(arguments.length,1);for(var r=kT(this).entries,o=toString_1(t),i=0;i<r.length;i++)if(r[i].key===o)return r[i].value;return null},getAll:function getAll(t){validateArgumentsLength(arguments.length,1);for(var r=kT(this).entries,o=toString_1(t),i=[],s=0;s<r.length;s++)r[s].key===o&&LT(i,r[s].value);return i},has:function has(t){validateArgumentsLength(arguments.length,1);for(var r=kT(this).entries,o=toString_1(t),i=0;i<r.length;)if(r[i++].key===o)return!0;return!1},set:function set(t,r){validateArgumentsLength(arguments.length,1);for(var o,i=kT(this),l=i.entries,u=!1,h=toString_1(t),m=toString_1(r),v=0;v<l.length;v++)(o=l[v]).key===h&&(u?HT(l,v--,1):(u=!0,o.value=m));u||LT(l,{key:h,value:m}),s||(this.length=l.length),i.updateURL()},sort:function sort(){var t=kT(this);Wa(t.entries,(function(t,r){return t.key>r.key?1:-1})),t.updateURL()},forEach:function forEach(t){for(var r,o=kT(this).entries,i=functionBindContext(t,arguments.length>1?arguments[1]:void 0),s=0;s<o.length;)i((r=o[s++]).value,r.key,this)},keys:function keys(){return new KT(this,"keys")},values:function values(){return new KT(this,"values")},entries:function entries(){return new KT(this,"entries")}},{enumerable:!0}),defineBuiltIn(QT,bT,QT.entries,{name:"entries"}),defineBuiltIn(QT,"toString",(function toString(){return kT(this).serialize()}),{enumerable:!0}),s&&defineBuiltInAccessor(QT,"size",{get:function size(){return kT(this).entries.length},configurable:!0,enumerable:!0}),setToStringTag(WT,wT),_export({global:!0,constructor:!0,forced:!nT},{URLSearchParams:WT}),!nT&&W(IT)){var YT=N(PT.has),JT=N(PT.set),wrapRequestOptions=function(t){if(Z(t)){var r,o=t.body;if(Cr(o)===wT)return r=t.headers?new IT(t.headers):new IT,YT(r,"content-type")||JT(r,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Pr(t,{body:createPropertyDescriptor(0,toString_1(o)),headers:createPropertyDescriptor(0,r)})}return t};if(W(ET)&&_export({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function fetch(t){return ET(t,arguments.length>1?wrapRequestOptions(arguments[1]):{})}}),W(xT)){var XT=function Request(t){return anInstance(this,AT),new xT(t,arguments.length>1?wrapRequestOptions(arguments[1]):{})};AT.constructor=XT,XT.prototype=AT,_export({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:XT})}}var ZT,eE={URLSearchParams:WT,getState:kT},tE=Ty.codeAt,rE=Gt.set,oE=Gt.getterFor("URL"),nE=eE.URLSearchParams,iE=eE.getState,sE=i.URL,aE=i.TypeError,cE=i.parseInt,lE=Math.floor,dE=Math.pow,uE=N("".charAt),hE=N(/./.exec),pE=N([].join),fE=N(1..toString),gE=N([].pop),mE=N([].push),vE=N("".replace),yE=N([].shift),bE=N("".split),wE=N("".slice),CE=N("".toLowerCase),_E=N([].unshift),kE="Invalid scheme",SE="Invalid host",TE="Invalid port",EE=/[a-z]/i,xE=/[\d+-.a-z]/i,IE=/\d/,AE=/^0x/i,PE=/^[0-7]+$/,RE=/^\d+$/,OE=/^[\da-f]+$/i,NE=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ME=/[\0\t\n\r #/:<>?@[\\\]^|]/,DE=/^[\u0000-\u0020]+/,FE=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,LE=/[\t\n\r]/g,serializeHost=function(t){var r,o,i,s;if("number"==typeof t){for(r=[],o=0;o<4;o++)_E(r,t%256),t=lE(t/256);return pE(r,".")}if("object"==typeof t){for(r="",i=function(t){for(var r=null,o=1,i=null,s=0,l=0;l<8;l++)0!==t[l]?(s>o&&(r=i,o=s),i=null,s=0):(null===i&&(i=l),++s);return s>o&&(r=i,o=s),r}(t),o=0;o<8;o++)s&&0===t[o]||(s&&(s=!1),i===o?(r+=o?":":"::",s=!0):(r+=fE(t[o],16),o<7&&(r+=":")));return"["+r+"]"}return t},UE={},BE=Sf({},UE,{" ":1,'"':1,"<":1,">":1,"`":1}),HE=Sf({},BE,{"#":1,"?":1,"{":1,"}":1}),$E=Sf({},HE,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),percentEncode=function(t,r){var o=tE(t,0);return o>32&&o<127&&!tt(r,t)?t:encodeURIComponent(t)},qE={ftp:21,file:null,http:80,https:443,ws:80,wss:443},isWindowsDriveLetter=function(t,r){var o;return 2==t.length&&hE(EE,uE(t,0))&&(":"==(o=uE(t,1))||!r&&"|"==o)},startsWithWindowsDriveLetter=function(t){var r;return t.length>1&&isWindowsDriveLetter(wE(t,0,2))&&(2==t.length||"/"===(r=uE(t,2))||"\\"===r||"?"===r||"#"===r)},isSingleDot=function(t){return"."===t||"%2e"===CE(t)},jE={},zE={},GE={},VE={},KE={},WE={},QE={},YE={},JE={},XE={},ZE={},ex={},tx={},rx={},ox={},nx={},ix={},sx={},ax={},cx={},lx={},URLState=function(t,r,o){var i,s,l,u=toString_1(t);if(r){if(s=this.parse(u))throw aE(s);this.searchParams=null}else{if(void 0!==o&&(i=new URLState(o,!0)),s=this.parse(u,null,i))throw aE(s);(l=iE(new nE)).bindURL(this),this.searchParams=l}};URLState.prototype={type:"URL",parse:function(t,r,o){var i,s,l,u,h,m=this,v=r||jE,C=0,_="",k=!1,E=!1,R=!1;for(t=toString_1(t),r||(m.scheme="",m.username="",m.password="",m.host=null,m.port=null,m.path=[],m.query=null,m.fragment=null,m.cannotBeABaseURL=!1,t=vE(t,DE,""),t=vE(t,FE,"$1")),t=vE(t,LE,""),i=as(t);C<=i.length;){switch(s=i[C],v){case jE:if(!s||!hE(EE,s)){if(r)return kE;v=GE;continue}_+=CE(s),v=zE;break;case zE:if(s&&(hE(xE,s)||"+"==s||"-"==s||"."==s))_+=CE(s);else{if(":"!=s){if(r)return kE;_="",v=GE,C=0;continue}if(r&&(m.isSpecial()!=tt(qE,_)||"file"==_&&(m.includesCredentials()||null!==m.port)||"file"==m.scheme&&!m.host))return;if(m.scheme=_,r)return void(m.isSpecial()&&qE[m.scheme]==m.port&&(m.port=null));_="","file"==m.scheme?v=rx:m.isSpecial()&&o&&o.scheme==m.scheme?v=VE:m.isSpecial()?v=YE:"/"==i[C+1]?(v=KE,C++):(m.cannotBeABaseURL=!0,mE(m.path,""),v=ax)}break;case GE:if(!o||o.cannotBeABaseURL&&"#"!=s)return kE;if(o.cannotBeABaseURL&&"#"==s){m.scheme=o.scheme,m.path=arraySliceSimple(o.path),m.query=o.query,m.fragment="",m.cannotBeABaseURL=!0,v=lx;break}v="file"==o.scheme?rx:WE;continue;case VE:if("/"!=s||"/"!=i[C+1]){v=WE;continue}v=JE,C++;break;case KE:if("/"==s){v=XE;break}v=sx;continue;case WE:if(m.scheme=o.scheme,s==ZT)m.username=o.username,m.password=o.password,m.host=o.host,m.port=o.port,m.path=arraySliceSimple(o.path),m.query=o.query;else if("/"==s||"\\"==s&&m.isSpecial())v=QE;else if("?"==s)m.username=o.username,m.password=o.password,m.host=o.host,m.port=o.port,m.path=arraySliceSimple(o.path),m.query="",v=cx;else{if("#"!=s){m.username=o.username,m.password=o.password,m.host=o.host,m.port=o.port,m.path=arraySliceSimple(o.path),m.path.length--,v=sx;continue}m.username=o.username,m.password=o.password,m.host=o.host,m.port=o.port,m.path=arraySliceSimple(o.path),m.query=o.query,m.fragment="",v=lx}break;case QE:if(!m.isSpecial()||"/"!=s&&"\\"!=s){if("/"!=s){m.username=o.username,m.password=o.password,m.host=o.host,m.port=o.port,v=sx;continue}v=XE}else v=JE;break;case YE:if(v=JE,"/"!=s||"/"!=uE(_,C+1))continue;C++;break;case JE:if("/"!=s&&"\\"!=s){v=XE;continue}break;case XE:if("@"==s){k&&(_="%40"+_),k=!0,l=as(_);for(var N=0;N<l.length;N++){var M=l[N];if(":"!=M||R){var B=percentEncode(M,$E);R?m.password+=B:m.username+=B}else R=!0}_=""}else if(s==ZT||"/"==s||"?"==s||"#"==s||"\\"==s&&m.isSpecial()){if(k&&""==_)return"Invalid authority";C-=as(_).length+1,_="",v=ZE}else _+=s;break;case ZE:case ex:if(r&&"file"==m.scheme){v=nx;continue}if(":"!=s||E){if(s==ZT||"/"==s||"?"==s||"#"==s||"\\"==s&&m.isSpecial()){if(m.isSpecial()&&""==_)return SE;if(r&&""==_&&(m.includesCredentials()||null!==m.port))return;if(u=m.parseHost(_))return u;if(_="",v=ix,r)return;continue}"["==s?E=!0:"]"==s&&(E=!1),_+=s}else{if(""==_)return SE;if(u=m.parseHost(_))return u;if(_="",v=tx,r==ex)return}break;case tx:if(!hE(IE,s)){if(s==ZT||"/"==s||"?"==s||"#"==s||"\\"==s&&m.isSpecial()||r){if(""!=_){var H=cE(_,10);if(H>65535)return TE;m.port=m.isSpecial()&&H===qE[m.scheme]?null:H,_=""}if(r)return;v=ix;continue}return TE}_+=s;break;case rx:if(m.scheme="file","/"==s||"\\"==s)v=ox;else{if(!o||"file"!=o.scheme){v=sx;continue}if(s==ZT)m.host=o.host,m.path=arraySliceSimple(o.path),m.query=o.query;else if("?"==s)m.host=o.host,m.path=arraySliceSimple(o.path),m.query="",v=cx;else{if("#"!=s){startsWithWindowsDriveLetter(pE(arraySliceSimple(i,C),""))||(m.host=o.host,m.path=arraySliceSimple(o.path),m.shortenPath()),v=sx;continue}m.host=o.host,m.path=arraySliceSimple(o.path),m.query=o.query,m.fragment="",v=lx}}break;case ox:if("/"==s||"\\"==s){v=nx;break}o&&"file"==o.scheme&&!startsWithWindowsDriveLetter(pE(arraySliceSimple(i,C),""))&&(isWindowsDriveLetter(o.path[0],!0)?mE(m.path,o.path[0]):m.host=o.host),v=sx;continue;case nx:if(s==ZT||"/"==s||"\\"==s||"?"==s||"#"==s){if(!r&&isWindowsDriveLetter(_))v=sx;else if(""==_){if(m.host="",r)return;v=ix}else{if(u=m.parseHost(_))return u;if("localhost"==m.host&&(m.host=""),r)return;_="",v=ix}continue}_+=s;break;case ix:if(m.isSpecial()){if(v=sx,"/"!=s&&"\\"!=s)continue}else if(r||"?"!=s)if(r||"#"!=s){if(s!=ZT&&(v=sx,"/"!=s))continue}else m.fragment="",v=lx;else m.query="",v=cx;break;case sx:if(s==ZT||"/"==s||"\\"==s&&m.isSpecial()||!r&&("?"==s||"#"==s)){if(".."===(h=CE(h=_))||"%2e."===h||".%2e"===h||"%2e%2e"===h?(m.shortenPath(),"/"==s||"\\"==s&&m.isSpecial()||mE(m.path,"")):isSingleDot(_)?"/"==s||"\\"==s&&m.isSpecial()||mE(m.path,""):("file"==m.scheme&&!m.path.length&&isWindowsDriveLetter(_)&&(m.host&&(m.host=""),_=uE(_,0)+":"),mE(m.path,_)),_="","file"==m.scheme&&(s==ZT||"?"==s||"#"==s))for(;m.path.length>1&&""===m.path[0];)yE(m.path);"?"==s?(m.query="",v=cx):"#"==s&&(m.fragment="",v=lx)}else _+=percentEncode(s,HE);break;case ax:"?"==s?(m.query="",v=cx):"#"==s?(m.fragment="",v=lx):s!=ZT&&(m.path[0]+=percentEncode(s,UE));break;case cx:r||"#"!=s?s!=ZT&&("'"==s&&m.isSpecial()?m.query+="%27":m.query+="#"==s?"%23":percentEncode(s,UE)):(m.fragment="",v=lx);break;case lx:s!=ZT&&(m.fragment+=percentEncode(s,BE))}C++}},parseHost:function(t){var r,o,i;if("["==uE(t,0)){if("]"!=uE(t,t.length-1))return SE;if(r=function(t){var r,o,i,s,l,u,h,m=[0,0,0,0,0,0,0,0],v=0,C=null,_=0,chr=function(){return uE(t,_)};if(":"==chr()){if(":"!=uE(t,1))return;_+=2,C=++v}for(;chr();){if(8==v)return;if(":"!=chr()){for(r=o=0;o<4&&hE(OE,chr());)r=16*r+cE(chr(),16),_++,o++;if("."==chr()){if(0==o)return;if(_-=o,v>6)return;for(i=0;chr();){if(s=null,i>0){if(!("."==chr()&&i<4))return;_++}if(!hE(IE,chr()))return;for(;hE(IE,chr());){if(l=cE(chr(),10),null===s)s=l;else{if(0==s)return;s=10*s+l}if(s>255)return;_++}m[v]=256*m[v]+s,2!=++i&&4!=i||v++}if(4!=i)return;break}if(":"==chr()){if(_++,!chr())return}else if(chr())return;m[v++]=r}else{if(null!==C)return;_++,C=++v}}if(null!==C)for(u=v-C,v=7;0!=v&&u>0;)h=m[v],m[v--]=m[C+u-1],m[C+--u]=h;else if(8!=v)return;return m}(wE(t,1,-1)),!r)return SE;this.host=r}else if(this.isSpecial()){if(t=function(t){var r,o,i=[],s=vT(mT(yT(t),aT,"."),".");for(r=0;r<s.length;r++)o=s[r],gT(i,dT(sT,o)?"xn--"+encode(o):o);return fT(i,".")}(t),hE(NE,t))return SE;if(r=function(t){var r,o,i,s,l,u,h,m=bE(t,".");if(m.length&&""==m[m.length-1]&&m.length--,(r=m.length)>4)return t;for(o=[],i=0;i<r;i++){if(""==(s=m[i]))return t;if(l=10,s.length>1&&"0"==uE(s,0)&&(l=hE(AE,s)?16:8,s=wE(s,8==l?1:2)),""===s)u=0;else{if(!hE(10==l?RE:8==l?PE:OE,s))return t;u=cE(s,l)}mE(o,u)}for(i=0;i<r;i++)if(u=o[i],i==r-1){if(u>=dE(256,5-r))return null}else if(u>255)return null;for(h=gE(o),i=0;i<o.length;i++)h+=o[i]*dE(256,3-i);return h}(t),null===r)return SE;this.host=r}else{if(hE(ME,t))return SE;for(r="",o=as(t),i=0;i<o.length;i++)r+=percentEncode(o[i],UE);this.host=r}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return tt(qE,this.scheme)},shortenPath:function(){var t=this.path,r=t.length;!r||"file"==this.scheme&&1==r&&isWindowsDriveLetter(t[0],!0)||t.length--},serialize:function(){var t=this,r=t.scheme,o=t.username,i=t.password,s=t.host,l=t.port,u=t.path,h=t.query,m=t.fragment,v=r+":";return null!==s?(v+="//",t.includesCredentials()&&(v+=o+(i?":"+i:"")+"@"),v+=serializeHost(s),null!==l&&(v+=":"+l)):"file"==r&&(v+="//"),v+=t.cannotBeABaseURL?u[0]:u.length?"/"+pE(u,"/"):"",null!==h&&(v+="?"+h),null!==m&&(v+="#"+m),v},setHref:function(t){var r=this.parse(t);if(r)throw aE(r);this.searchParams.update()},getOrigin:function(){var t=this.scheme,r=this.port;if("blob"==t)try{return new dx(t.path[0]).origin}catch(t){return"null"}return"file"!=t&&this.isSpecial()?t+"://"+serializeHost(this.host)+(null!==r?":"+r:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(t){this.parse(toString_1(t)+":",jE)},getUsername:function(){return this.username},setUsername:function(t){var r=as(toString_1(t));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var o=0;o<r.length;o++)this.username+=percentEncode(r[o],$E)}},getPassword:function(){return this.password},setPassword:function(t){var r=as(toString_1(t));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var o=0;o<r.length;o++)this.password+=percentEncode(r[o],$E)}},getHost:function(){var t=this.host,r=this.port;return null===t?"":null===r?serializeHost(t):serializeHost(t)+":"+r},setHost:function(t){this.cannotBeABaseURL||this.parse(t,ZE)},getHostname:function(){var t=this.host;return null===t?"":serializeHost(t)},setHostname:function(t){this.cannotBeABaseURL||this.parse(t,ex)},getPort:function(){var t=this.port;return null===t?"":toString_1(t)},setPort:function(t){this.cannotHaveUsernamePasswordPort()||(""==(t=toString_1(t))?this.port=null:this.parse(t,tx))},getPathname:function(){var t=this.path;return this.cannotBeABaseURL?t[0]:t.length?"/"+pE(t,"/"):""},setPathname:function(t){this.cannotBeABaseURL||(this.path=[],this.parse(t,ix))},getSearch:function(){var t=this.query;return t?"?"+t:""},setSearch:function(t){""==(t=toString_1(t))?this.query=null:("?"==uE(t,0)&&(t=wE(t,1)),this.query="",this.parse(t,cx)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var t=this.fragment;return t?"#"+t:""},setHash:function(t){""!=(t=toString_1(t))?("#"==uE(t,0)&&(t=wE(t,1)),this.fragment="",this.parse(t,lx)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var dx=function URL(t){var r=anInstance(this,ux),o=validateArgumentsLength(arguments.length,1)>1?arguments[1]:void 0,i=rE(r,new URLState(t,!1,o));s||(r.href=i.serialize(),r.origin=i.getOrigin(),r.protocol=i.getProtocol(),r.username=i.getUsername(),r.password=i.getPassword(),r.host=i.getHost(),r.hostname=i.getHostname(),r.port=i.getPort(),r.pathname=i.getPathname(),r.search=i.getSearch(),r.searchParams=i.getSearchParams(),r.hash=i.getHash())},ux=dx.prototype,accessorDescriptor=function(t,r){return{get:function(){return oE(this)[t]()},set:r&&function(t){return oE(this)[r](t)},configurable:!0,enumerable:!0}};if(s&&(defineBuiltInAccessor(ux,"href",accessorDescriptor("serialize","setHref")),defineBuiltInAccessor(ux,"origin",accessorDescriptor("getOrigin")),defineBuiltInAccessor(ux,"protocol",accessorDescriptor("getProtocol","setProtocol")),defineBuiltInAccessor(ux,"username",accessorDescriptor("getUsername","setUsername")),defineBuiltInAccessor(ux,"password",accessorDescriptor("getPassword","setPassword")),defineBuiltInAccessor(ux,"host",accessorDescriptor("getHost","setHost")),defineBuiltInAccessor(ux,"hostname",accessorDescriptor("getHostname","setHostname")),defineBuiltInAccessor(ux,"port",accessorDescriptor("getPort","setPort")),defineBuiltInAccessor(ux,"pathname",accessorDescriptor("getPathname","setPathname")),defineBuiltInAccessor(ux,"search",accessorDescriptor("getSearch","setSearch")),defineBuiltInAccessor(ux,"searchParams",accessorDescriptor("getSearchParams")),defineBuiltInAccessor(ux,"hash",accessorDescriptor("getHash","setHash"))),defineBuiltIn(ux,"toJSON",(function toJSON(){return oE(this).serialize()}),{enumerable:!0}),defineBuiltIn(ux,"toString",(function toString(){return oE(this).serialize()}),{enumerable:!0}),sE){var hx=sE.createObjectURL,px=sE.revokeObjectURL;hx&&defineBuiltIn(dx,"createObjectURL",functionBindContext(hx,sE)),px&&defineBuiltIn(dx,"revokeObjectURL",functionBindContext(px,sE))}setToStringTag(dx,"URL"),_export({global:!0,constructor:!0,forced:!nT,sham:!s},{URL:dx});var fx=getBuiltIn("URL"),gx=nT&&fails((function(){fx.canParse()}));_export({target:"URL",stat:!0,forced:!gx},{canParse:function canParse(t){var r=validateArgumentsLength(arguments.length,1),o=toString_1(t),i=r<2||void 0===arguments[1]?void 0:toString_1(arguments[1]);try{return!!new fx(o,i)}catch(t){return!1}}}),_export({target:"URL",proto:!0,enumerable:!0},{toJSON:function toJSON(){return h(URL.prototype.toString,this)}});var mx=URLSearchParams.prototype,vx=N(mx.forEach);s&&!("size"in mx)&&defineBuiltInAccessor(mx,"size",{get:function size(){var t=0;return vx(this,(function(){t++})),t},configurable:!0,enumerable:!0}),createCommonjsModule((function(t){var r=function(t){var r,o=Object.prototype,i=o.hasOwnProperty,s=Object.defineProperty||function(t,r,o){t[r]=o.value},l="function"==typeof Symbol?Symbol:{},u=l.iterator||"@@iterator",h=l.asyncIterator||"@@asyncIterator",m=l.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function(t,r,o){return t[r]=o}}function wrap(t,r,o,i){var l=r&&r.prototype instanceof Generator?r:Generator,u=Object.create(l.prototype),h=new Context(i||[]);return s(u,"_invoke",{value:makeInvokeMethod(t,o,h)}),u}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var v="suspendedStart",C="suspendedYield",_="executing",k="completed",E={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var R={};define(R,u,(function(){return this}));var N=Object.getPrototypeOf,M=N&&N(N(values([])));M&&M!==o&&i.call(M,u)&&(R=M);var B=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(R);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(o,s,l,u){var h=tryCatch(t[o],t,s);if("throw"!==h.type){var m=h.arg,v=m.value;return v&&"object"==typeof v&&i.call(v,"__await")?r.resolve(v.__await).then((function(t){invoke("next",t,l,u)}),(function(t){invoke("throw",t,l,u)})):r.resolve(v).then((function(t){m.value=t,l(m)}),(function(t){return invoke("throw",t,l,u)}))}u(h.arg)}var o;s(this,"_invoke",{value:function enqueue(t,i){function callInvokeWithMethodAndArg(){return new r((function(r,o){invoke(t,i,r,o)}))}return o=o?o.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i=v;return function invoke(s,l){if(i===_)throw new Error("Generator is already running");if(i===k){if("throw"===s)throw l;return doneResult()}for(o.method=s,o.arg=l;;){var u=o.delegate;if(u){var h=maybeInvokeDelegate(u,o);if(h){if(h===E)continue;return h}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(i===v)throw i=k,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i=_;var m=tryCatch(t,r,o);if("normal"===m.type){if(i=o.done?k:C,m.arg===E)continue;return{value:m.arg,done:o.done}}"throw"===m.type&&(i=k,o.method="throw",o.arg=m.arg)}}}function maybeInvokeDelegate(t,o){var i=o.method,s=t.iterator[i];if(s===r)return o.delegate=null,"throw"===i&&t.iterator.return&&(o.method="return",o.arg=r,maybeInvokeDelegate(t,o),"throw"===o.method)||"return"!==i&&(o.method="throw",o.arg=new TypeError("The iterator does not provide a '"+i+"' method")),E;var l=tryCatch(s,t.iterator,o.arg);if("throw"===l.type)return o.method="throw",o.arg=l.arg,o.delegate=null,E;var u=l.arg;return u?u.done?(o[t.resultName]=u.value,o.next=t.nextLoc,"return"!==o.method&&(o.method="next",o.arg=r),o.delegate=null,E):u:(o.method="throw",o.arg=new TypeError("iterator result is not an object"),o.delegate=null,E)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var o=t[u];if(o)return o.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var s=-1,l=function next(){for(;++s<t.length;)if(i.call(t,s))return next.value=t[s],next.done=!1,next;return next.value=r,next.done=!0,next};return l.next=l}}return{next:doneResult}}function doneResult(){return{value:r,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,s(B,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),s(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,m,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,m,"GeneratorFunction")),t.prototype=Object.create(B),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,h,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,s,l){void 0===l&&(l=Promise);var u=new AsyncIterator(wrap(r,o,i,s),l);return t.isGeneratorFunction(o)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},defineIteratorMethods(B),define(B,m,"Generator"),define(B,u,(function(){return this})),define(B,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(resetTryEntry),!t)for(var o in this)"t"===o.charAt(0)&&i.call(this,o)&&!isNaN(+o.slice(1))&&(this[o]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var o=this;function handle(i,s){return u.type="throw",u.arg=t,o.next=i,s&&(o.method="next",o.arg=r),!!s}for(var s=this.tryEntries.length-1;s>=0;--s){var l=this.tryEntries[s],u=l.completion;if("root"===l.tryLoc)return handle("end");if(l.tryLoc<=this.prev){var h=i.call(l,"catchLoc"),m=i.call(l,"finallyLoc");if(h&&m){if(this.prev<l.catchLoc)return handle(l.catchLoc,!0);if(this.prev<l.finallyLoc)return handle(l.finallyLoc)}else if(h){if(this.prev<l.catchLoc)return handle(l.catchLoc,!0)}else{if(!m)throw new Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return handle(l.finallyLoc)}}}},abrupt:function(t,r){for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o];if(s.tryLoc<=this.prev&&i.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var l=s;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var u=l?l.completion:{};return u.type=t,u.arg=r,l?(this.method="next",this.next=l.finallyLoc,E):this.complete(u)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),E},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),E}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var s=i.arg;resetTryEntry(o)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,o,i){return this.delegate={iterator:values(t),resultName:o,nextLoc:i},"next"===this.method&&(this.arg=r),E}},t}(t.exports);try{regeneratorRuntime=r}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}));var yx="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==yx&&yx,bx={searchParams:"URLSearchParams"in yx,iterable:"Symbol"in yx&&"iterator"in Symbol,blob:"FileReader"in yx&&"Blob"in yx&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in yx,arrayBuffer:"ArrayBuffer"in yx};if(bx.arrayBuffer)var wx=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Cx=ArrayBuffer.isView||function(t){return t&&wx.indexOf(Object.prototype.toString.call(t))>-1};function normalizeName(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function normalizeValue(t){return"string"!=typeof t&&(t=String(t)),t}function iteratorFor(t){var r={next:function(){var r=t.shift();return{done:void 0===r,value:r}}};return bx.iterable&&(r[Symbol.iterator]=function(){return r}),r}function Headers$1(t){this.map={},t instanceof Headers$1?t.forEach((function(t,r){this.append(r,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(r){this.append(r,t[r])}),this)}function consumed(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function fileReaderReady(t){return new Promise((function(r,o){t.onload=function(){r(t.result)},t.onerror=function(){o(t.error)}}))}function readBlobAsArrayBuffer(t){var r=new FileReader,o=fileReaderReady(r);return r.readAsArrayBuffer(t),o}function bufferClone(t){if(t.slice)return t.slice(0);var r=new Uint8Array(t.byteLength);return r.set(new Uint8Array(t)),r.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:bx.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:bx.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:bx.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():bx.arrayBuffer&&bx.blob&&function isDataView(t){return t&&DataView.prototype.isPrototypeOf(t)}(t)?(this._bodyArrayBuffer=bufferClone(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):bx.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||Cx(t))?this._bodyArrayBuffer=bufferClone(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):bx.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},bx.blob&&(this.blob=function(){var t=consumed(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=consumed(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var t=consumed(this);if(t)return t;if(this._bodyBlob)return function readBlobAsText(t){var r=new FileReader,o=fileReaderReady(r);return r.readAsText(t),o}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function readArrayBufferAsText(t){for(var r=new Uint8Array(t),o=new Array(r.length),i=0;i<r.length;i++)o[i]=String.fromCharCode(r[i]);return o.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},bx.formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}Headers$1.prototype.append=function(t,r){t=normalizeName(t),r=normalizeValue(r);var o=this.map[t];this.map[t]=o?o+", "+r:r},Headers$1.prototype.delete=function(t){delete this.map[normalizeName(t)]},Headers$1.prototype.get=function(t){return t=normalizeName(t),this.has(t)?this.map[t]:null},Headers$1.prototype.has=function(t){return this.map.hasOwnProperty(normalizeName(t))},Headers$1.prototype.set=function(t,r){this.map[normalizeName(t)]=normalizeValue(r)},Headers$1.prototype.forEach=function(t,r){for(var o in this.map)this.map.hasOwnProperty(o)&&t.call(r,this.map[o],o,this)},Headers$1.prototype.keys=function(){var t=[];return this.forEach((function(r,o){t.push(o)})),iteratorFor(t)},Headers$1.prototype.values=function(){var t=[];return this.forEach((function(r){t.push(r)})),iteratorFor(t)},Headers$1.prototype.entries=function(){var t=[];return this.forEach((function(r,o){t.push([o,r])})),iteratorFor(t)},bx.iterable&&(Headers$1.prototype[Symbol.iterator]=Headers$1.prototype.entries);var _x=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Request$1(t,r){if(!(this instanceof Request$1))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var o=(r=r||{}).body;if(t instanceof Request$1){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,r.headers||(this.headers=new Headers$1(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,o||null==t._bodyInit||(o=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=r.credentials||this.credentials||"same-origin",!r.headers&&this.headers||(this.headers=new Headers$1(r.headers)),this.method=function normalizeMethod(t){var r=t.toUpperCase();return _x.indexOf(r)>-1?r:t}(r.method||this.method||"GET"),this.mode=r.mode||this.mode||null,this.signal=r.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==r.cache&&"no-cache"!==r.cache)){var i=/([?&])_=[^&]*/;if(i.test(this.url))this.url=this.url.replace(i,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function decode(t){var r=new FormData;return t.trim().split("&").forEach((function(t){if(t){var o=t.split("="),i=o.shift().replace(/\+/g," "),s=o.join("=").replace(/\+/g," ");r.append(decodeURIComponent(i),decodeURIComponent(s))}})),r}function Response(t,r){if(!(this instanceof Response))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');r||(r={}),this.type="default",this.status=void 0===r.status?200:r.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===r.statusText?"":""+r.statusText,this.headers=new Headers$1(r.headers),this.url=r.url||"",this._initBody(t)}Request$1.prototype.clone=function(){return new Request$1(this,{body:this._bodyInit})},Body.call(Request$1.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers$1(this.headers),url:this.url})},Response.error=function(){var t=new Response(null,{status:0,statusText:""});return t.type="error",t};var kx=[301,302,303,307,308];Response.redirect=function(t,r){if(-1===kx.indexOf(r))throw new RangeError("Invalid status code");return new Response(null,{status:r,headers:{location:t}})};var Sx=yx.DOMException;try{new Sx}catch(t){Sx=function(t,r){this.message=t,this.name=r;var o=Error(t);this.stack=o.stack},Sx.prototype=Object.create(Error.prototype),Sx.prototype.constructor=Sx}function fetch$1(t,r){return new Promise((function(o,i){var s=new Request$1(t,r);if(s.signal&&s.signal.aborted)return i(new Sx("Aborted","AbortError"));var l=new XMLHttpRequest;function abortXhr(){l.abort()}l.onload=function(){var t,r,i={status:l.status,statusText:l.statusText,headers:(t=l.getAllResponseHeaders()||"",r=new Headers$1,t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var o=t.split(":"),i=o.shift().trim();if(i){var s=o.join(":").trim();r.append(i,s)}})),r)};i.url="responseURL"in l?l.responseURL:i.headers.get("X-Request-URL");var s="response"in l?l.response:l.responseText;setTimeout((function(){o(new Response(s,i))}),0)},l.onerror=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},l.ontimeout=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},l.onabort=function(){setTimeout((function(){i(new Sx("Aborted","AbortError"))}),0)},l.open(s.method,function fixUrl(t){try{return""===t&&yx.location.href?yx.location.href:t}catch(r){return t}}(s.url),!0),"include"===s.credentials?l.withCredentials=!0:"omit"===s.credentials&&(l.withCredentials=!1),"responseType"in l&&(bx.blob?l.responseType="blob":bx.arrayBuffer&&s.headers.get("Content-Type")&&-1!==s.headers.get("Content-Type").indexOf("application/octet-stream")&&(l.responseType="arraybuffer")),!r||"object"!=typeof r.headers||r.headers instanceof Headers$1?s.headers.forEach((function(t,r){l.setRequestHeader(r,t)})):Object.getOwnPropertyNames(r.headers).forEach((function(t){l.setRequestHeader(t,normalizeValue(r.headers[t]))})),s.signal&&(s.signal.addEventListener("abort",abortXhr),l.onreadystatechange=function(){4===l.readyState&&s.signal.removeEventListener("abort",abortXhr)}),l.send(void 0===s._bodyInit?null:s._bodyInit)}))}fetch$1.polyfill=!0,yx.fetch||(yx.fetch=fetch$1,yx.Headers=Headers$1,yx.Request=Request$1,yx.Response=Response)
/**
@license @nocompile
Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/,function(){var r;function ba(t){var r=0;return function(){return r<t.length?{done:!1,value:t[r++]}:{done:!0}}}var o="function"==typeof Object.defineProperties?Object.defineProperty:function(t,r,o){return t==Array.prototype||t==Object.prototype||(t[r]=o.value),t};var i,s=function da(r){r=["object"==typeof globalThis&&globalThis,r,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof t&&t];for(var o=0;o<r.length;++o){var i=r[o];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);function fa(t,r){if(r)e:{var i=s;t=t.split(".");for(var l=0;l<t.length-1;l++){var u=t[l];if(!(u in i))break e;i=i[u]}(r=r(l=i[t=t[t.length-1]]))!=l&&null!=r&&o(i,t,{configurable:!0,writable:!0,value:r})}}function ja(t){return(t={next:t})[Symbol.iterator]=function(){return this},t}function ka(t){var r="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return r?r.call(t):{next:ba(t)}}function w(t){if(!(t instanceof Array)){t=ka(t);for(var r,o=[];!(r=t.next()).done;)o.push(r.value);t=o}return t}if(fa("Symbol",(function(t){function c(t,r){this.g=t,o(this,"description",{configurable:!0,writable:!0,value:r})}if(t)return t;c.prototype.toString=function(){return this.g};var r=0;return function b(t){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c("jscomp_symbol_"+(t||"")+"_"+r++,t)}})),fa("Symbol.iterator",(function(t){if(t)return t;t=Symbol("Symbol.iterator");for(var r="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),i=0;i<r.length;i++){var l=s[r[i]];"function"==typeof l&&"function"!=typeof l.prototype[t]&&o(l.prototype,t,{configurable:!0,writable:!0,value:function(){return ja(ba(this))}})}return t})),"function"==typeof Object.setPrototypeOf)i=Object.setPrototypeOf;else{var l;e:{var u={};try{u.__proto__={a:!0},l=u.a;break e}catch(ur){}l=!1}i=l?function(t,r){if(t.__proto__=r,t.__proto__!==r)throw new TypeError(t+" is not extensible");return t}:null}var h=i;function ra(){this.u=!1,this.h=null,this.Oa=void 0,this.g=1,this.ea=0,this.i=null}function ua(t){if(t.u)throw new TypeError("Generator is already running");t.u=!0}function wa(t,r){t.i={ab:r,fb:!0},t.g=t.ea}function ya(t,r){return t.g=3,{value:r}}function za(t){this.g=new ra,this.h=t}function Ba(t,r,o,i){try{var s=r.call(t.g.h,o);if(!(s instanceof Object))throw new TypeError("Iterator result "+s+" is not an object");if(!s.done)return t.g.u=!1,s;var l=s.value}catch(r){return t.g.h=null,wa(t.g,r),Ca(t)}return t.g.h=null,i.call(t.g,l),Ca(t)}function Ca(t){for(;t.g.g;)try{var r=t.h(t.g);if(r)return t.g.u=!1,{value:r.value,done:!1}}catch(r){t.g.Oa=void 0,wa(t.g,r)}if(t.g.u=!1,t.g.i){if(r=t.g.i,t.g.i=null,r.fb)throw r.ab;return{value:r.return,done:!0}}return{value:void 0,done:!0}}function Da(t){this.next=function(r){return ua(t.g),t.g.h?r=Ba(t,t.g.h.next,r,t.g.O):(t.g.O(r),r=Ca(t)),r},this.throw=function(r){return ua(t.g),t.g.h?r=Ba(t,t.g.h.throw,r,t.g.O):(wa(t.g,r),r=Ca(t)),r},this.return=function(r){return function Aa(t,r){ua(t.g);var o=t.g.h;return o?Ba(t,"return"in o?o.return:function(t){return{value:t,done:!0}},r,t.g.return):(t.g.return(r),Ca(t))}(t,r)},this[Symbol.iterator]=function(){return this}}function Ea(t,r){return r=new Da(new za(r)),h&&t.prototype&&h(r,t.prototype),r}ra.prototype.O=function(t){this.Oa=t},ra.prototype.return=function(t){this.i={return:t},this.g=this.ea},Array.from||(Array.from=function(t){return[].slice.call(t)}),Object.assign||(Object.assign=function(t){for(var r,o=[].slice.call(arguments,1),i=0;i<o.length;i++)if(r=o[i])for(var s=t,l=Object.keys(r),u=0;u<l.length;u++){var h=l[u];s[h]=r[h]}return t});var m=setTimeout;function Ga(){}function A(t){if(!(this instanceof A))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this.N=0,this.Ha=!1,this.I=void 0,this.ba=[],Ia(t,this)}function Ja(t,r){for(;3===t.N;)t=t.I;0===t.N?t.ba.push(r):(t.Ha=!0,v((function(){var o=1===t.N?r.hb:r.ib;if(null===o)(1===t.N?La:Ma)(r.promise,t.I);else{try{var i=o(t.I)}catch(t){return void Ma(r.promise,t)}La(r.promise,i)}})))}function La(t,r){try{if(r===t)throw new TypeError("A promise cannot be resolved with itself.");if(r&&("object"==typeof r||"function"==typeof r)){var o=r.then;if(r instanceof A)return t.N=3,t.I=r,void Na(t);if("function"==typeof o)return void Ia(function Ha(t,r){return function(){t.apply(r,arguments)}}(o,r),t)}t.N=1,t.I=r,Na(t)}catch(r){Ma(t,r)}}function Ma(t,r){t.N=2,t.I=r,Na(t)}function Na(t){2===t.N&&0===t.ba.length&&v((function(){t.Ha||"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t.I)}));for(var r=0,o=t.ba.length;r<o;r++)Ja(t,t.ba[r]);t.ba=null}function Oa(t,r,o){this.hb="function"==typeof t?t:null,this.ib="function"==typeof r?r:null,this.promise=o}function Ia(t,r){var o=!1;try{t((function(t){o||(o=!0,La(r,t))}),(function(t){o||(o=!0,Ma(r,t))}))}catch(t){o||(o=!0,Ma(r,t))}}function Qa(t){return t&&"object"==typeof t&&t.constructor===A?t:new A((function(r){r(t)}))}A.prototype.catch=function(t){return this.then(null,t)},A.prototype.then=function(t,r){var o=new this.constructor(Ga);return Ja(this,new Oa(t,r,o)),o},A.prototype.finally=function(t){var r=this.constructor;return this.then((function(o){return r.resolve(t()).then((function(){return o}))}),(function(o){return r.resolve(t()).then((function(){return r.reject(o)}))}))};var v="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){m(t,0)};if(!window.Promise){window.Promise=A,A.prototype.then=A.prototype.then,A.all=function Pa(t){return new A((function(r,o){function d(t,l){try{if(l&&("object"==typeof l||"function"==typeof l)){var u=l.then;if("function"==typeof u)return void u.call(l,(function(r){d(t,r)}),o)}i[t]=l,0==--s&&r(i)}catch(t){o(t)}}if(!t||void 0===t.length)return o(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return r([]);for(var s=i.length,l=0;l<i.length;l++)d(l,i[l])}))},A.race=function Sa(t){return new A((function(r,o){if(!t||void 0===t.length)return o(new TypeError("Promise.race accepts an array"));for(var i=0,s=t.length;i<s;i++)Qa(t[i]).then(r,o)}))},A.resolve=Qa,A.reject=function Ra(t){return new A((function(r,o){o(t)}))};var C=document.createTextNode(""),_=[];new MutationObserver((function(){for(var t=_.length,r=0;r<t;r++)_[r]();_.splice(0,t)})).observe(C,{characterData:!0}),v=function(t){_.push(t),C.textContent=0<C.textContent.length?"":"a"}}!function(r,o){if(!(o in r)){var i=typeof t==typeof i?window:t,s=0,l=String(Math.random()),u="__symbol@@"+l,h=r.getOwnPropertyNames,m=r.getOwnPropertyDescriptor,v=r.create,C=r.keys,_=r.freeze||r,k=r.defineProperty,E=r.defineProperties,R=m(r,"getOwnPropertyNames"),N=r.prototype,M=N.hasOwnProperty,B=N.propertyIsEnumerable,H=N.toString,y=function(t,r,o){M.call(t,u)||k(t,u,{enumerable:!1,configurable:!1,writable:!1,value:{}}),t[u]["@@"+r]=o},x=function(){},ta=function(t){return t!=u&&!M.call(q,t)},ia=function(t){return t!=u&&M.call(q,t)},sa=function(t){var r=String(t);return ia(r)?M.call(this,r)&&!!this[u]&&this[u]["@@"+r]:B.call(this,t)},n=function(t){return k(N,t,{enumerable:!1,configurable:!0,get:x,set:function(r){z(this,t,{enumerable:!1,configurable:!0,writable:!0,value:r}),y(this,t,!0)}}),q[t]=k(r(t),"constructor",j),_(q[t])},$=function G(t){if(this instanceof G)throw new TypeError("Symbol is not a constructor");return n("__symbol:".concat(t||"",l,++s))},q=v(null),j={value:$},ib=function(t){return q[t]},Va=function(t,r,o){var i=String(r);if(ia(i)){if(r=z,o.enumerable){var s=v(o);s.enumerable=!1}else s=o;r(t,i,s),y(t,i,!!o.enumerable)}else k(t,r,o);return t},jb=function(t){return h(t).filter(ia).map(ib)};R.value=Va,k(r,"defineProperty",R),R.value=jb,k(r,o,R),R.value=function(t){return h(t).filter(ta)},k(r,"getOwnPropertyNames",R),R.value=function(t,r){var o=jb(r);return o.length?C(r).concat(o).forEach((function(o){sa.call(r,o)&&Va(t,o,r[o])})):E(t,r),t},k(r,"defineProperties",R),R.value=sa,k(N,"propertyIsEnumerable",R),R.value=$,k(i,"Symbol",R),R.value=function(t){return(t="__symbol:".concat("__symbol:",t,l))in N?q[t]:n(t)},k($,"for",R),R.value=function(t){if(ta(t))throw new TypeError(t+" is not a symbol");if(M.call(q,t)&&("__symbol:"===(t=t.slice(10)).slice(0,10)&&(t=t.slice(10))!==l))return 0<(t=t.slice(0,t.length-l.length)).length?t:void 0},k($,"keyFor",R),R.value=function(t,r){var o=m(t,r);return o&&ia(r)&&(o.enumerable=sa.call(t,r)),o},k(r,"getOwnPropertyDescriptor",R),R.value=function(t,r){return 1===arguments.length||void 0===r?v(t):function(t,r){var o=v(t);return h(r).forEach((function(t){sa.call(r,t)&&Va(o,t,r[t])})),o}(t,r)},k(r,"create",R),R.value=function(){var t=H.call(this);return"[object String]"===t&&ia(this)?"[object Symbol]":t},k(N,"toString",R);try{if(!0!==v(k({},"__symbol:",{get:function(){return k(this,"__symbol:",{value:!0})["__symbol:"]}}))["__symbol:"])throw"IE11";var z=k}catch(t){z=function(t,r,o){var i=m(N,r);delete N[r],k(t,r,o),k(N,r,i)}}}}(Object,"getOwnPropertySymbols"),function(t,r){var o,i=t.defineProperty,s=t.prototype,l=s.toString;"iterator match replace search split hasInstance isConcatSpreadable unscopables species toPrimitive toStringTag".split(" ").forEach((function(u){u in r||(i(r,u,{value:r(u)}),"toStringTag"===u&&((o=t.getOwnPropertyDescriptor(s,"toString")).value=function(){var t=l.call(this),o=null==this?this:this[r.toStringTag];return null==o?t:"[object "+o+"]"},i(s,"toString",o)))}))}(Object,Symbol),function(t,r,o){function d(){return this}r[t]||(r[t]=function(){var r=0,o=this,i={next:function(){var t=o.length<=r;return t?{done:t}:{done:t,value:o[r++]}}};return i[t]=d,i}),o[t]||(o[t]=function(){var r=String.fromCodePoint,o=this,i=0,s=o.length,l={next:function(){var t=s<=i,l=t?"":r(o.codePointAt(i));return i+=l.length,t?{done:t}:{done:t,value:l}}};return l[t]=d,l})}(Symbol.iterator,Array.prototype,String.prototype);var k=Object.prototype.toString;Object.prototype.toString=function(){return void 0===this?"[object Undefined]":null===this?"[object Null]":k.call(this)},Object.keys=function(t){return Object.getOwnPropertyNames(t).filter((function(r){return(r=Object.getOwnPropertyDescriptor(t,r))&&r.enumerable}))},String.prototype[Symbol.iterator]&&String.prototype.codePointAt||(String.prototype[Symbol.iterator]=function Xa(){var t,r=this;return Ea(Xa,(function(o){if(1==o.g&&(t=0),3!=o.g)return t<r.length?o=ya(o,r[t]):(o.g=0,o=void 0),o;t++,o.g=2}))}),Set.prototype[Symbol.iterator]||(Set.prototype[Symbol.iterator]=function Ya(){var t,r,o=this;return Ea(Ya,(function(i){if(1==i.g&&(t=[],o.forEach((function(r){t.push(r)})),r=0),3!=i.g)return r<t.length?i=ya(i,t[r]):(i.g=0,i=void 0),i;r++,i.g=2}))}),Map.prototype[Symbol.iterator]||(Map.prototype[Symbol.iterator]=function Za(){var t,r,o=this;return Ea(Za,(function(i){if(1==i.g&&(t=[],o.forEach((function(r,o){t.push([o,r])})),r=0),3!=i.g)return r<t.length?i=ya(i,t[r]):(i.g=0,i=void 0),i;r++,i.g=2}))});var E=document.createEvent("Event");if(E.initEvent("foo",!0,!0),E.preventDefault(),!E.defaultPrevented){var R=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(R.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var N=/Trident/.test(navigator.userAgent);if(!window.Event||N&&"function"!=typeof window.Event){var M=window.Event;if(window.Event=function(t,r){r=r||{};var o=document.createEvent("Event");return o.initEvent(t,!!r.bubbles,!!r.cancelable),o},M){for(var B in M)window.Event[B]=M[B];window.Event.prototype=M.prototype}}if((!window.CustomEvent||N&&"function"!=typeof window.CustomEvent)&&(window.CustomEvent=function(t,r){r=r||{};var o=document.createEvent("CustomEvent");return o.initCustomEvent(t,!!r.bubbles,!!r.cancelable,r.detail),o},window.CustomEvent.prototype=window.Event.prototype),!window.MouseEvent||N&&"function"!=typeof window.MouseEvent){var H=window.MouseEvent;if(window.MouseEvent=function(t,r){r=r||{};var o=document.createEvent("MouseEvent");return o.initMouseEvent(t,!!r.bubbles,!!r.cancelable,r.view||window,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget),o},H)for(var $ in H)window.MouseEvent[$]=H[$];window.MouseEvent.prototype=H.prototype}var q,j=function(){function a(){i++}var t=!1,r=!1,o={get capture(){return t=!0},get once(){return r=!0}},i=0,s=document.createElement("div");s.addEventListener("click",a,o);var l=t&&r;return l&&(s.dispatchEvent(new Event("click")),s.dispatchEvent(new Event("click")),l=1==i),s.removeEventListener("click",a,o),l}(),z=null!==(q=window.EventTarget)&&void 0!==q?q:window.Node;if(!j&&"addEventListener"in z.prototype){var lb=function(t){if(!t||"object"!=typeof t&&"function"!=typeof t){var r=!!t;t=!1}else r=!!t.capture,t=!!t.once;return{capture:r,once:t}},V=z.prototype.addEventListener,K=z.prototype.removeEventListener,W=new WeakMap,X=new WeakMap,sb=function(t,r,o){var i=o?W:X;return void 0===(o=i.get(t))&&i.set(t,o=new Map),void 0===(t=o.get(r))&&o.set(r,t=new WeakMap),t};z.prototype.addEventListener=function(t,r,o){var i=this;if(null!=r){var s=(o=lb(o)).capture;o=o.once;var l=sb(this,t,s);if(!l.has(r)){var u=o?function(o){return l.delete(r),K.call(i,t,u,s),"function"==typeof r?r.call(i,o):"function"==typeof(null==r?void 0:r.handleEvent)?r.handleEvent(o):void 0}:null;l.set(r,u),V.call(this,t,null!=u?u:r,s)}}},z.prototype.removeEventListener=function(t,r,o){if(null!=r){o=lb(o).capture;var i=sb(this,t,o),s=i.get(r);void 0!==s&&(i.delete(r),K.call(this,t,null!=s?s:r,o))}}}Object.getOwnPropertyDescriptor(Node.prototype,"baseURI")||Object.defineProperty(Node.prototype,"baseURI",{get:function(){var t=(this.ownerDocument||this).querySelector("base[href]");return t&&t.href||window.location.href},configurable:!0,enumerable:!0});var Z,re,oe=Element.prototype,ne=null!==(Z=Object.getOwnPropertyDescriptor(oe,"attributes"))&&void 0!==Z?Z:Object.getOwnPropertyDescriptor(Node.prototype,"attributes"),ae=null!==(re=null==ne?void 0:ne.get)&&void 0!==re?re:function(){return this.attributes},le=Array.prototype.map;oe.hasOwnProperty("getAttributeNames")||(oe.getAttributeNames=function(){return le.call(ae.call(this),(function(t){return t.name}))});var de,me=Element.prototype;me.hasOwnProperty("matches")||(me.matches=null!==(de=me.webkitMatchesSelector)&&void 0!==de?de:me.msMatchesSelector);var we=Node.prototype.appendChild;function Cb(t){(t=t.prototype).hasOwnProperty("append")||Object.defineProperty(t,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];for(o=(r=ka(r)).next();!o.done;o=r.next())o=o.value,we.call(this,"string"==typeof o?document.createTextNode(o):o)}})}Cb(Document),Cb(DocumentFragment),Cb(Element);var _e,Te,Ee=Node.prototype.insertBefore,xe=null!==(Te=null===(_e=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild"))||void 0===_e?void 0:_e.get)&&void 0!==Te?Te:function(){return this.firstChild};function Hb(t){(t=t.prototype).hasOwnProperty("prepend")||Object.defineProperty(t,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];o=xe.call(this);for(var i=(r=ka(r)).next();!i.done;i=r.next())i=i.value,Ee.call(this,"string"==typeof i?document.createTextNode(i):i,o)}})}Hb(Document),Hb(DocumentFragment),Hb(Element);var Ie,Fe,He=Node.prototype.appendChild,qe=Node.prototype.removeChild,Ge=null!==(Fe=null===(Ie=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild"))||void 0===Ie?void 0:Ie.get)&&void 0!==Fe?Fe:function(){return this.firstChild};function Nb(t){(t=t.prototype).hasOwnProperty("replaceChildren")||Object.defineProperty(t,"replaceChildren",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];for(;null!==(o=Ge.call(this));)qe.call(this,o);for(o=(r=ka(r)).next();!o.done;o=r.next())o=o.value,He.call(this,"string"==typeof o?document.createTextNode(o):o)}})}Nb(Document),Nb(DocumentFragment),Nb(Element);var Ve,We,et,tt,rt=Node.prototype.insertBefore,ot=null!==(We=null===(Ve=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===Ve?void 0:Ve.get)&&void 0!==We?We:function(){return this.parentNode},nt=null!==(tt=null===(et=Object.getOwnPropertyDescriptor(Node.prototype,"nextSibling"))||void 0===et?void 0:et.get)&&void 0!==tt?tt:function(){return this.nextSibling};function Vb(t){(t=t.prototype).hasOwnProperty("after")||Object.defineProperty(t,"after",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];if(null!==(o=ot.call(this)))for(var i=nt.call(this),s=(r=ka(r)).next();!s.done;s=r.next())s=s.value,rt.call(o,"string"==typeof s?document.createTextNode(s):s,i)}})}Vb(CharacterData),Vb(Element);var it,st,ct=Node.prototype.insertBefore,lt=null!==(st=null===(it=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===it?void 0:it.get)&&void 0!==st?st:function(){return this.parentNode};function $b(t){(t=t.prototype).hasOwnProperty("before")||Object.defineProperty(t,"before",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];if(null!==(o=lt.call(this)))for(var i=(r=ka(r)).next();!i.done;i=r.next())i=i.value,ct.call(o,"string"==typeof i?document.createTextNode(i):i,this)}})}$b(CharacterData),$b(Element);var dt,ut,ht=Node.prototype.removeChild,pt=null!==(ut=null===(dt=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===dt?void 0:dt.get)&&void 0!==ut?ut:function(){return this.parentNode};function ec(t){(t=t.prototype).hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=pt.call(this);t&&ht.call(t,this)}})}ec(CharacterData),ec(Element);var ft,gt,mt=Node.prototype.insertBefore,vt=Node.prototype.removeChild,yt=null!==(gt=null===(ft=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===ft?void 0:ft.get)&&void 0!==gt?gt:function(){return this.parentNode};function lc(t){(t=t.prototype).hasOwnProperty("replaceWith")||Object.defineProperty(t,"replaceWith",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];if(null!==(o=yt.call(this))){for(var i=(r=ka(r)).next();!i.done;i=r.next())i=i.value,mt.call(o,"string"==typeof i?document.createTextNode(i):i,this);vt.call(o,this)}}})}lc(CharacterData),lc(Element);var bt=window.Element.prototype,wt=window.HTMLElement.prototype,Ct=window.SVGElement.prototype;!wt.hasOwnProperty("classList")||bt.hasOwnProperty("classList")||Ct.hasOwnProperty("classList")||Object.defineProperty(bt,"classList",Object.getOwnPropertyDescriptor(wt,"classList"));var _t=Element.prototype,kt=Element.prototype.hasAttribute,St=Element.prototype.setAttribute,Tt=Element.prototype.removeAttribute;_t.hasOwnProperty("toggleAttribute")||(_t.toggleAttribute=function(t,r){return void 0===r?kt.call(this,t)?(Tt.call(this,t),!1):(St.call(this,t,""),!0):r?(kt.call(this,t)||St.call(this,t,""),!0):(Tt.call(this,t),!1)});var Et=document.createElement("style");Et.textContent="body {transition: opacity ease-in 0.2s; } \nbody[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } \n";var xt=document.querySelector("head");xt.insertBefore(Et,xt.firstChild);var It=window;It.WebComponents=It.WebComponents||{flags:{}};var At=document.querySelector('script[src*="webcomponents-bundle"]'),Pt=/wc-(.+)/,Rt={};if(!Rt.noOpts){if(location.search.slice(1).split("&").forEach((function(t){var r;(t=t.split("="))[0]&&(r=t[0].match(Pt))&&(Rt[r[1]]=t[1]||!0)})),At)for(var Ot=0,Nt=void 0;Nt=At.attributes[Ot];Ot++)"src"!==Nt.name&&(Rt[Nt.name]=Nt.value||!0);var Mt={};Rt.log&&Rt.log.split&&Rt.log.split(",").forEach((function(t){Mt[t]=!0})),Rt.log=Mt}It.WebComponents.flags=Rt;var Dt=Rt.shadydom;if(Dt){It.ShadyDOM=It.ShadyDOM||{},It.ShadyDOM.force=Dt;var Ft=Rt.noPatch;It.ShadyDOM.noPatch="true"===Ft||Ft}var Lt=Rt.register||Rt.ce;function Fc(){}function D(t){return t.__shady||(t.__shady=new Fc),t.__shady}function L(t){return t&&t.__shady}Lt&&window.customElements&&(It.customElements.forcePolyfill=Lt),function(){function a(){}function b(t,r){if(!t.childNodes.length)return[];switch(t.nodeType){case Node.DOCUMENT_NODE:return E.call(t,r);case Node.DOCUMENT_FRAGMENT_NODE:return R.call(t,r);default:return k.call(t,r)}}var t="undefined"==typeof HTMLTemplateElement,r=!(document.createDocumentFragment().cloneNode()instanceof DocumentFragment),o=!1;/Trident/.test(navigator.userAgent)&&function(){function p(t,o){if(t instanceof DocumentFragment)for(var i;i=t.firstChild;)r.call(this,i,o);else r.call(this,t,o);return t}o=!0;var t=Node.prototype.cloneNode;Node.prototype.cloneNode=function(r){return r=t.call(this,r),this instanceof DocumentFragment&&(r.__proto__=DocumentFragment.prototype),r},DocumentFragment.prototype.querySelectorAll=HTMLElement.prototype.querySelectorAll,DocumentFragment.prototype.querySelector=HTMLElement.prototype.querySelector,Object.defineProperties(DocumentFragment.prototype,{nodeType:{get:function(){return Node.DOCUMENT_FRAGMENT_NODE},configurable:!0},localName:{get:function(){},configurable:!0},nodeName:{get:function(){return"#document-fragment"},configurable:!0}});var r=Node.prototype.insertBefore;Node.prototype.insertBefore=p;var i=Node.prototype.appendChild;Node.prototype.appendChild=function(t){return t instanceof DocumentFragment?p.call(this,t,null):i.call(this,t),t};var s=Node.prototype.removeChild,l=Node.prototype.replaceChild;Node.prototype.replaceChild=function(t,r){return t instanceof DocumentFragment?(p.call(this,t,r),s.call(this,r)):l.call(this,t,r),r},Document.prototype.createDocumentFragment=function(){var t=this.createElement("df");return t.__proto__=DocumentFragment.prototype,t};var u=Document.prototype.importNode;Document.prototype.importNode=function(t,r){return r=u.call(this,t,r||!1),t instanceof DocumentFragment&&(r.__proto__=DocumentFragment.prototype),r}}();var i=Node.prototype.cloneNode,s=Document.prototype.createElement,l=Document.prototype.importNode,u=Node.prototype.removeChild,h=Node.prototype.appendChild,m=Node.prototype.replaceChild,v=DOMParser.prototype.parseFromString,C=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML")||{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t}},_=Object.getOwnPropertyDescriptor(window.Node.prototype,"childNodes")||{get:function(){return this.childNodes}},k=Element.prototype.querySelectorAll,E=Document.prototype.querySelectorAll,R=DocumentFragment.prototype.querySelectorAll,N=function(){if(!t){var o=document.createElement("template"),i=document.createElement("template");return i.content.appendChild(document.createElement("div")),o.content.appendChild(i),0===(o=o.cloneNode(!0)).content.childNodes.length||0===o.content.firstChild.content.childNodes.length||r}}();if(t){var M=document.implementation.createHTMLDocument("template"),B=!0,H=document.createElement("style");H.textContent="template{display:none;}";var $=document.head;$.insertBefore(H,$.firstElementChild),a.prototype=Object.create(HTMLElement.prototype);var q=!document.createElement("div").hasOwnProperty("innerHTML");a.Z=function(t){if(!t.content&&t.namespaceURI===document.documentElement.namespaceURI){t.content=M.createDocumentFragment();for(var r;r=t.firstChild;)h.call(t.content,r);if(q)t.__proto__=a.prototype;else if(t.cloneNode=function(t){return a.va(this,t)},B)try{n(t),J(t)}catch(t){B=!1}a.bootstrap(t.content)}};var j={option:["select"],thead:["table"],col:["colgroup","table"],tr:["tbody","table"],th:["tr","tbody","table"],td:["tr","tbody","table"]},n=function(t){Object.defineProperty(t,"innerHTML",{get:function(){return xa(this)},set:function(t){var r=j[(/<([a-z][^/\0>\x20\t\r\n\f]+)/i.exec(t)||["",""])[1].toLowerCase()];if(r)for(var o=0;o<r.length;o++)t="<"+r[o]+">"+t+"</"+r[o]+">";for(M.body.innerHTML=t,a.bootstrap(M);this.content.firstChild;)u.call(this.content,this.content.firstChild);if(t=M.body,r)for(o=0;o<r.length;o++)t=t.lastChild;for(;t.firstChild;)h.call(this.content,t.firstChild)},configurable:!0})},J=function(t){Object.defineProperty(t,"outerHTML",{get:function(){return"<template>"+this.innerHTML+"</template>"},set:function(t){if(!this.parentNode)throw Error("Failed to set the 'outerHTML' property on 'Element': This element has no parent node.");for(M.body.innerHTML=t,t=this.ownerDocument.createDocumentFragment();M.body.firstChild;)h.call(t,M.body.firstChild);m.call(this.parentNode,t,this)},configurable:!0})};n(a.prototype),J(a.prototype),a.bootstrap=function(t){for(var r,o=0,i=(t=b(t,"template")).length;o<i&&(r=t[o]);o++)a.Z(r)},document.addEventListener("DOMContentLoaded",(function(){a.bootstrap(document)})),Document.prototype.createElement=function(){var t=s.apply(this,arguments);return"template"===t.localName&&a.Z(t),t},DOMParser.prototype.parseFromString=function(){var t=v.apply(this,arguments);return a.bootstrap(t),t},Object.defineProperty(HTMLElement.prototype,"innerHTML",{get:function(){return xa(this)},set:function(t){C.set.call(this,t),a.bootstrap(this)},configurable:!0,enumerable:!0});var z=/[&\u00A0"]/g,V=/[&\u00A0<>]/g,ib=function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"Â ":return"&nbsp;"}},K=(H=function(t){for(var r={},o=0;o<t.length;o++)r[t[o]]=!0;return r})("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),W=H("style script xmp iframe noembed noframes plaintext noscript".split(" ")),xa=function(t,r){"template"===t.localName&&(t=t.content);for(var o,i="",s=r?r(t):_.get.call(t),l=0,u=s.length;l<u&&(o=s[l]);l++){e:{var h=o,m=t,v=r;switch(h.nodeType){case Node.ELEMENT_NODE:for(var C=h.localName,k="<"+C,E=h.attributes,R=0;m=E[R];R++)k+=" "+m.name+'="'+m.value.replace(z,ib)+'"';k+=">",h=K[C]?k:k+xa(h,v)+"</"+C+">";break e;case Node.TEXT_NODE:h=h.data,h=m&&W[m.localName]?h:h.replace(V,ib);break e;case Node.COMMENT_NODE:h="\x3c!--"+h.data+"--\x3e";break e;default:throw window.console.error(h),Error("not implemented")}}i+=h}return i}}if(t||N){a.va=function(t,r){var o=i.call(t,!1);return this.Z&&this.Z(o),r&&(h.call(o.content,i.call(t.content,!0)),I(o.content,t.content)),o};var I=function(t,r){if(r.querySelectorAll&&0!==(r=b(r,"template")).length)for(var o,i,s=0,l=(t=b(t,"template")).length;s<l;s++)i=r[s],o=t[s],a&&a.Z&&a.Z(i),m.call(o.parentNode,X.call(i,!0),o)},X=Node.prototype.cloneNode=function(t){if(!o&&r&&this instanceof DocumentFragment){if(!t)return this.ownerDocument.createDocumentFragment();var s=Z.call(this.ownerDocument,this,!0)}else s=this.nodeType===Node.ELEMENT_NODE&&"template"===this.localName&&this.namespaceURI==document.documentElement.namespaceURI?a.va(this,t):i.call(this,t);return t&&I(s,this),s},Z=Document.prototype.importNode=function(t,r){if(r=r||!1,"template"===t.localName)return a.va(t,r);var o=l.call(this,t,r);if(r){I(o,t),t=b(o,'script:not([type]),script[type="application/javascript"],script[type="text/javascript"]');for(var i,u=0;u<t.length;u++){i=t[u],(r=s.call(document,"script")).textContent=i.textContent;for(var h,v=i.attributes,C=0;C<v.length;C++)h=v[C],r.setAttribute(h.name,h.value);m.call(i.parentNode,r,i)}}return o}}t&&(window.HTMLTemplateElement=a)}(),Fc.prototype.toJSON=function(){return{}};var Ut=window.ShadyDOM||{};Ut.cb=!(!Element.prototype.attachShadow||!Node.prototype.getRootNode);var Bt,Ht=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild");Ut.D=!!(Ht&&Ht.configurable&&Ht.get),Ut.Ba=Ut.force||!Ut.cb,Ut.J=Ut.noPatch||!1,Ut.ha=Ut.preferPerformance,Ut.Da="on-demand"===Ut.J;var $t=Ut.querySelectorImplementation;function Jc(){return Document.prototype.msElementsFromPoint?"msElementsFromPoint":"elementsFromPoint"}function Lc(t){return(t=L(t))&&void 0!==t.firstChild}function O(t){return t instanceof ShadowRoot}function Mc(t){return(t=(t=L(t))&&t.root)&&Nc(t)}Bt=-1<["native","selectorEngine"].indexOf($t)?$t:void 0,Ut.wb=Bt,Ut.Ra=navigator.userAgent.match("Trident");var qt=Element.prototype,jt=qt.matches||qt.matchesSelector||qt.mozMatchesSelector||qt.msMatchesSelector||qt.oMatchesSelector||qt.webkitMatchesSelector,zt=document.createTextNode(""),Gt=0,Vt=[];function Tc(t){Vt.push(t),zt.textContent=Gt++}new MutationObserver((function(){for(;Vt.length;)try{Vt.shift()()}catch(t){throw zt.textContent=Gt++,t}})).observe(zt,{characterData:!0});var Kt=document.contains?function(t,r){return t.__shady_native_contains(r)}:function(t,r){return t===r||t.documentElement&&t.documentElement.__shady_native_contains(r)};function Vc(t,r){for(;r;){if(r==t)return!0;r=r.__shady_parentNode}return!1}function Wc(t){for(var r=t.length-1;0<=r;r--){var o=t[r],i=o.getAttribute("id")||o.getAttribute("name");i&&"length"!==i&&isNaN(i)&&(t[i]=o)}return t.item=function(r){return t[r]},t.namedItem=function(r){if("length"!==r&&isNaN(r)&&t[r])return t[r];for(var o=ka(t),i=o.next();!i.done;i=o.next())if(((i=i.value).getAttribute("id")||i.getAttribute("name"))==r)return i;return null},t}function Xc(t){var r=[];for(t=t.__shady_native_firstChild;t;t=t.__shady_native_nextSibling)r.push(t);return r}function Yc(t){var r=[];for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling)r.push(t);return r}function Zc(t,r,o){if(o.configurable=!0,o.value)t[r]=o.value;else try{Object.defineProperty(t,r,o)}catch(t){}}function P(t,r,o,i){for(var s in o=void 0===o?"":o,r)i&&0<=i.indexOf(s)||Zc(t,o+s,r[s])}function $c(t,r){for(var o in r)o in t&&Zc(t,o,r[o])}function Q(t){var r={};return Object.getOwnPropertyNames(t).forEach((function(o){r[o]=Object.getOwnPropertyDescriptor(t,o)})),r}function ad(t,r){for(var o,i=Object.getOwnPropertyNames(r),s=0;s<i.length;s++)t[o=i[s]]=r[o]}function bd(t){return t instanceof Node?t:document.createTextNode(""+t)}function cd(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];if(1===r.length)return bd(r[0]);o=document.createDocumentFragment();for(var i=(r=ka(r)).next();!i.done;i=r.next())o.appendChild(bd(i.value));return o}function dd(t){var r;for(r=void 0===r?1:r;0<r;r--)t=t.reduce((function(t,r){return Array.isArray(r)?t.push.apply(t,w(r)):t.push(r),t}),[]);return t}var Wt,Qt=[];function hd(t){Wt||(Wt=!0,Tc(id)),Qt.push(t)}function id(){Wt=!1;for(var t=!!Qt.length;Qt.length;)Qt.shift()();return t}function jd(){this.g=!1,this.addedNodes=[],this.removedNodes=[],this.qa=new Set}id.list=Qt,jd.prototype.flush=function(){if(this.g){this.g=!1;var t=this.takeRecords();t.length&&this.qa.forEach((function(r){r(t)}))}},jd.prototype.takeRecords=function(){if(this.addedNodes.length||this.removedNodes.length){var t=[{addedNodes:this.addedNodes,removedNodes:this.removedNodes}];return this.addedNodes=[],this.removedNodes=[],t}return[]};var Yt=/[&\u00A0"]/g,Jt=/[&\u00A0<>]/g;function qd(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"Â ":return"&nbsp;"}}function rd(t){for(var r={},o=0;o<t.length;o++)r[t[o]]=!0;return r}var Xt=rd("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),Zt=rd("style script xmp iframe noembed noframes plaintext noscript".split(" "));function ud(t,r){"template"===t.localName&&(t=t.content);for(var o="",i=r?r(t):t.childNodes,s=0,l=i.length,u=void 0;s<l&&(u=i[s]);s++){e:{var h=u,m=t,v=r;switch(h.nodeType){case Node.ELEMENT_NODE:for(var C,_="<"+(m=h.localName),k=h.attributes,E=0;C=k[E];E++)_+=" "+C.name+'="'+C.value.replace(Yt,qd)+'"';_+=">",h=Xt[m]?_:_+ud(h,v)+"</"+m+">";break e;case Node.TEXT_NODE:h=h.data,h=m&&Zt[m.localName]?h:h.replace(Jt,qd);break e;case Node.COMMENT_NODE:h="\x3c!--"+h.data+"--\x3e";break e;default:throw window.console.error(h),Error("not implemented")}}o+=h}return o}var er=Ut.D,tr={querySelector:function(t){return this.__shady_native_querySelector(t)},querySelectorAll:function(t){return this.__shady_native_querySelectorAll(t)}},rr={};function yd(t){rr[t]=function(r){return r["__shady_native_"+t]}}function zd(t,r){for(var o in P(t,r,"__shady_native_"),r)yd(o)}function S(t,r){r=void 0===r?[]:r;for(var o=0;o<r.length;o++){var i=r[o],s=Object.getOwnPropertyDescriptor(t,i);s&&(Object.defineProperty(t,"__shady_native_"+i,s),s.value?tr[i]||(tr[i]=s.value):yd(i))}}var or=document.createTreeWalker(document,NodeFilter.SHOW_ALL,null,!1),nr=document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT,null,!1),ir=document.implementation.createHTMLDocument("inert");function Dd(t){for(var r;r=t.__shady_native_firstChild;)t.__shady_native_removeChild(r)}var sr=["firstElementChild","lastElementChild","children","childElementCount"],ar=["querySelector","querySelectorAll","append","prepend","replaceChildren"];var cr=Q({get childNodes(){return this.__shady_childNodes},get firstChild(){return this.__shady_firstChild},get lastChild(){return this.__shady_lastChild},get childElementCount(){return this.__shady_childElementCount},get children(){return this.__shady_children},get firstElementChild(){return this.__shady_firstElementChild},get lastElementChild(){return this.__shady_lastElementChild},get shadowRoot(){return this.__shady_shadowRoot}}),lr=Q({get textContent(){return this.__shady_textContent},set textContent(t){this.__shady_textContent=t},get innerHTML(){return this.__shady_innerHTML},set innerHTML(t){this.__shady_innerHTML=t}}),dr=Q({get parentElement(){return this.__shady_parentElement},get parentNode(){return this.__shady_parentNode},get nextSibling(){return this.__shady_nextSibling},get previousSibling(){return this.__shady_previousSibling},get nextElementSibling(){return this.__shady_nextElementSibling},get previousElementSibling(){return this.__shady_previousElementSibling},get className(){return this.__shady_className},set className(t){this.__shady_className=t}});function Kd(t){for(var r in t){var o=t[r];o&&(o.enumerable=!1)}}Kd(cr),Kd(lr),Kd(dr);var ur,hr=Ut.D||!0===Ut.J,pr=hr?function(){}:function(t){var r=D(t);r.Ta||(r.Ta=!0,$c(t,dr))},fr=hr?function(){}:function(t){var r=D(t);r.Sa||(r.Sa=!0,$c(t,cr),window.customElements&&window.customElements.polyfillWrapFlushCallback&&!Ut.J||$c(t,lr))},gr="__eventWrappers"+Date.now(),mr=(ur=Object.getOwnPropertyDescriptor(Event.prototype,"composed"))?function(t){return ur.get.call(t)}:null,vr=function(){function a(){}var t=!1,r={get capture(){return t=!0,!1}};return window.addEventListener("test",a,r),window.removeEventListener("test",a,r),t}();function Rd(t){if(null===t||"object"!=typeof t&&"function"!=typeof t)var r=!!t,o=!1;else{r=!!t.capture,o=!!t.once;var i=t.U}return{Pa:i,capture:r,once:o,Na:vr?t:r}}var yr={blur:!0,focus:!0,focusin:!0,focusout:!0,click:!0,dblclick:!0,mousedown:!0,mouseenter:!0,mouseleave:!0,mousemove:!0,mouseout:!0,mouseover:!0,mouseup:!0,wheel:!0,beforeinput:!0,input:!0,keydown:!0,keyup:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,touchstart:!0,touchend:!0,touchmove:!0,touchcancel:!0,pointerover:!0,pointerenter:!0,pointerdown:!0,pointermove:!0,pointerup:!0,pointercancel:!0,pointerout:!0,pointerleave:!0,gotpointercapture:!0,lostpointercapture:!0,dragstart:!0,drag:!0,dragenter:!0,dragleave:!0,dragover:!0,drop:!0,dragend:!0,DOMActivate:!0,DOMFocusIn:!0,DOMFocusOut:!0,keypress:!0},br={DOMAttrModified:!0,DOMAttributeNameChanged:!0,DOMCharacterDataModified:!0,DOMElementNameChanged:!0,DOMNodeInserted:!0,DOMNodeInsertedIntoDocument:!0,DOMNodeRemoved:!0,DOMNodeRemovedFromDocument:!0,DOMSubtreeModified:!0};function Ud(t){return t instanceof Node?t.__shady_getRootNode():t}function Vd(t,r){var o=[],i=t;for(t=Ud(t);i;)o.push(i),i=i.__shady_assignedSlot?i.__shady_assignedSlot:i.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&i.host&&(r||i!==t)?i.host:i.__shady_parentNode;return o[o.length-1]===document&&o.push(window),o}function Xd(t,r){if(!O)return t;t=Vd(t,!0);for(var o,i,s=0,l=void 0,u=void 0;s<r.length;s++)if((i=Ud(o=r[s]))!==l&&(u=t.indexOf(i),l=i),!O(i)||-1<u)return o}var wr={get composed(){return void 0===this.__composed&&(mr?this.__composed="focusin"===this.type||"focusout"===this.type||mr(this):!1!==this.isTrusted&&(this.__composed=yr[this.type])),this.__composed||!1},composedPath:function(){return this.__composedPath||(this.__composedPath=Vd(this.__target,this.composed)),this.__composedPath},get target(){return Xd(this.currentTarget||this.__previousCurrentTarget,this.composedPath())},get relatedTarget(){return this.__relatedTarget?(this.__relatedTargetComposedPath||(this.__relatedTargetComposedPath=Vd(this.__relatedTarget,!0)),Xd(this.currentTarget||this.__previousCurrentTarget,this.__relatedTargetComposedPath)):null},stopPropagation:function(){Event.prototype.stopPropagation.call(this),this.ua=!0},stopImmediatePropagation:function(){Event.prototype.stopImmediatePropagation.call(this),this.ua=this.__immediatePropagationStopped=!0}},Cr=Ut.D&&Object.getOwnPropertyDescriptor(Event.prototype,"eventPhase");function $d(t){function b(r,o){return(r=new t(r,o)).__composed=o&&!!o.composed,r}return b.__proto__=t,b.prototype=t.prototype,b}Cr&&(Object.defineProperty(wr,"eventPhase",{get:function(){return this.currentTarget===this.target?Event.AT_TARGET:this.__shady_native_eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(wr,"__shady_native_eventPhase",Cr));var _r={focus:!0,blur:!0};function be(t){return t.__target!==t.target||t.__relatedTarget!==t.relatedTarget}function ce(t,r,o){if(o=r.__handlers&&r.__handlers[t.type]&&r.__handlers[t.type][o])for(var i,s=0;(i=o[s])&&(!be(t)||t.target!==t.relatedTarget)&&(i.call(r,t),!t.__immediatePropagationStopped);s++);}var kr=new Event("e").hasOwnProperty("currentTarget");function ee(t){var r=(t=kr?Object.create(t):t).composedPath(),o=r.map((function(t){return Xd(t,r)})),i=t.bubbles,s=Object.getOwnPropertyDescriptor(t,"currentTarget");Object.defineProperty(t,"currentTarget",{configurable:!0,enumerable:!0,get:function(){return m}});var l=Event.CAPTURING_PHASE,u=Object.getOwnPropertyDescriptor(t,"eventPhase");Object.defineProperty(t,"eventPhase",{configurable:!0,enumerable:!0,get:function(){return l}});try{for(var h=r.length-1;0<=h;h--){var m=r[h];if(l=m===o[h]?Event.AT_TARGET:Event.CAPTURING_PHASE,ce(t,m,"capture"),t.ua)return}for(h=0;h<r.length;h++){var v=(m=r[h])===o[h];if((v||i)&&(l=v?Event.AT_TARGET:Event.BUBBLING_PHASE,ce(t,m,"bubble"),t.ua))break}}finally{kr||(s?Object.defineProperty(t,"currentTarget",s):delete t.currentTarget,u?Object.defineProperty(t,"eventPhase",u):delete t.eventPhase)}}function fe(t,r,o,i){for(var s=0;s<t.length;s++){var l=t[s],u=l.type,h=l.capture;if(r===l.node&&o===u&&i===h)return s}return-1}function ge(t){return id(),!Ut.ha&&this instanceof Node&&!Kt(document,this)?(t.__target||he(t,this),ee(t)):this.__shady_native_dispatchEvent(t)}function ie(t,r,o){var i=this,s=Rd(o),l=s.capture,u=s.once,h=s.Pa;if(s=s.Na,r){var m=typeof r;if(("function"===m||"object"===m)&&("object"!==m||r.handleEvent&&"function"==typeof r.handleEvent)){if(br[t])return this.__shady_native_addEventListener(t,r,s);var v=h||this;if(h=r[gr]){if(-1<fe(h,v,t,l))return}else r[gr]=[];h=function(s){if(u&&i.__shady_removeEventListener(t,r,o),s.__target||he(s),v!==i){var h=Object.getOwnPropertyDescriptor(s,"currentTarget");Object.defineProperty(s,"currentTarget",{get:function(){return v},configurable:!0});var C=Object.getOwnPropertyDescriptor(s,"eventPhase");Object.defineProperty(s,"eventPhase",{configurable:!0,enumerable:!0,get:function(){return l?Event.CAPTURING_PHASE:Event.BUBBLING_PHASE}})}if(s.__previousCurrentTarget=s.currentTarget,(!O(v)&&"slot"!==v.localName||-1!=s.composedPath().indexOf(v))&&(s.composed||-1<s.composedPath().indexOf(v)))if(be(s)&&s.target===s.relatedTarget)s.eventPhase===Event.BUBBLING_PHASE&&s.stopImmediatePropagation();else if(s.eventPhase===Event.CAPTURING_PHASE||s.bubbles||s.target===v||v instanceof Window){var _="function"===m?r.call(v,s):r.handleEvent&&r.handleEvent(s);return v!==i&&(h?(Object.defineProperty(s,"currentTarget",h),h=null):delete s.currentTarget,C?(Object.defineProperty(s,"eventPhase",C),C=null):delete s.eventPhase),_}},r[gr].push({node:v,type:t,capture:l,ub:h}),this.__handlers=this.__handlers||{},this.__handlers[t]=this.__handlers[t]||{capture:[],bubble:[]},this.__handlers[t][l?"capture":"bubble"].push(h),_r[t]||this.__shady_native_addEventListener(t,h,s)}}}function je(t,r,o){if(r){var i=Rd(o);o=i.capture;var s=i.Pa;if(i=i.Na,br[t])return this.__shady_native_removeEventListener(t,r,i);var l=s||this;s=void 0;var u=null;try{u=r[gr]}catch(t){}u&&(-1<(l=fe(u,l,t,o))&&(s=u.splice(l,1)[0].ub,u.length||(r[gr]=void 0))),this.__shady_native_removeEventListener(t,s||r,i),s&&this.__handlers&&this.__handlers[t]&&(-1<(r=(t=this.__handlers[t][o?"capture":"bubble"]).indexOf(s))&&t.splice(r,1))}}var Sr=Q(wr);function he(t,r){if(r=void 0===r?t.target:r,t.__target=r,t.__relatedTarget=t.relatedTarget,Ut.D){if(!(r=Object.getPrototypeOf(t)).hasOwnProperty("__shady_patchedProto")){var o=Object.create(r);o.__shady_sourceProto=r,P(o,Sr),r.__shady_patchedProto=o}t.__proto__=r.__shady_patchedProto}else P(t,Sr)}var Tr=$d(Event),Er=$d(CustomEvent),xr=$d(MouseEvent);var Ir=Object.getOwnPropertyNames(Element.prototype).filter((function(t){return"on"===t.substring(0,2)})),Ar=Object.getOwnPropertyNames(HTMLElement.prototype).filter((function(t){return"on"===t.substring(0,2)}));function se(t){return{set:function(r){var o=D(this),i=t.substring(2);o.T||(o.T={}),o.T[t]&&this.removeEventListener(i,o.T[t]),this.__shady_addEventListener(i,r),o.T[t]=r},get:function(){var r=L(this);return r&&r.T&&r.T[t]},configurable:!0}}function te(t,r){return{index:t,ia:[],pa:r}}function ue(t,r,o,i){var s=0,l=0,u=0,h=0,m=Math.min(r-s,i-l);if(0==s&&0==l)e:{for(u=0;u<m;u++)if(t[u]!==o[u])break e;u=m}if(r==t.length&&i==o.length){h=t.length;for(var v=o.length,C=0;C<m-u&&ve(t[--h],o[--v]);)C++;h=C}if(l+=u,i-=h,0==(r-=h)-(s+=u)&&0==i-l)return[];if(s==r){for(r=te(s,0);l<i;)r.ia.push(o[l++]);return[r]}if(l==i)return[te(s,r-s)];for(i=i-(u=l)+1,h=r-(m=s)+1,r=Array(i),v=0;v<i;v++)r[v]=Array(h),r[v][0]=v;for(v=0;v<h;v++)r[0][v]=v;for(v=1;v<i;v++)for(C=1;C<h;C++)if(t[m+C-1]===o[u+v-1])r[v][C]=r[v-1][C-1];else{var _=r[v-1][C]+1,k=r[v][C-1]+1;r[v][C]=_<k?_:k}for(m=r.length-1,u=r[0].length-1,i=r[m][u],t=[];0<m||0<u;)0==m?(t.push(2),u--):0==u?(t.push(3),m--):(h=r[m-1][u-1],(_=(v=r[m-1][u])<(C=r[m][u-1])?v<h?v:h:C<h?C:h)==h?(h==i?t.push(0):(t.push(1),i=h),m--,u--):_==v?(t.push(3),m--,i=v):(t.push(2),u--,i=C));for(t.reverse(),r=void 0,m=[],u=0;u<t.length;u++)switch(t[u]){case 0:r&&(m.push(r),r=void 0),s++,l++;break;case 1:r||(r=te(s,0)),r.pa++,s++,r.ia.push(o[l]),l++;break;case 2:r||(r=te(s,0)),r.pa++,s++;break;case 3:r||(r=te(s,0)),r.ia.push(o[l]),l++}return r&&m.push(r),m}function ve(t,r){return t===r}var Pr=Q({dispatchEvent:ge,addEventListener:ie,removeEventListener:je}),Rr=null;function ye(){return Rr||(Rr=window.ShadyCSS&&window.ShadyCSS.ScopingShim),Rr||null}function ze(t,r,o){var i=ye();return!(!i||"class"!==r)&&(i.setElementClass(t,o),!0)}function Ae(t,r){var o=ye();o&&o.unscopeNode(t,r)}function Be(t,r){var o=ye();if(!o)return!0;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){for(o=!0,t=t.__shady_firstChild;t;t=t.__shady_nextSibling)o=o&&Be(t,r);return o}return t.nodeType!==Node.ELEMENT_NODE||o.currentScopeForNode(t)===r}function Ce(t){if(t.nodeType!==Node.ELEMENT_NODE)return"";var r=ye();return r?r.currentScopeForNode(t):""}function De(t,r){if(t)for(t.nodeType===Node.ELEMENT_NODE&&r(t),t=t.__shady_firstChild;t;t=t.__shady_nextSibling)t.nodeType===Node.ELEMENT_NODE&&De(t,r)}var Or=window.document,Nr=Ut.ha,Mr=Object.getOwnPropertyDescriptor(Node.prototype,"isConnected"),Dr=Mr&&Mr.get;function Je(t){for(var r;r=t.__shady_firstChild;)t.__shady_removeChild(r)}function Ke(t){var r=L(t);if(r&&void 0!==r.ta)for(r=t.__shady_firstChild;r;r=r.__shady_nextSibling)Ke(r);(t=L(t))&&(t.ta=void 0)}function Le(t){var r=t;if(t&&"slot"===t.localName){var o=L(t);(o=o&&o.aa)&&(r=o.length?o[0]:Le(t.__shady_nextSibling))}return r}function Me(t,r,o){if(t=(t=L(t))&&t.ga){if(r)if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(var i=0,s=r.childNodes.length;i<s;i++)t.addedNodes.push(r.childNodes[i]);else t.addedNodes.push(r);o&&t.removedNodes.push(o),function kd(t){t.g||(t.g=!0,Tc((function(){t.flush()})))}(t)}}var Fr=Q({get parentNode(){var t=L(this);return void 0!==(t=t&&t.parentNode)?t:this.__shady_native_parentNode},get firstChild(){var t=L(this);return void 0!==(t=t&&t.firstChild)?t:this.__shady_native_firstChild},get lastChild(){var t=L(this);return void 0!==(t=t&&t.lastChild)?t:this.__shady_native_lastChild},get nextSibling(){var t=L(this);return void 0!==(t=t&&t.nextSibling)?t:this.__shady_native_nextSibling},get previousSibling(){var t=L(this);return void 0!==(t=t&&t.previousSibling)?t:this.__shady_native_previousSibling},get childNodes(){if(Lc(this)){var t=L(this);if(!t.childNodes){t.childNodes=[];for(var r=this.__shady_firstChild;r;r=r.__shady_nextSibling)t.childNodes.push(r)}var o=t.childNodes}else o=this.__shady_native_childNodes;return o.item=function(t){return o[t]},o},get parentElement(){var t=L(this);return(t=t&&t.parentNode)&&t.nodeType!==Node.ELEMENT_NODE&&(t=null),void 0!==t?t:this.__shady_native_parentElement},get isConnected(){if(Dr&&Dr.call(this))return!0;if(this.nodeType==Node.DOCUMENT_FRAGMENT_NODE)return!1;var t=this.ownerDocument;if(null===t||Kt(t,this))return!0;for(t=this;t&&!(t instanceof Document);)t=t.__shady_parentNode||(O(t)?t.host:void 0);return!!(t&&t instanceof Document)},get textContent(){if(Lc(this)){for(var t=[],r=this.__shady_firstChild;r;r=r.__shady_nextSibling)r.nodeType!==Node.COMMENT_NODE&&t.push(r.__shady_textContent);return t.join("")}return this.__shady_native_textContent},set textContent(t){switch(null==t&&(t=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:if(!Lc(this)&&Ut.D){var r=this.__shady_firstChild;(r!=this.__shady_lastChild||r&&r.nodeType!=Node.TEXT_NODE)&&Je(this),this.__shady_native_textContent=t}else Je(this),(0<t.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_insertBefore(document.createTextNode(t));break;default:this.nodeValue=t}},insertBefore:function(t,r){if(this.ownerDocument!==Or&&t.ownerDocument!==Or)return this.__shady_native_insertBefore(t,r),t;if(t===this)throw Error("Failed to execute 'appendChild' on 'Node': The new child element contains the parent.");if(r){var o=L(r);if(void 0!==(o=o&&o.parentNode)&&o!==this||void 0===o&&r.__shady_native_parentNode!==this)throw Error("Failed to execute 'insertBefore' on 'Node': The node before which the new node is to be inserted is not a child of this node.")}if(r===t)return t;Me(this,t);var i=[],s=(o=Ne(this))?o.host.localName:Ce(this),l=t.__shady_parentNode;if(l){var u=Ce(t),h=!!o||!Ne(t)||Nr&&void 0!==this.__noInsertionPoint;l.__shady_removeChild(t,h)}l=!0;var m=(!Nr||void 0===t.__noInsertionPoint&&void 0===this.__noInsertionPoint)&&!Be(t,s),v=o&&!t.__noInsertionPoint&&(!Nr||t.nodeType===Node.DOCUMENT_FRAGMENT_NODE);return(v||m)&&(m&&(u=u||Ce(t)),De(t,(function(t){if(v&&"slot"===t.localName&&i.push(t),m){var r=u;ye()&&(r&&Ae(t,r),(r=ye())&&r.scopeNode(t,s))}}))),i.length&&(Oe(o),o.i.push.apply(o.i,w(i)),Pe(o)),Lc(this)&&(function Qe(t,r,o){Nf(r,2);var i=D(r);if(void 0!==i.firstChild&&(i.childNodes=null),t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(t=t.__shady_native_firstChild;t;t=t.__shady_native_nextSibling)Of(t,r,i,o);else Of(t,r,i,o)}(t,this,r),(h=L(this)).root?(l=!1,Mc(this)&&Pe(h.root)):o&&"slot"===this.localName&&(l=!1,Pe(o))),l?(o=O(this)?this.host:this,r?(r=Le(r),o.__shady_native_insertBefore(t,r)):o.__shady_native_appendChild(t)):t.ownerDocument!==this.ownerDocument&&this.ownerDocument.adoptNode(t),t},appendChild:function(t){if(this!=t||!O(t))return this.__shady_insertBefore(t)},removeChild:function(t,r){if(r=void 0!==r&&r,this.ownerDocument!==Or)return this.__shady_native_removeChild(t);if(t.__shady_parentNode!==this)throw Error("The node to be removed is not a child of this node: "+t);Me(this,null,t);var o=Ne(t),i=o&&function Re(t,r){if(t.g){kf(t);var o,i=t.h;for(o in i)for(var s=i[o],l=0;l<s.length;l++){var u=s[l];if(Vc(r,u)){s.splice(l,1);var h=t.g.indexOf(u);if(0<=h&&(t.g.splice(h,1),(h=L(u.__shady_parentNode))&&h.ka&&h.ka--),l--,h=(u=L(u)).aa)for(var m=0;m<h.length;m++){var v=h[m],C=v.__shady_native_parentNode;C&&C.__shady_native_removeChild(v)}u.aa=[],u.assignedNodes=[],h=!0}}return h}}(o,t),s=L(this);if(Lc(this)&&(function Se(t,r){var o=D(t);r=D(r),t===r.firstChild&&(r.firstChild=o.nextSibling),t===r.lastChild&&(r.lastChild=o.previousSibling),t=o.previousSibling;var i=o.nextSibling;t&&(D(t).nextSibling=i),i&&(D(i).previousSibling=t),o.parentNode=o.previousSibling=o.nextSibling=void 0,void 0!==r.childNodes&&(r.childNodes=null)}(t,this),Mc(this))){Pe(s.root);var l=!0}if(ye()&&!r&&o&&t.nodeType!==Node.TEXT_NODE){var u=Ce(t);De(t,(function(t){Ae(t,u)}))}return Ke(t),o&&((r="slot"===this.localName)&&(l=!0),(i||r)&&Pe(o)),l||(l=O(this)?this.host:this,(!s.root&&"slot"!==t.localName||l===t.__shady_native_parentNode)&&l.__shady_native_removeChild(t)),t},replaceChild:function(t,r){return this.__shady_insertBefore(t,r),this.__shady_removeChild(r),t},cloneNode:function(t){if("template"==this.localName)return this.__shady_native_cloneNode(t);var r=this.__shady_native_cloneNode(!1);if(t&&r.nodeType!==Node.ATTRIBUTE_NODE){t=this.__shady_firstChild;for(var o;t;t=t.__shady_nextSibling)o=t.__shady_cloneNode(!0),r.__shady_appendChild(o)}return r},getRootNode:function(t){if(this&&this.nodeType){var r=D(this),o=r.ta;return void 0===o&&(O(this)?(o=this,r.ta=o):(o=(o=this.__shady_parentNode)?o.__shady_getRootNode(t):this,document.documentElement.__shady_native_contains(this)&&(r.ta=o))),o}},contains:function(t){return Vc(this,t)}}),Lr=Q({get assignedSlot(){var t=this.__shady_parentNode;return(t=t&&t.__shady_shadowRoot)&&Ue(t),(t=L(this))&&t.assignedSlot||null}}),Ur=new Map;function Xe(t,r,o,i){for(i=void 0===i||i;r<t.length;r++)if("\\"===t[r]&&r<t.length-1&&"\n"!==t[r+1])r++;else{if(-1!==o.indexOf(t[r]))return r;if(i&&Ur.has(t[r])){var s=Ur.get(t[r]);r=Xe(t,r+1,[s.end],s.sa)}}return t.length}function Ze(t,r,o){var i=[];return $e(t,r,o,i),i}function $e(t,r,o,i){for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling){var s;if(s=t.nodeType===Node.ELEMENT_NODE){var l=r,u=o,h=i,m=l(s=t);m&&h.push(s),u&&u(m)?s=m:($e(s,l,u,h),s=void 0)}if(s)break}}[["(",{end:")",sa:!0}],["[",{end:"]",sa:!0}],['"',{end:'"',sa:!1}],["'",{end:"'",sa:!1}]].forEach((function(t){var r=ka(t);t=r.next().value,r=r.next().value,Ur.set(t,r)}));var Br={get firstElementChild(){var t=L(this);if(t&&void 0!==t.firstChild){for(t=this.__shady_firstChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_nextSibling;return t}return this.__shady_native_firstElementChild},get lastElementChild(){var t=L(this);if(t&&void 0!==t.lastChild){for(t=this.__shady_lastChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_previousSibling;return t}return this.__shady_native_lastElementChild},get children(){return Lc(this)?Wc(Array.prototype.filter.call(Yc(this),(function(t){return t.nodeType===Node.ELEMENT_NODE}))):this.__shady_native_children},get childElementCount(){var t=this.__shady_children;return t?t.length:0}},Hr=Q((Br.append=function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];this.__shady_insertBefore(cd.apply(null,w(r)),null)},Br.prepend=function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];this.__shady_insertBefore(cd.apply(null,w(r)),this.__shady_firstChild)},Br.replaceChildren=function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];for(;null!==(o=this.__shady_firstChild);)this.__shady_removeChild(o);this.__shady_insertBefore(cd.apply(null,w(r)),null)},Br));function cf(t,r){function c(r,o){return(r===t||-1===o.indexOf(":scope"))&&jt.call(r,o)}var o=function Ye(t){function b(){if(0<o.length){for(;" "===o[o.length-1];)o.pop();r.push({La:o.filter((function(t,r){return 0==r%2})),Za:o.filter((function(t,r){return 1==r%2}))}),o.length=0}}for(var r=[],o=[],i=0;i<t.length;){var s=o[o.length-1],l=Xe(t,i,[","," ",">","+","~"]),u=l===i?t[i]:t.substring(i,l);","===u?b():-1!==[void 0," ",">","+","~"].indexOf(s)&&" "===u||(" "===s&&-1!==[">","+","~"].indexOf(u)?o[o.length-1]=u:o.push(u)),i=l+(l===i?1:0)}return b(),r}(r);if(1>o.length)return[];for(r=dd(Ze(t,(function(){return!0})).map((function(t){return dd(o.map((function(r){var o=r.La,i=o.length-1;return c(t,o[i])?{target:t,da:r,fa:t,index:i}:[]})))})));r.some((function(t){return 0<t.index}));)r=dd(r.map((function(t){if(0>=t.index)return t;var r=t.target,o=t.fa,i=t.da;t=t.index-1;var s=i.Za[t],l=i.La[t];if(" "===s){for(s=[],o=o.__shady_parentElement;o;o=o.__shady_parentElement)c(o,l)&&s.push({target:r,da:i,fa:o,index:t});return s}if(">"===s)return c(o=o.__shady_parentElement,l)?{target:r,da:i,fa:o,index:t}:[];if("+"===s)return(o=o.__shady_previousElementSibling)&&c(o,l)?{target:r,da:i,fa:o,index:t}:[];if("~"===s){for(s=[],o=o.__shady_previousElementSibling;o;o=o.__shady_previousElementSibling)c(o,l)&&s.push({target:r,da:i,fa:o,index:t});return s}throw Error("Unrecognized combinator: '"+s+"'.")})));return function ed(t){for(var r=[],o=new Set,i=(t=ka(t)).next();!i.done;i=t.next())i=i.value,o.has(i)||(r.push(i),o.add(i));return r}(r.map((function(t){return t.target})))}var $r=Ut.querySelectorImplementation,qr=Q({querySelector:function(t){if("native"===$r){for(var r=Array.prototype.slice.call((this instanceof ShadowRoot?this.host:this).__shady_native_querySelectorAll(t)),o=this.__shady_getRootNode(),i=(r=ka(r)).next();!i.done;i=r.next())if((i=i.value).__shady_getRootNode()==o)return i;return null}if("selectorEngine"===$r)return cf(this,t)[0]||null;if(void 0===$r)return Ze(this,(function(r){return jt.call(r,t)}),(function(t){return!!t}))[0]||null;throw Error("Unrecognized value of ShadyDOM.querySelectorImplementation: '"+$r+"'")},querySelectorAll:function(t,r){if(r||"native"===$r){r=Array.prototype.slice.call((this instanceof ShadowRoot?this.host:this).__shady_native_querySelectorAll(t));var o=this.__shady_getRootNode();return Wc(r.filter((function(t){return t.__shady_getRootNode()==o})))}if("selectorEngine"===$r)return Wc(cf(this,t));if(void 0===$r)return Wc(Ze(this,(function(r){return jt.call(r,t)})));throw Error("Unrecognized value of ShadyDOM.querySelectorImplementation: '"+$r+"'")}}),jr=Ut.ha&&!Ut.J?ad({},Hr):Hr;ad(Hr,qr);var zr=Q({after:function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];if(null!==(o=this.__shady_parentNode)){var i=this.__shady_nextSibling;o.__shady_insertBefore(cd.apply(null,w(r)),i)}},before:function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];null!==(o=this.__shady_parentNode)&&o.__shady_insertBefore(cd.apply(null,w(r)),this)},remove:function(){var t=this.__shady_parentNode;null!==t&&t.__shady_removeChild(this)},replaceWith:function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];if(null!==(o=this.__shady_parentNode)){var i=this.__shady_nextSibling;o.__shady_removeChild(this),o.__shady_insertBefore(cd.apply(null,w(r)),i)}}}),Gr=window.document;function jf(t,r){if("slot"===r)Mc(t=t.__shady_parentNode)&&Pe(L(t).root);else if("slot"===t.localName&&"name"===r&&(r=Ne(t))){if(r.g){kf(r);var o=t.Ua,i=lf(t);if(i!==o){var s=(o=r.h[o]).indexOf(t);0<=s&&o.splice(s,1),(o=r.h[i]||(r.h[i]=[])).push(t),1<o.length&&(r.h[i]=mf(o))}}Pe(r)}}var Vr=Q({get previousElementSibling(){var t=L(this);if(t&&void 0!==t.previousSibling){for(t=this.__shady_previousSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_previousSibling;return t}return this.__shady_native_previousElementSibling},get nextElementSibling(){var t=L(this);if(t&&void 0!==t.nextSibling){for(t=this.__shady_nextSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_nextSibling;return t}return this.__shady_native_nextElementSibling},get slot(){return this.getAttribute("slot")},set slot(t){this.__shady_setAttribute("slot",t)},get className(){return this.getAttribute("class")||""},set className(t){this.__shady_setAttribute("class",t)},setAttribute:function(t,r){this.ownerDocument!==Gr?this.__shady_native_setAttribute(t,r):ze(this,t,r)||(this.__shady_native_setAttribute(t,r),jf(this,t))},removeAttribute:function(t){this.ownerDocument!==Gr?this.__shady_native_removeAttribute(t):ze(this,t,"")?""===this.getAttribute(t)&&this.__shady_native_removeAttribute(t):(this.__shady_native_removeAttribute(t),jf(this,t))},toggleAttribute:function(t,r){return this.ownerDocument!==Gr?this.__shady_native_toggleAttribute(t,r):ze(this,t,"")?""!==this.getAttribute(t)||r?void 0:this.__shady_native_toggleAttribute(t,r):(r=this.__shady_native_toggleAttribute(t,r),jf(this,t),r)}});Ut.ha||Ir.forEach((function(t){Vr[t]=se(t)}));var Kr=Q({attachShadow:function(t){if(!this)throw Error("Must provide a host.");if(!t)throw Error("Not enough arguments.");if(t.shadyUpgradeFragment&&!Ut.Ra){var r=t.shadyUpgradeFragment;if(r.__proto__=ShadowRoot.prototype,of(r,this,t),pf(r,r),t=r.__noInsertionPoint?null:r.querySelectorAll("slot"),r.__noInsertionPoint=void 0,t&&t.length){var o=r;Oe(o),o.i.push.apply(o.i,w(t)),Pe(r)}r.host.__shady_native_appendChild(r)}else r=new qf(ho,this,t);return this.__CE_shadowRoot=r},get shadowRoot(){var t=L(this);return t&&t.lb||null}});ad(Vr,Kr);var Wr=document.implementation.createHTMLDocument("inert"),Qr=Q({get innerHTML(){return Lc(this)?ud("template"===this.localName?this.content:this,Yc):this.__shady_native_innerHTML},set innerHTML(t){if("template"===this.localName)this.__shady_native_innerHTML=t;else{Je(this);var r=this.localName||"div";for(r=this.namespaceURI&&this.namespaceURI!==Wr.namespaceURI?Wr.createElementNS(this.namespaceURI,r):Wr.createElement(r),Ut.D?r.__shady_native_innerHTML=t:r.innerHTML=t;t=r.__shady_firstChild;)this.__shady_insertBefore(t)}}}),Yr=Q({blur:function(){var t=L(this);(t=(t=t&&t.root)&&t.activeElement)?t.__shady_blur():this.__shady_native_blur()}});Ut.ha||Ar.forEach((function(t){Yr[t]=se(t)}));var Jr=Q({assignedNodes:function(t){if("slot"===this.localName){var r=this.__shady_getRootNode();return r&&O(r)&&Ue(r),(r=L(this))&&(t&&t.flatten?r.aa:r.assignedNodes)||[]}},addEventListener:function(t,r,o){if("slot"!==this.localName||"slotchange"===t)ie.call(this,t,r,o);else{"object"!=typeof o&&(o={capture:!!o});var i=this.__shady_parentNode;if(!i)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");o.U=this,i.__shady_addEventListener(t,r,o)}},removeEventListener:function(t,r,o){if("slot"!==this.localName||"slotchange"===t)je.call(this,t,r,o);else{"object"!=typeof o&&(o={capture:!!o});var i=this.__shady_parentNode;if(!i)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");o.U=this,i.__shady_removeEventListener(t,r,o)}}}),Xr=Q({getElementById:function(t){return""===t?null:Ze(this,(function(r){return r.id==t}),(function(t){return!!t}))[0]||null}});function yf(t,r){for(var o;r&&!t.has(o=r.__shady_getRootNode());)r=o.host;return r}var Zr="__shady_native_"+Jc(),eo=Q({get activeElement(){var t=Ut.D?document.__shady_native_activeElement:document.activeElement;if(!t||!t.nodeType)return null;var r=!!O(this);if(!(this===document||r&&this.host!==t&&this.host.__shady_native_contains(t)))return null;for(r=Ne(t);r&&r!==this;)r=Ne(t=r.host);return this===document?r?null:t:r===this?t:null},elementsFromPoint:function(t,r){if(t=document[Zr](t,r),this===document&&Ut.useNativeDocumentEFP)return t;t=[].slice.call(t),r=function zf(t){var r=new Set;for(r.add(t);O(t)&&t.host;)t=t.host.__shady_getRootNode(),r.add(t);return r}(this);for(var o=new Set,i=0;i<t.length;i++)o.add(yf(r,t[i]));var s=[];return o.forEach((function(t){return s.push(t)})),s},elementFromPoint:function(t,r){return this===document&&Ut.useNativeDocumentEFP?this.__shady_native_elementFromPoint(t,r):this.__shady_elementsFromPoint(t,r)[0]||null}}),to=window.document,ro=Q({importNode:function(t,r){if(t.ownerDocument!==to||"template"===t.localName)return this.__shady_native_importNode(t,r);var o=this.__shady_native_importNode(t,!1);if(r)for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling)r=this.__shady_importNode(t,!0),o.__shady_appendChild(r);return o}}),oo=Q({dispatchEvent:ge,addEventListener:ie.bind(window),removeEventListener:je.bind(window)}),no={};Object.getOwnPropertyDescriptor(HTMLElement.prototype,"parentElement")&&(no.parentElement=Fr.parentElement),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"contains")&&(no.contains=Fr.contains),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"children")&&(no.children=Hr.children),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"innerHTML")&&(no.innerHTML=Qr.innerHTML),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"className")&&(no.className=Vr.className);var io={EventTarget:[Pr],Node:[Fr,window.EventTarget?null:Pr],Text:[Lr],Comment:[Lr],CDATASection:[Lr],ProcessingInstruction:[Lr],Element:[Vr,Hr,zr,Lr,!Ut.D||"innerHTML"in Element.prototype?Qr:null,window.HTMLSlotElement?null:Jr],HTMLElement:[Yr,no],HTMLSlotElement:[Jr],DocumentFragment:[jr,Xr],Document:[ro,jr,Xr,eo],Window:[oo],CharacterData:[zr],XMLHttpRequest:[window.EventTarget?null:Pr]},so=Ut.D?null:["innerHTML","textContent"];function If(t,r,o,i){r.forEach((function(r){return t&&r&&P(t,r,o,i)}))}function Jf(t){var r,o=t?null:so;for(r in io)If(window[r]&&window[r].prototype,io[r],t,o)}function Kf(t){return t.__shady_protoIsPatched=!0,If(t,io.EventTarget),If(t,io.Node),If(t,io.Element),If(t,io.HTMLElement),If(t,io.HTMLSlotElement),t}["Text","Comment","CDATASection","ProcessingInstruction"].forEach((function(t){var r=window[t],o=Object.create(r.prototype);o.__shady_protoIsPatched=!0,If(o,io.EventTarget),If(o,io.Node),io[t]&&If(o,io[t]),r.prototype.__shady_patchedProto=o}));var ao=Ut.Da,co=Ut.D;function Nf(t,r){if(ao&&!t.__shady_protoIsPatched&&!O(t)){var o=Object.getPrototypeOf(t),i=o.hasOwnProperty("__shady_patchedProto")&&o.__shady_patchedProto;i||(Kf(i=Object.create(o)),o.__shady_patchedProto=i),Object.setPrototypeOf(t,i)}co||(1===r?pr(t):2===r&&fr(t))}function Of(t,r,o,i){Nf(t,1),i=i||null;var s=D(t),l=i?D(i):null;s.previousSibling=i?l.previousSibling:r.__shady_lastChild,(l=L(s.previousSibling))&&(l.nextSibling=t),(l=L(s.nextSibling=i))&&(l.previousSibling=t),s.parentNode=r,i?i===o.firstChild&&(o.firstChild=t):(o.lastChild=t,o.firstChild||(o.firstChild=t)),o.childNodes=null}function pf(t,r){var o=D(t);if(r||void 0===o.firstChild){o.childNodes=null;var i=o.firstChild=t.__shady_native_firstChild;for(o.lastChild=t.__shady_native_lastChild,Nf(t,2),o=i,i=void 0;o;o=o.__shady_native_nextSibling){var s=D(o);s.parentNode=r||t,s.nextSibling=o.__shady_native_nextSibling,s.previousSibling=i||null,i=o,Nf(o,1)}}}var lo=Q({addEventListener:function(t,r,o){"object"!=typeof o&&(o={capture:!!o}),o.U=o.U||this,this.host.__shady_addEventListener(t,r,o)},removeEventListener:function(t,r,o){"object"!=typeof o&&(o={capture:!!o}),o.U=o.U||this,this.host.__shady_removeEventListener(t,r,o)}});function Qf(t,r){P(t,lo,r),P(t,eo,r),P(t,Qr,r),P(t,Hr,r),Ut.J&&!r?(P(t,Fr,r),P(t,Xr,r)):Ut.D||(P(t,dr),P(t,cr),P(t,lr))}var uo,ho={},po=Ut.deferConnectionCallbacks&&"loading"===document.readyState;function Tf(t){var r=[];do{r.unshift(t)}while(t=t.__shady_parentNode);return r}function qf(t,r,o){if(t!==ho)throw new TypeError("Illegal constructor");this.g=null,of(this,r,o)}function of(t,r,o){if(t.host=r,t.mode=o&&o.mode,pf(t.host),(r=D(t.host)).root=t,r.lb="closed"!==t.mode?t:null,(r=D(t)).firstChild=r.lastChild=r.parentNode=r.nextSibling=r.previousSibling=null,Ut.preferPerformance)for(;r=t.host.__shady_native_firstChild;)t.host.__shady_native_removeChild(r);else Pe(t)}function Pe(t){t.Y||(t.Y=!0,hd((function(){return Ue(t)})))}function Ue(t){var r;if(r=t.Y){for(var o;t;)t.Y&&(o=t),O(t=(r=t).host.__shady_getRootNode())&&(r=L(r.host))&&0<r.ka||(t=void 0);r=o}(o=r)&&o._renderSelf()}function Uf(t,r,o){var i=D(r),s=i.xa;i.xa=null,o||(o=(t=t.h[r.__shady_slot||"__catchall"])&&t[0]),o?(D(o).assignedNodes.push(r),i.assignedSlot=o):i.assignedSlot=void 0,s!==i.assignedSlot&&i.assignedSlot&&(D(i.assignedSlot).Aa=!0)}function Vf(t,r,o){for(var i=0,s=void 0;i<o.length&&(s=o[i]);i++)if("slot"==s.localName){var l=L(s).assignedNodes;l&&l.length&&Vf(t,r,l)}else r.push(o[i])}function Wf(t,r){r.__shady_native_dispatchEvent(new Event("slotchange")),(r=L(r)).assignedSlot&&Wf(t,r.assignedSlot)}function Oe(t){t.i=t.i||[],t.g=t.g||[],t.h=t.h||{}}function kf(t){if(t.i&&t.i.length){for(var r,o=t.i,i=0;i<o.length;i++){var s=o[i];pf(s);var l=s.__shady_parentNode;pf(l),(l=L(l)).ka=(l.ka||0)+1,l=lf(s),t.h[l]?((r=r||{})[l]=!0,t.h[l].push(s)):t.h[l]=[s],t.g.push(s)}if(r)for(var u in r)t.h[u]=mf(t.h[u]);t.i=[]}}function lf(t){var r=t.name||t.getAttribute("name")||"__catchall";return t.Ua=r}function mf(t){return t.sort((function(t,r){t=Tf(t);for(var o=Tf(r),i=0;i<t.length;i++){r=t[i];var s=o[i];if(r!==s)return(t=Yc(r.__shady_parentNode)).indexOf(r)-t.indexOf(s)}}))}function Nc(t){return kf(t),!(!t.g||!t.g.length)}if(qf.prototype._renderSelf=function(){var t=po;if(po=!0,this.Y=!1,this.g){kf(this);for(var r,o=0;o<this.g.length;o++){var i=L(r=this.g[o]),s=i.assignedNodes;if(i.assignedNodes=[],i.aa=[],i.Ja=s)for(i=0;i<s.length;i++){var l=L(s[i]);l.xa=l.assignedSlot,l.assignedSlot===r&&(l.assignedSlot=null)}}for(o=this.host.__shady_firstChild;o;o=o.__shady_nextSibling)Uf(this,o);for(o=0;o<this.g.length;o++){if(!(s=L(r=this.g[o])).assignedNodes.length)for(i=r.__shady_firstChild;i;i=i.__shady_nextSibling)Uf(this,i,r);if((i=(i=L(r.__shady_parentNode))&&i.root)&&(Nc(i)||i.Y)&&i._renderSelf(),Vf(this,s.aa,s.assignedNodes),i=s.Ja){for(l=0;l<i.length;l++)L(i[l]).xa=null;s.Ja=null,i.length>s.assignedNodes.length&&(s.Aa=!0)}s.Aa&&(s.Aa=!1,Wf(this,r))}for(r=this.g,o=[],s=0;s<r.length;s++)(l=L(i=r[s].__shady_parentNode))&&l.root||!(0>o.indexOf(i))||o.push(i);for(r=0;r<o.length;r++){for(s=(l=o[r])===this?this.host:l,i=[],l=l.__shady_firstChild;l;l=l.__shady_nextSibling)if("slot"==l.localName)for(var u=L(l).aa,h=0;h<u.length;h++)i.push(u[h]);else i.push(l);l=Xc(s),u=ue(i,i.length,l,l.length);for(var m=h=0,v=void 0;h<u.length&&(v=u[h]);h++){for(var C=0,_=void 0;C<v.ia.length&&(_=v.ia[C]);C++)_.__shady_native_parentNode===s&&s.__shady_native_removeChild(_),l.splice(v.index+m,1);m-=v.pa}for(m=0,v=void 0;m<u.length&&(v=u[m]);m++)for(h=l[v.index],C=v.index;C<v.index+v.pa;C++)_=i[C],s.__shady_native_insertBefore(_,h),l.splice(C,0,_)}}if(!Ut.preferPerformance&&!this.Ia)for(o=this.host.__shady_firstChild;o;o=o.__shady_nextSibling)r=L(o),o.__shady_native_parentNode!==this.host||"slot"!==o.localName&&r.assignedSlot||this.host.__shady_native_removeChild(o);this.Ia=!0,po=t,uo&&uo()},function(t){t.__proto__=DocumentFragment.prototype,Qf(t,"__shady_"),Qf(t),Object.defineProperties(t,{nodeType:{value:Node.DOCUMENT_FRAGMENT_NODE,configurable:!0},nodeName:{value:"#document-fragment",configurable:!0},nodeValue:{value:null,configurable:!0}}),["localName","namespaceURI","prefix"].forEach((function(r){Object.defineProperty(t,r,{value:void 0,configurable:!0})})),["ownerDocument","baseURI","isConnected"].forEach((function(r){Object.defineProperty(t,r,{get:function(){return this.host[r]},configurable:!0})}))}(qf.prototype),window.customElements&&window.customElements.define&&Ut.Ba&&!Ut.preferPerformance){var fo=new Map;uo=function(){var t=[];fo.forEach((function(r,o){t.push([o,r])})),fo.clear();for(var r=0;r<t.length;r++){var o=t[r][0];t[r][1]?o.__shadydom_connectedCallback():o.__shadydom_disconnectedCallback()}},po&&document.addEventListener("readystatechange",(function(){po=!1,uo()}),{once:!0});var go=window.customElements.define,$f=function(t,r){var o=r.prototype.connectedCallback,i=r.prototype.disconnectedCallback;go.call(window.customElements,t,function(t,r,o){var i=0,s="__isConnected"+i++;return(r||o)&&(t.prototype.connectedCallback=t.prototype.__shadydom_connectedCallback=function(){po?fo.set(this,!0):this[s]||(this[s]=!0,r&&r.call(this))},t.prototype.disconnectedCallback=t.prototype.__shadydom_disconnectedCallback=function(){po?this.isConnected||fo.set(this,!1):this[s]&&(this[s]=!1,o&&o.call(this))}),t}(r,o,i)),r.prototype.connectedCallback=o,r.prototype.disconnectedCallback=i};window.customElements.define=$f,Object.defineProperty(window.CustomElementRegistry.prototype,"define",{value:$f,configurable:!0})}function Ne(t){if(O(t=t.__shady_getRootNode()))return t}function ag(t){this.node=t}function bg(t){Object.defineProperty(ag.prototype,t,{get:function(){return this.node["__shady_"+t]},set:function(r){this.node["__shady_"+t]=r},configurable:!0})}(r=ag.prototype).addEventListener=function(t,r,o){return this.node.__shady_addEventListener(t,r,o)},r.removeEventListener=function(t,r,o){return this.node.__shady_removeEventListener(t,r,o)},r.appendChild=function(t){return this.node.__shady_appendChild(t)},r.insertBefore=function(t,r){return this.node.__shady_insertBefore(t,r)},r.removeChild=function(t){return this.node.__shady_removeChild(t)},r.replaceChild=function(t,r){return this.node.__shady_replaceChild(t,r)},r.cloneNode=function(t){return this.node.__shady_cloneNode(t)},r.getRootNode=function(t){return this.node.__shady_getRootNode(t)},r.contains=function(t){return this.node.__shady_contains(t)},r.dispatchEvent=function(t){return this.node.__shady_dispatchEvent(t)},r.setAttribute=function(t,r){this.node.__shady_setAttribute(t,r)},r.getAttribute=function(t){return this.node.__shady_native_getAttribute(t)},r.hasAttribute=function(t){return this.node.__shady_native_hasAttribute(t)},r.removeAttribute=function(t){this.node.__shady_removeAttribute(t)},r.toggleAttribute=function(t,r){return this.node.__shady_toggleAttribute(t,r)},r.attachShadow=function(t){return this.node.__shady_attachShadow(t)},r.focus=function(){this.node.__shady_native_focus()},r.blur=function(){this.node.__shady_blur()},r.importNode=function(t,r){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_importNode(t,r)},r.getElementById=function(t){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_getElementById(t)},r.elementsFromPoint=function(t,r){return this.node.__shady_elementsFromPoint(t,r)},r.elementFromPoint=function(t,r){return this.node.__shady_elementFromPoint(t,r)},r.querySelector=function(t){return this.node.__shady_querySelector(t)},r.querySelectorAll=function(t,r){return this.node.__shady_querySelectorAll(t,r)},r.assignedNodes=function(t){if("slot"===this.node.localName)return this.node.__shady_assignedNodes(t)},r.append=function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];return this.node.__shady_append.apply(this.node,w(r))},r.prepend=function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];return this.node.__shady_prepend.apply(this.node,w(r))},r.after=function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];return this.node.__shady_after.apply(this.node,w(r))},r.before=function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];return this.node.__shady_before.apply(this.node,w(r))},r.remove=function(){return this.node.__shady_remove()},r.replaceWith=function(t){for(var r=[],o=0;o<arguments.length;++o)r[o]=arguments[o];return this.node.__shady_replaceWith.apply(this.node,w(r))},s.Object.defineProperties(ag.prototype,{activeElement:{configurable:!0,enumerable:!0,get:function(){if(O(this.node)||this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_activeElement}},_activeElement:{configurable:!0,enumerable:!0,get:function(){return this.activeElement}},host:{configurable:!0,enumerable:!0,get:function(){if(O(this.node))return this.node.host}},parentNode:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentNode}},firstChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstChild}},lastChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastChild}},nextSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextSibling}},previousSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousSibling}},childNodes:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childNodes}},parentElement:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentElement}},firstElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstElementChild}},lastElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastElementChild}},nextElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextElementSibling}},previousElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousElementSibling}},children:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_children}},childElementCount:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childElementCount}},shadowRoot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_shadowRoot}},assignedSlot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_assignedSlot}},isConnected:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_isConnected}},innerHTML:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_innerHTML},set:function(t){this.node.__shady_innerHTML=t}},textContent:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_textContent},set:function(t){this.node.__shady_textContent=t}},slot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_slot},set:function(t){this.node.__shady_slot=t}},className:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_className},set:function(t){this.node.__shady_className=t}}}),Ir.forEach((function(t){return bg(t)})),Ar.forEach((function(t){return bg(t)}));var mo=new WeakMap;function dg(t){if(O(t)||t instanceof ag)return t;var r=mo.get(t);return r||(r=new ag(t),mo.set(t,r)),r}if(Ut.Ba){var vo=Ut.D?function(t){return t}:function(t){return fr(t),pr(t),t},yo={inUse:Ut.Ba,patch:vo,isShadyRoot:O,enqueue:hd,flush:id,flushInitial:function(t){!t.Ia&&t.Y&&Ue(t)},settings:Ut,filterMutations:function nd(t,r){var o=r.getRootNode();return t.map((function(t){var r=o===t.target.getRootNode();if(r&&t.addedNodes){if(r=[].slice.call(t.addedNodes).filter((function(t){return o===t.getRootNode()})),r.length)return t=Object.create(t),Object.defineProperty(t,"addedNodes",{value:r,configurable:!0}),t}else if(r)return t})).filter((function(t){return t}))},observeChildren:function ld(t,r){var o=D(t);o.ga||(o.ga=new jd),o.ga.qa.add(r);var i=o.ga;return{Va:r,X:i,Wa:t,takeRecords:function(){return i.takeRecords()}}},unobserveChildren:function md(t){var r=t&&t.X;r&&(r.qa.delete(t.Va),r.qa.size||(D(t.Wa).ga=null))},deferConnectionCallbacks:Ut.deferConnectionCallbacks,preferPerformance:Ut.preferPerformance,handlesDynamicScoping:!0,wrap:Ut.J?dg:vo,wrapIfNeeded:!0===Ut.J?dg:function(t){return t},Wrapper:ag,composedPath:function Wd(t){return t.__composedPath||(t.__composedPath=Vd(t.target,!0)),t.__composedPath},noPatch:Ut.J,patchOnDemand:Ut.Da,nativeMethods:tr,nativeTree:rr,patchElementProto:Kf,querySelectorImplementation:Ut.querySelectorImplementation};window.ShadyDOM=yo,function Gd(){var t=["dispatchEvent","addEventListener","removeEventListener"];window.EventTarget?(S(window.EventTarget.prototype,t),void 0===window.__shady_native_addEventListener&&S(Window.prototype,t)):(S(Node.prototype,t),S(Window.prototype,t),S(XMLHttpRequest.prototype,t)),er?S(Node.prototype,"parentNode firstChild lastChild previousSibling nextSibling childNodes parentElement textContent".split(" ")):zd(Node.prototype,{parentNode:{get:function(){return or.currentNode=this,or.parentNode()}},firstChild:{get:function(){return or.currentNode=this,or.firstChild()}},lastChild:{get:function(){return or.currentNode=this,or.lastChild()}},previousSibling:{get:function(){return or.currentNode=this,or.previousSibling()}},nextSibling:{get:function(){return or.currentNode=this,or.nextSibling()}},childNodes:{get:function(){var t=[];or.currentNode=this;for(var r=or.firstChild();r;)t.push(r),r=or.nextSibling();return t}},parentElement:{get:function(){return nr.currentNode=this,nr.parentNode()}},textContent:{get:function(){switch(this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:for(var t,r=document.createTreeWalker(this,NodeFilter.SHOW_TEXT,null,!1),o="";t=r.nextNode();)o+=t.nodeValue;return o;default:return this.nodeValue}},set:function(t){switch(null==t&&(t=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:Dd(this),(0<t.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_native_insertBefore(document.createTextNode(t),void 0);break;default:this.nodeValue=t}}}}),S(Node.prototype,"appendChild insertBefore removeChild replaceChild cloneNode contains".split(" ")),S(HTMLElement.prototype,["parentElement","contains"]),t={firstElementChild:{get:function(){return nr.currentNode=this,nr.firstChild()}},lastElementChild:{get:function(){return nr.currentNode=this,nr.lastChild()}},children:{get:function(){var t=[];nr.currentNode=this;for(var r=nr.firstChild();r;)t.push(r),r=nr.nextSibling();return Wc(t)}},childElementCount:{get:function(){return this.children?this.children.length:0}}},er?(S(Element.prototype,sr),S(Element.prototype,["previousElementSibling","nextElementSibling","innerHTML","className"]),S(HTMLElement.prototype,["children","innerHTML","className"])):(zd(Element.prototype,t),zd(Element.prototype,{previousElementSibling:{get:function(){return nr.currentNode=this,nr.previousSibling()}},nextElementSibling:{get:function(){return nr.currentNode=this,nr.nextSibling()}},innerHTML:{get:function(){return ud(this,Xc)},set:function(t){var r="template"===this.localName?this.content:this;Dd(r);var o=this.localName||"div";for((o=this.namespaceURI&&this.namespaceURI!==ir.namespaceURI?ir.createElementNS(this.namespaceURI,o):ir.createElement(o)).innerHTML=t,t="template"===this.localName?o.content:o;o=t.__shady_native_firstChild;)r.__shady_native_insertBefore(o,void 0)}},className:{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}}})),S(Element.prototype,"setAttribute getAttribute hasAttribute removeAttribute toggleAttribute focus blur".split(" ")),S(Element.prototype,ar),S(HTMLElement.prototype,["focus","blur"]),window.HTMLTemplateElement&&S(window.HTMLTemplateElement.prototype,["innerHTML"]),er?S(DocumentFragment.prototype,sr):zd(DocumentFragment.prototype,t),S(DocumentFragment.prototype,ar),er?(S(Document.prototype,sr),S(Document.prototype,["activeElement"])):zd(Document.prototype,t),S(Document.prototype,["importNode","getElementById","elementFromPoint",Jc()]),S(Document.prototype,ar)}(),Jf("__shady_"),Object.defineProperty(document,"_activeElement",eo.activeElement),P(Window.prototype,oo,"__shady_"),Ut.J?Ut.Da&&P(Element.prototype,Kr):(Jf(),function pe(){if(!mr&&Object.getOwnPropertyDescriptor(Event.prototype,"isTrusted")){var a=function(){var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,composed:!0});this.__shady_dispatchEvent(t)};Element.prototype.click?Element.prototype.click=a:HTMLElement.prototype.click&&(HTMLElement.prototype.click=a)}}()),function ke(){for(var t in _r)window.__shady_native_addEventListener(t,(function(t){t.__target||(he(t),ee(t))}),!0)}(),window.Event=Tr,window.CustomEvent=Er,window.MouseEvent=xr,window.ShadowRoot=qf}var bo=window.Document.prototype.createElement,wo=window.Document.prototype.createElementNS,Co=window.Document.prototype.importNode,_o=window.Document.prototype.prepend,ko=window.Document.prototype.append,So=window.DocumentFragment.prototype.prepend,To=window.DocumentFragment.prototype.append,Eo=window.Node.prototype.cloneNode,xo=window.Node.prototype.appendChild,Io=window.Node.prototype.insertBefore,Ao=window.Node.prototype.removeChild,Po=window.Node.prototype.replaceChild,Ro=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),Oo=window.Element.prototype.attachShadow,No=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),Mo=window.Element.prototype.getAttribute,Do=window.Element.prototype.setAttribute,Fo=window.Element.prototype.removeAttribute,Lo=window.Element.prototype.toggleAttribute,Uo=window.Element.prototype.getAttributeNS,Bo=window.Element.prototype.setAttributeNS,Ho=window.Element.prototype.removeAttributeNS,$o=window.Element.prototype.insertAdjacentElement,qo=window.Element.prototype.insertAdjacentHTML,jo=window.Element.prototype.prepend,zo=window.Element.prototype.append,Go=window.Element.prototype.before,Vo=window.Element.prototype.after,Ko=window.Element.prototype.replaceWith,Wo=window.Element.prototype.remove,Qo=window.HTMLElement,Yo=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),Jo=window.HTMLElement.prototype.insertAdjacentElement,Xo=window.HTMLElement.prototype.insertAdjacentHTML,Zo=new Set;function Og(t){var r=Zo.has(t);return t=/^[a-z][.0-9_a-z]*-[-.0-9_a-z]*$/.test(t),!r&&t}"annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" ").forEach((function(t){return Zo.add(t)}));var en=document.contains?document.contains.bind(document):document.documentElement.contains.bind(document.documentElement);function T(t){var r=t.isConnected;if(void 0!==r)return r;if(en(t))return!0;for(;t&&!(t.__CE_isImportDocument||t instanceof Document);)t=t.parentNode||(window.ShadowRoot&&t instanceof ShadowRoot?t.host:void 0);return!(!t||!(t.__CE_isImportDocument||t instanceof Document))}function Qg(t){var r=t.children;if(r)return Array.prototype.slice.call(r);for(r=[],t=t.firstChild;t;t=t.nextSibling)t.nodeType===Node.ELEMENT_NODE&&r.push(t);return r}function Rg(t,r){for(;r&&r!==t&&!r.nextSibling;)r=r.parentNode;return r&&r!==t?r.nextSibling:null}function Sg(t,r,o){for(var i=t;i;){if(i.nodeType===Node.ELEMENT_NODE){var s=i;r(s);var l=s.localName;if("link"===l&&"import"===s.getAttribute("rel")){if(i=s.import,void 0===o&&(o=new Set),i instanceof Node&&!o.has(i))for(o.add(i),i=i.firstChild;i;i=i.nextSibling)Sg(i,r,o);i=Rg(t,s);continue}if("template"===l){i=Rg(t,s);continue}if(s=s.__CE_shadowRoot)for(s=s.firstChild;s;s=s.nextSibling)Sg(s,r,o)}i=i.firstChild?i.firstChild:Rg(t,i)}}function Tg(){var t=!(null==rn||!rn.noDocumentConstructionObserver),r=!(null==rn||!rn.shadyDomFastWalk);this.ca=[],this.g=[],this.W=!1,this.shadyDomFastWalk=r,this.sb=!t}function Vg(t,r,o,i){var s=window.ShadyDOM;if(t.shadyDomFastWalk&&s&&s.inUse){if(r.nodeType===Node.ELEMENT_NODE&&o(r),r.querySelectorAll)for(t=s.nativeMethods.querySelectorAll.call(r,"*"),r=0;r<t.length;r++)o(t[r])}else Sg(r,o,i)}function Yg(t,r){t.W&&Vg(t,r,(function(r){return Zg(t,r)}))}function Zg(t,r){if(t.W&&!r.__CE_patched){r.__CE_patched=!0;for(var o=0;o<t.ca.length;o++)t.ca[o](r);for(o=0;o<t.g.length;o++)t.g[o](r)}}function $g(t,r){var o=[];for(Vg(t,r,(function(t){return o.push(t)})),r=0;r<o.length;r++){var i=o[r];1===i.__CE_state?t.connectedCallback(i):ah(t,i)}}function bh(t,r){var o=[];for(Vg(t,r,(function(t){return o.push(t)})),r=0;r<o.length;r++){var i=o[r];1===i.__CE_state&&t.disconnectedCallback(i)}}function ch(t,r,o){var i=(o=void 0===o?{}:o).tb,s=o.upgrade||function(r){return ah(t,r)},l=[];for(Vg(t,r,(function(r){if(t.W&&Zg(t,r),"link"===r.localName&&"import"===r.getAttribute("rel")){var o=r.import;o instanceof Node&&(o.__CE_isImportDocument=!0,o.__CE_registry=document.__CE_registry),o&&"complete"===o.readyState?o.__CE_documentLoadHandled=!0:r.addEventListener("load",(function(){var o=r.import;if(!o.__CE_documentLoadHandled){o.__CE_documentLoadHandled=!0;var l=new Set;i&&(i.forEach((function(t){return l.add(t)})),l.delete(o)),ch(t,o,{tb:l,upgrade:s})}}))}else l.push(r)}),i),r=0;r<l.length;r++)s(l[r])}function ah(t,r){try{var o=r.ownerDocument,i=o.__CE_registry,s=i&&(o.defaultView||o.__CE_isImportDocument)?dh(i,r.localName):void 0;if(s&&void 0===r.__CE_state){s.constructionStack.push(r);try{try{if(new s.constructorFunction!==r)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{s.constructionStack.pop()}}catch(t){throw r.__CE_state=2,t}if(r.__CE_state=1,r.__CE_definition=s,s.attributeChangedCallback&&r.hasAttributes()){var l=s.observedAttributes;for(s=0;s<l.length;s++){var u=l[s],h=r.getAttribute(u);null!==h&&t.attributeChangedCallback(r,u,null,h,null)}}T(r)&&t.connectedCallback(r)}}catch(t){eh(t)}}function fh(t,r,o,i){var s=r.__CE_registry;if(s&&(null===i||"http://www.w3.org/1999/xhtml"===i)&&(s=dh(s,o)))try{var l=new s.constructorFunction;if(void 0===l.__CE_state||void 0===l.__CE_definition)throw Error("Failed to construct '"+o+"': The returned value was not constructed with the HTMLElement constructor.");if("http://www.w3.org/1999/xhtml"!==l.namespaceURI)throw Error("Failed to construct '"+o+"': The constructed element's namespace must be the HTML namespace.");if(l.hasAttributes())throw Error("Failed to construct '"+o+"': The constructed element must not have any attributes.");if(null!==l.firstChild)throw Error("Failed to construct '"+o+"': The constructed element must not have any children.");if(null!==l.parentNode)throw Error("Failed to construct '"+o+"': The constructed element must not have a parent node.");if(l.ownerDocument!==r)throw Error("Failed to construct '"+o+"': The constructed element's owner document is incorrect.");if(l.localName!==o)throw Error("Failed to construct '"+o+"': The constructed element's local name is incorrect.");return l}catch(s){return eh(s),r=null===i?bo.call(r,o):wo.call(r,i,o),Object.setPrototypeOf(r,HTMLUnknownElement.prototype),r.__CE_state=2,r.__CE_definition=void 0,Zg(t,r),r}return Zg(t,r=null===i?bo.call(r,o):wo.call(r,i,o)),r}function eh(t){var r="",o="",i=0,s=0;t instanceof Error?(r=t.message,o=t.sourceURL||t.fileName||"",i=t.line||t.lineNumber||0,s=t.column||t.columnNumber||0):r="Uncaught "+String(t);var l=void 0;void 0===ErrorEvent.prototype.initErrorEvent?l=new ErrorEvent("error",{cancelable:!0,message:r,filename:o,lineno:i,colno:s,error:t}):((l=document.createEvent("ErrorEvent")).initErrorEvent("error",!1,!0,r,o,i),l.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{configurable:!0,get:function(){return!0}})}),void 0===l.error&&Object.defineProperty(l,"error",{configurable:!0,enumerable:!0,get:function(){return t}}),window.dispatchEvent(l),l.defaultPrevented||console.error(t)}function gh(){var t=this;this.I=void 0,this.Ka=new Promise((function(r){t.g=r}))}function hh(t){var r=document;this.X=void 0,this.S=t,this.g=r,ch(this.S,this.g),"loading"===this.g.readyState&&(this.X=new MutationObserver(this.h.bind(this)),this.X.observe(this.g,{childList:!0,subtree:!0}))}function ih(t){t.X&&t.X.disconnect()}function U(t){this.ma=new Map,this.na=new Map,this.Fa=new Map,this.wa=!1,this.za=new Map,this.la=function(t){return t()},this.V=!1,this.oa=[],this.S=t,this.Ga=t.sb?new hh(t):void 0}function jh(t,r){if(!Og(r))throw new SyntaxError("The element name '"+r+"' is not valid.");if(dh(t,r))throw Error("A custom element with name '"+r+"' has already been defined.");if(t.wa)throw Error("A custom element is already being defined.")}function lh(t,r,o){var i;t.wa=!0;try{var s=o.prototype;if(!(s instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var f=function(t){var r=s[t];if(void 0!==r&&!(r instanceof Function))throw Error("The '"+t+"' callback must be a function.");return r},l=f("connectedCallback"),u=f("disconnectedCallback"),h=f("adoptedCallback"),m=(i=f("attributeChangedCallback"))&&o.observedAttributes||[]}catch(t){throw t}finally{t.wa=!1}return o={localName:r,constructorFunction:o,connectedCallback:l,disconnectedCallback:u,adoptedCallback:h,attributeChangedCallback:i,observedAttributes:m,constructionStack:[]},t.na.set(r,o),t.Fa.set(o.constructorFunction,o),o}function kh(t){if(!1!==t.V){t.V=!1;for(var r=[],o=t.oa,i=new Map,s=0;s<o.length;s++)i.set(o[s],[]);for(ch(t.S,document,{upgrade:function(o){if(void 0===o.__CE_state){var s=o.localName,l=i.get(s);l?l.push(o):t.na.has(s)&&r.push(o)}}}),s=0;s<r.length;s++)ah(t.S,r[s]);for(s=0;s<o.length;s++){for(var l=o[s],u=i.get(l),h=0;h<u.length;h++)ah(t.S,u[h]);(l=t.za.get(l))&&l.resolve(void 0)}o.length=0}}function dh(t,r){var o=t.na.get(r);if(o)return o;if(o=t.ma.get(r)){t.ma.delete(r);try{return lh(t,r,o())}catch(t){eh(t)}}}function mh(t,r,o){function d(r){return function(o){for(var i=[],s=0;s<arguments.length;++s)i[s]=arguments[s];s=[];for(var l=[],u=0;u<i.length;u++){var h=i[u];if(h instanceof Element&&T(h)&&l.push(h),h instanceof DocumentFragment)for(h=h.firstChild;h;h=h.nextSibling)s.push(h);else s.push(h)}for(r.apply(this,i),i=0;i<l.length;i++)bh(t,l[i]);if(T(this))for(i=0;i<s.length;i++)(l=s[i])instanceof Element&&$g(t,l)}}void 0!==o.prepend&&(r.prepend=d(o.prepend)),void 0!==o.append&&(r.append=d(o.append))}function ph(t){function b(r,o){Object.defineProperty(r,"innerHTML",{enumerable:o.enumerable,configurable:!0,get:o.get,set:function(r){var i=this,s=void 0;if(T(this)&&(s=[],Vg(t,this,(function(t){t!==i&&s.push(t)}))),o.set.call(this,r),s)for(var l=0;l<s.length;l++){var u=s[l];1===u.__CE_state&&t.disconnectedCallback(u)}return this.ownerDocument.__CE_registry?ch(t,this):Yg(t,this),r}})}function c(r,o){r.insertAdjacentElement=function(r,i){var s=T(i);return r=o.call(this,r,i),s&&bh(t,i),T(r)&&$g(t,i),r}}function d(r,o){function g(r,o){for(var i=[];r!==o;r=r.nextSibling)i.push(r);for(o=0;o<i.length;o++)ch(t,i[o])}r.insertAdjacentHTML=function(t,r){if("beforebegin"===(t=t.toLowerCase())){var i=this.previousSibling;o.call(this,t,r),g(i||this.parentNode.firstChild,this)}else if("afterbegin"===t)i=this.firstChild,o.call(this,t,r),g(this.firstChild,i);else if("beforeend"===t)i=this.lastChild,o.call(this,t,r),g(i||this.firstChild,null);else{if("afterend"!==t)throw new SyntaxError("The value provided ("+String(t)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");i=this.nextSibling,o.call(this,t,r),g(this.nextSibling,i)}}}Oo&&(Element.prototype.attachShadow=function(r){if(r=Oo.call(this,r),t.W&&!r.__CE_patched){r.__CE_patched=!0;for(var o=0;o<t.ca.length;o++)t.ca[o](r)}return this.__CE_shadowRoot=r}),No&&No.get?b(Element.prototype,No):Yo&&Yo.get?b(HTMLElement.prototype,Yo):function Xg(t,r){t.W=!0,t.g.push(r)}(t,(function(t){b(t,{enumerable:!0,configurable:!0,get:function(){return Eo.call(this,!0).innerHTML},set:function(t){var r="template"===this.localName,o=r?this.content:this,i=wo.call(document,this.namespaceURI,this.localName);for(i.innerHTML=t;0<o.childNodes.length;)Ao.call(o,o.childNodes[0]);for(t=r?i.content:i;0<t.childNodes.length;)xo.call(o,t.childNodes[0])}})})),Element.prototype.setAttribute=function(r,o){if(1!==this.__CE_state)return Do.call(this,r,o);var i=Mo.call(this,r);Do.call(this,r,o),o=Mo.call(this,r),t.attributeChangedCallback(this,r,i,o,null)},Element.prototype.setAttributeNS=function(r,o,i){if(1!==this.__CE_state)return Bo.call(this,r,o,i);var s=Uo.call(this,r,o);Bo.call(this,r,o,i),i=Uo.call(this,r,o),t.attributeChangedCallback(this,o,s,i,r)},Element.prototype.removeAttribute=function(r){if(1!==this.__CE_state)return Fo.call(this,r);var o=Mo.call(this,r);Fo.call(this,r),null!==o&&t.attributeChangedCallback(this,r,o,null,null)},Lo&&(Element.prototype.toggleAttribute=function(r,o){if(1!==this.__CE_state)return Lo.call(this,r,o);var i=Mo.call(this,r);return null!==i!==(o=Lo.call(this,r,o))&&t.attributeChangedCallback(this,r,i,o?"":null,null),o}),Element.prototype.removeAttributeNS=function(r,o){if(1!==this.__CE_state)return Ho.call(this,r,o);var i=Uo.call(this,r,o);Ho.call(this,r,o);var s=Uo.call(this,r,o);i!==s&&t.attributeChangedCallback(this,o,i,s,r)},Jo?c(HTMLElement.prototype,Jo):$o&&c(Element.prototype,$o),Xo?d(HTMLElement.prototype,Xo):qo&&d(Element.prototype,qo),mh(t,Element.prototype,{prepend:jo,append:zo}),function oh(t){function b(r){return function(o){for(var i=[],s=0;s<arguments.length;++s)i[s]=arguments[s];s=[];for(var l=[],u=0;u<i.length;u++){var h=i[u];if(h instanceof Element&&T(h)&&l.push(h),h instanceof DocumentFragment)for(h=h.firstChild;h;h=h.nextSibling)s.push(h);else s.push(h)}for(r.apply(this,i),i=0;i<l.length;i++)bh(t,l[i]);if(T(this))for(i=0;i<s.length;i++)(l=s[i])instanceof Element&&$g(t,l)}}var r=Element.prototype;void 0!==Go&&(r.before=b(Go)),void 0!==Vo&&(r.after=b(Vo)),void 0!==Ko&&(r.replaceWith=function(r){for(var o=[],i=0;i<arguments.length;++i)o[i]=arguments[i];i=[];for(var s=[],l=0;l<o.length;l++){var u=o[l];if(u instanceof Element&&T(u)&&s.push(u),u instanceof DocumentFragment)for(u=u.firstChild;u;u=u.nextSibling)i.push(u);else i.push(u)}for(l=T(this),Ko.apply(this,o),o=0;o<s.length;o++)bh(t,s[o]);if(l)for(bh(t,this),o=0;o<i.length;o++)(s=i[o])instanceof Element&&$g(t,s)}),void 0!==Wo&&(r.remove=function(){var r=T(this);Wo.call(this),r&&bh(t,this)})}(t)}Tg.prototype.connectedCallback=function(t){var r=t.__CE_definition;if(r.connectedCallback)try{r.connectedCallback.call(t)}catch(t){eh(t)}},Tg.prototype.disconnectedCallback=function(t){var r=t.__CE_definition;if(r.disconnectedCallback)try{r.disconnectedCallback.call(t)}catch(t){eh(t)}},Tg.prototype.attributeChangedCallback=function(t,r,o,i,s){var l=t.__CE_definition;if(l.attributeChangedCallback&&-1<l.observedAttributes.indexOf(r))try{l.attributeChangedCallback.call(t,r,o,i,s)}catch(t){eh(t)}},gh.prototype.resolve=function(t){if(this.I)throw Error("Already resolved.");this.I=t,this.g(t)},hh.prototype.h=function(t){var r=this.g.readyState;for("interactive"!==r&&"complete"!==r||ih(this),r=0;r<t.length;r++)for(var o=t[r].addedNodes,i=0;i<o.length;i++)ch(this.S,o[i])},(r=U.prototype).jb=function(t,r){var o=this;if(!(r instanceof Function))throw new TypeError("Custom element constructor getters must be functions.");jh(this,t),this.ma.set(t,r),this.oa.push(t),this.V||(this.V=!0,this.la((function(){return kh(o)})))},r.define=function(t,r){var o=this;if(!(r instanceof Function))throw new TypeError("Custom element constructors must be functions.");jh(this,t),lh(this,t,r),this.oa.push(t),this.V||(this.V=!0,this.la((function(){return kh(o)})))},r.upgrade=function(t){ch(this.S,t)},r.get=function(t){if(t=dh(this,t))return t.constructorFunction},r.whenDefined=function(t){if(!Og(t))return Promise.reject(new SyntaxError("'"+t+"' is not a valid custom element name."));var r=this.za.get(t);if(r)return r.Ka;r=new gh,this.za.set(t,r);var o=this.na.has(t)||this.ma.has(t);return t=-1===this.oa.indexOf(t),o&&t&&r.resolve(void 0),r.Ka},r.polyfillWrapFlushCallback=function(t){this.Ga&&ih(this.Ga);var r=this.la;this.la=function(o){return t((function(){return r(o)}))}},U.prototype.define=U.prototype.define,U.prototype.upgrade=U.prototype.upgrade,U.prototype.get=U.prototype.get,U.prototype.whenDefined=U.prototype.whenDefined,U.prototype.polyfillDefineLazy=U.prototype.jb,U.prototype.polyfillWrapFlushCallback=U.prototype.polyfillWrapFlushCallback;var tn={};var rn=window.customElements;function th(){var t=new Tg;!function rh(t){function b(){var r=this.constructor,o=document.__CE_registry.Fa.get(r);if(!o)throw Error("Failed to construct a custom element: The constructor was not registered with `customElements`.");var i=o.constructionStack;if(0===i.length)return i=bo.call(document,o.localName),Object.setPrototypeOf(i,r.prototype),i.__CE_state=1,i.__CE_definition=o,Zg(t,i),i;var s=i.length-1,l=i[s];if(l===tn)throw Error("Failed to construct '"+o.localName+"': This element was already constructed.");return i[s]=tn,Object.setPrototypeOf(l,r.prototype),Zg(t,l),l}b.prototype=Qo.prototype,Object.defineProperty(HTMLElement.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:b}),window.HTMLElement=b}(t),function nh(t){Document.prototype.createElement=function(r){return fh(t,this,r,null)},Document.prototype.importNode=function(r,o){return r=Co.call(this,r,!!o),this.__CE_registry?ch(t,r):Yg(t,r),r},Document.prototype.createElementNS=function(r,o){return fh(t,this,o,r)},mh(t,Document.prototype,{prepend:_o,append:ko})}(t),mh(t,DocumentFragment.prototype,{prepend:So,append:To}),function sh(t){function b(r,o){Object.defineProperty(r,"textContent",{enumerable:o.enumerable,configurable:!0,get:o.get,set:function(r){if(this.nodeType===Node.TEXT_NODE)o.set.call(this,r);else{var i=void 0;if(this.firstChild){var s=this.childNodes,l=s.length;if(0<l&&T(this)){i=Array(l);for(var u=0;u<l;u++)i[u]=s[u]}}if(o.set.call(this,r),i)for(r=0;r<i.length;r++)bh(t,i[r])}}})}Node.prototype.insertBefore=function(r,o){if(r instanceof DocumentFragment){var i=Qg(r);if(r=Io.call(this,r,o),T(this))for(o=0;o<i.length;o++)$g(t,i[o]);return r}return i=r instanceof Element&&T(r),o=Io.call(this,r,o),i&&bh(t,r),T(this)&&$g(t,r),o},Node.prototype.appendChild=function(r){if(r instanceof DocumentFragment){var o=Qg(r);if(r=xo.call(this,r),T(this))for(var i=0;i<o.length;i++)$g(t,o[i]);return r}return o=r instanceof Element&&T(r),i=xo.call(this,r),o&&bh(t,r),T(this)&&$g(t,r),i},Node.prototype.cloneNode=function(r){return r=Eo.call(this,!!r),this.ownerDocument.__CE_registry?ch(t,r):Yg(t,r),r},Node.prototype.removeChild=function(r){var o=r instanceof Element&&T(r),i=Ao.call(this,r);return o&&bh(t,r),i},Node.prototype.replaceChild=function(r,o){if(r instanceof DocumentFragment){var i=Qg(r);if(r=Po.call(this,r,o),T(this))for(bh(t,o),o=0;o<i.length;o++)$g(t,i[o]);return r}i=r instanceof Element&&T(r);var s=Po.call(this,r,o),l=T(this);return l&&bh(t,o),i&&bh(t,r),l&&$g(t,r),s},Ro&&Ro.get?b(Node.prototype,Ro):function Wg(t,r){t.W=!0,t.ca.push(r)}(t,(function(t){b(t,{enumerable:!0,configurable:!0,get:function(){for(var t=[],r=this.firstChild;r;r=r.nextSibling)r.nodeType!==Node.COMMENT_NODE&&t.push(r.textContent);return t.join("")},set:function(t){for(;this.firstChild;)Ao.call(this,this.firstChild);null!=t&&""!==t&&xo.call(this,document.createTextNode(t))}})}))}(t),ph(t),window.CustomElementRegistry=U,t=new U(t),document.__CE_registry=t,Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:t})}function uh(){this.end=this.start=0,this.rules=this.parent=this.previous=null,this.cssText=this.parsedCssText="",this.atRule=!1,this.type=0,this.parsedSelector=this.selector=this.keyframesName=""}function vh(t){var r=t=t.replace(dn,"").replace(un,""),o=new uh;o.start=0,o.end=r.length;for(var i=o,s=0,l=r.length;s<l;s++)if("{"===r[s]){i.rules||(i.rules=[]);var u=i,h=u.rules[u.rules.length-1]||null;(i=new uh).start=s+1,i.parent=u,i.previous=h,u.rules.push(i)}else"}"===r[s]&&(i.end=s+1,i=i.parent||o);return yh(o,t)}function yh(t,r){var o=r.substring(t.start,t.end-1);if(t.parsedCssText=t.cssText=o.trim(),t.parent&&(o=function zh(t){return t.replace(/\\([0-9a-f]{1,6})\s/gi,(function(t,r){for(r=6-(t=r).length;r--;)t="0"+t;return"\\"+t}))}(o=r.substring(t.previous?t.previous.end:t.parent.start,t.start-1)),o=(o=o.replace(vn," ")).substring(o.lastIndexOf(";")+1),o=t.parsedSelector=t.selector=o.trim(),t.atRule=0===o.indexOf("@"),t.atRule?0===o.indexOf("@media")?t.type=cn:o.match(mn)&&(t.type=an,t.keyframesName=t.selector.split(vn).pop()):t.type=0===o.indexOf("--")?ln:sn),o=t.rules)for(var i=0,s=o.length,l=void 0;i<s&&(l=o[i]);i++)yh(l,r);return t}function Gh(t,r,o){o=void 0===o?"":o;var i="";if(t.cssText||t.rules){var s,l=t.rules;if((s=l)&&(s=!((s=l[0])&&s.selector&&0===s.selector.indexOf("--"))),s){s=0;for(var u=l.length,h=void 0;s<u&&(h=l[s]);s++)i=Gh(h,r,i)}else r?r=t.cssText:r=(r=(r=t.cssText).replace(hn,"").replace(pn,"")).replace(fn,"").replace(gn,""),(i=r.trim())&&(i="  "+i+"\n")}return i&&(t.selector&&(o+=t.selector+" {\n"),o+=i,t.selector&&(o+="}\n\n")),o}rn&&!rn.forcePolyfill&&"function"==typeof rn.define&&"function"==typeof rn.get||th(),window.__CE_installPolyfill=th;var on,nn,sn=1,an=7,cn=4,ln=1e3,dn=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,un=/@import[^;]*;/gim,hn=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,pn=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,fn=/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,gn=/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,mn=/^@[^\s]*keyframes/,vn=/\s+/g,yn=!(window.ShadyDOM&&window.ShadyDOM.inUse);function Mh(t){on=(!t||!t.shimcssproperties)&&(yn||!(navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)||!window.CSS||!CSS.supports||!CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&void 0!==window.ShadyCSS.cssBuild&&(nn=window.ShadyCSS.cssBuild);var bn=!(!window.ShadyCSS||!window.ShadyCSS.disableRuntime);window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?on=window.ShadyCSS.nativeCss:window.ShadyCSS?(Mh(window.ShadyCSS),window.ShadyCSS=void 0):Mh(window.WebComponents&&window.WebComponents.flags);var wn=on,Cn=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,_n=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,kn=/(--[\w-]+)\s*([:,;)]|$)/gi,Sn=/(animation\s*:)|(animation-name\s*:)/,Tn=/@media\s(.*)/,En=/\{[^}]*\}/g,xn=new Set;function Wh(t,r){return t?("string"==typeof t&&(t=vh(t)),r&&Xh(t,r),Gh(t,wn)):""}function Yh(t){return!t.__cssRules&&t.textContent&&(t.__cssRules=vh(t.textContent)),t.__cssRules||null}function $h(t){return!!t.parent&&t.parent.type===an}function Xh(t,r,o,i){if(t){var s=!1,l=t.type;if(i&&l===cn){var u=t.selector.match(Tn);u&&(window.matchMedia(u[1]).matches||(s=!0))}if(l===sn?r(t):o&&l===an?o(t):l===ln&&(s=!0),(t=t.rules)&&!s)for(s=0,l=t.length,u=void 0;s<l&&(u=t[s]);s++)Xh(u,r,o,i)}}function ai(t,r,o,i){var s=document.createElement("style");return r&&s.setAttribute("scope",r),s.textContent=t,bi(s,o,i),s}var In=null;function di(t){t=document.createComment(" Shady DOM styles for "+t+" ");var r=document.head;return r.insertBefore(t,(In?In.nextSibling:null)||r.firstChild),In=t}function bi(t,r,o){(r=r||document.head).insertBefore(t,o&&o.nextSibling||r.firstChild),In?t.compareDocumentPosition(In)===Node.DOCUMENT_POSITION_PRECEDING&&(In=t):In=t}function ei(t,r){for(var o=0,i=t.length;r<i;r++)if("("===t[r])o++;else if(")"===t[r]&&0==--o)return r;return-1}function fi(t,r){var o=t.indexOf("var(");if(-1===o)return r(t,"","","");var i=ei(t,o+3),s=t.substring(o+4,i);return o=t.substring(0,o),t=fi(t.substring(i+1),r),-1===(i=s.indexOf(","))?r(o,s.trim(),"",t):r(o,s.substring(0,i).trim(),s.substring(i+1).trim(),t)}function gi(t,r){yn?t.setAttribute("class",r):window.ShadyDOM.nativeMethods.setAttribute.call(t,"class",r)}var An=window.ShadyDOM&&window.ShadyDOM.wrap||function(t){return t};function ii(t){var r=t.localName,o="";return r?-1<r.indexOf("-")||(o=r,r=t.getAttribute&&t.getAttribute("is")||""):(r=t.is,o=t.extends),{is:r,ja:o}}function ji(t){for(var r=[],o="",i=0;0<=i&&i<t.length;i++)if("("===t[i]){var s=ei(t,i);o+=t.slice(i,s+1),i=s}else","===t[i]?(r.push(o),o=""):o+=t[i];return o&&r.push(o),r}function ki(t){if(void 0!==nn)return nn;if(void 0===t.__cssBuild){var r=t.getAttribute("css-build");if(r)t.__cssBuild=r;else{if(""!==(r=(r="template"===t.localName?t.content.firstChild:t.firstChild)instanceof Comment&&"css-build"===(r=r.textContent.trim().split(":"))[0]?r[1]:"")){var o="template"===t.localName?t.content.firstChild:t.firstChild;o.parentNode.removeChild(o)}t.__cssBuild=r}}return t.__cssBuild||""}function li(t){return!(""===(t=void 0===t?"":t)||!wn)&&(yn?"shadow"===t:"shady"===t)}function mi(){}function oi(t,r,o){var i;if(r.nodeType===Node.ELEMENT_NODE&&o(r),i="template"===r.localName?(r.content||r._content||r).childNodes:r.children||r.childNodes)for(r=0;r<i.length;r++)oi(t,i[r],o)}function qi(t,r,o){if(r)if(t.classList)o?(t.classList.remove("style-scope"),t.classList.remove(r)):(t.classList.add("style-scope"),t.classList.add(r));else if(t.getAttribute){var i=t.getAttribute("class");o?i&&gi(t,r=i.replace("style-scope","").replace(r,"")):gi(t,(i?i+" ":"")+"style-scope "+r)}}function ri(t,r,o){oi(Un,t,(function(t){qi(t,r,!0),qi(t,o)}))}function si(t,r){oi(Un,t,(function(t){qi(t,r||"",!0)}))}function ti(t,r,o,i,s){var l=Un;return""===(s=void 0===s?"":s)&&(yn||"shady"===(void 0===i?"":i)?s=Wh(r,o):s=function ui(t,r,o,i,s){var l=vi(o,i);return o=o?"."+o:"",Wh(r,(function(r){r.i||(r.selector=r.G=wi(t,r,t.h,o,l),r.i=!0),s&&s(r,o,l)}))}(l,r,(t=ii(t)).is,t.ja,o)+"\n\n"),s.trim()}function vi(t,r){return r?"[is="+t+"]":t}function wi(t,r,o,i,s){var l=ji(r.selector);if(!$h(r)){r=0;for(var u=l.length,h=void 0;r<u&&(h=l[r]);r++)l[r]=o.call(t,h,i,s)}return l.filter((function(t){return!!t})).join(",")}function xi(t){return t.replace(Pn,(function(t,r,o){return-1<o.indexOf("+")?o=o.replace(/\+/g,"___"):-1<o.indexOf("___")&&(o=o.replace(/___/g,"+")),":"+r+"("+o+")"}))}function Hi(t,r){t=t.split(/(\[.+?\])/);for(var o=[],i=0;i<t.length;i++)if(1==i%2)o.push(t[i]);else{var s=t[i];""===s&&i===t.length-1||((s=s.split(":"))[0]+=r,o.push(s.join(":")))}return o.join("")}function Li(t){":root"===t.selector&&(t.selector="html")}mi.prototype.h=function(t,r,o){var i=!1;t=t.trim();var s=Pn.test(t);s&&(t=xi(t=t.replace(Pn,(function(t,r,o){return":"+r+"("+o.replace(/\s/g,"")+")"}))));var l=Ln.test(t);if(l){var u=function zi(t){for(var r,o=[];r=t.match(Ln);){var i=r.index,s=ei(t,i);if(-1===s)throw Error(r.input+" selector missing ')'");r=t.slice(i,s+1),t=t.replace(r,"î"),o.push(r)}return{Ea:t,matches:o}}(t);t=u.Ea,u=u.matches}return t=(t=t.replace(Nn,":host $1")).replace(Rn,(function(t,s,l){return i||(t=function Ei(t,r,o,i){var s=t.indexOf("::slotted");if(0<=t.indexOf(":host")?t=function Gi(t,r){var o=t.match(Mn);return(o=o&&o[2].trim()||"")?o[0].match(On)?t.replace(Mn,(function(t,o,i){return r+i})):o.split(On)[0]===r?o:"should_not_match":t.replace(":host",r)}(t,i):0!==s&&(t=o?Hi(t,o):t),o=!1,0<=s&&(r="",o=!0),o){var l=!0;o&&(t=t.replace(Dn,(function(t,r){return" > "+r})))}return{value:t,Ya:r,stop:l}}(l,s,r,o),i=i||t.stop,s=t.Ya,l=t.value),s+l})),l&&(t=function Bi(t,r){var o=t.split("î");return r.reduce((function(t,r,i){return t+r+o[i+1]}),o[0])}(t,u)),s&&(t=xi(t)),t.replace(Fn,(function(t,r,o,i){return'[dir="'+o+'"] '+r+i+", "+r+'[dir="'+o+'"]'+i}))},mi.prototype.i=function(t){return t.match(":host")?"":t.match("::slotted")?this.h(t,":not(.style-scope)"):Hi(t.trim(),":not(.style-scope)")},s.Object.defineProperties(mi.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return"style-scope"}}});var Pn=/:(nth[-\w]+)\(([^)]+)\)/,Rn=/(^|[\s>+~]+)((?:\[.+?\]|[^\s>+~=[])+)/g,On=/[[.:#*]/,Nn=/^(::slotted)/,Mn=/(:host)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,Dn=/(?:::slotted)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,Fn=/(.*):dir\((?:(ltr|rtl))\)(.*)/,Ln=/:(?:matches|any|-(?:webkit|moz)-any)/,Un=new mi;function Mi(t,r,o,i,s){this.M=t||null,this.h=r||null,this.Ca=o||[],this.K=null,this.cssBuild=s||"",this.ja=i||"",this.g=this.L=this.R=null}function Ni(t){return t?t.__styleInfo:null}function Oi(t,r){return t.__styleInfo=r}function Pi(t){var r=this.matches||this.matchesSelector||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector;return r&&r.call(this,t)}Mi.prototype.i=function(){return this.M},Mi.prototype._getStyleRules=Mi.prototype.i;var Bn=/:host\s*>\s*/,Hn=navigator.userAgent.match("Trident");function Si(){}function Ui(t){if(!t.F){var r={},o={};Vi(t,o)&&(r.P=o,t.rules=null),r.cssText=t.parsedCssText.replace(En,"").replace(Cn,""),t.F=r}}function Vi(t,r){var o=t.F;if(!o){o=t.parsedCssText;for(var i;t=Cn.exec(o);)"inherit"===(i=(t[2]||t[3]).trim())&&"unset"===i||(r[t[1].trim()]=i),i=!0;return i}if(o.P)return Object.assign(r,o.P),!0}function Wi(t,r,o){return r&&(r=0<=r.indexOf(";")?Xi(t,r,o):fi(r,(function(r,i,s,l){return i?((i=Wi(t,o[i],o))&&"initial"!==i?"apply-shim-inherit"===i&&(i="inherit"):i=Wi(t,o[s]||s,o)||s,r+(i||"")+l):r+l}))),r&&r.trim()||""}function Xi(t,r,o){r=r.split(";");for(var i,s,l=0;l<r.length;l++)if(i=r[l]){if(_n.lastIndex=0,s=_n.exec(i))i=Wi(t,o[s[1]],o);else if(-1!==(s=i.indexOf(":"))){var u=i.substring(s);u=Wi(t,u=u.trim(),o)||u,i=i.substring(0,s)+u}r[l]=i&&i.lastIndexOf(";")===i.length-1?i.slice(0,-1):i||""}return r.join(";")}function $i(t,r,o){var i={},s={};return Xh(r,(function(r){!function Zi(t,r,o,i){if(r.F||Ui(r),r.F.P){var s=ii(t);t=s.is,s=s.ja,s=t?vi(t,s):"html";var l=r.parsedSelector,u=!!l.match(Bn)||"html"===s&&-1<l.indexOf("html"),h=0===l.indexOf(":host")&&!u;"shady"===o&&(h=!(u=l===s+" > *."+s||-1!==l.indexOf("html"))&&0===l.indexOf(s)),(u||h)&&(o=s,h&&(r.G||(r.G=wi(Un,r,Un.h,t?"."+t:"",s)),o=r.G||s),u&&"html"===s&&(o=r.G||r.O),i({Ea:o,gb:h,vb:u}))}}(t,r,o,(function(o){Pi.call(t._element||t,o.Ea)&&(o.gb?Vi(r,i):Vi(r,s))}))}),null,!0),{mb:s,eb:i}}function aj(t,r,o,i){var s=ii(r),l=vi(s.is,s.ja),u=new RegExp("(?:^|[^.#[:])"+(r.extends?"\\"+l.slice(0,-1)+"\\]":l)+"($|[.:[\\s>+~])"),h=Ni(r);s=h.M,h=h.cssBuild;var m=function bj(t,r){t=t.h;var o={};if(!yn&&t)for(var i=0,s=t[i];i<t.length;s=t[++i]){var l=s,u=r;l.u=new RegExp("\\b"+l.keyframesName+"(?!\\B|-)","g"),l.g=l.keyframesName+"-"+u,l.G=l.G||l.selector,l.selector=l.G.replace(l.keyframesName,l.g),o[s.keyframesName]=cj(s)}return o}(s,i);return ti(r,s,(function(r){var s="";if(r.F||Ui(r),r.F.cssText&&(s=Xi(t,r.F.cssText,o)),r.cssText=s,!yn&&!$h(r)&&r.cssText){var h=s=r.cssText;if(null==r.Ma&&(r.Ma=Sn.test(s)),r.Ma)if(null==r.ra)for(var v in r.ra=[],m)s!==(h=(h=m[v])(s))&&(s=h,r.ra.push(v));else{for(v=0;v<r.ra.length;++v)s=(h=m[r.ra[v]])(s);h=s}r.cssText=h,r.G=r.G||r.selector,s="."+i,h=0;for(var C=(v=ji(r.G)).length,_=void 0;h<C&&(_=v[h]);h++)v[h]=_.match(u)?_.replace(l,s):s+" "+_;r.selector=v.join(",")}}),h)}function cj(t){return function(r){return r.replace(t.u,t.g)}}function dj(t,r){var o=$n,i=Yh(t);t.textContent=Wh(i,(function(t){var i=t.cssText=t.parsedCssText;t.F&&t.F.cssText&&(i=i.replace(hn,"").replace(pn,""),t.cssText=Xi(o,i,r))}))}s.Object.defineProperties(Si.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return"x-scope"}}});var $n=new Si,qn={},jn=window.customElements;if(jn&&!yn&&!bn){var zn=jn.define;jn.define=function(t,r,o){qn[t]||(qn[t]=di(t)),zn.call(jn,t,r,o)}}function ij(){this.cache={}}function jj(){}ij.prototype.store=function(t,r,o,i){var s=this.cache[t]||[];s.push({P:r,styleElement:o,L:i}),100<s.length&&s.shift(),this.cache[t]=s};var Gn=new RegExp(Un.g+"\\s*([^\\s]*)");function lj(t){return(t=(t.classList&&t.classList.value?t.classList.value:t.getAttribute("class")||"").match(Gn))?t[1]:""}function mj(t){var r=An(t).getRootNode();return r===t||r===t.ownerDocument?"":(t=r.host)?ii(t).is:""}function nj(t){for(var r=0;r<t.length;r++){var o=t[r];if(o.target!==document.documentElement&&o.target!==document.head)for(var i=0;i<o.addedNodes.length;i++){var s=o.addedNodes[i];if(s.nodeType===Node.ELEMENT_NODE){var l=s.getRootNode(),u=lj(s);if(u&&l===s.ownerDocument&&("style"!==s.localName&&"template"!==s.localName||""===ki(s)))si(s,u);else if(l instanceof ShadowRoot)for((l=mj(s))!==u&&ri(s,u,l),s=window.ShadyDOM.nativeMethods.querySelectorAll.call(s,":not(."+Un.g+")"),u=0;u<s.length;u++){var h=mj(l=s[u]);h&&qi(l,h)}}}}}if(!(yn||window.ShadyDOM&&window.ShadyDOM.handlesDynamicScoping)){var Vn=new MutationObserver(nj),pj=function(t){Vn.observe(t,{childList:!0,subtree:!0})};if(window.customElements&&!window.customElements.polyfillWrapFlushCallback)pj(document);else{var qj=function(){pj(document.body)};window.HTMLImports?window.HTMLImports.whenReady(qj):requestAnimationFrame((function(){if("loading"===document.readyState){var a=function(){qj(),document.removeEventListener("readystatechange",a)};document.addEventListener("readystatechange",a)}else qj()}))}jj=function(){nj(Vn.takeRecords())}}var Kn={},Wn=Promise.resolve();function tj(t){(t=Kn[t])&&(t._applyShimCurrentVersion=t._applyShimCurrentVersion||0,t._applyShimValidatingVersion=t._applyShimValidatingVersion||0,t._applyShimNextVersion=(t._applyShimNextVersion||0)+1)}function uj(t){return t._applyShimCurrentVersion===t._applyShimNextVersion}var Qn={},Yn=new ij;function Y(){this.ea={},this.i=document.documentElement;var t=new uh;t.rules=[],this.u=Oi(this.i,new Mi(t)),this.O=!1,this.g=this.h=null}function zj(t){var r=ii(t),o=r.is;r=r.ja;var i=qn[o]||null,s=Kn[o];if(s)return Oi(t,r=new Mi(o=s._styleAst,i,s.g,r,s=ki(s))),r}function yj(t){if(!t.h&&window.ShadyCSS&&window.ShadyCSS.ApplyShim){t.h=window.ShadyCSS.ApplyShim,t.h.invalidCallback=tj;var r=!0}else r=!1;return function Aj(t){!t.g&&window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface&&(t.g=window.ShadyCSS.CustomStyleInterface,t.g.transformCallback=function(r){t.Qa(r)},t.g.validateCallback=function(){requestAnimationFrame((function(){(t.g.enqueued||t.O)&&t.flushCustomStyles()}))})}(t),r}function Dj(t,r,o){var i=ii(r).is;if(o.K){var s,l=o.K;for(s in l)null===s?r.style.removeProperty(s):r.style.setProperty(s,l[s])}!(l=Kn[i])&&r!==t.i||l&&""!==ki(l)||!l||!l._style||uj(l)||((uj(l)||l._applyShimValidatingVersion!==l._applyShimNextVersion)&&(yj(t),t.h&&t.h.transformRules(l._styleAst,i),l._style.textContent=ti(r,o.M),function vj(t){t._applyShimValidatingVersion=t._applyShimNextVersion,t._validating||(t._validating=!0,Wn.then((function(){t._applyShimCurrentVersion=t._applyShimNextVersion,t._validating=!1})))}(l)),yn&&(t=r.shadowRoot)&&(t=t.querySelector("style"))&&(t.textContent=ti(r,o.M)),o.M=l._styleAst)}function Ej(t,r){return(r=An(r).getRootNode().host)?Ni(r)||zj(r)?r:Ej(t,r):t.i}function Cj(t,r,o){var i=Ej(t,r),s=Ni(i),l=s.R;for(var u in i===t.i||l||(Cj(t,i,s),l=s.R),t=Object.create(l||null),i=$i(r,o.M,o.cssBuild),r=function Yi(t,r){var o={},i=[];return Xh(t,(function(t){t.F||Ui(t);var s=t.G||t.parsedSelector;r&&t.F.P&&s&&Pi.call(r,s)&&(Vi(t,o),t=t.index,s=parseInt(t/32,10),i[s]=(i[s]||0)|1<<t%32)}),null,!0),{P:o,key:i}}(s.M,r).P,Object.assign(t,i.eb,r,i.mb),r=o.K)((s=r[u])||0===s)&&(t[u]=s);for(u=$n,r=Object.getOwnPropertyNames(t),s=0;s<r.length;s++)t[i=r[s]]=Wi(u,t[i],t);o.R=t}(r=Y.prototype).flush=function(){jj()},r.bb=function(t){return Yh(t)},r.qb=function(t){return Wh(t)},r.prepareTemplate=function(t,r,o){this.prepareTemplateDom(t,r),this.prepareTemplateStyles(t,r,o)},r.prepareTemplateStyles=function(t,r,o){if(!t._prepared&&!bn){yn||qn[r]||(qn[r]=di(r)),t._prepared=!0,t.name=r,t.extends=o,Kn[r]=t;var i=ki(t),s=li(i);o={is:r,extends:o};for(var l=[],u=t.content.querySelectorAll("style"),h=0;h<u.length;h++){var m=u[h];if(m.hasAttribute("shady-unscoped")){if(!yn){var v=m.textContent;if(!xn.has(v)){xn.add(v);var C=document.createElement("style");C.setAttribute("shady-unscoped",""),C.textContent=v,document.head.appendChild(C)}m.parentNode.removeChild(m)}}else l.push(m.textContent),m.parentNode.removeChild(m)}l=l.join("").trim()+(Qn[r]||""),yj(this),s||((u=!i)&&(u=_n.test(l)||Cn.test(l),_n.lastIndex=0,Cn.lastIndex=0),h=vh(l),u&&wn&&this.h&&this.h.transformRules(h,r),t._styleAst=h),u=[],wn||(u=function Ti(t){var r={},o=[],i=0;for(var s in Xh(t,(function(t){Ui(t),t.index=i++,t=t.F.cssText;for(var o;o=kn.exec(t);){var s=o[1];":"!==o[2]&&(r[s]=!0)}}),(function(t){o.push(t)})),t.h=o,t=[],r)t.push(s);return t}(t._styleAst)),u.length&&!wn||(h=yn?t.content:null,r=qn[r]||null,i=(i=ti(o,t._styleAst,null,i,s?l:"")).length?ai(i,o.is,h,r):null,t._style=i),t.g=u}},r.kb=function(t,r){Qn[r]=t.join(" ")},r.prepareTemplateDom=function(t,r){if(!bn){var o=ki(t);yn||"shady"===o||t._domPrepared||(t._domPrepared=!0,function ni(t,r){oi(Un,t,(function(t){qi(t,r||"")}))}(t.content,r))}},r.flushCustomStyles=function(){if(!bn){var t=yj(this);if(this.g){var r=this.g.processStyles();if((t||this.g.enqueued)&&!li(this.u.cssBuild)){if(wn){if(!this.u.cssBuild)for(t=0;t<r.length;t++){var o=this.g.getStyleForCustomStyle(r[t]);if(o&&wn&&this.h){var i=Yh(o);yj(this),this.h.transformRules(i),o.textContent=Wh(i)}}}else{for(function Bj(t,r){r=r.map((function(r){return t.g.getStyleForCustomStyle(r)})).filter((function(t){return!!t})),r.sort((function(t,r){return(t=r.compareDocumentPosition(t))&Node.DOCUMENT_POSITION_FOLLOWING?1:t&Node.DOCUMENT_POSITION_PRECEDING?-1:0})),t.u.M.rules=r.map((function(t){return Yh(t)}))}(this,r),Cj(this,this.i,this.u),t=0;t<r.length;t++)(o=this.g.getStyleForCustomStyle(r[t]))&&dj(o,this.u.R);this.O&&this.styleDocument()}this.g.enqueued=!1}}}},r.styleElement=function(t,r){if(bn){if(r){Ni(t)||Oi(t,new Mi(null));var o=Ni(t);o.K=o.K||{},Object.assign(o.K,r),Dj(this,t,o)}}else if(o=Ni(t)||zj(t))if(t!==this.i&&(this.O=!0),r&&(o.K=o.K||{},Object.assign(o.K,r)),wn)Dj(this,t,o);else if(this.flush(),Cj(this,t,o),o.Ca&&o.Ca.length){var i;r=ii(t).is;e:{if(i=Yn.cache[r])for(var s=i.length-1;0<=s;s--){var l=i[s];t:{for(var u=o.Ca,h=0;h<u.length;h++){var m=u[h];if(l.P[m]!==o.R[m]){u=!1;break t}}u=!0}if(u){i=l;break e}}i=void 0}u=i?i.styleElement:null,s=o.L,(l=i&&i.L)||(l=r+"-"+(l=this.ea[r]=(this.ea[r]||0)+1)),o.L=l,l=o.L,h=$n,h=u?u.textContent||"":aj(h,t,o.R,l);var v=(m=Ni(t)).g;v&&!yn&&v!==u&&(v._useCount--,0>=v._useCount&&v.parentNode&&v.parentNode.removeChild(v)),yn?m.g?(m.g.textContent=h,u=m.g):h&&(u=ai(h,l,t.shadowRoot,m.h)):u?u.parentNode||(Hn&&-1<h.indexOf("@media")&&(u.textContent=h),bi(u,null,m.h)):h&&(u=ai(h,l,null,m.h)),u&&(u._useCount=u._useCount||0,m.g!=u&&u._useCount++,m.g=u),l=u,yn||(u=o.L,m=h=t.getAttribute("class")||"",s&&(m=h.replace(new RegExp("\\s*x-scope\\s*"+s+"\\s*","g")," ")),h!==(m+=(m?" ":"")+"x-scope "+u)&&gi(t,m)),i||Yn.store(r,o.R,l,o.L)}},r.styleDocument=function(t){this.styleSubtree(this.i,t)},r.styleSubtree=function(t,r){var o=An(t),i=o.shadowRoot,s=t===this.i;if((i||s)&&this.styleElement(t,r),t=s?o:i)for(t=Array.from(t.querySelectorAll("*")).filter((function(t){return An(t).shadowRoot})),r=0;r<t.length;r++)this.styleSubtree(t[r])},r.Qa=function(t){var r=this,o=ki(t);if(o!==this.u.cssBuild&&(this.u.cssBuild=o),!li(o)){var i=Yh(t);Xh(i,(function(t){if(yn)Li(t);else{var i=Un;t.selector=t.parsedSelector,Li(t),t.selector=t.G=wi(i,t,i.i,void 0,void 0)}wn&&""===o&&(yj(r),r.h&&r.h.transformRule(t))})),wn?t.textContent=Wh(i):this.u.M.rules.push(i)}},r.getComputedStyleValue=function(t,r){var o;return wn||(o=(Ni(t)||Ni(Ej(this,t))).R[r]),(o=o||window.getComputedStyle(t).getPropertyValue(r))?o.trim():""},r.pb=function(t,r){var o=An(t).getRootNode();if(r=r?("string"==typeof r?r:String(r)).split(/\s/):[],!(o=o.host&&o.host.localName)){var i=t.getAttribute("class");if(i){i=i.split(/\s/);for(var s=0;s<i.length;s++)if(i[s]===Un.g){o=i[s+1];break}}}o&&r.push(Un.g,o),wn||(o=Ni(t))&&o.L&&r.push($n.g,o.L),gi(t,r.join(" "))},r.Xa=function(t){return Ni(t)},r.ob=function(t,r){qi(t,r)},r.rb=function(t,r){qi(t,r,!0)},r.nb=function(t){return mj(t)},r.$a=function(t){return lj(t)},Y.prototype.flush=Y.prototype.flush,Y.prototype.prepareTemplate=Y.prototype.prepareTemplate,Y.prototype.styleElement=Y.prototype.styleElement,Y.prototype.styleDocument=Y.prototype.styleDocument,Y.prototype.styleSubtree=Y.prototype.styleSubtree,Y.prototype.getComputedStyleValue=Y.prototype.getComputedStyleValue,Y.prototype.setElementClass=Y.prototype.pb,Y.prototype._styleInfoForNode=Y.prototype.Xa,Y.prototype.transformCustomStyleForDocument=Y.prototype.Qa,Y.prototype.getStyleAst=Y.prototype.bb,Y.prototype.styleAstToString=Y.prototype.qb,Y.prototype.flushCustomStyles=Y.prototype.flushCustomStyles,Y.prototype.scopeNode=Y.prototype.ob,Y.prototype.unscopeNode=Y.prototype.rb,Y.prototype.scopeForNode=Y.prototype.nb,Y.prototype.currentScopeForNode=Y.prototype.$a,Y.prototype.prepareAdoptedCssText=Y.prototype.kb,Object.defineProperties(Y.prototype,{nativeShadow:{get:function(){return yn}},nativeCss:{get:function(){return wn}}});var Jn,Xn,Zn=new Y;window.ShadyCSS&&(Jn=window.ShadyCSS.ApplyShim,Xn=window.ShadyCSS.CustomStyleInterface),window.ShadyCSS={ScopingShim:Zn,prepareTemplate:function(t,r,o){Zn.flushCustomStyles(),Zn.prepareTemplate(t,r,o)},prepareTemplateDom:function(t,r){Zn.prepareTemplateDom(t,r)},prepareTemplateStyles:function(t,r,o){Zn.flushCustomStyles(),Zn.prepareTemplateStyles(t,r,o)},styleSubtree:function(t,r){Zn.flushCustomStyles(),Zn.styleSubtree(t,r)},styleElement:function(t){Zn.flushCustomStyles(),Zn.styleElement(t)},styleDocument:function(t){Zn.flushCustomStyles(),Zn.styleDocument(t)},flushCustomStyles:function(){Zn.flushCustomStyles()},getComputedStyleValue:function(t,r){return Zn.getComputedStyleValue(t,r)},nativeCss:wn,nativeShadow:yn,cssBuild:nn,disableRuntime:bn},Jn&&(window.ShadyCSS.ApplyShim=Jn),Xn&&(window.ShadyCSS.CustomStyleInterface=Xn),function(t){function b(t){return""==t&&(f.call(this),this.m=!0),t.toLowerCase()}function c(t){var r=t.charCodeAt(0);return 32<r&&127>r&&-1==[34,35,60,62,63,96].indexOf(r)?t:encodeURIComponent(t)}function d(t){var r=t.charCodeAt(0);return 32<r&&127>r&&-1==[34,35,60,62,96].indexOf(r)?t:encodeURIComponent(t)}function e(t,r,o){var h=r||"scheme start",m=0,v="",C=!1,_=!1;e:for(;(null!=t[m-1]||0==m)&&!this.m;){var k=t[m];switch(h){case"scheme start":if(!k||!l.test(k)){if(r)break e;v="",h="no scheme";continue}v+=k.toLowerCase(),h="scheme";break;case"scheme":if(k&&u.test(k))v+=k.toLowerCase();else{if(":"!=k){if(r)break e;v="",m=0,h="no scheme";continue}if(this.l=v,v="",r)break e;void 0!==i[this.l]&&(this.H=!0),h="file"==this.l?"relative":this.H&&o&&o.l==this.l?"relative or authority":this.H?"authority first slash":"scheme data"}break;case"scheme data":"?"==k?(this.A="?",h="query"):"#"==k?(this.C="#",h="fragment"):null!=k&&"\t"!=k&&"\n"!=k&&"\r"!=k&&(this.ya+=c(k));break;case"no scheme":if(o&&void 0!==i[o.l]){h="relative";continue}f.call(this),this.m=!0;break;case"relative or authority":if("/"!=k||"/"!=t[m+1]){h="relative";continue}h="authority ignore slashes";break;case"relative":if(this.H=!0,"file"!=this.l&&(this.l=o.l),null==k){this.o=o.o,this.v=o.v,this.s=o.s.slice(),this.A=o.A,this.B=o.B,this.j=o.j;break e}if("/"==k||"\\"==k)h="relative slash";else if("?"==k)this.o=o.o,this.v=o.v,this.s=o.s.slice(),this.A="?",this.B=o.B,this.j=o.j,h="query";else{if("#"!=k){h=t[m+1];var E=t[m+2];("file"!=this.l||!l.test(k)||":"!=h&&"|"!=h||null!=E&&"/"!=E&&"\\"!=E&&"?"!=E&&"#"!=E)&&(this.o=o.o,this.v=o.v,this.B=o.B,this.j=o.j,this.s=o.s.slice(),this.s.pop()),h="relative path";continue}this.o=o.o,this.v=o.v,this.s=o.s.slice(),this.A=o.A,this.C="#",this.B=o.B,this.j=o.j,h="fragment"}break;case"relative slash":if("/"!=k&&"\\"!=k){"file"!=this.l&&(this.o=o.o,this.v=o.v,this.B=o.B,this.j=o.j),h="relative path";continue}h="file"==this.l?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!=k){h="authority ignore slashes";continue}h="authority second slash";break;case"authority second slash":if(h="authority ignore slashes","/"!=k)continue;break;case"authority ignore slashes":if("/"!=k&&"\\"!=k){h="authority";continue}break;case"authority":if("@"==k){for(C&&(v+="%40"),C=!0,k=0;k<v.length;k++)"\t"==(E=v[k])||"\n"==E||"\r"==E||(":"==E&&null===this.j?this.j="":(E=c(E),null!==this.j?this.j+=E:this.B+=E));v=""}else{if(null==k||"/"==k||"\\"==k||"?"==k||"#"==k){m-=v.length,v="",h="host";continue}v+=k}break;case"file host":if(null==k||"/"==k||"\\"==k||"?"==k||"#"==k){2!=v.length||!l.test(v[0])||":"!=v[1]&&"|"!=v[1]?(0!=v.length&&(this.o=b.call(this,v),v=""),h="relative path start"):h="relative path";continue}"\t"==k||"\n"==k||"\r"==k||(v+=k);break;case"host":case"hostname":if(":"!=k||_){if(null==k||"/"==k||"\\"==k||"?"==k||"#"==k){if(this.o=b.call(this,v),v="",h="relative path start",r)break e;continue}"\t"!=k&&"\n"!=k&&"\r"!=k&&("["==k?_=!0:"]"==k&&(_=!1),v+=k)}else if(this.o=b.call(this,v),v="",h="port","hostname"==r)break e;break;case"port":if(/[0-9]/.test(k))v+=k;else{if(null==k||"/"==k||"\\"==k||"?"==k||"#"==k||r){if(""!=v&&((v=parseInt(v,10))!=i[this.l]&&(this.v=v+""),v=""),r)break e;h="relative path start";continue}"\t"==k||"\n"==k||"\r"==k||(f.call(this),this.m=!0)}break;case"relative path start":if(h="relative path","/"!=k&&"\\"!=k)continue;break;case"relative path":null!=k&&"/"!=k&&"\\"!=k&&(r||"?"!=k&&"#"!=k)?"\t"!=k&&"\n"!=k&&"\r"!=k&&(v+=c(k)):((E=s[v.toLowerCase()])&&(v=E),".."==v?(this.s.pop(),"/"!=k&&"\\"!=k&&this.s.push("")):"."==v&&"/"!=k&&"\\"!=k?this.s.push(""):"."!=v&&("file"==this.l&&0==this.s.length&&2==v.length&&l.test(v[0])&&"|"==v[1]&&(v=v[0]+":"),this.s.push(v)),v="","?"==k?(this.A="?",h="query"):"#"==k&&(this.C="#",h="fragment"));break;case"query":r||"#"!=k?null!=k&&"\t"!=k&&"\n"!=k&&"\r"!=k&&(this.A+=d(k)):(this.C="#",h="fragment");break;case"fragment":null!=k&&"\t"!=k&&"\n"!=k&&"\r"!=k&&(this.C+=k)}m++}}function f(){this.B=this.ya=this.l="",this.j=null,this.v=this.o="",this.s=[],this.C=this.A="",this.H=this.m=!1}function g(t,r){void 0===r||r instanceof g||(r=new g(String(r))),this.g=t,f.call(this),e.call(this,this.g.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,""),null,r)}var r=!1;try{var o=new URL("b","http://a");o.pathname="c%20d",r="http://a/c%20d"===o.href}catch(t){}if(!r){var i=Object.create(null);i.ftp=21,i.file=0,i.gopher=70,i.http=80,i.https=443,i.ws=80,i.wss=443;var s=Object.create(null);s["%2e"]=".",s[".%2e"]="..",s["%2e."]="..",s["%2e%2e"]="..";var l=/[a-zA-Z]/,u=/[a-zA-Z0-9+\-.]/;g.prototype={toString:function(){return this.href},get href(){if(this.m)return this.g;var t="";return""==this.B&&null==this.j||(t=this.B+(null!=this.j?":"+this.j:"")+"@"),this.protocol+(this.H?"//"+t+this.host:"")+this.pathname+this.A+this.C},set href(t){f.call(this),e.call(this,t)},get protocol(){return this.l+":"},set protocol(t){this.m||e.call(this,t+":","scheme start")},get host(){return this.m?"":this.v?this.o+":"+this.v:this.o},set host(t){!this.m&&this.H&&e.call(this,t,"host")},get hostname(){return this.o},set hostname(t){!this.m&&this.H&&e.call(this,t,"hostname")},get port(){return this.v},set port(t){!this.m&&this.H&&e.call(this,t,"port")},get pathname(){return this.m?"":this.H?"/"+this.s.join("/"):this.ya},set pathname(t){!this.m&&this.H&&(this.s=[],e.call(this,t,"relative path start"))},get search(){return this.m||!this.A||"?"==this.A?"":this.A},set search(t){!this.m&&this.H&&(this.A="?","?"==t[0]&&(t=t.slice(1)),e.call(this,t,"query"))},get hash(){return this.m||!this.C||"#"==this.C?"":this.C},set hash(t){this.m||(t?(this.C="#","#"==t[0]&&(t=t.slice(1)),e.call(this,t,"fragment")):this.C="")},get origin(){var t;if(this.m||!this.l)return"";switch(this.l){case"data":case"file":case"javascript":case"mailto":return"null"}return(t=this.host)?this.l+"://"+t:""}};var h=t.URL;h&&(g.createObjectURL=function(t){return h.createObjectURL.apply(h,arguments)},g.revokeObjectURL=function(t){h.revokeObjectURL(t)}),t.URL=g}}(window);var ci=window.customElements,hi=!1,pi=null;function Kj(){window.HTMLTemplateElement.bootstrap&&window.HTMLTemplateElement.bootstrap(window.document),pi&&pi(),hi=!0,window.WebComponents.ready=!0,document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))}ci.polyfillWrapFlushCallback&&ci.polyfillWrapFlushCallback((function(t){pi=t,hi&&t()})),"complete"!==document.readyState?(window.addEventListener("load",Kj),window.addEventListener("DOMContentLoaded",(function(){window.removeEventListener("load",Kj),Kj()}))):Kj()}.call(t);class BatchResponse{}const Tx=new Set,Ex="https://graph.microsoft.com";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function __awaiter$J(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))}var xx;[Ex,"https://graph.microsoft.us","https://dod-graph.microsoft.us","https://graph.microsoft.de","https://microsoftgraph.chinacloudapi.cn"].forEach((t=>Tx.add(t))),function(t){t.GET="GET",t.PATCH="PATCH",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE"}(xx||(xx={}));class BatchRequestContent{constructor(t){if(this.requests=new Map,void 0!==t){const r=BatchRequestContent.requestLimit;if(t.length>r){const t=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${r}`);throw t.name="Limit Exceeded Error",t}for(const r of t)this.addRequest(r)}}static validateDependencies(t){if(0===t.size){const t=new Error("Empty requests map, Please provide at least one request.");throw t.name="Empty Requests Error",t}return(t=>{const r=t.entries();let o=r.next();for(;!o.done;){const t=o.value[1];if(void 0!==t.dependsOn&&t.dependsOn.length>0)return!1;o=r.next()}return!0})(t)||(t=>{const r=t.entries();let o=r.next();const i=o.value[1];if(void 0!==i.dependsOn&&i.dependsOn.length>0)return!1;let s=o;for(o=r.next();!o.done;){const t=o.value[1];if(void 0===t.dependsOn||1!==t.dependsOn.length||t.dependsOn[0]!==s.value[1].id)return!1;s=o,o=r.next()}return!0})(t)||(t=>{const r=t.entries();let o=r.next();const i=o.value[1];let s;if(void 0===i.dependsOn||0===i.dependsOn.length)s=i.id;else{if(1!==i.dependsOn.length)return!1;{const r=i.dependsOn[0];if(r===i.id||!t.has(r))return!1;s=r}}for(o=r.next();!o.done;){const t=o.value[1];if((void 0===t.dependsOn||0===t.dependsOn.length)&&s!==t.id)return!1;if(void 0!==t.dependsOn&&0!==t.dependsOn.length){if(1===t.dependsOn.length&&(t.id===s||t.dependsOn[0]!==s))return!1;if(t.dependsOn.length>1)return!1}o=r.next()}return!0})(t)}static getRequestData(t){return __awaiter$J(this,void 0,void 0,(function*(){const r={url:""},o=new RegExp("^https?://");r.url=o.test(t.url)?"/"+t.url.split(/.*?\/\/.*?\//)[1]:t.url,r.method=t.method;const i={};return t.headers.forEach(((t,r)=>{i[r]=t})),Object.keys(i).length&&(r.headers=i),t.method!==xx.PATCH&&t.method!==xx.POST&&t.method!==xx.PUT||(r.body=yield BatchRequestContent.getRequestBody(t)),r}))}static getRequestBody(t){return __awaiter$J(this,void 0,void 0,(function*(){let r,o=!1;try{const i=t.clone();r=yield i.json(),o=!0}catch(t){}if(!o)try{if("undefined"!=typeof Blob){const o=yield t.blob(),i=new FileReader;r=yield new Promise((t=>{i.addEventListener("load",(()=>{const r=i.result,o=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(r);t(o[4])}),!1),i.readAsDataURL(o)}))}else if("undefined"!=typeof Buffer){r=(yield t.buffer()).toString("base64")}o=!0}catch(t){}return r}))}addRequest(t){const r=BatchRequestContent.requestLimit;if(""===t.id){const t=new Error("Id for a request is empty, Please provide an unique id");throw t.name="Empty Id For Request",t}if(this.requests.size===r){const t=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${r}`);throw t.name="Limit Exceeded Error",t}if(this.requests.has(t.id)){const r=new Error(`Adding request with duplicate id ${t.id}, Make the id of the requests unique`);throw r.name="Duplicate RequestId Error",r}return this.requests.set(t.id,t),t.id}removeRequest(t){const r=this.requests.delete(t),o=this.requests.entries();let i=o.next();for(;!i.done;){const r=i.value[1].dependsOn;if(void 0!==r){const o=r.indexOf(t);-1!==o&&r.splice(o,1),0===r.length&&delete i.value[1].dependsOn}i=o.next()}return r}getContent(){return __awaiter$J(this,void 0,void 0,(function*(){const t=[],r={requests:t},o=this.requests.entries();let i=o.next();if(i.done){const t=new Error("No requests added yet, Please add at least one request.");throw t.name="Empty Payload",t}if(!BatchRequestContent.validateDependencies(this.requests)){const t=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw t.name="Invalid Dependency",t}for(;!i.done;){const r=i.value[1],s=yield BatchRequestContent.getRequestData(r.request);if(void 0!==s.body&&(void 0===s.headers||void 0===s.headers["content-type"])){const t=new Error(`Content-type header is not mentioned for request #${r.id}, For request having body, Content-type header should be mentioned`);throw t.name="Invalid Content-type header",t}s.id=r.id,void 0!==r.dependsOn&&r.dependsOn.length>0&&(s.dependsOn=r.dependsOn),t.push(s),i=o.next()}return r.requests=t,r}))}addDependency(t,r){if(!this.requests.has(t)){const r=new Error(`Dependent ${t} does not exists, Please check the id`);throw r.name="Invalid Dependent",r}if(void 0!==r&&!this.requests.has(r)){const t=new Error(`Dependency ${r} does not exists, Please check the id`);throw t.name="Invalid Dependency",t}if(void 0!==r){const o=this.requests.get(t);if(void 0===o.dependsOn&&(o.dependsOn=[]),-1!==o.dependsOn.indexOf(r)){const o=new Error(`Dependency ${r} is already added for the request ${t}`);throw o.name="Duplicate Dependency",o}o.dependsOn.push(r)}else{const o=this.requests.entries();let i,s=o.next();for(;!s.done&&s.value[1].id!==t;)i=s,s=o.next();if(void 0===i){const t=new Error(`Can't add dependency ${r}, There is only a dependent request in the batch`);throw t.name="Invalid Dependency Addition",t}{const r=i.value[0];if(void 0===s.value[1].dependsOn&&(s.value[1].dependsOn=[]),-1!==s.value[1].dependsOn.indexOf(r)){const o=new Error(`Dependency ${r} is already added for the request ${t}`);throw o.name="Duplicate Dependency",o}s.value[1].dependsOn.push(r)}}}removeDependency(t,r){const o=this.requests.get(t);if(void 0===o||void 0===o.dependsOn||0===o.dependsOn.length)return!1;if(void 0!==r){const t=o.dependsOn.indexOf(r);return-1!==t&&(o.dependsOn.splice(t,1),!0)}return delete o.dependsOn,!0}}BatchRequestContent.requestLimit=20;class MiddlewareControl{constructor(t=[]){this.middlewareOptions=new Map;for(const r of t){const t=r.constructor;this.middlewareOptions.set(t,r)}}getMiddlewareOptions(t){return this.middlewareOptions.get(t)}setMiddlewareOptions(t,r){this.middlewareOptions.set(t,r)}}const getRequestHeader=(t,r,o)=>{let i=null;if("undefined"!=typeof Request&&t instanceof Request)i=t.headers.get(o);else if(void 0!==r&&void 0!==r.headers)if("undefined"!=typeof Headers&&r.headers instanceof Headers)i=r.headers.get(o);else if(r.headers instanceof Array){const t=r.headers;for(let r=0,s=t.length;r<s;r++)if(t[r][0]===o){i=t[r][1];break}}else void 0!==r.headers[o]&&(i=r.headers[o]);return i},setRequestHeader=(t,r,o,i)=>{if("undefined"!=typeof Request&&t instanceof Request)t.headers.set(o,i);else if(void 0!==r)if(void 0===r.headers)r.headers=new Headers({[o]:i});else if("undefined"!=typeof Headers&&r.headers instanceof Headers)r.headers.set(o,i);else if(r.headers instanceof Array){let t=0;const s=r.headers.length;for(;t<s;t++){const s=r.headers[t];if(s[0]===o){s[1]=i;break}}t===s&&r.headers.push([o,i])}else Object.assign(r.headers,{[o]:i})},appendRequestHeader=(t,r,o,i)=>{"undefined"!=typeof Request&&t instanceof Request?t.headers.append(o,i):void 0!==r&&(void 0===r.headers?r.headers=new Headers({[o]:i}):"undefined"!=typeof Headers&&r.headers instanceof Headers?r.headers.append(o,i):r.headers instanceof Array?r.headers.push([o,i]):void 0===r.headers?r.headers={[o]:i}:void 0===r.headers[o]?r.headers[o]=i:r.headers[o]+=`, ${i}`)};class AuthenticationHandlerOptions{constructor(t,r){this.authenticationProvider=t,this.authenticationProviderOptions=r}}var Ix;!function(t){t[t.NONE=0]="NONE",t[t.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",t[t.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",t[t.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(Ix||(Ix={}));class TelemetryHandlerOptions{constructor(){this.featureUsage=Ix.NONE}static updateFeatureUsageFlag(t,r){let o;t.middlewareControl instanceof MiddlewareControl?o=t.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions):t.middlewareControl=new MiddlewareControl,void 0===o&&(o=new TelemetryHandlerOptions,t.middlewareControl.setMiddlewareOptions(TelemetryHandlerOptions,o)),o.setFeatureUsage(r)}setFeatureUsage(t){this.featureUsage=this.featureUsage|t}getFeatureUsage(){return this.featureUsage.toString(16)}}class AuthenticationHandler{constructor(t){this.authenticationProvider=t}execute(t){return __awaiter$J(this,void 0,void 0,(function*(){try{let r,o,i;t.middlewareControl instanceof MiddlewareControl&&(r=t.middlewareControl.getMiddlewareOptions(AuthenticationHandlerOptions)),void 0!==r&&(o=r.authenticationProvider,i=r.authenticationProviderOptions),void 0===o&&(o=this.authenticationProvider);const s=`Bearer ${yield o.getAccessToken(i)}`;return appendRequestHeader(t.request,t.options,AuthenticationHandler.AUTHORIZATION_HEADER,s),TelemetryHandlerOptions.updateFeatureUsageFlag(t,Ix.AUTHENTICATION_HANDLER_ENABLED),yield this.nextMiddleware.execute(t)}catch(t){throw t}}))}setNext(t){this.nextMiddleware=t}}AuthenticationHandler.AUTHORIZATION_HEADER="Authorization";class HTTPMessageHandler{execute(t){return __awaiter$J(this,void 0,void 0,(function*(){try{return void(t.response=yield fetch(t.request,t.options))}catch(t){throw t}}))}}class RetryHandlerOptions{constructor(t=RetryHandlerOptions.DEFAULT_DELAY,r=RetryHandlerOptions.DEFAULT_MAX_RETRIES,o=RetryHandlerOptions.DEFAULT_SHOULD_RETRY){if(t>RetryHandlerOptions.MAX_DELAY&&r>RetryHandlerOptions.MAX_MAX_RETRIES){const t=new Error(`Delay and MaxRetries should not be more than ${RetryHandlerOptions.MAX_DELAY} and ${RetryHandlerOptions.MAX_MAX_RETRIES}`);throw t.name="MaxLimitExceeded",t}if(t>RetryHandlerOptions.MAX_DELAY){const t=new Error(`Delay should not be more than ${RetryHandlerOptions.MAX_DELAY}`);throw t.name="MaxLimitExceeded",t}if(r>RetryHandlerOptions.MAX_MAX_RETRIES){const t=new Error(`MaxRetries should not be more than ${RetryHandlerOptions.MAX_MAX_RETRIES}`);throw t.name="MaxLimitExceeded",t}if(t<0&&r<0){const t=new Error("Delay and MaxRetries should not be negative");throw t.name="MinExpectationNotMet",t}if(t<0){const t=new Error("Delay should not be negative");throw t.name="MinExpectationNotMet",t}if(r<0){const t=new Error("MaxRetries should not be negative");throw t.name="MinExpectationNotMet",t}this.delay=Math.min(t,RetryHandlerOptions.MAX_DELAY),this.maxRetries=Math.min(r,RetryHandlerOptions.MAX_MAX_RETRIES),this.shouldRetry=o}getMaxDelay(){return RetryHandlerOptions.MAX_DELAY}}RetryHandlerOptions.DEFAULT_DELAY=3,RetryHandlerOptions.DEFAULT_MAX_RETRIES=3,RetryHandlerOptions.MAX_DELAY=180,RetryHandlerOptions.MAX_MAX_RETRIES=10,RetryHandlerOptions.DEFAULT_SHOULD_RETRY=()=>!0;class RetryHandler{constructor(t=new RetryHandlerOptions){this.options=t}isRetry(t){return-1!==RetryHandler.RETRY_STATUS_CODES.indexOf(t.status)}isBuffered(t,r){const o="string"==typeof t?r.method:t.method;if(o===xx.PUT||o===xx.PATCH||o===xx.POST){if("application/octet-stream"===getRequestHeader(t,r,"Content-Type"))return!1}return!0}getDelay(t,r,o){const getRandomness=()=>Number(Math.random().toFixed(3)),i=void 0!==t.headers?t.headers.get(RetryHandler.RETRY_AFTER_HEADER):null;let s;return s=null!==i?Number.isNaN(Number(i))?Math.round((new Date(i).getTime()-Date.now())/1e3):Number(i):r>=2?this.getExponentialBackOffTime(r)+o+getRandomness():o+getRandomness(),Math.min(s,this.options.getMaxDelay()+getRandomness())}getExponentialBackOffTime(t){return Math.round(.5*(Math.pow(2,t)-1))}sleep(t){return __awaiter$J(this,void 0,void 0,(function*(){const r=1e3*t;return new Promise((t=>setTimeout(t,r)))}))}getOptions(t){let r;return t.middlewareControl instanceof MiddlewareControl&&(r=t.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===r&&(r=Object.assign(new RetryHandlerOptions,this.options)),r}executeWithRetry(t,r,o){return __awaiter$J(this,void 0,void 0,(function*(){try{if(yield this.nextMiddleware.execute(t),r<o.maxRetries&&this.isRetry(t.response)&&this.isBuffered(t.request,t.options)&&o.shouldRetry(o.delay,r,t.request,t.options,t.response)){++r,setRequestHeader(t.request,t.options,RetryHandler.RETRY_ATTEMPT_HEADER,r.toString());const i=this.getDelay(t.response,r,o.delay);return yield this.sleep(i),yield this.executeWithRetry(t,r,o)}return}catch(t){throw t}}))}execute(t){return __awaiter$J(this,void 0,void 0,(function*(){try{const r=0,o=this.getOptions(t);return TelemetryHandlerOptions.updateFeatureUsageFlag(t,Ix.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(t,r,o)}catch(t){throw t}}))}setNext(t){this.nextMiddleware=t}}RetryHandler.RETRY_STATUS_CODES=[429,503,504],RetryHandler.RETRY_ATTEMPT_HEADER="Retry-Attempt",RetryHandler.RETRY_AFTER_HEADER="Retry-After";class RedirectHandlerOptions{constructor(t=RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS,r=RedirectHandlerOptions.DEFAULT_SHOULD_RETRY){if(t>RedirectHandlerOptions.MAX_MAX_REDIRECTS){const t=new Error(`MaxRedirects should not be more than ${RedirectHandlerOptions.MAX_MAX_REDIRECTS}`);throw t.name="MaxLimitExceeded",t}if(t<0){const t=new Error("MaxRedirects should not be negative");throw t.name="MinExpectationNotMet",t}this.maxRedirects=t,this.shouldRedirect=r}}RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS=5,RedirectHandlerOptions.MAX_MAX_REDIRECTS=20,RedirectHandlerOptions.DEFAULT_SHOULD_RETRY=()=>!0;class RedirectHandler$1{constructor(t=new RedirectHandlerOptions){this.options=t}isRedirect(t){return-1!==RedirectHandler$1.REDIRECT_STATUS_CODES.indexOf(t.status)}hasLocationHeader(t){return t.headers.has(RedirectHandler$1.LOCATION_HEADER)}getLocationHeader(t){return t.headers.get(RedirectHandler$1.LOCATION_HEADER)}isRelativeURL(t){return-1===t.indexOf("://")}shouldDropAuthorizationHeader(t,r){const o=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,i=o.exec(t);let s,l;null!==i&&(s=i[0]);const u=o.exec(r);return null!==u&&(l=u[0]),void 0!==s&&void 0!==l&&s!==l}updateRequestUrl(t,r){return __awaiter$J(this,void 0,void 0,(function*(){var o,i;r.request="string"==typeof r.request?t:yield(o=t,i=r.request,__awaiter$J(void 0,void 0,void 0,(function*(){const t=i.headers.get("Content-Type")?yield i.blob():yield Promise.resolve(void 0),{method:r,headers:s,referrer:l,referrerPolicy:u,mode:h,credentials:m,cache:v,redirect:C,integrity:_,keepalive:k,signal:E}=i;return new Request(o,{method:r,headers:s,body:t,referrer:l,referrerPolicy:u,mode:h,credentials:m,cache:v,redirect:C,integrity:_,keepalive:k,signal:E})})))}))}getOptions(t){let r;return t.middlewareControl instanceof MiddlewareControl&&(r=t.middlewareControl.getMiddlewareOptions(RedirectHandlerOptions)),void 0===r&&(r=Object.assign(new RedirectHandlerOptions,this.options)),r}executeWithRedirect(t,r,o){return __awaiter$J(this,void 0,void 0,(function*(){try{yield this.nextMiddleware.execute(t);const i=t.response;if(!(r<o.maxRedirects&&this.isRedirect(i)&&this.hasLocationHeader(i)&&o.shouldRedirect(i)))return;if(++r,i.status===RedirectHandler$1.STATUS_CODE_SEE_OTHER)t.options.method=xx.GET,delete t.options.body;else{const r=this.getLocationHeader(i);!this.isRelativeURL(r)&&this.shouldDropAuthorizationHeader(i.url,r)&&delete t.options.headers[RedirectHandler$1.AUTHORIZATION_HEADER],yield this.updateRequestUrl(r,t)}yield this.executeWithRedirect(t,r,o)}catch(t){throw t}}))}execute(t){return __awaiter$J(this,void 0,void 0,(function*(){try{const r=0,o=this.getOptions(t);return t.options.redirect=RedirectHandler$1.MANUAL_REDIRECT,TelemetryHandlerOptions.updateFeatureUsageFlag(t,Ix.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(t,r,o)}catch(t){throw t}}))}setNext(t){this.nextMiddleware=t}}RedirectHandler$1.REDIRECT_STATUS_CODES=[301,302,303,307,308],RedirectHandler$1.STATUS_CODE_SEE_OTHER=303,RedirectHandler$1.LOCATION_HEADER="Location",RedirectHandler$1.AUTHORIZATION_HEADER="Authorization",RedirectHandler$1.MANUAL_REDIRECT="manual";const Ax=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn"]),Px=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],serializeContent=t=>{const r=t&&t.constructor&&t.constructor.name;if("Buffer"===r||"Blob"===r||"File"===r||"FormData"===r||"string"==typeof t)return t;if("ArrayBuffer"===r)t=Buffer.from(t);else if("Int8Array"===r||"Int16Array"===r||"Int32Array"===r||"Uint8Array"===r||"Uint16Array"===r||"Uint32Array"===r||"Uint8ClampedArray"===r||"Float32Array"===r||"Float64Array"===r||"DataView"===r)t=Buffer.from(t.buffer);else try{t=JSON.stringify(t)}catch(t){throw new Error("Unable to stringify the content")}return t};class TelemetryHandler{execute(t){return __awaiter$J(this,void 0,void 0,(function*(){try{if((t=>{if(-1!==(t=t.toLowerCase()).indexOf("https://")){const r=(t=t.replace("https://","")).indexOf(":"),o=t.indexOf("/");let i="";if(-1!==o)return-1!==r&&r<o?(i=t.substring(0,r),Ax.has(i)):(i=t.substring(0,o),Ax.has(i))}return!1})("string"==typeof t.request?t.request:t.request.url)){let r=getRequestHeader(t.request,t.options,TelemetryHandler.CLIENT_REQUEST_ID_HEADER);r||(r=(()=>{let t="";for(let r=0;r<32;r++)8!==r&&12!==r&&16!==r&&20!==r||(t+="-"),t+=Math.floor(16*Math.random()).toString(16);return t})(),setRequestHeader(t.request,t.options,TelemetryHandler.CLIENT_REQUEST_ID_HEADER,r));let o,i=`${TelemetryHandler.PRODUCT_NAME}/2.2.1`;if(t.middlewareControl instanceof MiddlewareControl&&(o=t.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions)),o){const t=o.getFeatureUsage();i+=` (${TelemetryHandler.FEATURE_USAGE_STRING}=${t})`}appendRequestHeader(t.request,t.options,TelemetryHandler.SDK_VERSION_HEADER,i)}else delete t.options.headers[TelemetryHandler.CLIENT_REQUEST_ID_HEADER],delete t.options.headers[TelemetryHandler.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(t)}catch(t){throw t}}))}setNext(t){this.nextMiddleware=t}}var Rx,Ox,Nx,Mx,Dx;TelemetryHandler.CLIENT_REQUEST_ID_HEADER="client-request-id",TelemetryHandler.SDK_VERSION_HEADER="SdkVersion",TelemetryHandler.PRODUCT_NAME="graph-js",TelemetryHandler.FEATURE_USAGE_STRING="featureUsage",function(t){t[t.MANUAL=0]="MANUAL",t[t.RANDOM=1]="RANDOM"}(Rx||(Rx={}));class CustomAuthenticationProvider{constructor(t){this.provider=t}getAccessToken(){return __awaiter$J(this,void 0,void 0,(function*(){return new Promise(((t,r)=>{this.provider(((o,i)=>{i?t(i):r(o)}))}))}))}}class GraphError extends Error{constructor(t=-1,r,o){super(r||o&&o.message),Object.setPrototypeOf(this,GraphError.prototype),this.statusCode=t,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=o?o.stack:this.stack}}class GraphErrorHandler{static constructError(t,r){const o=new GraphError(r,"",t);return void 0!==t.name&&(o.code=t.name),o.body=t.toString(),o.date=new Date,o}static constructErrorFromResponse(t,r){t=t.error;const o=new GraphError(r,t.message);o.code=t.code,void 0!==t.innerError&&(o.requestId=t.innerError["request-id"],o.date=new Date(t.innerError.date));try{o.body=JSON.stringify(t)}catch(t){}return o}static getError(t=null,r=-1,o){return __awaiter$J(this,void 0,void 0,(function*(){let i;if(i=t&&t.error?GraphErrorHandler.constructErrorFromResponse(t,r):"undefined"!=typeof Error&&t instanceof Error?GraphErrorHandler.constructError(t,r):new GraphError(r),"function"!=typeof o)return i;o(i,null)}))}}!function(t){t.ARRAYBUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.RAW="raw",t.STREAM="stream",t.TEXT="text"}(Ox||(Ox={})),function(t){t.TEXT_HTML="text/html",t.TEXT_XML="text/xml",t.APPLICATION_XML="application/xml",t.APPLICATION_XHTML="application/xhtml+xml"}(Nx||(Nx={})),function(t){t.TEXT_PLAIN="text/plain",t.APPLICATION_JSON="application/json"}(Mx||(Mx={})),function(t){t.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",t.IMAGE="^image\\/.+"}(Dx||(Dx={}));class GraphResponseHandler{static parseDocumentResponse(t,r){try{return"undefined"!=typeof DOMParser?new Promise(((o,i)=>{t.text().then((t=>{try{const i=(new DOMParser).parseFromString(t,r);o(i)}catch(t){i(t)}}))})):Promise.resolve(t.body)}catch(t){throw t}}static convertResponse(t,r){return __awaiter$J(this,void 0,void 0,(function*(){if(204===t.status)return Promise.resolve();let o;try{switch(r){case Ox.ARRAYBUFFER:o=yield t.arrayBuffer();break;case Ox.BLOB:o=yield t.blob();break;case Ox.DOCUMENT:o=yield GraphResponseHandler.parseDocumentResponse(t,Nx.TEXT_XML);break;case Ox.JSON:o=yield t.json();break;case Ox.STREAM:o=yield Promise.resolve(t.body);break;case Ox.TEXT:o=yield t.text();break;default:const r=t.headers.get("Content-type");if(null!==r){const i=r.split(";")[0];o=new RegExp(Dx.DOCUMENT).test(i)?yield GraphResponseHandler.parseDocumentResponse(t,i):new RegExp(Dx.IMAGE).test(i)?t.blob():i===Mx.TEXT_PLAIN?yield t.text():i===Mx.APPLICATION_JSON?yield t.json():Promise.resolve(t.body)}else o=Promise.resolve(t.body)}}catch(t){throw t}return o}))}static getResponse(t,r,o){return __awaiter$J(this,void 0,void 0,(function*(){try{if(r===Ox.RAW)return Promise.resolve(t);{const i=yield GraphResponseHandler.convertResponse(t,r);if(!t.ok)throw i;if("function"!=typeof o)return i;o(null,i)}}catch(t){throw t}}))}}class GraphRequest{constructor(t,r,o){this.parsePath=t=>{if(-1!==t.indexOf("https://")){const r=(t=t.replace("https://","")).indexOf("/");-1!==r&&(this.urlComponents.host="https://"+t.substring(0,r),t=t.substring(r+1,t.length));const o=t.indexOf("/");-1!==o&&(this.urlComponents.version=t.substring(0,o),t=t.substring(o+1,t.length))}"/"===t.charAt(0)&&(t=t.substr(1));const r=t.indexOf("?");if(-1===r)this.urlComponents.path=t;else{this.urlComponents.path=t.substr(0,r);const o=t.substring(r+1,t.length).split("&");for(const t of o)this.parseQueryParameter(t)}},this.httpClient=t,this.config=r,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(o)}addCsvQueryParameter(t,r,o){this.urlComponents.oDataQueryParams[t]=this.urlComponents.oDataQueryParams[t]?this.urlComponents.oDataQueryParams[t]+",":"";let i=[];o.length>1&&"string"==typeof r?i=Array.prototype.slice.call(o):"string"==typeof r?i.push(r):i=i.concat(r),this.urlComponents.oDataQueryParams[t]+=i.join(",")}buildFullUrl(){const t=(t=>{const removePreSlash=t=>t.replace(/^\/+/,"");return Array.prototype.slice.call(t).reduce(((t,r)=>{return[(o=t,o.replace(/\/+$/,"")),removePreSlash(r)].join("/");var o}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(t),t}createQueryString(){const t=this.urlComponents,r=[];if(0!==Object.keys(t.oDataQueryParams).length)for(const o in t.oDataQueryParams)t.oDataQueryParams.hasOwnProperty(o)&&r.push(o+"="+t.oDataQueryParams[o]);if(0!==Object.keys(t.otherURLQueryParams).length)for(const o in t.otherURLQueryParams)t.otherURLQueryParams.hasOwnProperty(o)&&r.push(o+"="+t.otherURLQueryParams[o]);if(0!==t.otherURLQueryOptions.length)for(const o of t.otherURLQueryOptions)r.push(o);return r.length>0?"?"+r.join("&"):""}parseQueryParameter(t){if("string"==typeof t)if("?"===t.charAt(0)&&(t=t.substring(1)),-1!==t.indexOf("&")){const r=t.split("&");for(const t of r)this.parseQueryParamenterString(t)}else this.parseQueryParamenterString(t);else if(t.constructor===Object)for(const r in t)t.hasOwnProperty(r)&&this.setURLComponentsQueryParamater(r,t[r]);return this}parseQueryParamenterString(t){if(this.isValidQueryKeyValuePair(t)){const r=t.indexOf("="),o=t.substring(0,r),i=t.substring(r+1);this.setURLComponentsQueryParamater(o,i)}else this.urlComponents.otherURLQueryOptions.push(t)}setURLComponentsQueryParamater(t,r){if(-1!==Px.indexOf(t)){const o=this.urlComponents.oDataQueryParams[t],i=o&&("$expand"===t||"$select"===t||"$orderby"===t);this.urlComponents.oDataQueryParams[t]=i?o+","+r:r}else this.urlComponents.otherURLQueryParams[t]=r}isValidQueryKeyValuePair(t){const r=t.indexOf("=");if(-1===r)return!1;return!(-1!==t.indexOf("(")&&t.indexOf("(")<r)}updateRequestOptions(t){const r=Object.assign({},t.headers);if(void 0!==this.config.fetchOptions){const r=Object.assign({},this.config.fetchOptions);Object.assign(t,r),void 0!==typeof this.config.fetchOptions.headers&&(t.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(t,this._options),void 0!==t.headers&&Object.assign(r,t.headers),Object.assign(r,this._headers),t.headers=r}send(t,r,o){return __awaiter$J(this,void 0,void 0,(function*(){let i;const s=new MiddlewareControl(this._middlewareOptions);this.updateRequestOptions(r);try{i=(yield this.httpClient.sendRequest({request:t,options:r,middlewareControl:s})).response;return yield GraphResponseHandler.getResponse(i,this._responseType,o)}catch(t){let r;void 0!==i&&(r=i.status);throw yield GraphErrorHandler.getError(t,r,o)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const t=Object.keys(this._headers);for(const r of t)if("content-type"===r.toLowerCase())return;this.header("Content-Type","application/json")}header(t,r){return this._headers[t]=r,this}headers(t){for(const r in t)t.hasOwnProperty(r)&&(this._headers[r]=t[r]);return this}option(t,r){return this._options[t]=r,this}options(t){for(const r in t)t.hasOwnProperty(r)&&(this._options[r]=t[r]);return this}middlewareOptions(t){return this._middlewareOptions=t,this}version(t){return this.urlComponents.version=t,this}responseType(t){return this._responseType=t,this}select(t){return this.addCsvQueryParameter("$select",t,arguments),this}expand(t){return this.addCsvQueryParameter("$expand",t,arguments),this}orderby(t){return this.addCsvQueryParameter("$orderby",t,arguments),this}filter(t){return this.urlComponents.oDataQueryParams.$filter=t,this}search(t){return this.urlComponents.oDataQueryParams.$search=t,this}top(t){return this.urlComponents.oDataQueryParams.$top=t,this}skip(t){return this.urlComponents.oDataQueryParams.$skip=t,this}skipToken(t){return this.urlComponents.oDataQueryParams.$skipToken=t,this}count(t=!1){return this.urlComponents.oDataQueryParams.$count=t.toString(),this}query(t){return this.parseQueryParameter(t)}get(t){return __awaiter$J(this,void 0,void 0,(function*(){const r=this.buildFullUrl(),o={method:xx.GET};try{return yield this.send(r,o,t)}catch(t){throw t}}))}post(t,r){return __awaiter$J(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),i={method:xx.POST,body:serializeContent(t)};"FormData"===(t&&t.constructor&&t.constructor.name)?i.headers={}:(this.setHeaderContentType(),i.headers=this._headers);try{return yield this.send(o,i,r)}catch(t){throw t}}))}create(t,r){return __awaiter$J(this,void 0,void 0,(function*(){try{return yield this.post(t,r)}catch(t){throw t}}))}put(t,r){return __awaiter$J(this,void 0,void 0,(function*(){const o=this.buildFullUrl();this.setHeaderContentType();const i={method:xx.PUT,body:serializeContent(t)};try{return yield this.send(o,i,r)}catch(t){throw t}}))}patch(t,r){return __awaiter$J(this,void 0,void 0,(function*(){const o=this.buildFullUrl();this.setHeaderContentType();const i={method:xx.PATCH,body:serializeContent(t)};try{return yield this.send(o,i,r)}catch(t){throw t}}))}update(t,r){return __awaiter$J(this,void 0,void 0,(function*(){try{return yield this.patch(t,r)}catch(t){throw t}}))}delete(t){return __awaiter$J(this,void 0,void 0,(function*(){const r=this.buildFullUrl(),o={method:xx.DELETE};try{return yield this.send(r,o,t)}catch(t){throw t}}))}del(t){return __awaiter$J(this,void 0,void 0,(function*(){try{return yield this.delete(t)}catch(t){throw t}}))}getStream(t){return __awaiter$J(this,void 0,void 0,(function*(){const r=this.buildFullUrl(),o={method:xx.GET};this.responseType(Ox.STREAM);try{return yield this.send(r,o,t)}catch(t){throw t}}))}putStream(t,r){return __awaiter$J(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),i={method:xx.PUT,headers:{"Content-Type":"application/octet-stream"},body:t};try{return yield this.send(o,i,r)}catch(t){throw t}}))}}class HTTPClient{constructor(...t){if(!t||!t.length){const t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Please provide a default middleware chain or custom middleware chain",t}this.setMiddleware(...t)}setMiddleware(...t){t.length>1?this.parseMiddleWareArray(t):this.middleware=t[0]}parseMiddleWareArray(t){t.forEach(((r,o)=>{o<t.length-1&&r.setNext(t[o+1])})),this.middleware=t[0]}sendRequest(t){return __awaiter$J(this,void 0,void 0,(function*(){try{if("string"==typeof t.request&&void 0===t.options){const t=new Error;throw t.name="InvalidRequestOptions",t.message="Unable to execute the middleware, Please provide valid options for a request",t}return yield this.middleware.execute(t),t}catch(t){throw t}}))}}class HTTPClientFactory{static createWithAuthenticationProvider(t){const r=new AuthenticationHandler(t),o=new RetryHandler(new RetryHandlerOptions),i=new TelemetryHandler,s=new HTTPMessageHandler;if(r.setNext(o),"object"==typeof process&&"function"==typeof require){const t=new RedirectHandler$1(new RedirectHandlerOptions);o.setNext(t),t.setNext(i)}else o.setNext(i);return i.setNext(s),HTTPClientFactory.createWithMiddleware(r)}static createWithMiddleware(...t){return new HTTPClient(...t)}}class Client{constructor(t){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"};try{(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const t=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw t.name="PolyFillNotAvailable",t}if("undefined"==typeof Promise){const t=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}if("undefined"==typeof fetch){const t=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}})()}catch(t){throw t}for(const r in t)t.hasOwnProperty(r)&&(this.config[r]=t[r]);let r;if(void 0!==t.authProvider&&void 0!==t.middleware){const t=new Error;throw t.name="AmbiguityInInitialization",t.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",t}if(void 0!==t.authProvider)r=HTTPClientFactory.createWithAuthenticationProvider(t.authProvider);else{if(void 0===t.middleware){const t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",t}r=new HTTPClient(...[].concat(t.middleware))}this.httpClient=r}static init(t){const r={};for(const o in t)t.hasOwnProperty(o)&&(r[o]="authProvider"===o?new CustomAuthenticationProvider(t[o]):t[o]);return Client.initWithMiddleware(r)}static initWithMiddleware(t){try{return new Client(t)}catch(t){throw t}}api(t){return new GraphRequest(this.httpClient,this.config,t)}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics$2=function(t,r){return extendStatics$2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])},extendStatics$2(t,r)};function __extends$2(t,r){function __(){this.constructor=t}extendStatics$2(t,r),t.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}var __assign$2=function(){return __assign$2=Object.assign||function __assign(t){for(var r,o=1,i=arguments.length;o<i;o++)for(var s in r=arguments[o])Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s]);return t},__assign$2.apply(this,arguments)};function __awaiter$I(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))}function __generator$2(t,r){var o,i,s,l,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(l){return function(h){return function step(l){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=2&l[0]?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return u.label++,{value:l[1],done:!1};case 5:u.label++,i=l[1],l=[0];continue;case 7:l=u.ops.pop(),u.trys.pop();continue;default:if(!(s=u.trys,(s=s.length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){u=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){u.label=l[1];break}if(6===l[0]&&u.label<s[1]){u.label=s[1],s=l;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(l);break}s[2]&&u.ops.pop(),u.trys.pop();continue}l=r.call(t,u)}catch(t){l=[6,t],i=0}finally{o=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,h])}}}function __spreadArrays$1(){for(var t=0,r=0,o=arguments.length;r<o;r++)t+=arguments[r].length;var i=Array(t),s=0;for(r=0;r<o;r++)for(var l=arguments[r],u=0,h=l.length;u<h;u++,s++)i[s]=l[u];return i}var Fx,Lx=function(){function CryptoUtils(){}return CryptoUtils.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,CryptoUtils.decimalToHex(r[0])+CryptoUtils.decimalToHex(r[1])+CryptoUtils.decimalToHex(r[2])+CryptoUtils.decimalToHex(r[3])+"-"+CryptoUtils.decimalToHex(r[4])+CryptoUtils.decimalToHex(r[5])+"-"+CryptoUtils.decimalToHex(r[6])+CryptoUtils.decimalToHex(r[7])+"-"+CryptoUtils.decimalToHex(r[8])+CryptoUtils.decimalToHex(r[9])+"-"+CryptoUtils.decimalToHex(r[10])+CryptoUtils.decimalToHex(r[11])+CryptoUtils.decimalToHex(r[12])+CryptoUtils.decimalToHex(r[13])+CryptoUtils.decimalToHex(r[14])+CryptoUtils.decimalToHex(r[15])}for(var o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",i="0123456789abcdef",s=0,l="",u=0;u<36;u++)"-"!==o[u]&&"4"!==o[u]&&(s=16*Math.random()|0),"x"===o[u]?l+=i[s]:"y"===o[u]?(s&=3,l+=i[s|=8]):l+=o[u];return l},CryptoUtils.isGuid=function(t){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)},CryptoUtils.decimalToHex=function(t){for(var r=t.toString(16);r.length<2;)r="0"+r;return r},CryptoUtils.base64Encode=function(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function toSolidBytes(t,r){return String.fromCharCode(Number("0x"+r))})))},CryptoUtils.base64Decode=function(t){var r=t.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(r).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""))},CryptoUtils.deserialize=function(t){var r,o=/\+/g,i=/([^&=]+)=([^&]*)/g,decode=function(t){return decodeURIComponent(t.replace(o," "))},s={};for(r=i.exec(t);r;)s[decode(r[1])]=decode(r[2]),r=i.exec(t);return s},CryptoUtils}(),Ux=function(){function Constants(){}return Object.defineProperty(Constants,"libraryName",{get:function(){return"Msal.js"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"claims",{get:function(){return"claims"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"clientId",{get:function(){return"clientId"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"cachePrefix",{get:function(){return"msal"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"scopes",{get:function(){return"scopes"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"upn",{get:function(){return"upn"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"domain_hint",{get:function(){return"domain_hint"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"prompt",{get:function(){return"prompt"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"resourceDelimiter",{get:function(){return"|"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"cacheDelimiter",{get:function(){return"."},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"popUpWidth",{get:function(){return this._popUpWidth},set:function(t){this._popUpWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"popUpHeight",{get:function(){return this._popUpHeight},set:function(t){this._popUpHeight=t},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"login",{get:function(){return"LOGIN"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"unknown",{get:function(){return"UNKNOWN"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"ADFS",{get:function(){return"adfs"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"common",{get:function(){return"common"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"openidScope",{get:function(){return"openid"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"profileScope",{get:function(){return"profile"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(Constants,"inProgress",{get:function(){return"inProgress"},enumerable:!1,configurable:!0}),Constants._popUpWidth=483,Constants._popUpHeight=600,Constants}();!function(t){t.SCOPE="scope",t.STATE="state",t.ERROR="error",t.ERROR_DESCRIPTION="error_description",t.ACCESS_TOKEN="access_token",t.ID_TOKEN="id_token",t.EXPIRES_IN="expires_in",t.SESSION_STATE="session_state",t.CLIENT_INFO="client_info"}(Fx||(Fx={}));var Bx,Hx,$x,qx="id_token",jx="token",zx="id_token token";!function(t){t.AUTHORITY="authority",t.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",t.SESSION_STATE="session.state",t.STATE_LOGIN="state.login",t.STATE_ACQ_TOKEN="state.acquireToken",t.STATE_RENEW="state.renew",t.NONCE_IDTOKEN="nonce.idtoken",t.LOGIN_REQUEST="login.request",t.RENEW_STATUS="token.renew.status",t.URL_HASH="urlHash",t.INTERACTION_STATUS="interaction.status",t.REDIRECT_REQUEST="redirect_request"}(Bx||(Bx={})),function(t){t.IDTOKEN="idtoken",t.CLIENT_INFO="client.info"}(Hx||(Hx={})),function(t){t.LOGIN_ERROR="login.error",t.ERROR="error",t.ERROR_DESC="error.description"}($x||($x={}));var Gx,Vx=".well-known/openid-configuration";!function(t){t.ACCOUNT="account",t.SID="sid",t.LOGIN_HINT="login_hint",t.ORGANIZATIONS="organizations",t.CONSUMERS="consumers",t.ID_TOKEN="id_token",t.ACCOUNT_ID="accountIdentifier",t.HOMEACCOUNT_ID="homeAccountIdentifier"}(Gx||(Gx={}));var Kx,Wx=[Gx.SID,Gx.LOGIN_HINT],Qx="GET",Yx={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},Jx="msalIdTokenFrame",Xx="msalRenewFrame",Zx={code:"unexpected_error",desc:"Unexpected error in authentication."},eI={code:"no_window_object",desc:"No window object available. Details:"},tI=function(t){function AuthError(r,o){var i=t.call(this,o)||this;return Object.setPrototypeOf(i,AuthError.prototype),i.errorCode=r,i.errorMessage=o,i.name="AuthError",i}return __extends$2(AuthError,t),AuthError.createUnexpectedError=function(t){return new AuthError(Zx.code,Zx.desc+": "+t)},AuthError.createNoWindowObjectError=function(t){return new AuthError(eI.code,eI.desc+" "+t)},AuthError}(Error),rI=function(){function StringUtils(){}return StringUtils.isEmpty=function(t){return void 0===t||!t||0===t.length},StringUtils.validateAndParseJsonCacheKey=function(t){try{var r=JSON.parse(t);return r&&"object"==typeof r?r:null}catch(t){return null}},StringUtils}(),oI={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},nI={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},iI={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},sI={code:"invalid_id_token",desc:"Invalid ID token format."},aI={code:"invalid_state_error",desc:"Invalid state."},cI={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},lI={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},dI={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},uI={code:"user_cancelled",desc:"User cancelled the flow."},hI={code:"callback_error",desc:"Error occurred in token received callback function."},pI={code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},fI={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},gI={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},mI={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},vI={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},yI={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},bI={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},wI={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},CI={code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},_I={code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"},kI=function(t){function ClientAuthError(r,o){var i=t.call(this,r,o)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,ClientAuthError.prototype),i}return __extends$2(ClientAuthError,t),ClientAuthError.createEndpointResolutionError=function(t){var r=oI.desc;return t&&!rI.isEmpty(t)&&(r+=" Details: "+t),new ClientAuthError(oI.code,r)},ClientAuthError.createPopupWindowError=function(t){var r=nI.desc;return t&&!rI.isEmpty(t)&&(r+=" Details: "+t),new ClientAuthError(nI.code,r)},ClientAuthError.createTokenRenewalTimeoutError=function(){return new ClientAuthError(iI.code,iI.desc)},ClientAuthError.createInvalidIdTokenError=function(t){return new ClientAuthError(sI.code,sI.desc+" Given token: "+t)},ClientAuthError.createInvalidStateError=function(t,r){return new ClientAuthError(aI.code,aI.desc+" "+t+", state expected : "+r+".")},ClientAuthError.createNonceMismatchError=function(t,r){return new ClientAuthError(cI.code,cI.desc+" "+t+", nonce expected : "+r+".")},ClientAuthError.createLoginInProgressError=function(){return new ClientAuthError(lI.code,lI.desc)},ClientAuthError.createAcquireTokenInProgressError=function(){return new ClientAuthError(dI.code,dI.desc)},ClientAuthError.createUserCancelledError=function(){return new ClientAuthError(uI.code,uI.desc)},ClientAuthError.createErrorInCallbackFunction=function(t){return new ClientAuthError(hI.code,hI.desc+" "+t+".")},ClientAuthError.createUserLoginRequiredError=function(){return new ClientAuthError(pI.code,pI.desc)},ClientAuthError.createUserDoesNotExistError=function(){return new ClientAuthError(fI.code,fI.desc)},ClientAuthError.createClientInfoDecodingError=function(t){return new ClientAuthError(gI.code,gI.desc+" Failed with error: "+t)},ClientAuthError.createClientInfoNotPopulatedError=function(t){return new ClientAuthError(mI.code,mI.desc+" Failed with error: "+t)},ClientAuthError.createIdTokenNullOrEmptyError=function(t){return new ClientAuthError(vI.code,vI.desc+" Raw ID Token Value: "+t)},ClientAuthError.createIdTokenParsingError=function(t){return new ClientAuthError(yI.code,yI.desc+" Failed with error: "+t)},ClientAuthError.createTokenEncodingError=function(t){return new ClientAuthError(bI.code,bI.desc+" Attempted to decode: "+t)},ClientAuthError.createInvalidInteractionTypeError=function(){return new ClientAuthError(wI.code,wI.desc)},ClientAuthError.createCacheParseError=function(t){var r="invalid key: "+t+", "+CI.desc;return new ClientAuthError(CI.code,r)},ClientAuthError.createBlockTokenRequestsInHiddenIframeError=function(){return new ClientAuthError(_I.code,_I.desc)},ClientAuthError}(tI),SI={code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},TI={code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},EI={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},xI={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},II={code:"scopes_required",desc:"Scopes are required to obtain an access token."},AI={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},PI={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},RI={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},OI={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},NI={code:"authority_uri_insecure",desc:"Authority URIs must use https."},MI={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},DI={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},FI={code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},LI={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},UI={code:"empty_request_error",desc:"Request object is required."},BI={code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},HI={code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},$I={code:"sso_silent_error",desc:"request must contain either sid or login_hint"},qI={code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."},jI=function(t){function ClientConfigurationError(r,o){var i=t.call(this,r,o)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,ClientConfigurationError.prototype),i}return __extends$2(ClientConfigurationError,t),ClientConfigurationError.createNoSetConfigurationError=function(){return new ClientConfigurationError(SI.code,""+SI.desc)},ClientConfigurationError.createStorageNotSupportedError=function(t){return new ClientConfigurationError(TI.code,TI.desc+" Given location: "+t)},ClientConfigurationError.createRedirectCallbacksNotSetError=function(){return new ClientConfigurationError(EI.code,EI.desc)},ClientConfigurationError.createInvalidCallbackObjectError=function(t){return new ClientConfigurationError(xI.code,xI.desc+" Given value for callback function: "+t)},ClientConfigurationError.createEmptyScopesArrayError=function(t){return new ClientConfigurationError(AI.code,AI.desc+" Given value: "+t+".")},ClientConfigurationError.createScopesNonArrayError=function(t){return new ClientConfigurationError(PI.code,PI.desc+" Given value: "+t+".")},ClientConfigurationError.createScopesRequiredError=function(t){return new ClientConfigurationError(II.code,II.desc+" Given value: "+t)},ClientConfigurationError.createInvalidPromptError=function(t){return new ClientConfigurationError(RI.code,RI.desc+" Given value: "+t)},ClientConfigurationError.createClaimsRequestParsingError=function(t){return new ClientConfigurationError(LI.code,LI.desc+" Given value: "+t)},ClientConfigurationError.createEmptyRequestError=function(){var t=UI;return new ClientConfigurationError(t.code,t.desc)},ClientConfigurationError.createInvalidCorrelationIdError=function(){return new ClientConfigurationError(BI.code,BI.desc)},ClientConfigurationError.createKnownAuthoritiesNotSetError=function(){return new ClientConfigurationError(FI.code,FI.desc)},ClientConfigurationError.createInvalidAuthorityTypeError=function(){return new ClientConfigurationError(OI.code,OI.desc)},ClientConfigurationError.createUntrustedAuthorityError=function(t){return new ClientConfigurationError(DI.code,DI.desc+" Provided Authority: "+t)},ClientConfigurationError.createTelemetryConfigError=function(t){var r=HI,o=r.code,i=r.desc,s={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"},l=Object.keys(s).reduce((function(r,o){return t[o]?r:r.concat([o+" ("+s[o]+")"])}),[]);return new ClientConfigurationError(o,i+" mising values: "+l.join(","))},ClientConfigurationError.createSsoSilentError=function(){return new ClientConfigurationError($I.code,$I.desc)},ClientConfigurationError.createInvalidAuthorityMetadataError=function(){return new ClientConfigurationError(qI.code,qI.desc)},ClientConfigurationError}(kI),zI=function(){function ScopeSet(){}return ScopeSet.isIntersectingScopes=function(t,r){for(var o=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(t)),i=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(r)),s=0;s<i.length;s++)if(o.indexOf(i[s].toLowerCase())>-1)return!0;return!1},ScopeSet.containsScope=function(t,r){var o=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(t));return this.trimAndConvertArrayToLowerCase(__spreadArrays$1(r)).every((function(t){return o.indexOf(t.toString().toLowerCase())>=0}))},ScopeSet.trimAndConvertToLowerCase=function(t){return t.trim().toLowerCase()},ScopeSet.trimAndConvertArrayToLowerCase=function(t){var r=this;return t.map((function(t){return r.trimAndConvertToLowerCase(t)}))},ScopeSet.trimScopes=function(t){return t.map((function(t){return t.trim()}))},ScopeSet.removeElement=function(t,r){var o=this.trimAndConvertToLowerCase(r);return t.filter((function(t){return t!==o}))},ScopeSet.parseScope=function(t){var r="";if(t)for(var o=0;o<t.length;++o)r+=o!==t.length-1?t[o]+" ":t[o];return r},ScopeSet.validateInputScope=function(t,r){if(t){if(!Array.isArray(t))throw jI.createScopesNonArrayError(t);if(t.length<1&&r)throw jI.createEmptyScopesArrayError(t.toString())}else if(r)throw jI.createScopesRequiredError(t)},ScopeSet.getScopeFromState=function(t){if(t){var r=t.indexOf(Ux.resourceDelimiter);if(r>-1&&r+1<t.length)return t.substring(r+1)}return""},ScopeSet.appendScopes=function(t,r){if(t){var o=r?this.trimAndConvertArrayToLowerCase(__spreadArrays$1(r)):null,i=this.trimAndConvertArrayToLowerCase(__spreadArrays$1(t));return o?__spreadArrays$1(i,o):i}return null},ScopeSet.onlyContainsOidcScopes=function(t){var r=t.length,o=0;return t.indexOf(Ux.openidScope)>-1&&(o+=1),t.indexOf(Ux.profileScope)>-1&&(o+=1),r>0&&r===o},ScopeSet.containsAnyOidcScopes=function(t){var r=t.indexOf(Ux.openidScope)>-1,o=t.indexOf(Ux.profileScope)>-1;return r||o},ScopeSet.onlyContainsClientId=function(t,r){return!!t&&t.indexOf(r)>-1&&1===t.length},ScopeSet.appendDefaultScopes=function(t){var r=t;return-1===r.indexOf(Ux.openidScope)&&r.push(Ux.openidScope),-1===r.indexOf(Ux.profileScope)&&r.push(Ux.profileScope),r},ScopeSet.removeDefaultScopes=function(t){return t.filter((function(t){return t!==Ux.openidScope&&t!==Ux.profileScope}))},ScopeSet.translateClientIdIfSingleScope=function(t,r){return this.onlyContainsClientId(t,r)?Ux.oidcScopes:t},ScopeSet}(),GI=function(){function UrlUtils(){}return UrlUtils.createNavigateUrl=function(t){var r=this.createNavigationUrlString(t),o=t.authorityInstance.AuthorizationEndpoint;return o.indexOf("?")<0?o+="?":o+="&",""+o+r.join("&")},UrlUtils.createNavigationUrlString=function(t){var r=zI.appendDefaultScopes(t.scopes),o=[];return o.push("response_type="+t.responseType),o.push("scope="+encodeURIComponent(zI.parseScope(r))),o.push("client_id="+encodeURIComponent(t.clientId)),o.push("redirect_uri="+encodeURIComponent(t.redirectUri)),o.push("state="+encodeURIComponent(t.state)),o.push("nonce="+encodeURIComponent(t.nonce)),o.push("client_info=1"),o.push("x-client-SKU="+t.xClientSku),o.push("x-client-Ver="+t.xClientVer),t.promptValue&&o.push("prompt="+encodeURIComponent(t.promptValue)),t.claimsValue&&o.push("claims="+encodeURIComponent(t.claimsValue)),t.queryParameters&&o.push(t.queryParameters),t.extraQueryParameters&&o.push(t.extraQueryParameters),o.push("client-request-id="+encodeURIComponent(t.correlationId)),o},UrlUtils.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},UrlUtils.removeHashFromUrl=function(t){return t.split("#")[0]},UrlUtils.replaceTenantPath=function(t,r){var o=t.toLowerCase(),i=this.GetUrlComponents(o),s=i.PathSegments;return!r||0===s.length||s[0]!==Ux.common&&s[0]!==Gx.ORGANIZATIONS&&s[0]!==Gx.CONSUMERS||(s[0]=r),this.constructAuthorityUriFromObject(i,s)},UrlUtils.constructAuthorityUriFromObject=function(t,r){return this.CanonicalizeUri(t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/"))},UrlUtils.isCommonAuthority=function(t){var r=this.CanonicalizeUri(t),o=this.GetUrlComponents(r).PathSegments;return 0!==o.length&&o[0]===Ux.common},UrlUtils.isOrganizationsAuthority=function(t){var r=this.CanonicalizeUri(t),o=this.GetUrlComponents(r).PathSegments;return 0!==o.length&&o[0]===Gx.ORGANIZATIONS},UrlUtils.isConsumersAuthority=function(t){var r=this.CanonicalizeUri(t),o=this.GetUrlComponents(r).PathSegments;return 0!==o.length&&o[0]===Gx.CONSUMERS},UrlUtils.GetUrlComponents=function(t){if(!t)throw"Url required";var r=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),o=t.match(r);if(!o||o.length<6)throw"Valid url required";var i={Protocol:o[1],HostNameAndPort:o[4],AbsolutePath:o[5]},s=i.AbsolutePath.split("/");return s=s.filter((function(t){return t&&t.length>0})),i.PathSegments=s,o[6]&&(i.Search=o[6]),o[8]&&(i.Hash=o[8]),i},UrlUtils.CanonicalizeUri=function(t){if(t){var r=t.toLowerCase();return UrlUtils.endsWith(r,"/")||(r+="/"),r}return t},UrlUtils.endsWith=function(t,r){return!(!t||!r)&&-1!==t.indexOf(r,t.length-r.length)},UrlUtils.urlRemoveQueryStringParameter=function(t,r){if(rI.isEmpty(t))return t;var o=new RegExp("(\\&"+r+"=)[^&]+");return t.replace(o,""),o=new RegExp("("+r+"=)[^&]+&"),t.replace(o,""),o=new RegExp("("+r+"=)[^&]+"),t.replace(o,"")},UrlUtils.getHashFromUrl=function(t){var r=t.indexOf("#"),o=t.indexOf("#/");return o>-1?t.substring(o+2):r>-1?t.substring(r+1):t},UrlUtils.urlContainsHash=function(t){var r=UrlUtils.deserializeHash(t);return r.hasOwnProperty(Fx.ERROR_DESCRIPTION)||r.hasOwnProperty(Fx.ERROR)||r.hasOwnProperty(Fx.ACCESS_TOKEN)||r.hasOwnProperty(Fx.ID_TOKEN)},UrlUtils.deserializeHash=function(t){var r=UrlUtils.getHashFromUrl(t);return Lx.deserialize(r)},UrlUtils.getHostFromUri=function(t){var r=String(t).replace(/^(https?:)\/\//,"");return r=r.split("/")[0]},UrlUtils}(),VI=function VI(t,r,o,i,s){this.authority=GI.CanonicalizeUri(t),this.clientId=r,this.scopes=o,this.homeAccountIdentifier=Lx.base64Encode(i)+"."+Lx.base64Encode(s)},KI=function KI(t,r,o,i){this.accessToken=t,this.idToken=r,this.expiresIn=o,this.homeAccountIdentifier=i},WI="1.4.17",QI=function(){function ServerRequestParameters(t,r,o,i,s,l,u){this.authorityInstance=t,this.clientId=r,this.nonce=Lx.createNewGuid(),this.scopes=s?__spreadArrays$1(s):Ux.oidcScopes,this.scopes=zI.trimScopes(this.scopes),this.state=l,this.correlationId=u,this.xClientSku="MSAL.JS",this.xClientVer=WI,this.responseType=o,this.redirectUri=i}return Object.defineProperty(ServerRequestParameters.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!1,configurable:!0}),ServerRequestParameters.prototype.populateQueryParams=function(t,r,o,i){var s={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),ServerRequestParameters.isSSOParam(r)&&(s=this.constructUnifiedCacheQueryParameter(r,null))),o&&(s=this.constructUnifiedCacheQueryParameter(null,o)),s=this.addHintParameters(t,s);var l=r?r.extraQueryParameters:null;this.queryParameters=ServerRequestParameters.generateQueryParametersString(s),this.extraQueryParameters=ServerRequestParameters.generateQueryParametersString(l,i)},ServerRequestParameters.prototype.constructUnifiedCacheQueryParameter=function(t,r){var o,i,s;if(t)if(t.account){var l=t.account;(null===(o=l.idTokenClaims)||void 0===o?void 0:o.login_hint)?(i=Gx.LOGIN_HINT,s=l.idTokenClaims.login_hint):l.sid?(i=Gx.SID,s=l.sid):l.userName&&(i=Gx.LOGIN_HINT,s=l.userName)}else t.sid?(i=Gx.SID,s=t.sid):t.loginHint&&(i=Gx.LOGIN_HINT,s=t.loginHint);else r&&r.hasOwnProperty(Ux.upn)&&(i=Gx.ID_TOKEN,s=r.upn);return this.addSSOParameter(i,s)},ServerRequestParameters.prototype.addHintParameters=function(t,r){var o,i,s=r;return t&&(s[Gx.SID]||s[Gx.LOGIN_HINT]||((null===(o=t.idTokenClaims)||void 0===o?void 0:o.login_hint)?s=this.addSSOParameter(Gx.LOGIN_HINT,null===(i=t.idTokenClaims)||void 0===i?void 0:i.login_hint,s):t.sid&&this.promptValue===Yx.NONE?s=this.addSSOParameter(Gx.SID,t.sid,s):t.userName&&(s=this.addSSOParameter(Gx.LOGIN_HINT,t.userName,s)))),s},ServerRequestParameters.prototype.addSSOParameter=function(t,r,o){var i=o||{};if(!r)return i;switch(t){case Gx.SID:i[Gx.SID]=r;break;case Gx.ID_TOKEN:case Gx.LOGIN_HINT:i[Gx.LOGIN_HINT]=r}return i},ServerRequestParameters.generateQueryParametersString=function(t,r){var o=null;return t&&Object.keys(t).forEach((function(i){i===Ux.domain_hint&&(r||t[Gx.SID])||(o?o+="&"+i+"="+encodeURIComponent(t[i]):o=i+"="+encodeURIComponent(t[i]))})),o},ServerRequestParameters.isSSOParam=function(t){return!(!t||!(t.account||t.sid||t.loginHint))},ServerRequestParameters.determineResponseType=function(t,r){return zI.onlyContainsOidcScopes(r)?qx:t?this.responseTypeForMatchingAccounts(r):zx},ServerRequestParameters.responseTypeForMatchingAccounts=function(t){return zI.containsAnyOidcScopes(t)?zx:jx},ServerRequestParameters}(),YI=function(){function XhrClient(){}return XhrClient.prototype.sendRequestAsync=function(t,r,o){var i=this;return new Promise((function(o,s){var l=new XMLHttpRequest;if(l.open(r,t,!0),l.onload=function(){var t;(l.status<200||l.status>=300)&&s(i.handleError(l.responseText));try{t=JSON.parse(l.responseText)}catch(t){s(i.handleError(l.responseText))}var r={statusCode:l.status,body:t};o(r)},l.onerror=function(){s(l.status)},r!==Qx)throw"not implemented";l.send()}))},XhrClient.prototype.handleError=function(t){var r;try{if((r=JSON.parse(t)).error)return r.error;throw t}catch(r){return t}},XhrClient}(),JI=function(){function TrustedAuthority(){}return TrustedAuthority.setTrustedAuthoritiesFromConfig=function(t,r){t&&!this.getTrustedHostList().length&&r.forEach((function(t){TrustedAuthority.TrustedHostList.push(t.toLowerCase())}))},TrustedAuthority.getAliases=function(t,r,o){return __awaiter$I(this,void 0,void 0,(function(){var i,s,l,u;return __generator$2(this,(function(h){return i=new YI,s=Qx,l="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+t+"oauth2/v2.0/authorize",u=r.createAndStartHttpEvent(o,s,l,"getAliases"),[2,i.sendRequestAsync(l,s,!0).then((function(t){return u.httpResponseStatus=t.statusCode,r.stopEvent(u),t.body.metadata})).catch((function(t){throw u.serverErrorCode=t,r.stopEvent(u),t}))]}))}))},TrustedAuthority.setTrustedAuthoritiesFromNetwork=function(t,r,o){return __awaiter$I(this,void 0,void 0,(function(){var i;return __generator$2(this,(function(s){switch(s.label){case 0:return[4,this.getAliases(t,r,o)];case 1:return s.sent().forEach((function(t){t.aliases.forEach((function(t){TrustedAuthority.TrustedHostList.push(t.toLowerCase())}))})),i=GI.GetUrlComponents(t).HostNameAndPort,TrustedAuthority.getTrustedHostList().length&&!TrustedAuthority.IsInTrustedHostList(i)&&TrustedAuthority.TrustedHostList.push(i.toLowerCase()),[2]}}))}))},TrustedAuthority.getTrustedHostList=function(){return this.TrustedHostList},TrustedAuthority.IsInTrustedHostList=function(t){return this.TrustedHostList.indexOf(t.toLowerCase())>-1},TrustedAuthority.TrustedHostList=[],TrustedAuthority}();!function(t){t[t.Default=0]="Default",t[t.Adfs=1]="Adfs"}(Kx||(Kx={}));var XI,ZI=function(){function Authority(t,r,o){this.IsValidationEnabled=r,this.CanonicalAuthority=t,this.validateAsUri(),this.tenantDiscoveryResponse=o}return Authority.isAdfs=function(t){var r=GI.GetUrlComponents(t).PathSegments;return r.length&&r[0].toLowerCase()===Ux.ADFS},Object.defineProperty(Authority.prototype,"AuthorityType",{get:function(){return Authority.isAdfs(this.canonicalAuthority)?Kx.Adfs:Kx.Default},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Authority.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(Authority.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(t){this.canonicalAuthority=GI.CanonicalizeUri(t),this.canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=GI.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===Kx.Adfs?""+this.CanonicalAuthority+Vx:this.CanonicalAuthority+"v2.0/"+Vx},enumerable:!1,configurable:!0}),Authority.prototype.validateAsUri=function(){var t;try{t=this.CanonicalAuthorityUrlComponents}catch(t){throw OI}if(!t.Protocol||"https:"!==t.Protocol.toLowerCase())throw NI;if(!t.PathSegments||t.PathSegments.length<1)throw MI},Authority.prototype.DiscoverEndpoints=function(t,r,o){var i=new YI,s=Qx,l=r.createAndStartHttpEvent(o,s,t,"openIdConfigurationEndpoint");return i.sendRequestAsync(t,s,!0).then((function(t){return l.httpResponseStatus=t.statusCode,r.stopEvent(l),{AuthorizationEndpoint:t.body.authorization_endpoint,EndSessionEndpoint:t.body.end_session_endpoint,Issuer:t.body.issuer}})).catch((function(t){throw l.serverErrorCode=t,r.stopEvent(l),t}))},Authority.prototype.resolveEndpointsAsync=function(t,r){return __awaiter$I(this,void 0,void 0,(function(){var o,i,s;return __generator$2(this,(function(l){switch(l.label){case 0:return this.IsValidationEnabled?(o=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==JI.getTrustedHostList().length?[3,2]:[4,JI.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,t,r)]):[3,3];case 1:l.sent(),l.label=2;case 2:if(!JI.IsInTrustedHostList(o))throw jI.createUntrustedAuthorityError(o);l.label=3;case 3:return i=this.GetOpenIdConfigurationEndpoint(),s=this,[4,this.DiscoverEndpoints(i,t,r)];case 4:return s.tenantDiscoveryResponse=l.sent(),[2,this.tenantDiscoveryResponse]}}))}))},Authority.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},Authority.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},Authority}(),eA=function(){function ClientInfo(t,r){if(!t||rI.isEmpty(t))return this.uid="",void(this.utid="");try{var o=Lx.base64Decode(t),i=JSON.parse(o);i&&(i.hasOwnProperty("uid")&&(this.uid=r?ClientInfo.stripPolicyFromUid(i.uid,r):i.uid),i.hasOwnProperty("utid")&&(this.utid=i.utid))}catch(t){throw kI.createClientInfoDecodingError(t)}}return Object.defineProperty(ClientInfo.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(t){this._uid=t},enumerable:!1,configurable:!0}),Object.defineProperty(ClientInfo.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(t){this._utid=t},enumerable:!1,configurable:!0}),ClientInfo.createClientInfoFromIdToken=function(t,r){var o={uid:t.subject,utid:""};return new ClientInfo(Lx.base64Encode(JSON.stringify(o)),r)},ClientInfo.stripPolicyFromUid=function(t,r){var o=t.split("-"),i=r.split("/").reverse(),s="";return rI.isEmpty(i[0])?i.length>1&&(s=i[1]):s=i[0],o[o.length-1]===s?o.slice(0,o.length-1).join("-"):t},ClientInfo.prototype.encodeClientInfo=function(){var t=JSON.stringify({uid:this.uid,utid:this.utid});return Lx.base64Encode(t)},ClientInfo}(),tA=function(){function TimeUtils(){}return TimeUtils.parseExpiresIn=function(t){return parseInt(t||"3599",10)},TimeUtils.now=function(){return Math.round((new Date).getTime()/1e3)},TimeUtils.relativeNowMs=function(){return window.performance.now()},TimeUtils}(),rA=function(){function TokenUtils(){}return TokenUtils.decodeJwt=function(t){if(rI.isEmpty(t))return null;var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);return!r||r.length<4?null:{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},TokenUtils.validateExpirationIsWithinOffset=function(t,r){var o=r||300;return t&&t>tA.now()+o},TokenUtils.extractIdToken=function(t){var r=this.decodeJwt(t);if(!r)return null;try{var o=r.JWSPayload,i=Lx.base64Decode(o);return i?JSON.parse(i):null}catch(t){}return null},TokenUtils}(),oA=function oA(t){if(rI.isEmpty(t))throw kI.createIdTokenNullOrEmptyError(t);try{this.rawIdToken=t,this.claims=rA.extractIdToken(t),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(t){throw kI.createIdTokenParsingError(t)}},nA=function nA(t,r){this.key=t,this.value=r},iA=function(){function BrowserStorage(t){if(!window)throw tI.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[t]&&null!==window[t]))throw jI.createStorageNotSupportedError(t);this.cacheLocation=t}return BrowserStorage.prototype.setItem=function(t,r,o){window[this.cacheLocation].setItem(t,r),o&&this.setItemCookie(t,r)},BrowserStorage.prototype.getItem=function(t,r){return r&&this.getItemCookie(t)?this.getItemCookie(t):window[this.cacheLocation].getItem(t)},BrowserStorage.prototype.removeItem=function(t){return window[this.cacheLocation].removeItem(t)},BrowserStorage.prototype.clear=function(){return window[this.cacheLocation].clear()},BrowserStorage.prototype.setItemCookie=function(t,r,o){var i=encodeURIComponent(t)+"="+encodeURIComponent(r)+";path=/;";o&&(i+="expires="+this.getCookieExpirationTime(o)+";");document.cookie=i},BrowserStorage.prototype.getItemCookie=function(t){for(var r=encodeURIComponent(t)+"=",o=document.cookie.split(";"),i=0;i<o.length;i++){for(var s=o[i];" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(r))return decodeURIComponent(s.substring(r.length,s.length))}return""},BrowserStorage.prototype.clearItemCookie=function(t){this.setItemCookie(t,"",-1)},BrowserStorage.prototype.getCookieExpirationTime=function(t){var r=new Date;return new Date(r.getTime()+24*t*60*60*1e3).toUTCString()},BrowserStorage}(),sA=function(){function RequestUtils(){}return RequestUtils.validateRequest=function(t,r,o,i){if(!r&&!t)throw jI.createEmptyRequestError();var s,l;t&&(s=r?zI.appendScopes(t.scopes,t.extraScopesToConsent):t.scopes,zI.validateInputScope(s,!r),s=zI.translateClientIdIfSingleScope(s,o),this.validatePromptParameter(t.prompt),l=this.validateEQParameters(t.extraQueryParameters,t.claimsRequest),this.validateClaimsRequest(t.claimsRequest));var u=this.validateAndGenerateState(t&&t.state,i),h=this.validateAndGenerateCorrelationId(t&&t.correlationId);return __assign$2(__assign$2({},t),{extraQueryParameters:l,scopes:s,state:u,correlationId:h})},RequestUtils.validatePromptParameter=function(t){if(t&&[Yx.LOGIN,Yx.SELECT_ACCOUNT,Yx.CONSENT,Yx.NONE].indexOf(t)<0)throw jI.createInvalidPromptError(t)},RequestUtils.validateEQParameters=function(t,r){var o=__assign$2({},t);return o?(r&&delete o[Ux.claims],Wx.forEach((function(t){o[t]&&delete o[t]})),o):null},RequestUtils.validateClaimsRequest=function(t){if(t)try{JSON.parse(t)}catch(t){throw jI.createClaimsRequestParsingError(t)}},RequestUtils.validateAndGenerateState=function(t,r){return rI.isEmpty(t)?RequestUtils.generateLibraryState(r):""+RequestUtils.generateLibraryState(r)+Ux.resourceDelimiter+t},RequestUtils.generateLibraryState=function(t){var r={id:Lx.createNewGuid(),ts:tA.now(),method:t},o=JSON.stringify(r);return Lx.base64Encode(o)},RequestUtils.parseLibraryState=function(t){var r=decodeURIComponent(t).split(Ux.resourceDelimiter)[0];if(Lx.isGuid(r))return{id:r,ts:tA.now(),method:Ux.interactionTypeRedirect};try{var o=Lx.base64Decode(r);return JSON.parse(o)}catch(r){throw kI.createInvalidStateError(t,null)}},RequestUtils.validateAndGenerateCorrelationId=function(t){if(t&&!Lx.isGuid(t))throw jI.createInvalidCorrelationIdError();return Lx.isGuid(t)?t:Lx.createNewGuid()},RequestUtils.createRequestSignature=function(t){return""+t.scopes.join(" ").toLowerCase()+Ux.resourceDelimiter+t.authority},RequestUtils}(),aA=function(t){function AuthCache(r,o,i){var s=t.call(this,o)||this;return s.temporaryCache=new iA("sessionStorage"),s.clientId=r,s.rollbackEnabled=!0,s.migrateCacheEntries(i),s}return __extends$2(AuthCache,t),AuthCache.prototype.migrateCacheEntries=function(r){var o,i=this,s=Ux.cachePrefix+"."+Hx.IDTOKEN,l=Ux.cachePrefix+"."+Hx.CLIENT_INFO,u=Ux.cachePrefix+"."+$x.ERROR,h=Ux.cachePrefix+"."+$x.ERROR_DESC,m=t.prototype.getItem.call(this,s);if(m)try{o=new oA(m)}catch(t){return}if(o&&o.claims&&o.claims.aud===this.clientId){var v=[m,t.prototype.getItem.call(this,l),t.prototype.getItem.call(this,u),t.prototype.getItem.call(this,h)];[Hx.IDTOKEN,Hx.CLIENT_INFO,$x.ERROR,$x.ERROR_DESC].forEach((function(t,o){return i.duplicateCacheEntry(t,v[o],r)}))}},AuthCache.prototype.duplicateCacheEntry=function(t,r,o){r&&this.setItem(t,r,o)},AuthCache.prototype.generateCacheKey=function(t,r){try{return JSON.parse(t),t}catch(o){return 0===t.indexOf(""+Ux.cachePrefix)||0===t.indexOf(Ux.adalIdToken)?t:r?Ux.cachePrefix+"."+this.clientId+"."+t:Ux.cachePrefix+"."+t}},AuthCache.prototype.matchKeyForType=function(t,r,o,i){var s=rI.validateAndParseJsonCacheKey(t);if(!s)return null;var l=t.match(r)&&t.match(o),u=!1;switch(i){case Fx.ACCESS_TOKEN:u=!!t.match(Ux.scopes);break;case Fx.ID_TOKEN:u=!t.match(Ux.scopes)}return l&&u?s:null},AuthCache.prototype.setItem=function(r,o,i){t.prototype.setItem.call(this,this.generateCacheKey(r,!0),o,i),this.rollbackEnabled&&!i&&t.prototype.setItem.call(this,this.generateCacheKey(r,!1),o,i)},AuthCache.prototype.getItem=function(r,o){return t.prototype.getItem.call(this,this.generateCacheKey(r,!0),o)},AuthCache.prototype.removeItem=function(r){this.temporaryCache.removeItem(this.generateCacheKey(r,!0)),t.prototype.removeItem.call(this,this.generateCacheKey(r,!0)),this.rollbackEnabled&&t.prototype.removeItem.call(this,this.generateCacheKey(r,!1))},AuthCache.prototype.setTemporaryItem=function(t,r,o){this.temporaryCache.setItem(this.generateCacheKey(t,!0),r,o)},AuthCache.prototype.getTemporaryItem=function(t,r){return this.temporaryCache.getItem(this.generateCacheKey(t,!0),r)},AuthCache.prototype.resetCacheItems=function(){var r,o=window[this.cacheLocation];for(r in o)o.hasOwnProperty(r)&&-1!==r.indexOf(Ux.cachePrefix)&&t.prototype.removeItem.call(this,r)},AuthCache.prototype.resetTempCacheItems=function(r){var o=this,i=r&&sA.parseLibraryState(r).id,s=this.tokenRenewalInProgress(r),l=window[this.cacheLocation];i&&!s&&Object.keys(l).forEach((function(r){-1!==r.indexOf(i)&&(o.removeItem(r),t.prototype.clearItemCookie.call(o,r))})),this.setInteractionInProgress(!1),this.removeItem(Bx.REDIRECT_REQUEST)},AuthCache.prototype.setItemCookie=function(r,o,i){t.prototype.setItemCookie.call(this,this.generateCacheKey(r,!0),o,i),this.rollbackEnabled&&t.prototype.setItemCookie.call(this,this.generateCacheKey(r,!1),o,i)},AuthCache.prototype.clearItemCookie=function(r){t.prototype.clearItemCookie.call(this,this.generateCacheKey(r,!0)),this.rollbackEnabled&&t.prototype.clearItemCookie.call(this,this.generateCacheKey(r,!1))},AuthCache.prototype.getItemCookie=function(r){return t.prototype.getItemCookie.call(this,this.generateCacheKey(r,!0))},AuthCache.prototype.getAllTokensByType=function(t,r,o){var i=this,s=Object.keys(window[this.cacheLocation]).reduce((function(s,l){var u=i.matchKeyForType(l,t,r,o);if(u){var h=i.getItem(l);if(h)try{var m=new nA(u,JSON.parse(h));return s.concat([m])}catch(t){return s}}return s}),[]);return s},AuthCache.prototype.getAllAccessTokens=function(t,r){return this.getAllTokensByType(t,r,Fx.ACCESS_TOKEN)},AuthCache.prototype.getAllIdTokens=function(t,r){return this.getAllTokensByType(t,r,Fx.ID_TOKEN)},AuthCache.prototype.getAllTokens=function(t,r){return __spreadArrays$1(this.getAllAccessTokens(t,r),this.getAllIdTokens(t,r))},AuthCache.prototype.isInteractionInProgress=function(t){var r=this.getInteractionInProgress();return t?r===this.clientId:!!r},AuthCache.prototype.getInteractionInProgress=function(){return this.getTemporaryItem(this.generateCacheKey(Bx.INTERACTION_STATUS,!1))},AuthCache.prototype.setInteractionInProgress=function(t){if(t){if(this.isInteractionInProgress(!1))throw kI.createAcquireTokenInProgressError();this.setTemporaryItem(this.generateCacheKey(Bx.INTERACTION_STATUS,!1),this.clientId)}else!t&&this.isInteractionInProgress(!0)&&this.removeItem(this.generateCacheKey(Bx.INTERACTION_STATUS,!1))},AuthCache.prototype.tokenRenewalInProgress=function(t){var r=this.getItem(AuthCache.generateTemporaryCacheKey(Bx.RENEW_STATUS,t));return!(!r||r!==Ux.inProgress)},AuthCache.prototype.clearMsalCookie=function(r){var o=this;r?(this.clearItemCookie(AuthCache.generateTemporaryCacheKey(Bx.NONCE_IDTOKEN,r)),this.clearItemCookie(AuthCache.generateTemporaryCacheKey(Bx.STATE_LOGIN,r)),this.clearItemCookie(AuthCache.generateTemporaryCacheKey(Bx.LOGIN_REQUEST,r)),this.clearItemCookie(AuthCache.generateTemporaryCacheKey(Bx.STATE_ACQ_TOKEN,r))):document.cookie.split(";").forEach((function(r){var i=r.trim().split("=")[0];i.indexOf(Ux.cachePrefix)>-1&&t.prototype.clearItemCookie.call(o,i)}))},AuthCache.generateAcquireTokenAccountKey=function(t,r){var o=sA.parseLibraryState(r).id;return""+Bx.ACQUIRE_TOKEN_ACCOUNT+Ux.resourceDelimiter+t+Ux.resourceDelimiter+o},AuthCache.generateAuthorityKey=function(t){return AuthCache.generateTemporaryCacheKey(Bx.AUTHORITY,t)},AuthCache.generateTemporaryCacheKey=function(t,r){var o=sA.parseLibraryState(r).id;return""+t+Ux.resourceDelimiter+o},AuthCache}(iA),cA=function(){function Account(t,r,o,i,s,l,u){this.accountIdentifier=t,this.homeAccountIdentifier=r,this.userName=o,this.name=i,this.idToken=s,this.idTokenClaims=s,this.sid=l,this.environment=u}return Account.createAccount=function(t,r){var o,i=t.objectId||t.subject,s=r?r.uid:"",l=r?r.utid:"";return rI.isEmpty(s)||(o=rI.isEmpty(l)?Lx.base64Encode(s):Lx.base64Encode(s)+"."+Lx.base64Encode(l)),new Account(i,o,t.preferredName,t.name,t.claims,t.sid,t.issuer)},Account.compareAccounts=function(t,r){return!(!t||!r)&&!(!t.homeAccountIdentifier||!r.homeAccountIdentifier||t.homeAccountIdentifier!==r.homeAccountIdentifier)},Account}(),lA=function(){function WindowUtils(){}return WindowUtils.isInIframe=function(){return window.parent!==window},WindowUtils.isInPopup=function(){return!(!window.opener||window.opener===window)},WindowUtils.generateFrameName=function(t,r){return""+t+Ux.resourceDelimiter+r},WindowUtils.monitorIframeForHash=function(t,r,o,i){return new Promise((function(s,l){var u=tA.relativeNowMs()+r;i.verbose("monitorWindowForIframe polling started");var h=setInterval((function(){if(tA.relativeNowMs()>u)return i.error("monitorIframeForHash unable to find hash in url, timing out"),i.errorPii("monitorIframeForHash polling timed out for url: "+o),clearInterval(h),void l(kI.createTokenRenewalTimeoutError());var r;try{r=t.location.href}catch(t){}r&&GI.urlContainsHash(r)&&(i.verbose("monitorIframeForHash found url in hash"),clearInterval(h),s(t.location.hash))}),WindowUtils.POLLING_INTERVAL_MS)}))},WindowUtils.monitorPopupForHash=function(t,r,o,i){return new Promise((function(s,l){var u=r/WindowUtils.POLLING_INTERVAL_MS,h=0;i.verbose("monitorWindowForHash polling started");var m=setInterval((function(){if(t.closed)return i.error("monitorWindowForHash window closed"),clearInterval(m),void l(kI.createUserCancelledError());var r;try{r=t.location.href}catch(t){}if(r&&"about:blank"!==r)if(h++,r&&GI.urlContainsHash(r)){i.verbose("monitorPopupForHash found url in hash"),clearInterval(m);var v=t.location.hash;WindowUtils.clearUrlFragment(t),s(v)}else h>u&&(i.error("monitorPopupForHash unable to find hash in url, timing out"),i.errorPii("monitorPopupForHash polling timed out for url: "+o),clearInterval(m),l(kI.createTokenRenewalTimeoutError()))}),WindowUtils.POLLING_INTERVAL_MS)}))},WindowUtils.loadFrame=function(t,r,o,i){var s=this;return i.infoPii("LoadFrame: "+r),new Promise((function(l,u){setTimeout((function(){var o=s.loadFrameSync(t,r,i);o?l(o):u("Unable to load iframe with name: "+r)}),o)}))},WindowUtils.loadFrameSync=function(t,r,o){var i=WindowUtils.addHiddenIFrame(r,o);return i?(""!==i.src&&"about:blank"!==i.src||(i.src=t,o.infoPii("Frame Name : "+r+" Navigated to: "+t)),i):null},WindowUtils.addHiddenIFrame=function(t,r){if(void 0===t)return null;r.info("Add msal iframe to document"),r.infoPii("Add msal frame to document:"+t);var o=document.getElementById(t);if(o)r.verbose("Add msal iframe already exists");else{r.verbose("Add msal iframe does not exist");var i=document.createElement("iframe");i.setAttribute("id",t),i.setAttribute("aria-hidden","true"),i.style.visibility="hidden",i.style.position="absolute",i.style.width=i.style.height="0",i.style.border="0",i.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),o=document.getElementsByTagName("body")[0].appendChild(i)}return o},WindowUtils.removeHiddenIframe=function(t){document.body===t.parentNode&&document.body.removeChild(t)},WindowUtils.getIframeWithHash=function(t){var r=document.getElementsByTagName("iframe"),o=Array.apply(null,Array(r.length)).map((function(t,o){return r.item(o)}));return o.filter((function(r){try{return r.contentWindow.location.hash===t}catch(t){return!1}}))[0]},WindowUtils.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},WindowUtils.getPopUpWithHash=function(t){return WindowUtils.getPopups().filter((function(r){try{return r.location.hash===t}catch(t){return!1}}))[0]},WindowUtils.trackPopup=function(t){WindowUtils.getPopups().push(t)},WindowUtils.closePopups=function(){WindowUtils.getPopups().forEach((function(t){return t.close()}))},WindowUtils.blockReloadInHiddenIframes=function(){if(GI.urlContainsHash(window.location.hash)&&WindowUtils.isInIframe())throw kI.createBlockTokenRequestsInHiddenIframeError()},WindowUtils.checkIfBackButtonIsPressed=function(t){var r=t.getItem(Bx.REDIRECT_REQUEST);if(r&&!GI.urlContainsHash(window.location.hash)){var o=r.split(Ux.resourceDelimiter);o.shift();var i=o.length>0?o.join(Ux.resourceDelimiter):null;t.resetTempCacheItems(i)}},WindowUtils.clearUrlFragment=function(t){t.location.hash="","function"==typeof t.history.replaceState&&t.history.replaceState(null,null,""+t.location.pathname+t.location.search)},WindowUtils.POLLING_INTERVAL_MS=50,WindowUtils}(),dA=function(){function ResponseUtils(){}return ResponseUtils.setResponseIdToken=function(t,r){if(!t)return null;if(!r)return t;var o=Number(r.expiration);return o&&!t.expiresOn&&(t.expiresOn=new Date(1e3*o)),__assign$2(__assign$2({},t),{idToken:r,idTokenClaims:r.claims,uniqueId:r.objectId||r.subject,tenantId:r.tenantId})},ResponseUtils.buildAuthResponse=function(t,r,o,i,s,l){switch(o.responseType){case qx:var u=__assign$2(__assign$2({},r),{tokenType:Fx.ID_TOKEN,account:i,scopes:s,accountState:l});return(u=ResponseUtils.setResponseIdToken(u,t)).idToken?u:null;case zx:var h=ResponseUtils.setResponseIdToken(r,t);return h&&h.accessToken&&h.idToken?h:null;case jx:return ResponseUtils.setResponseIdToken(r,t);default:return null}},ResponseUtils}(),uA=function(){function AuthorityFactory(){}return AuthorityFactory.saveMetadataFromNetwork=function(t,r,o){return __awaiter$I(this,void 0,void 0,(function(){var i;return __generator$2(this,(function(s){switch(s.label){case 0:return[4,t.resolveEndpointsAsync(r,o)];case 1:return i=s.sent(),this.metadataMap.set(t.CanonicalAuthority,i),[2,i]}}))}))},AuthorityFactory.getMetadata=function(t){return this.metadataMap.get(t)},AuthorityFactory.saveMetadataFromConfig=function(t,r){try{if(r){var o=JSON.parse(r);if(!o.authorization_endpoint||!o.end_session_endpoint||!o.issuer)throw jI.createInvalidAuthorityMetadataError();this.metadataMap.set(t,{AuthorizationEndpoint:o.authorization_endpoint,EndSessionEndpoint:o.end_session_endpoint,Issuer:o.issuer})}}catch(t){throw jI.createInvalidAuthorityMetadataError()}},AuthorityFactory.CreateInstance=function(t,r,o){return rI.isEmpty(t)?null:(o&&this.saveMetadataFromConfig(t,o),new ZI(t,r,this.metadataMap.get(t)))},AuthorityFactory.metadataMap=new Map,AuthorityFactory}();!function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose"}(XI||(XI={}));var hA=function(){function Logger(t,r){void 0===r&&(r={}),this.level=XI.Info;var o=r.correlationId,i=void 0===o?"":o,s=r.level,l=void 0===s?XI.Info:s,u=r.piiLoggingEnabled,h=void 0!==u&&u;this.localCallback=t,this.correlationId=i,this.level=l,this.piiLoggingEnabled=h}return Logger.prototype.logMessage=function(t,r,o){if(!(t>this.level||!this.piiLoggingEnabled&&o)){var i,s=(new Date).toUTCString();i=rI.isEmpty(this.correlationId)?s+":"+WI+"-"+XI[t]+(o?"-pii":"")+" "+r:s+":"+this.correlationId+"-"+WI+"-"+XI[t]+(o?"-pii":"")+" "+r,this.executeCallback(t,i,o)}},Logger.prototype.executeCallback=function(t,r,o){this.localCallback&&this.localCallback(t,r,o)},Logger.prototype.error=function(t){this.logMessage(XI.Error,t,!1)},Logger.prototype.errorPii=function(t){this.logMessage(XI.Error,t,!0)},Logger.prototype.warning=function(t){this.logMessage(XI.Warning,t,!1)},Logger.prototype.warningPii=function(t){this.logMessage(XI.Warning,t,!0)},Logger.prototype.info=function(t){this.logMessage(XI.Info,t,!1)},Logger.prototype.infoPii=function(t){this.logMessage(XI.Info,t,!0)},Logger.prototype.verbose=function(t){this.logMessage(XI.Verbose,t,!1)},Logger.prototype.verbosePii=function(t){this.logMessage(XI.Verbose,t,!0)},Logger.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},Logger}(),pA={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return GI.getCurrentUrl()},postLogoutRedirectUri:function(){return GI.getCurrentUrl()},navigateToLoginRequestUrl:!0},fA={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},gA={logger:new hA(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},mA={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};var vA={code:"server_unavailable",desc:"Server is temporarily unavailable."},yA={code:"unknown_server_error"},bA=function(t){function ServerError(r,o){var i=t.call(this,r,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,ServerError.prototype),i}return __extends$2(ServerError,t),ServerError.createServerUnavailableError=function(){return new ServerError(vA.code,vA.desc)},ServerError.createUnknownServerError=function(t){return new ServerError(yA.code,t)},ServerError}(tI),wA={code:"interaction_required"},CA={code:"consent_required"},_A={code:"login_required"},kA=function(t){function InteractionRequiredAuthError(r,o){var i=t.call(this,r,o)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,InteractionRequiredAuthError.prototype),i}return __extends$2(InteractionRequiredAuthError,t),InteractionRequiredAuthError.isInteractionRequiredError=function(t){var r=[wA.code,CA.code,_A.code];return t&&r.indexOf(t)>-1},InteractionRequiredAuthError.createLoginRequiredAuthError=function(t){return new InteractionRequiredAuthError(_A.code,t)},InteractionRequiredAuthError.createInteractionRequiredAuthError=function(t){return new InteractionRequiredAuthError(wA.code,t)},InteractionRequiredAuthError.createConsentRequiredAuthError=function(t){return new InteractionRequiredAuthError(CA.code,t)},InteractionRequiredAuthError}(bA);function buildResponseStateOnly(t){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:t,fromCache:!1}}var SA,TA,EA,xA="event_name",IA="elapsed_time",AA="Microsoft.MSAL.correlation_id",PA="msal.api_telem_id",RA="msal.api_id",OA="Microsoft_MSAL_cache_event_count",NA="Microsoft_MSAL_http_event_count",MA="Microsoft_MSAL_ui_event_count",scrubTenantFromUri=function(t){var r=GI.GetUrlComponents(t);if(ZI.isAdfs(t))return t;var o=r.PathSegments;if(o&&o.length>=2){var i="tfp"===o[1]?2:1;i<o.length&&(o[i]="<tenant>")}return r.Protocol+"//"+r.HostNameAndPort+"/"+o.join("/")},hashPersonalIdentifier=function(t){return Lx.base64Encode(t)},prependEventNamePrefix=function(t){return"msal."+(t||"")},supportsBrowserPerformance=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},DA=function(){function TelemetryEvent(t,r,o){var i;this.eventId=Lx.createNewGuid(),this.label=o,this.event=((i={})[prependEventNamePrefix(xA)]=t,i[prependEventNamePrefix(IA)]=-1,i[""+AA]=r,i)}return TelemetryEvent.prototype.setElapsedTime=function(t){this.event[prependEventNamePrefix(IA)]=t},TelemetryEvent.prototype.stop=function(){var t,r,o;this.setElapsedTime(+Date.now()-+this.startTimestamp),t=this.displayName,r=this.perfStartMark,o=this.perfEndMark,supportsBrowserPerformance()&&(window.performance.mark(o),window.performance.measure(t,r,o),window.performance.clearMeasures(t),window.performance.clearMarks(r),window.performance.clearMarks(o))},TelemetryEvent.prototype.start=function(){var t;this.startTimestamp=Date.now(),this.event[prependEventNamePrefix("start_time")]=this.startTimestamp,t=this.perfStartMark,supportsBrowserPerformance()&&window.performance.mark(t)},Object.defineProperty(TelemetryEvent.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+AA]},set:function(t){this.event[""+AA]=t},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"eventName",{get:function(){return this.event[prependEventNamePrefix(xA)]},enumerable:!1,configurable:!0}),TelemetryEvent.prototype.get=function(){return __assign$2(__assign$2({},this.event),{eventId:this.eventId})},Object.defineProperty(TelemetryEvent.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!1,configurable:!0}),Object.defineProperty(TelemetryEvent.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!1,configurable:!0}),TelemetryEvent}(),FA=function(t){function DefaultEvent(r,o,i,s){var l=t.call(this,prependEventNamePrefix("default_event"),o,"DefaultEvent")||this;return l.event[prependEventNamePrefix("client_id")]=i,l.event[prependEventNamePrefix("sdk_plaform")]=r.sdk,l.event[prependEventNamePrefix("sdk_version")]=r.sdkVersion,l.event[prependEventNamePrefix("application_name")]=r.applicationName,l.event[prependEventNamePrefix("application_version")]=r.applicationVersion,l.event[prependEventNamePrefix("effective_connection_speed")]=r.networkInformation&&r.networkInformation.connectionSpeed,l.event[""+MA]=l.getEventCount(prependEventNamePrefix("ui_event"),s),l.event[""+NA]=l.getEventCount(prependEventNamePrefix("http_event"),s),l.event[""+OA]=l.getEventCount(prependEventNamePrefix("cache_event"),s),l}return __extends$2(DefaultEvent,t),DefaultEvent.prototype.getEventCount=function(t,r){return r[t]?r[t]:0},DefaultEvent}(DA),LA=prependEventNamePrefix("authority"),UA=prependEventNamePrefix("authority_type"),BA=prependEventNamePrefix("ui_behavior"),HA=prependEventNamePrefix("tenant_id"),$A=prependEventNamePrefix("user_id"),qA=prependEventNamePrefix("was_successful"),jA=prependEventNamePrefix("api_error_code"),zA=prependEventNamePrefix("login_hint");!function(t){t[t.AcquireTokenRedirect=2001]="AcquireTokenRedirect",t[t.AcquireTokenSilent=2002]="AcquireTokenSilent",t[t.AcquireTokenPopup=2003]="AcquireTokenPopup",t[t.LoginRedirect=2004]="LoginRedirect",t[t.LoginPopup=2005]="LoginPopup",t[t.Logout=2006]="Logout"}(TA||(TA={})),function(t){t.AcquireTokenRedirect="AcquireTokenRedirect",t.AcquireTokenSilent="AcquireTokenSilent",t.AcquireTokenPopup="AcquireTokenPopup",t.LoginRedirect="LoginRedirect",t.LoginPopup="LoginPopup",t.Logout="Logout"}(EA||(EA={}));var GA,VA,KA=((SA={})[EA.AcquireTokenSilent]=TA.AcquireTokenSilent,SA[EA.AcquireTokenPopup]=TA.AcquireTokenPopup,SA[EA.AcquireTokenRedirect]=TA.AcquireTokenRedirect,SA[EA.LoginPopup]=TA.LoginPopup,SA[EA.LoginRedirect]=TA.LoginRedirect,SA[EA.Logout]=TA.Logout,SA),WA=function(t){function ApiEvent(r,o,i){var s=t.call(this,prependEventNamePrefix("api_event"),r,i)||this;return i&&(s.apiCode=KA[i],s.apiEventIdentifier=i),s.piiEnabled=o,s}return __extends$2(ApiEvent,t),Object.defineProperty(ApiEvent.prototype,"apiEventIdentifier",{set:function(t){this.event[PA]=t},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"apiCode",{set:function(t){this.event[RA]=t},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"authority",{set:function(t){this.event[LA]=scrubTenantFromUri(t).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"apiErrorCode",{set:function(t){this.event[jA]=t},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"tenantId",{set:function(t){this.event[HA]=this.piiEnabled&&t?hashPersonalIdentifier(t):null},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"accountId",{set:function(t){this.event[$A]=this.piiEnabled&&t?hashPersonalIdentifier(t):null},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"wasSuccessful",{get:function(){return!0===this.event[qA]},set:function(t){this.event[qA]=t},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"loginHint",{set:function(t){this.event[zA]=this.piiEnabled&&t?hashPersonalIdentifier(t):null},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"authorityType",{set:function(t){this.event[UA]=t.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(ApiEvent.prototype,"promptType",{set:function(t){this.event[BA]=t.toLowerCase()},enumerable:!1,configurable:!0}),ApiEvent}(DA),QA=prependEventNamePrefix("http_path"),YA=prependEventNamePrefix("user_agent"),JA=prependEventNamePrefix("query_parameters"),XA=prependEventNamePrefix("api_version"),ZA=prependEventNamePrefix("response_code"),eP=prependEventNamePrefix("oauth_error_code"),tP=prependEventNamePrefix("http_method"),rP=prependEventNamePrefix("request_id_header"),oP=prependEventNamePrefix("spe_info"),nP=prependEventNamePrefix("server_error_code"),iP=prependEventNamePrefix("server_sub_error_code"),sP=prependEventNamePrefix("url"),aP=function(t){function HttpEvent(r,o){return t.call(this,prependEventNamePrefix("http_event"),r,o)||this}return __extends$2(HttpEvent,t),Object.defineProperty(HttpEvent.prototype,"url",{set:function(t){var r=scrubTenantFromUri(t);this.event[sP]=r&&r.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"httpPath",{set:function(t){this.event[QA]=scrubTenantFromUri(t).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"userAgent",{set:function(t){this.event[YA]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"queryParams",{set:function(t){this.event[JA]=QI.generateQueryParametersString(t)},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"apiVersion",{set:function(t){this.event[XA]=t.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"httpResponseStatus",{set:function(t){this.event[ZA]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"oAuthErrorCode",{set:function(t){this.event[eP]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"httpMethod",{set:function(t){this.event[tP]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"requestIdHeader",{set:function(t){this.event[rP]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"speInfo",{set:function(t){this.event[oP]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"serverErrorCode",{set:function(t){this.event[nP]=t},enumerable:!1,configurable:!0}),Object.defineProperty(HttpEvent.prototype,"serverSubErrorCode",{set:function(t){this.event[iP]=t},enumerable:!1,configurable:!0}),HttpEvent}(DA),cP=function(){function TelemetryManager(t,r,o){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=__assign$2({sdk:Ux.libraryName,sdkVersion:WI,networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},t.platform),this.clientId=t.clientId,this.onlySendFailureTelemetry=t.onlySendFailureTelemetry,this.telemetryEmitter=r,this.logger=o}return TelemetryManager.getTelemetrymanagerStub=function(t,r){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:t},(function(){}),r)},TelemetryManager.prototype.startEvent=function(t){this.logger.verbose("Telemetry Event started: "+t.key),this.telemetryEmitter&&(t.start(),this.inProgressEvents[t.key]=t)},TelemetryManager.prototype.stopEvent=function(t){if(this.logger.verbose("Telemetry Event stopped: "+t.key),this.telemetryEmitter&&this.inProgressEvents[t.key]){t.stop(),this.incrementEventCount(t);var r=this.completedEvents[t.telemetryCorrelationId];this.completedEvents[t.telemetryCorrelationId]=__spreadArrays$1(r||[],[t]),delete this.inProgressEvents[t.key]}},TelemetryManager.prototype.flush=function(t){var r=this;if(this.logger.verbose("Flushing telemetry events: "+t),this.telemetryEmitter&&this.completedEvents[t]){var o=this.getOrphanedEvents(t);o.forEach((function(t){return r.incrementEventCount(t)}));var i=__spreadArrays$1(this.completedEvents[t],o);delete this.completedEvents[t];var s=this.eventCountByCorrelationId[t];if(delete this.eventCountByCorrelationId[t],i&&i.length){var l=__spreadArrays$1(i,[new FA(this.telemetryPlatform,t,this.clientId,s)]);this.telemetryEmitter(l.map((function(t){return t.get()})))}}},TelemetryManager.prototype.createAndStartApiEvent=function(t,r){var o=new WA(t,this.logger.isPiiLoggingEnabled(),r);return this.startEvent(o),o},TelemetryManager.prototype.stopAndFlushApiEvent=function(t,r,o,i){r.wasSuccessful=o,i&&(r.apiErrorCode=i),this.stopEvent(r),this.flush(t)},TelemetryManager.prototype.createAndStartHttpEvent=function(t,r,o,i){var s=new aP(t,i);return s.url=o,s.httpMethod=r,this.startEvent(s),s},TelemetryManager.prototype.incrementEventCount=function(t){var r,o=t.eventName,i=this.eventCountByCorrelationId[t.telemetryCorrelationId];i?i[o]=i[o]?i[o]+1:1:this.eventCountByCorrelationId[t.telemetryCorrelationId]=((r={})[o]=1,r)},TelemetryManager.prototype.getOrphanedEvents=function(t){var r=this;return Object.keys(this.inProgressEvents).reduce((function(o,i){if(-1!==i.indexOf(t)){var s=r.inProgressEvents[i];return delete r.inProgressEvents[i],__spreadArrays$1(o,[s])}return o}),[])},TelemetryManager}(),lP=function(){function AuthCacheUtils(){}return AuthCacheUtils.filterTokenCacheItemsByScope=function(t,r){return t.filter((function(t){var o=t.key.scopes.split(" "),i=zI.removeDefaultScopes(r);return 0===i.length?zI.containsScope(o,r):zI.containsScope(o,i)}))},AuthCacheUtils.filterTokenCacheItemsByAuthority=function(t,r){return t.filter((function(t){return GI.CanonicalizeUri(t.key.authority)===r}))},AuthCacheUtils.filterTokenCacheItemsByDomain=function(t,r){return t.filter((function(t){return GI.GetUrlComponents(t.key.authority).HostNameAndPort===r}))},AuthCacheUtils}(),dP=function(){function UserAgentApplication(t){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=function buildConfiguration$1(t){var r=t.auth,o=t.cache,i=void 0===o?{}:o,s=t.system,l=void 0===s?{}:s,u=t.framework,h=void 0===u?{}:u;return{auth:__assign$2(__assign$2({},pA),r),cache:__assign$2(__assign$2({},fA),i),system:__assign$2(__assign$2({},gA),l),framework:__assign$2(__assign$2({},mA),h)}}(t),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),JI.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),uA.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new aA(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals||(window.activeRenewals={}),window.renewStates||(window.renewStates=[]),window.callbackMappedToRenewStates||(window.callbackMappedToRenewStates={}),window.promiseMappedToRenewStates||(window.promiseMappedToRenewStates={}),window.msal=this;var r=window.location.hash,o=GI.urlContainsHash(r);(lA.checkIfBackButtonIsPressed(this.cacheStorage),o&&this.cacheStorage.isInteractionInProgress(!0))&&(this.getResponseState(r).method===Ux.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(r))}return Object.defineProperty(UserAgentApplication.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(t){this.authorityInstance=uA.CreateInstance(t,this.config.auth.validateAuthority)},enumerable:!1,configurable:!0}),UserAgentApplication.prototype.getAuthorityInstance=function(){return this.authorityInstance},UserAgentApplication.prototype.handleRedirectCallback=function(t,r){if(!t)throw jI.createInvalidCallbackObjectError(t);r?(this.tokenReceivedCallback=t,this.errorReceivedCallback=r,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=t,this.redirectError?this.authErrorHandler(Ux.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(Ux.interactionTypeRedirect,this.redirectResponse)},UserAgentApplication.prototype.urlContainsHash=function(t){return this.logger.verbose("UrlContainsHash has been called"),GI.urlContainsHash(t)},UserAgentApplication.prototype.authResponseHandler=function(t,r,o){if(this.logger.verbose("AuthResponseHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),t===Ux.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(r)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,r));else{if(t!==Ux.interactionTypePopup)throw kI.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),o(r)}},UserAgentApplication.prototype.authErrorHandler=function(t,r,o,i){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),t===Ux.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(r,o.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),r;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(r,o)}else{if(t!==Ux.interactionTypePopup)throw kI.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),i(r)}},UserAgentApplication.prototype.loginRedirect=function(t){this.logger.verbose("LoginRedirect has been called");var r=sA.validateRequest(t,!0,this.clientId,Ux.interactionTypeRedirect);this.acquireTokenInteractive(Ux.interactionTypeRedirect,!0,r,null,null)},UserAgentApplication.prototype.acquireTokenRedirect=function(t){this.logger.verbose("AcquireTokenRedirect has been called");var r=sA.validateRequest(t,!1,this.clientId,Ux.interactionTypeRedirect);this.acquireTokenInteractive(Ux.interactionTypeRedirect,!1,r,null,null)},UserAgentApplication.prototype.loginPopup=function(t){var r=this;this.logger.verbose("LoginPopup has been called");var o=sA.validateRequest(t,!0,this.clientId,Ux.interactionTypePopup),i=this.telemetryManager.createAndStartApiEvent(o.correlationId,EA.LoginPopup);return new Promise((function(t,i){r.acquireTokenInteractive(Ux.interactionTypePopup,!0,o,t,i)})).then((function(t){return r.logger.verbose("Successfully logged in"),r.telemetryManager.stopAndFlushApiEvent(o.correlationId,i,!0),t})).catch((function(t){throw r.cacheStorage.resetTempCacheItems(o.state),r.telemetryManager.stopAndFlushApiEvent(o.correlationId,i,!1,t.errorCode),t}))},UserAgentApplication.prototype.acquireTokenPopup=function(t){var r=this;this.logger.verbose("AcquireTokenPopup has been called");var o=sA.validateRequest(t,!1,this.clientId,Ux.interactionTypePopup),i=this.telemetryManager.createAndStartApiEvent(o.correlationId,EA.AcquireTokenPopup);return new Promise((function(t,i){r.acquireTokenInteractive(Ux.interactionTypePopup,!1,o,t,i)})).then((function(t){return r.logger.verbose("Successfully acquired token"),r.telemetryManager.stopAndFlushApiEvent(o.correlationId,i,!0),t})).catch((function(t){throw r.cacheStorage.resetTempCacheItems(o.state),r.telemetryManager.stopAndFlushApiEvent(o.correlationId,i,!1,t.errorCode),t}))},UserAgentApplication.prototype.acquireTokenInteractive=function(t,r,o,i,s){var l,u=this;this.logger.verbose("AcquireTokenInteractive has been called"),lA.blockReloadInHiddenIframes();try{this.cacheStorage.setInteractionInProgress(!0)}catch(i){var h=r?kI.createLoginInProgressError():kI.createAcquireTokenInProgressError(),m=buildResponseStateOnly(this.getAccountState(o.state));return this.cacheStorage.resetTempCacheItems(o.state),void this.authErrorHandler(t,h,m,s)}if(t===Ux.interactionTypeRedirect&&this.cacheStorage.setItem(Bx.REDIRECT_REQUEST,""+Ux.inProgress+Ux.resourceDelimiter+o.state),o&&o.account&&!r?(l=o.account,this.logger.verbose("Account set from request")):(l=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),l||QI.isSSOParam(o))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(l,t,r,o,i,s);else{if(!r){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");m=buildResponseStateOnly(this.getAccountState(o.state));return this.cacheStorage.resetTempCacheItems(o.state),void this.authErrorHandler(t,kI.createUserLoginRequiredError(),m,s)}if(this.extractADALIdToken()&&!o.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var v=this.buildIDTokenRequest(o);this.silentLogin=!0,this.acquireTokenSilent(v).then((function(r){u.silentLogin=!1,u.logger.info("Unified cache call is successful"),u.authResponseHandler(t,r,i)}),(function(l){u.silentLogin=!1,u.logger.error("Error occurred during unified cache ATS: "+l),u.acquireTokenHelper(null,t,r,o,i,s)}))}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,t,r,o,i,s)}},UserAgentApplication.prototype.acquireTokenHelper=function(t,r,o,i,s,l){return __awaiter$I(this,void 0,void 0,(function(){var u,h,m,v,C,_,k,E,R,N;return __generator$2(this,(function(M){switch(M.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+r+". isLoginCall: "+o),u=i.scopes?i.scopes.join(" ").toLowerCase():Ux.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+u),m=i&&i.authority?uA.CreateInstance(i.authority,this.config.auth.validateAuthority,i.authorityMetadata):this.authorityInstance,M.label=1;case 1:return M.trys.push([1,11,,12]),m.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,uA.saveMetadataFromNetwork(m,this.telemetryManager,i.correlationId)]);case 2:return M.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),M.label=4;case 4:if(C=o?qx:this.getTokenType(t,i.scopes),_=i.redirectStartPage||window.location.href,h=new QI(m,this.clientId,C,this.getRedirectUri(i&&i.redirectUri),i.scopes,i.state,i.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(h,t,o,_),this.logger.verbose("Updating cache entries"),h.populateQueryParams(t,i),this.logger.verbose("Query parameters populated from account"),k=GI.createNavigateUrl(h)+Ux.response_mode_fragment,r===Ux.interactionTypeRedirect)o?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(aA.generateTemporaryCacheKey(Bx.STATE_ACQ_TOKEN,i.state),h.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+h.state));else{if(r!==Ux.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),kI.createInvalidInteractionTypeError();window.renewStates.push(h.state),window.requestType=o?Ux.login:Ux.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+h.state),this.registerCallback(h.state,u,s,l)}if(r!==Ux.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{v=this.openPopup(k,"msal",Ux.popUpWidth,Ux.popUpHeight),lA.trackPopup(v)}catch(t){if(this.logger.info(nI.code+":"+nI.desc),this.cacheStorage.setItem($x.ERROR,nI.code),this.cacheStorage.setItem($x.ERROR_DESC,nI.desc),l)return l(kI.createPopupWindowError()),[2]}if(!v)return[3,8];M.label=5;case 5:return M.trys.push([5,7,,8]),[4,lA.monitorPopupForHash(v,this.config.system.loadFrameTimeout,k,this.logger)];case 6:return E=M.sent(),this.handleAuthenticationResponse(E),this.cacheStorage.setInteractionInProgress(!1),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",E),lA.closePopups(),[3,8];case 7:return R=M.sent(),l&&l(R),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",R.errorCode+Ux.resourceDelimiter+R.errorMessage):(this.cacheStorage.setInteractionInProgress(!1),v.close()),[3,8];case 8:return[3,10];case 9:i.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==i.onRedirectNavigate(k)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(k)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(k)),M.label=10;case 10:return[3,12];case 11:return N=M.sent(),this.logger.error(N),this.cacheStorage.resetTempCacheItems(i.state),this.authErrorHandler(r,kI.createEndpointResolutionError(N.toString),buildResponseStateOnly(i.state),l),v&&v.close(),[3,12];case 12:return[2]}}))}))},UserAgentApplication.prototype.ssoSilent=function(t){if(this.logger.verbose("ssoSilent has been called"),!t)throw jI.createEmptyRequestError();if(!t.sid&&!t.loginHint)throw jI.createSsoSilentError();return this.acquireTokenSilent(__assign$2(__assign$2({},t),{scopes:Ux.oidcScopes}))},UserAgentApplication.prototype.acquireTokenSilent=function(t){var r=this;this.logger.verbose("AcquireTokenSilent has been called");var o=sA.validateRequest(t,!1,this.clientId,Ux.interactionTypeSilent),i=this.telemetryManager.createAndStartApiEvent(o.correlationId,EA.AcquireTokenSilent),s=sA.createRequestSignature(o);return new Promise((function(t,i){return __awaiter$I(r,void 0,void 0,(function(){var r,l,u,h,m,v,C,_,k,E,R;return __generator$2(this,(function(N){switch(N.label){case 0:if(lA.blockReloadInHiddenIframes(),r=o.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+r),o.account?(l=o.account,this.logger.verbose("Account set from request")):(l=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),u=this.cacheStorage.getItem(Ux.adalIdToken),!l&&!o.sid&&!o.loginHint&&rI.isEmpty(u))return this.logger.info("User login is required"),[2,i(kI.createUserLoginRequiredError())];if(h=this.getTokenType(l,o.scopes),this.logger.verbose("Response type: "+h),m=new QI(uA.CreateInstance(o.authority,this.config.auth.validateAuthority,o.authorityMetadata),this.clientId,h,this.getRedirectUri(o.redirectUri),o.scopes,o.state,o.correlationId),this.logger.verbose("Finished building server authentication request"),QI.isSSOParam(o)||l?(m.populateQueryParams(l,o,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):l||rI.isEmpty(u)?this.logger.verbose("No additional query parameters added"):(v=rA.extractIdToken(u),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),m.populateQueryParams(l,null,v,!0)),!(C=o.claimsRequest||m.claimsValue)&&!o.forceRefresh)try{k=this.getCachedToken(m,l)}catch(t){_=t}return k?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(k.scopes)),t(k),[2,null]):[3,1];case 1:return _?(this.logger.infoPii(_.errorCode+":"+_.errorMessage),i(_),[2,null]):[3,2];case 2:E=void 0,E=C?"Skipped cache lookup since claims were given":o.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(E),m.authorityInstance||(m.authorityInstance=o.authority?uA.CreateInstance(o.authority,this.config.auth.validateAuthority,o.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+m.authority),N.label=3;case 3:return N.trys.push([3,7,,8]),m.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,uA.saveMetadataFromNetwork(m.authorityInstance,this.telemetryManager,o.correlationId)]);case 4:return N.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),N.label=6;case 6:return window.activeRenewals[s]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[s],s,t,i)):o.scopes&&zI.onlyContainsOidcScopes(o.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(s,t,i,l,m)):(this.logger.verbose("Renewing access token"),this.renewToken(s,t,i,l,m)),[3,8];case 7:return R=N.sent(),this.logger.error(R),i(kI.createEndpointResolutionError(R.toString())),[2,null];case 8:return[2]}}))}))})).then((function(t){return r.logger.verbose("Successfully acquired token"),r.telemetryManager.stopAndFlushApiEvent(o.correlationId,i,!0),t})).catch((function(t){throw r.cacheStorage.resetTempCacheItems(o.state),r.telemetryManager.stopAndFlushApiEvent(o.correlationId,i,!1,t.errorCode),t}))},UserAgentApplication.prototype.openPopup=function(t,r,o,i){this.logger.verbose("OpenPopup has been called");try{var s=window.screenLeft?window.screenLeft:window.screenX,l=window.screenTop?window.screenTop:window.screenY,u=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,m=u/2-o/2+s,v=h/2-i/2+l,C=window.open(t,r,"width="+o+", height="+i+", top="+v+", left="+m+", scrollbars=yes");if(!C)throw kI.createPopupWindowError();return C.focus&&C.focus(),C}catch(t){throw this.cacheStorage.setInteractionInProgress(!1),kI.createPopupWindowError(t.toString())}},UserAgentApplication.prototype.loadIframeTimeout=function(t,r,o){return __awaiter$I(this,void 0,void 0,(function(){var i,s,l,u,h;return __generator$2(this,(function(m){switch(m.label){case 0:return i=window.activeRenewals[o],this.logger.verbosePii("Set loading state to pending for: "+o+":"+i),this.cacheStorage.setItem(aA.generateTemporaryCacheKey(Bx.RENEW_STATUS,i),Ux.inProgress),this.config.system.navigateFrameWait?[4,lA.loadFrame(t,r,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return l=m.sent(),[3,3];case 2:l=lA.loadFrameSync(t,r,this.logger),m.label=3;case 3:s=l,m.label=4;case 4:return m.trys.push([4,6,,7]),[4,lA.monitorIframeForHash(s.contentWindow,this.config.system.loadFrameTimeout,t,this.logger)];case 5:return(u=m.sent())&&this.handleAuthenticationResponse(u),[3,7];case 6:throw h=m.sent(),this.cacheStorage.getItem(aA.generateTemporaryCacheKey(Bx.RENEW_STATUS,i))===Ux.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+o+":"+i),i&&window.callbackMappedToRenewStates[i]&&window.callbackMappedToRenewStates[i](null,h),this.cacheStorage.removeItem(aA.generateTemporaryCacheKey(Bx.RENEW_STATUS,i))),lA.removeHiddenIframe(s),h;case 7:return lA.removeHiddenIframe(s),[2]}}))}))},UserAgentApplication.prototype.navigateWindow=function(t,r){if(!t||rI.isEmpty(t))throw this.logger.info("Navigate url is empty"),tI.createUnexpectedError("Navigate url is empty");var o=r||window,i=r?"Navigated Popup window to:"+t:"Navigate to:"+t;this.logger.infoPii(i),o.location.assign(t)},UserAgentApplication.prototype.registerCallback=function(t,r,o,i){var s=this;window.activeRenewals[r]=t,window.promiseMappedToRenewStates[t]||(window.promiseMappedToRenewStates[t]=[]),window.promiseMappedToRenewStates[t].push({resolve:o,reject:i}),window.callbackMappedToRenewStates[t]||(window.callbackMappedToRenewStates[t]=function(o,i){delete window.activeRenewals[r];for(var l=0;l<window.promiseMappedToRenewStates[t].length;++l)try{if(i)window.promiseMappedToRenewStates[t][l].reject(i);else{if(!o)throw s.cacheStorage.resetTempCacheItems(t),tI.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[t][l].resolve(o)}}catch(t){s.logger.warning(t)}delete window.promiseMappedToRenewStates[t],delete window.callbackMappedToRenewStates[t]})},UserAgentApplication.prototype.logout=function(t){this.logger.verbose("Logout has been called"),this.logoutAsync(t)},UserAgentApplication.prototype.logoutAsync=function(t){return __awaiter$I(this,void 0,void 0,(function(){var r,o,i,s,l,u;return __generator$2(this,(function(h){switch(h.label){case 0:r=t||Lx.createNewGuid(),o=this.telemetryManager.createAndStartApiEvent(r,EA.Logout),this.clearCache(),this.account=null,h.label=1;case 1:return h.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,uA.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,t)]);case 2:return h.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),h.label=4;case 4:return i="client-request-id="+r,s=void 0,this.getPostLogoutRedirectUri()?(s="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(s="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),l=void 0,this.authorityInstance.EndSessionEndpoint?(l=this.authorityInstance.EndSessionEndpoint+"?"+i+s,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(l=this.authority+"oauth2/v2.0/logout?"+i+s,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(r,o,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(l),[3,6];case 5:return u=h.sent(),this.telemetryManager.stopAndFlushApiEvent(r,o,!1,u.errorCode),[3,6];case 6:return[2]}}))}))},UserAgentApplication.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var t=this.cacheStorage.getAllTokens(Ux.clientId,Ux.homeAccountIdentifier),r=0;r<t.length;r++)this.cacheStorage.removeItem(JSON.stringify(t[r].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},UserAgentApplication.prototype.clearCacheForScope=function(t){this.logger.verbose("Clearing access token from cache");for(var r=this.cacheStorage.getAllAccessTokens(Ux.clientId,Ux.homeAccountIdentifier),o=0;o<r.length;o++){var i=r[o];i.value.accessToken===t&&(this.cacheStorage.removeItem(JSON.stringify(i.key)),this.logger.verbosePii("Access token removed: "+i.key))}},UserAgentApplication.prototype.isCallback=function(t){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),GI.urlContainsHash(t)},UserAgentApplication.prototype.processCallBack=function(t,r,o){this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");var i,s,l=r;l||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),l=this.getResponseState(t));try{i=this.saveTokenFromHash(t,l)}catch(t){s=t}try{this.cacheStorage.clearMsalCookie(l.state);var u=this.getAccountState(l.state);if(i){if(l.requestType===Ux.renewToken||i.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+Fx.ACCESS_TOKEN),i.tokenType=Fx.ACCESS_TOKEN):l.requestType===Ux.login&&(this.logger.verbose("Response tokenType set to "+Fx.ID_TOKEN),i.tokenType=Fx.ID_TOKEN),!o)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=i)}else if(!o)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=buildResponseStateOnly(u),this.redirectError=s,void this.cacheStorage.resetTempCacheItems(l.state);this.logger.verbose("Calling callback provided to processCallback"),o(i,s)}catch(t){throw this.logger.error("Error occurred in token received callback function: "+t),kI.createErrorInCallbackFunction(t.toString())}},UserAgentApplication.prototype.handleAuthenticationResponse=function(t){this.logger.verbose("HandleAuthenticationResponse has been called");var r=t||window.location.hash,o=this.getResponseState(r);this.logger.verbose("Obtained state from response");var i=window.callbackMappedToRenewStates[o.state];this.processCallBack(r,o,i)},UserAgentApplication.prototype.handleRedirectAuthenticationResponse=function(t){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),lA.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var r=this.getResponseState(t);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var o=this.cacheStorage.getItem(aA.generateTemporaryCacheKey(Bx.LOGIN_REQUEST,r.state),this.inCookie);if(!o||"null"===o)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var i=GI.removeHashFromUrl(window.location.href),s=GI.removeHashFromUrl(o);if(i!==s)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+i+", finalRedirectUrl: "+s),void window.location.assign(""+s+t);this.logger.verbose("Current url matches login request url");var l=GI.GetUrlComponents(o);l.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=l.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(t,r,null)},UserAgentApplication.prototype.getResponseState=function(t){this.logger.verbose("GetResponseState has been called");var r,o=GI.deserializeHash(t);if(!o)throw tI.createUnexpectedError("Hash was not parsed correctly.");if(!o.hasOwnProperty(Fx.STATE))throw tI.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var i=sA.parseLibraryState(o.state);if((r={requestType:Ux.unknown,state:o.state,timestamp:i.ts,method:i.method,stateMatch:!1}).state===this.cacheStorage.getItem(aA.generateTemporaryCacheKey(Bx.STATE_LOGIN,r.state),this.inCookie)||r.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),r.requestType=Ux.login,r.stateMatch=!0,r;if(r.state===this.cacheStorage.getItem(aA.generateTemporaryCacheKey(Bx.STATE_ACQ_TOKEN,r.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),r.requestType=Ux.renewToken,r.stateMatch=!0,r;if(!r.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),r.requestType=window.requestType;for(var s=window.renewStates,l=0;l<s.length;l++)if(s[l]===r.state){this.logger.verbose("Matching state found for request"),r.stateMatch=!0;break}r.stateMatch||this.logger.verbose("Matching state not found for request")}return r},UserAgentApplication.prototype.getCachedToken=function(t,r){this.logger.verbose("GetCachedToken has been called");var o=t.scopes,i=this.getCachedIdToken(t,r),s=this.getCachedAccessToken(t,r,o),l=this.getAccountState(t.state);return dA.buildAuthResponse(i,s,t,r,o,l)},UserAgentApplication.prototype.getTokenCacheItemByAuthority=function(t,r,o,i){var s,l=this;return 1===(s=GI.isCommonAuthority(t)||GI.isOrganizationsAuthority(t)||GI.isConsumersAuthority(t)?lP.filterTokenCacheItemsByDomain(r,GI.GetUrlComponents(t).HostNameAndPort):lP.filterTokenCacheItemsByAuthority(r,t)).length?s[0]:s.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),s.forEach((function(t){l.cacheStorage.removeItem(JSON.stringify(t.key))})),null):(this.logger.verbose("No matching tokens of type "+i+" found"),null)},UserAgentApplication.prototype.getCachedIdToken=function(t,r){this.logger.verbose("Getting all cached tokens of type ID Token");var o=this.cacheStorage.getAllIdTokens(this.clientId,r?r.homeAccountIdentifier:null),i=t.authority||this.authority,s=this.getTokenCacheItemByAuthority(i,o,null,Fx.ID_TOKEN);if(s){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(s)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var l=s.value;return l?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),l?new oA(l.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(s.key)),null}return this.logger.verbose("No tokens found"),null},UserAgentApplication.prototype.getCachedAccessToken=function(t,r,o){this.logger.verbose("Getting all cached tokens of type Access Token");var i=this.cacheStorage.getAllAccessTokens(this.clientId,r?r.homeAccountIdentifier:null),s=lP.filterTokenCacheItemsByScope(i,o),l=t.authority||this.authority,u=this.getTokenCacheItemByAuthority(l,s,o,Fx.ACCESS_TOKEN);if(u){if(t.authorityInstance=uA.CreateInstance(u.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(u)){this.logger.verbose("Access token expiration is within offset, using access token found in cache");var h=r||this.getAccount();if(!h)throw tI.createUnexpectedError("Account should not be null here.");var m=this.getAccountState(t.state);return{uniqueId:"",tenantId:"",tokenType:Fx.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:u.value.accessToken,scopes:u.key.scopes.split(" "),expiresOn:new Date(1e3*Number(u.value.expiresIn)),account:h,accountState:m,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(u.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},UserAgentApplication.prototype.evaluateTokenExpiration=function(t){var r=Number(t.value.expiresIn);return rA.validateExpirationIsWithinOffset(r,this.config.system.tokenRenewalOffsetSeconds)},UserAgentApplication.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var t=this.cacheStorage.getItem(Ux.adalIdToken);return rI.isEmpty(t)?null:rA.extractIdToken(t)},UserAgentApplication.prototype.renewToken=function(t,r,o,i,s){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+t);var l=lA.generateFrameName(Xx,t);lA.addHiddenIFrame(l,this.logger),this.updateCacheEntries(s,i,!1),this.logger.verbosePii("RenewToken expected state: "+s.state);var u=GI.urlRemoveQueryStringParameter(GI.createNavigateUrl(s),Ux.prompt)+Ux.prompt_none+Ux.response_mode_fragment;window.renewStates.push(s.state),window.requestType=Ux.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(s.state,t,r,o),this.logger.infoPii("Navigate to: "+u),this.loadIframeTimeout(u,l,t).catch((function(t){return o(t)}))},UserAgentApplication.prototype.renewIdToken=function(t,r,o,i,s){this.logger.info("RenewIdToken has been called");var l=lA.generateFrameName(Jx,t);lA.addHiddenIFrame(l,this.logger),this.updateCacheEntries(s,i,!1),this.logger.verbose("RenewIdToken expected state: "+s.state);var u=GI.urlRemoveQueryStringParameter(GI.createNavigateUrl(s),Ux.prompt)+Ux.prompt_none+Ux.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=Ux.login,this.silentAuthenticationState=s.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=Ux.renewToken,window.renewStates.push(s.state)),this.registerCallback(s.state,t,r,o),this.logger.infoPii('Navigate to:" '+u),this.loadIframeTimeout(u,l,t).catch((function(t){return o(t)}))},UserAgentApplication.prototype.saveToken=function(t,r,o,i,s){var l=new VI(r,this.clientId,o,i.uid,i.utid),u=new KI(t.accessToken,t.idToken.rawIdToken,s.toString(),i.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(l),JSON.stringify(u)),s?(this.logger.verbose("New expiration set for token"),t.expiresOn=new Date(1e3*s)):this.logger.error("Could not parse expiresIn parameter for access token"),t},UserAgentApplication.prototype.saveIdToken=function(t,r,o,i,s){this.logger.verbose("SaveIdToken has been called");var l=__assign$2({},t);l.scopes=Ux.oidcScopes,l.accessToken=o[Fx.ID_TOKEN];var u=Number(s.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(l,r,undefined,i,u)},UserAgentApplication.prototype.saveAccessToken=function(t,r,o,i){this.logger.verbose("SaveAccessToken has been called");var s=__assign$2({},t),l=o[Fx.SCOPE],u=l.split(" "),h=this.cacheStorage.getAllAccessTokens(this.clientId,r);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var m=0;m<h.length;m++){var v=h[m];if(v.key.homeAccountIdentifier===t.account.homeAccountIdentifier){var C=v.key.scopes.split(" ");zI.isIntersectingScopes(C,u)&&this.cacheStorage.removeItem(JSON.stringify(v.key))}}s.accessToken=o[Fx.ACCESS_TOKEN],s.scopes=u;var _=tA.parseExpiresIn(o[Fx.EXPIRES_IN]),k=sA.parseLibraryState(o[Fx.STATE]).ts+_;return this.logger.verbose("Saving access token to cache"),this.saveToken(s,r,l,i,k)},UserAgentApplication.prototype.saveTokenFromHash=function(t,r){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+r.stateMatch+"; Request type: "+r.requestType);var o,i={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},s=GI.deserializeHash(t),l="",u="",h=null;if(s.hasOwnProperty(Fx.ERROR_DESCRIPTION)||s.hasOwnProperty(Fx.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+s[Fx.ERROR]+"; Error description: "+s[Fx.ERROR_DESCRIPTION]),this.cacheStorage.setItem($x.ERROR,s[Fx.ERROR]),this.cacheStorage.setItem($x.ERROR_DESC,s[Fx.ERROR_DESCRIPTION]),r.requestType===Ux.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem($x.LOGIN_ERROR,s[Fx.ERROR_DESCRIPTION]+":"+s[Fx.ERROR]),l=aA.generateAuthorityKey(r.state)),r.requestType===Ux.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),l=aA.generateAuthorityKey(r.state);var m=this.getAccount(),v=void 0;m&&!rI.isEmpty(m.homeAccountIdentifier)?(v=m.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(v=Ux.no_account,this.logger.verbose("AccountId is set as no_account")),u=aA.generateAcquireTokenAccountKey(v,r.state)}var C=s[Fx.ERROR],_=s[Fx.ERROR_DESCRIPTION];o=kA.isInteractionRequiredError(C)||kA.isInteractionRequiredError(_)?new kA(s[Fx.ERROR],s[Fx.ERROR_DESCRIPTION]):new bA(s[Fx.ERROR],s[Fx.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),r.stateMatch){this.logger.info("State is right"),s.hasOwnProperty(Fx.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(aA.generateTemporaryCacheKey(Bx.SESSION_STATE,r.state),s[Fx.SESSION_STATE])),i.accountState=this.getAccountState(r.state);var k=void 0;if(s.hasOwnProperty(Fx.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),i.accessToken=s[Fx.ACCESS_TOKEN],s.hasOwnProperty(Fx.SCOPE)&&(i.scopes=s[Fx.SCOPE].split(" ")),s.hasOwnProperty(Fx.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),h=new oA(s[Fx.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),h=new oA(this.cacheStorage.getItem(Hx.IDTOKEN))),i=dA.setResponseIdToken(i,h);var E=this.populateAuthority(r.state,this.inCookie,this.cacheStorage,h);this.logger.verbose("Got authority from cache"),s.hasOwnProperty(Fx.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),k=new eA(s[Fx.CLIENT_INFO],E)):this.authorityInstance.AuthorityType===Kx.Adfs?k=eA.createClientInfoFromIdToken(h,E):this.logger.warning("ClientInfo not received in the response from AAD"),i.account=cA.createAccount(h,k),this.logger.verbose("Account object created from response");var R=void 0;i.account&&!rI.isEmpty(i.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),R=i.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),R=Ux.no_account),u=aA.generateAcquireTokenAccountKey(R,r.state);var N=aA.generateAcquireTokenAccountKey(Ux.no_account,r.state);this.logger.verbose("AcquireTokenAccountKey generated");var M=this.cacheStorage.getItem(u),B=void 0;rI.isEmpty(M)?rI.isEmpty(this.cacheStorage.getItem(N))||(this.logger.verbose("No acquireToken account retrieved from cache"),i=this.saveAccessToken(i,E,s,k)):(B=JSON.parse(M),this.logger.verbose("AcquireToken request account retrieved from cache"),i.account&&B&&cA.compareAccounts(i.account,B)?(i=this.saveAccessToken(i,E,s,k),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(s.hasOwnProperty(Fx.ID_TOKEN)){this.logger.info("Fragment has idToken"),h=new oA(s[Fx.ID_TOKEN]);E=this.populateAuthority(r.state,this.inCookie,this.cacheStorage,h);if(i=dA.setResponseIdToken(i,h),s.hasOwnProperty(Fx.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),k=new eA(s[Fx.CLIENT_INFO],E)):this.authorityInstance.AuthorityType===Kx.Adfs?k=eA.createClientInfoFromIdToken(h,E):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=cA.createAccount(h,k),i.account=this.account,this.logger.verbose("Account object created from response"),h&&h.nonce){this.logger.verbose("IdToken has nonce");var H=this.cacheStorage.getItem(aA.generateTemporaryCacheKey(Bx.NONCE_IDTOKEN,r.state),this.inCookie);h.nonce!==H?(this.account=null,this.cacheStorage.setItem($x.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+H+",Actual Nonce: "+h.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+H+", Actual Nonce: "+h.nonce),o=kI.createNonceMismatchError(H,h.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(Hx.IDTOKEN,s[Fx.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(Hx.CLIENT_INFO,k.encodeClientInfo(),this.inCookie),this.saveIdToken(i,E,s,k,h))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),l=r.state,u=r.state,this.logger.error("Invalid id_token received in the response"),o=kI.createInvalidIdTokenError(h),this.cacheStorage.setItem($x.ERROR,o.errorCode),this.cacheStorage.setItem($x.ERROR_DESC,o.errorMessage)}}else{this.logger.verbose("State mismatch"),l=r.state,u=r.state;var $=this.cacheStorage.getItem(aA.generateTemporaryCacheKey(Bx.STATE_LOGIN,r.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+$+", Actual State: "+r.state),o=kI.createInvalidStateError(r.state,$),this.cacheStorage.setItem($x.ERROR,o.errorCode),this.cacheStorage.setItem($x.ERROR_DESC,o.errorMessage)}if(this.cacheStorage.removeItem(aA.generateTemporaryCacheKey(Bx.RENEW_STATUS,r.state)),this.cacheStorage.resetTempCacheItems(r.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(l,"",-1),this.cacheStorage.clearMsalCookie(r.state)),o)throw o;if(!i)throw tI.createUnexpectedError("Response is null");return i},UserAgentApplication.prototype.populateAuthority=function(t,r,o,i){this.logger.verbose("PopulateAuthority has been called");var s=aA.generateAuthorityKey(t),l=o.getItem(s,r);return rI.isEmpty(l)?l:GI.replaceTenantPath(l,i.tenantId)},UserAgentApplication.prototype.getAccount=function(){if(this.account)return this.account;var t=this.cacheStorage.getItem(Hx.IDTOKEN,this.inCookie),r=this.cacheStorage.getItem(Hx.CLIENT_INFO,this.inCookie);if(!rI.isEmpty(t)&&!rI.isEmpty(r)){var o=new oA(t),i=new eA(r,"");return this.account=cA.createAccount(o,i),this.account}return null},UserAgentApplication.prototype.getAccountState=function(t){if(t){var r=t.indexOf(Ux.resourceDelimiter);if(r>-1&&r+1<t.length)return t.substring(r+1)}return t},UserAgentApplication.prototype.getAllAccounts=function(){for(var t=[],r=this.cacheStorage.getAllAccessTokens(Ux.clientId,Ux.homeAccountIdentifier),o=0;o<r.length;o++){var i=new oA(r[o].value.idToken),s=new eA(r[o].value.homeAccountIdentifier,""),l=cA.createAccount(i,s);t.push(l)}return this.getUniqueAccounts(t)},UserAgentApplication.prototype.getUniqueAccounts=function(t){if(!t||t.length<=1)return t;for(var r=[],o=[],i=0;i<t.length;++i)t[i].homeAccountIdentifier&&-1===r.indexOf(t[i].homeAccountIdentifier)&&(r.push(t[i].homeAccountIdentifier),o.push(t[i]));return o},UserAgentApplication.prototype.broadcast=function(t,r){var o=new CustomEvent(t,{detail:r});window.dispatchEvent(o)},UserAgentApplication.prototype.getCachedTokenInternal=function(t,r,o,i){var s=r||this.getAccount();if(!s)return null;var l=this.authorityInstance?this.authorityInstance:uA.CreateInstance(this.authority,this.config.auth.validateAuthority),u=this.getTokenType(s,t),h=new QI(l,this.clientId,u,this.getRedirectUri(),t,o,i);return this.getCachedToken(h,r)},UserAgentApplication.prototype.getScopesForEndpoint=function(t){if(this.config.framework.unprotectedResources.length>0)for(var r=0;r<this.config.framework.unprotectedResources.length;r++)if(t.indexOf(this.config.framework.unprotectedResources[r])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var o=0,i=Array.from(this.config.framework.protectedResourceMap.keys());o<i.length;o++){var s=i[o];if(t.indexOf(s)>-1)return this.config.framework.protectedResourceMap.get(s)}return t.indexOf("http://")>-1||t.indexOf("https://")>-1?GI.getHostFromUri(t)===GI.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},UserAgentApplication.prototype.getLoginInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},UserAgentApplication.prototype.setInteractionInProgress=function(t){this.cacheStorage.setInteractionInProgress(t)},UserAgentApplication.prototype.setloginInProgress=function(t){this.setInteractionInProgress(t)},UserAgentApplication.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},UserAgentApplication.prototype.setAcquireTokenInProgress=function(t){this.setInteractionInProgress(t)},UserAgentApplication.prototype.getLogger=function(){return this.logger},UserAgentApplication.prototype.setLogger=function(t){this.logger=t},UserAgentApplication.prototype.getRedirectUri=function(t){return t||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},UserAgentApplication.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},UserAgentApplication.prototype.getCurrentConfiguration=function(){if(!this.config)throw jI.createNoSetConfigurationError();return this.config},UserAgentApplication.prototype.getTokenType=function(t,r){var o=cA.compareAccounts(t,this.getAccount());return QI.determineResponseType(o,r)},UserAgentApplication.prototype.setAccountCache=function(t,r){var o=t?this.getAccountId(t):Ux.no_account,i=aA.generateAcquireTokenAccountKey(o,r);this.cacheStorage.setItem(i,JSON.stringify(t))},UserAgentApplication.prototype.setAuthorityCache=function(t,r){var o=aA.generateAuthorityKey(t);this.cacheStorage.setItem(o,GI.CanonicalizeUri(r),this.inCookie)},UserAgentApplication.prototype.updateCacheEntries=function(t,r,o,i){i&&this.cacheStorage.setItem(aA.generateTemporaryCacheKey(Bx.LOGIN_REQUEST,t.state),i,this.inCookie),o?this.cacheStorage.setItem(aA.generateTemporaryCacheKey(Bx.STATE_LOGIN,t.state),t.state,this.inCookie):this.setAccountCache(r,t.state),this.setAuthorityCache(t.state,t.authority),this.cacheStorage.setItem(aA.generateTemporaryCacheKey(Bx.NONCE_IDTOKEN,t.state),t.nonce,this.inCookie)},UserAgentApplication.prototype.getAccountId=function(t){return rI.isEmpty(t.homeAccountIdentifier)?Ux.no_account:t.homeAccountIdentifier},UserAgentApplication.prototype.buildIDTokenRequest=function(t){return{scopes:Ux.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:t.extraQueryParameters,correlationId:t.correlationId}},UserAgentApplication.prototype.getTelemetryManagerFromConfig=function(t,r){if(!t)return cP.getTelemetrymanagerStub(r,this.logger);var o=t.applicationName,i=t.applicationVersion,s=t.telemetryEmitter;if(!o||!i||!s)throw jI.createTelemetryConfigError(t);return new cP({platform:{applicationName:o,applicationVersion:i},clientId:r},s,this.logger)},UserAgentApplication}();class EventDispatcher{constructor(){this.eventHandlers=[]}fire(t){for(const r of this.eventHandlers)r(t)}add(t){this.eventHandlers.push(t)}remove(t){for(let r=0;r<this.eventHandlers.length;r++)this.eventHandlers[r]===t&&(this.eventHandlers.splice(r,1),r--)}}class IProvider{get state(){return this._state}get isIncrementalConsentDisabled(){return this._isIncrementalConsentDisabled}set isIncrementalConsentDisabled(t){this._isIncrementalConsentDisabled=t}get name(){return"MgtIProvider"}constructor(){this.isMultipleAccountDisabled=!0,this._loginChangedDispatcher=new EventDispatcher,this._activeAccountChangedDispatcher=new EventDispatcher,this._isIncrementalConsentDisabled=!1,this._state=exports.ProviderState.Loading}setState(t){t!==this._state&&(this._state=t,this._loginChangedDispatcher.fire({}))}onStateChanged(t){this._loginChangedDispatcher.add(t)}removeStateChangedHandler(t){this._loginChangedDispatcher.remove(t)}setActiveAccount(t){this.fireActiveAccountChanged()}onActiveAccountChanged(t){this._activeAccountChangedDispatcher.add(t)}removeActiveAccountChangedHandler(t){this._activeAccountChangedDispatcher.remove(t)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(...t){return this.getAccessToken({scopes:t})}}exports.LoginType=void 0,(GA=exports.LoginType||(exports.LoginType={}))[GA.Popup=0]="Popup",GA[GA.Redirect=1]="Redirect",exports.ProviderState=void 0,(VA=exports.ProviderState||(exports.ProviderState={}))[VA.Loading=0]="Loading",VA[VA.SignedOut=1]="SignedOut",VA[VA.SignedIn=2]="SignedIn";var uP,__awaiter$H=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class Providers{static get globalProvider(){return this._globalProvider}static set globalProvider(t){t!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),t&&(t.onStateChanged(this.handleProviderStateChanged),t.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=t,this._eventDispatcher.fire(exports.ProvidersChangedState.ProviderChanged))}static onProviderUpdated(t){this._eventDispatcher.add(t)}static removeProviderUpdatedListener(t){this._eventDispatcher.remove(t)}static onActiveAccountChanged(t){this._activeAccountChangedDispatcher.add(t)}static removeActiveAccountChangedListener(t){this._activeAccountChangedDispatcher.remove(t)}static me(){return __awaiter$H(this,void 0,void 0,(function*(){if(!this._me){const t=this.client;if(t)try{const r=yield t.api("me").get();r&&r.id&&(this._me=r)}catch(t){}}return this._me}))}static get client(){return Providers.globalProvider&&Providers.globalProvider.state===exports.ProviderState.SignedIn?Providers.globalProvider.graph.client:null}static handleProviderStateChanged(){Providers.globalProvider&&Providers.globalProvider.state===exports.ProviderState.SignedIn||(Providers._me=null),Providers._eventDispatcher.fire(exports.ProvidersChangedState.ProviderStateChanged)}static handleActiveAccountChanged(){Providers._activeAccountChangedDispatcher.fire(null)}}function prepScopes(...t){const r={scopes:t};return Providers.globalProvider.isIncrementalConsentDisabled?[]:[new AuthenticationHandlerOptions(void 0,r)]}function chainMiddleware(...t){const r=t[0];let o=r;for(let r=1;r<t.length;++r){const i=t[r];o.setNext&&o.setNext(i),o=i}return r}function validateBaseURL(t){try{const r=new URL(t).origin;if(Tx.has(r))return r}catch(t){return}}Providers._eventDispatcher=new EventDispatcher,Providers._activeAccountChangedDispatcher=new EventDispatcher,exports.ProvidersChangedState=void 0,(uP=exports.ProvidersChangedState||(exports.ProvidersChangedState={}))[uP.ProviderChanged=0]="ProviderChanged",uP[uP.ProviderStateChanged=1]="ProviderStateChanged";var __awaiter$G=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class BatchRequest{constructor(t,r,o,i){"/"!==o.charAt(0)&&(o="/"+o),this.resource=o,this.method=i,this.index=t,this.id=r}}class Batch{constructor(t){this.graph=t,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}get hasRequests(){return this.requestsQueue.length>0}get(t,r,o,i){const s=this.nextIndex++,l=new BatchRequest(s,t,r,"GET");l.headers=i,this.allRequests.push(l),this.requestsQueue.push(s),o&&(this.scopes=this.scopes.concat(o))}executeNext(){return __awaiter$G(this,void 0,void 0,(function*(){const t=new Map;if(this.retryAfter&&(yield function delay(t){return new Promise((r=>{setTimeout(r,t)}))}(1e3*this.retryAfter),this.retryAfter=0),!this.hasRequests)return t;const r=this.requestsQueue.splice(0,20),o=new BatchRequestContent;for(const t of r.map((t=>this.allRequests[t])))o.addRequest({id:t.index.toString(),request:new Request(Batch.baseUrl+t.resource,{method:t.method,headers:t.headers})});const i=this.scopes.length?prepScopes(...this.scopes):[],s=this.graph.api("$batch").middlewareOptions(i),l=yield o.getContent(),u=yield s.post(l);for(const r of u.responses){const o=new BatchResponse,i=this.allRequests[r.id];o.id=i.id,o.index=i.index,o.headers=r.headers,200===r.status?(r.headers["Content-Type"].includes("image/jpeg")?o.content="data:image/jpeg;base64,"+r.body:r.headers["Content-Type"].includes("image/pjpeg")?o.content="data:image/pjpeg;base64,"+r.body:r.headers["Content-Type"].includes("image/png")?o.content="data:image/png;base64,"+r.body:o.content=r.body,t.set(i.id,o)):429===r.status&&(this.requestsQueue.unshift(r.id),this.retryAfter=Math.max(this.retryAfter,parseInt(r.headers["Retry-After"],10)||1))}return t}))}executeAll(){return __awaiter$G(this,void 0,void 0,(function*(){const t=new Map;for(;this.hasRequests;){const r=yield this.executeNext();for(const[o,i]of r)t.set(o,i)}return t}))}}Batch.baseUrl="https://graph.microsoft.com";class ComponentMiddlewareOptions{constructor(t){this.componentName="string"==typeof t?t:t.tagName.toLowerCase()}}var __awaiter$F=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class SdkVersionMiddleware{constructor(t,r){this._packageVersion=t,this._providerName=r}execute(t){var r;return __awaiter$F(this,void 0,void 0,(function*(){try{if("string"==typeof t.request)if(validateBaseURL(t.request)){const r=[],o=t.middlewareControl.getMiddlewareOptions(ComponentMiddlewareOptions);if(o){const t=`${o.componentName}/${this._packageVersion}`;r.push(t)}if(this._providerName){const t=`${this._providerName}/${this._packageVersion}`;r.push(t)}const i=`mgt/${this._packageVersion}`;r.push(i),r.push(getRequestHeader(t.request,t.options,"SdkVersion"));const s=r.join(", ");setRequestHeader(t.request,t.options,"SdkVersion",s)}else null===(r=null==t?void 0:t.options)||void 0===r||delete r.headers.SdkVersion}catch(t){}return yield this._nextMiddleware.execute(t)}))}setNext(t){this._nextMiddleware=t}}const hP="2.10.1";class Graph{get client(){return this._client}get componentName(){return this._componentName}get version(){return this._version}constructor(t,r="v1.0"){this._client=t,this._version=r}forComponent(t){const r=new Graph(this._client,this._version);return r.setComponent(t),r}api(t){let r=this._client.api(t).version(this._version);return this._componentName&&(r.middlewareOptions=t=>{const o=r;return o._middlewareOptions=o._middlewareOptions.concat(t),r},r=r.middlewareOptions([new ComponentMiddlewareOptions(this._componentName)])),r}createBatch(){return new Batch(this)}setComponent(t){this._componentName=t instanceof Element?t.tagName:t}}function createFromProvider(t,r,o){const i=[new AuthenticationHandler(t),new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new SdkVersionMiddleware(hP,t.name),new HTTPMessageHandler],s=Client.initWithMiddleware({middleware:chainMiddleware(...i)}),l=new Graph(s,r);return o?l.forComponent(o):l}class BetaGraph extends Graph{static fromGraph(t){const r=new BetaGraph(t.client);return r.setComponent(t.componentName),r}constructor(t,r="beta"){super(t,r)}forComponent(t){const r=new BetaGraph(this.client);return this.setComponent(t),r}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const pP="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,removeNodes=(t,r,o=null)=>{for(;r!==o;){const o=r.nextSibling;t.removeChild(r),r=o}},fP=`{{lit-${String(Math.random()).slice(2)}}}`,gP=`\x3c!--${fP}--\x3e`,mP=new RegExp(`${fP}|${gP}`),vP="$lit$";class Template{constructor(t,r){this.parts=[],this.element=r;const o=[],i=[],s=document.createTreeWalker(r.content,133,null,!1);let l=0,u=-1,h=0;const{strings:m,values:{length:v}}=t;for(;h<v;){const t=s.nextNode();if(null!==t){if(u++,1===t.nodeType){if(t.hasAttributes()){const r=t.attributes,{length:o}=r;let i=0;for(let t=0;t<o;t++)endsWith(r[t].name,vP)&&i++;for(;i-- >0;){const r=m[h],o=yP.exec(r)[2],i=o.toLowerCase()+vP,s=t.getAttribute(i);t.removeAttribute(i);const l=s.split(mP);this.parts.push({type:"attribute",index:u,name:o,strings:l}),h+=l.length-1}}"TEMPLATE"===t.tagName&&(i.push(t),s.currentNode=t.content)}else if(3===t.nodeType){const r=t.data;if(r.indexOf(fP)>=0){const i=t.parentNode,s=r.split(mP),l=s.length-1;for(let r=0;r<l;r++){let o,l=s[r];if(""===l)o=createMarker();else{const t=yP.exec(l);null!==t&&endsWith(t[2],vP)&&(l=l.slice(0,t.index)+t[1]+t[2].slice(0,-5)+t[3]),o=document.createTextNode(l)}i.insertBefore(o,t),this.parts.push({type:"node",index:++u})}""===s[l]?(i.insertBefore(createMarker(),t),o.push(t)):t.data=s[l],h+=l}}else if(8===t.nodeType)if(t.data===fP){const r=t.parentNode;null!==t.previousSibling&&u!==l||(u++,r.insertBefore(createMarker(),t)),l=u,this.parts.push({type:"node",index:u}),null===t.nextSibling?t.data="":(o.push(t),u--),h++}else{let r=-1;for(;-1!==(r=t.data.indexOf(fP,r+1));)this.parts.push({type:"node",index:-1}),h++}}else s.currentNode=i.pop()}for(const t of o)t.parentNode.removeChild(t)}}const endsWith=(t,r)=>{const o=t.length-r.length;return o>=0&&t.slice(o)===r},isTemplatePartActive=t=>-1!==t.index,createMarker=()=>document.createComment(""),yP=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function removeNodesFromTemplate(t,r){const{element:{content:o},parts:i}=t,s=document.createTreeWalker(o,133,null,!1);let l=nextActiveIndexInTemplateParts(i),u=i[l],h=-1,m=0;const v=[];let C=null;for(;s.nextNode();){h++;const t=s.currentNode;for(t.previousSibling===C&&(C=null),r.has(t)&&(v.push(t),null===C&&(C=t)),null!==C&&m++;void 0!==u&&u.index===h;)u.index=null!==C?-1:u.index-m,l=nextActiveIndexInTemplateParts(i,l),u=i[l]}v.forEach((t=>t.parentNode.removeChild(t)))}const countNodes=t=>{let r=11===t.nodeType?0:1;const o=document.createTreeWalker(t,133,null,!1);for(;o.nextNode();)r++;return r},nextActiveIndexInTemplateParts=(t,r=-1)=>{for(let o=r+1;o<t.length;o++){const r=t[o];if(isTemplatePartActive(r))return o}return-1};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const bP=new WeakMap,directive=t=>(...r)=>{const o=t(...r);return bP.set(o,!0),o},isDirective=t=>"function"==typeof t&&bP.has(t),wP={},CP={};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class TemplateInstance{constructor(t,r,o){this.__parts=[],this.template=t,this.processor=r,this.options=o}update(t){let r=0;for(const o of this.__parts)void 0!==o&&o.setValue(t[r]),r++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const t=pP?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),r=[],o=this.template.parts,i=document.createTreeWalker(t,133,null,!1);let s,l=0,u=0,h=i.nextNode();for(;l<o.length;)if(s=o[l],isTemplatePartActive(s)){for(;u<s.index;)u++,"TEMPLATE"===h.nodeName&&(r.push(h),i.currentNode=h.content),null===(h=i.nextNode())&&(i.currentNode=r.pop(),h=i.nextNode());if("node"===s.type){const t=this.processor.handleTextExpression(this.options);t.insertAfterNode(h.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(h,s.name,s.strings,this.options));l++}else this.__parts.push(void 0),l++;return pP&&(document.adoptNode(t),customElements.upgrade(t)),t}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const _P=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:t=>t}),kP=` ${fP} `;class TemplateResult{constructor(t,r,o,i){this.strings=t,this.values=r,this.type=o,this.processor=i}getHTML(){const t=this.strings.length-1;let r="",o=!1;for(let i=0;i<t;i++){const t=this.strings[i],s=t.lastIndexOf("\x3c!--");o=(s>-1||o)&&-1===t.indexOf("--\x3e",s+1);const l=yP.exec(t);r+=null===l?t+(o?kP:gP):t.substr(0,l.index)+l[1]+l[2]+vP+l[3]+fP}return r+=this.strings[t],r}getTemplateElement(){const t=document.createElement("template");let r=this.getHTML();return void 0!==_P&&(r=_P.createHTML(r)),t.innerHTML=r,t}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const isPrimitive=t=>null===t||!("object"==typeof t||"function"==typeof t),isIterable=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class AttributeCommitter{constructor(t,r,o){this.dirty=!0,this.element=t,this.name=r,this.strings=o,this.parts=[];for(let t=0;t<o.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new AttributePart(this)}_getValue(){const t=this.strings,r=t.length-1,o=this.parts;if(1===r&&""===t[0]&&""===t[1]){const t=o[0].value;if("symbol"==typeof t)return String(t);if("string"==typeof t||!isIterable(t))return t}let i="";for(let s=0;s<r;s++){i+=t[s];const r=o[s];if(void 0!==r){const t=r.value;if(isPrimitive(t)||!isIterable(t))i+="string"==typeof t?t:String(t);else for(const r of t)i+="string"==typeof r?r:String(r)}}return i+=t[r],i}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class AttributePart{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===wP||isPrimitive(t)&&t===this.value||(this.value=t,isDirective(t)||(this.committer.dirty=!0))}commit(){for(;isDirective(this.value);){const t=this.value;this.value=wP,t(this)}this.value!==wP&&this.committer.commit()}}class NodePart{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(createMarker()),this.endNode=t.appendChild(createMarker())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=createMarker()),t.__insert(this.endNode=createMarker())}insertAfterPart(t){t.__insert(this.startNode=createMarker()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(null===this.startNode.parentNode)return;for(;isDirective(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=wP,t(this)}const t=this.__pendingValue;t!==wP&&(isPrimitive(t)?t!==this.value&&this.__commitText(t):t instanceof TemplateResult?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):isIterable(t)?this.__commitIterable(t):t===CP?(this.value=CP,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const r=this.startNode.nextSibling,o="string"==typeof(t=null==t?"":t)?t:String(t);r===this.endNode.previousSibling&&3===r.nodeType?r.data=o:this.__commitNode(document.createTextNode(o)),this.value=t}__commitTemplateResult(t){const r=this.options.templateFactory(t);if(this.value instanceof TemplateInstance&&this.value.template===r)this.value.update(t.values);else{const o=new TemplateInstance(r,t.processor,this.options),i=o._clone();o.update(t.values),this.__commitNode(i),this.value=o}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const r=this.value;let o,i=0;for(const s of t)o=r[i],void 0===o&&(o=new NodePart(this.options),r.push(o),0===i?o.appendIntoPart(this):o.insertAfterPart(r[i-1])),o.setValue(s),o.commit(),i++;i<r.length&&(r.length=i,this.clear(o&&o.endNode))}clear(t=this.startNode){removeNodes(this.startNode.parentNode,t.nextSibling,this.endNode)}}class BooleanAttributePart{constructor(t,r,o){if(this.value=void 0,this.__pendingValue=void 0,2!==o.length||""!==o[0]||""!==o[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=r,this.strings=o}setValue(t){this.__pendingValue=t}commit(){for(;isDirective(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=wP,t(this)}if(this.__pendingValue===wP)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=wP}}class PropertyCommitter extends AttributeCommitter{constructor(t,r,o){super(t,r,o),this.single=2===o.length&&""===o[0]&&""===o[1]}_createPart(){return new PropertyPart(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class PropertyPart extends AttributePart{}let SP=!1;(()=>{try{const t={get capture(){return SP=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})();class EventPart{constructor(t,r,o){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=r,this.eventContext=o,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;isDirective(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=wP,t(this)}if(this.__pendingValue===wP)return;const t=this.__pendingValue,r=this.value,o=null==t||null!=r&&(t.capture!==r.capture||t.once!==r.once||t.passive!==r.passive),i=null!=t&&(null==r||o);o&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),i&&(this.__options=getOptions(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=wP}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const getOptions=t=>t&&(SP?{capture:t.capture,passive:t.passive,once:t.once}:t.capture)
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */;function templateFactory(t){let r=TP.get(t.type);void 0===r&&(r={stringsArray:new WeakMap,keyString:new Map},TP.set(t.type,r));let o=r.stringsArray.get(t.strings);if(void 0!==o)return o;const i=t.strings.join(fP);return o=r.keyString.get(i),void 0===o&&(o=new Template(t,t.getTemplateElement()),r.keyString.set(i,o)),r.stringsArray.set(t.strings,o),o}const TP=new Map,EP=new WeakMap;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const xP=new
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class DefaultTemplateProcessor{handleAttributeExpressions(t,r,o,i){const s=r[0];if("."===s){return new PropertyCommitter(t,r.slice(1),o).parts}if("@"===s)return[new EventPart(t,r.slice(1),i.eventContext)];if("?"===s)return[new BooleanAttributePart(t,r.slice(1),o)];return new AttributeCommitter(t,r,o).parts}handleTextExpression(t){return new NodePart(t)}};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");const html$1=(t,...r)=>new TemplateResult(t,r,"html",xP)
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */,getTemplateCacheKey=(t,r)=>`${t}--${r}`;let IP=!0;void 0===window.ShadyCSS?IP=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),IP=!1);const shadyTemplateFactory=t=>r=>{const o=getTemplateCacheKey(r.type,t);let i=TP.get(o);void 0===i&&(i={stringsArray:new WeakMap,keyString:new Map},TP.set(o,i));let s=i.stringsArray.get(r.strings);if(void 0!==s)return s;const l=r.strings.join(fP);if(s=i.keyString.get(l),void 0===s){const o=r.getTemplateElement();IP&&window.ShadyCSS.prepareTemplateDom(o,t),s=new Template(r,o),i.keyString.set(l,s)}return i.stringsArray.set(r.strings,s),s},AP=["html","svg"],PP=new Set,prepareTemplateStyles=(t,r,o)=>{PP.add(t);const i=o?o.element:document.createElement("template"),s=r.querySelectorAll("style"),{length:l}=s;if(0===l)return void window.ShadyCSS.prepareTemplateStyles(i,t);const u=document.createElement("style");for(let t=0;t<l;t++){const r=s[t];r.parentNode.removeChild(r),u.textContent+=r.textContent}(t=>{AP.forEach((r=>{const o=TP.get(getTemplateCacheKey(r,t));void 0!==o&&o.keyString.forEach((t=>{const{element:{content:r}}=t,o=new Set;Array.from(r.querySelectorAll("style")).forEach((t=>{o.add(t)})),removeNodesFromTemplate(t,o)}))}))})(t);const h=i.content;o?function insertNodeIntoTemplate(t,r,o=null){const{element:{content:i},parts:s}=t;if(null==o)return void i.appendChild(r);const l=document.createTreeWalker(i,133,null,!1);let u=nextActiveIndexInTemplateParts(s),h=0,m=-1;for(;l.nextNode();)for(m++,l.currentNode===o&&(h=countNodes(r),o.parentNode.insertBefore(r,o));-1!==u&&s[u].index===m;){if(h>0){for(;-1!==u;)s[u].index+=h,u=nextActiveIndexInTemplateParts(s,u);return}u=nextActiveIndexInTemplateParts(s,u)}}(o,u,h.firstChild):h.insertBefore(u,h.firstChild),window.ShadyCSS.prepareTemplateStyles(i,t);const m=h.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==m)r.insertBefore(m.cloneNode(!0),r.firstChild);else if(o){h.insertBefore(u,h.firstChild);const t=new Set;t.add(u),removeNodesFromTemplate(o,t)}};window.JSCompiler_renameProperty=(t,r)=>t;const RP={toAttribute(t,r){switch(r){case Boolean:return t?"":null;case Object:case Array:return null==t?t:JSON.stringify(t)}return t},fromAttribute(t,r){switch(r){case Boolean:return null!==t;case Number:return null===t?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},notEqual=(t,r)=>r!==t&&(r==r||t==t),OP={attribute:!0,type:String,converter:RP,reflect:!1,hasChanged:notEqual},NP="finalized";class UpdatingElement extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const t=[];return this._classProperties.forEach(((r,o)=>{const i=this._attributeNameForProperty(o,r);void 0!==i&&(this._attributeToPropertyMap.set(i,o),t.push(i))})),t}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach(((t,r)=>this._classProperties.set(r,t)))}}static createProperty(t,r=OP){if(this._ensureClassProperties(),this._classProperties.set(t,r),r.noAccessor||this.prototype.hasOwnProperty(t))return;const o="symbol"==typeof t?Symbol():`__${t}`,i=this.getPropertyDescriptor(t,o,r);void 0!==i&&Object.defineProperty(this.prototype,t,i)}static getPropertyDescriptor(t,r,o){return{get(){return this[r]},set(i){const s=this[t];this[r]=i,this.requestUpdateInternal(t,s,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this._classProperties&&this._classProperties.get(t)||OP}static finalize(){const t=Object.getPrototypeOf(this);if(t.hasOwnProperty(NP)||t.finalize(),this[NP]=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const t=this.properties,r=[...Object.getOwnPropertyNames(t),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]];for(const o of r)this.createProperty(o,t[o])}}static _attributeNameForProperty(t,r){const o=r.attribute;return!1===o?void 0:"string"==typeof o?o:"string"==typeof t?t.toLowerCase():void 0}static _valueHasChanged(t,r,o=notEqual){return o(t,r)}static _propertyValueFromAttribute(t,r){const o=r.type,i=r.converter||RP,s="function"==typeof i?i:i.fromAttribute;return s?s(t,o):t}static _propertyValueToAttribute(t,r){if(void 0===r.reflect)return;const o=r.type,i=r.converter;return(i&&i.toAttribute||RP.toAttribute)(t,o)}initialize(){this._updateState=0,this._updatePromise=new Promise((t=>this._enableUpdatingResolver=t)),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach(((t,r)=>{if(this.hasOwnProperty(r)){const t=this[r];delete this[r],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(r,t)}}))}_applyInstanceProperties(){this._instanceProperties.forEach(((t,r)=>this[r]=t)),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(t,r,o){r!==o&&this._attributeToProperty(t,o)}_propertyToAttribute(t,r,o=OP){const i=this.constructor,s=i._attributeNameForProperty(t,o);if(void 0!==s){const t=i._propertyValueToAttribute(r,o);if(void 0===t)return;this._updateState=8|this._updateState,null==t?this.removeAttribute(s):this.setAttribute(s,t),this._updateState=-9&this._updateState}}_attributeToProperty(t,r){if(8&this._updateState)return;const o=this.constructor,i=o._attributeToPropertyMap.get(t);if(void 0!==i){const t=o.getPropertyOptions(i);this._updateState=16|this._updateState,this[i]=o._propertyValueFromAttribute(r,t),this._updateState=-17&this._updateState}}requestUpdateInternal(t,r,o){let i=!0;if(void 0!==t){const s=this.constructor;o=o||s.getPropertyOptions(t),s._valueHasChanged(this[t],r,o.hasChanged)?(this._changedProperties.has(t)||this._changedProperties.set(t,r),!0!==o.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(t,o))):i=!1}!this._hasRequestedUpdate&&i&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(t,r){return this.requestUpdateInternal(t,r),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(t){}const t=this.performUpdate();return null!=t&&await t,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let t=!1;const r=this._changedProperties;try{t=this.shouldUpdate(r),t?this.update(r):this._markUpdated()}catch(r){throw t=!1,this._markUpdated(),r}t&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(r)),this.updated(r))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(t){return!0}update(t){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach(((t,r)=>this._propertyToAttribute(r,this[r],t))),this._reflectingProperties=void 0),this._markUpdated()}updated(t){}firstUpdated(t){}}UpdatingElement[NP]=!0;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const standardProperty$1=(t,r)=>"method"===r.kind&&r.descriptor&&!("value"in r.descriptor)?Object.assign(Object.assign({},r),{finisher(o){o.createProperty(r.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof r.initializer&&(this[r.key]=r.initializer.call(this))},finisher(o){o.createProperty(r.key,t)}},legacyProperty$1=(t,r,o)=>{r.constructor.createProperty(o,t)};function property$1(t){return(r,o)=>void 0!==o?legacyProperty$1(t,r,o):standardProperty$1(t,r)}
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const MP=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,DP=Symbol();class CSSResult$1{constructor(t,r){if(r!==DP)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){return void 0===this._styleSheet&&(MP?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");const FP={};class LitElement extends UpdatingElement{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const t=this.getStyles();if(Array.isArray(t)){const addStyles=(t,r)=>t.reduceRight(((t,r)=>Array.isArray(r)?addStyles(r,t):(t.add(r),t)),r),r=addStyles(t,new Set),o=[];r.forEach((t=>o.unshift(t))),this._styles=o}else this._styles=void 0===t?[]:[t];this._styles=this._styles.map((t=>{if(t instanceof CSSStyleSheet&&!MP){const r=Array.prototype.slice.call(t.cssRules).reduce(((t,r)=>t+r.cssText),"");return new CSSResult$1(String(r),DP)}return t}))}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const t=this.constructor._styles;0!==t.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?MP?this.renderRoot.adoptedStyleSheets=t.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(t.map((t=>t.cssText)),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(t){const r=this.render();super.update(t),r!==FP&&this.constructor.render(r,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach((t=>{const r=document.createElement("style");r.textContent=t.cssText,this.renderRoot.appendChild(r)})))}render(){return FP}}LitElement.finalized=!0,LitElement.render=(t,r,o)=>{if(!o||"object"!=typeof o||!o.scopeName)throw new Error("The `scopeName` option is required.");const i=o.scopeName,s=EP.has(r),l=IP&&11===r.nodeType&&!!r.host,u=l&&!PP.has(i),h=u?document.createDocumentFragment():r;if(((t,r,o)=>{let i=EP.get(r);void 0===i&&(removeNodes(r,r.firstChild),EP.set(r,i=new NodePart(Object.assign({templateFactory:templateFactory},o))),i.appendInto(r)),i.setValue(t),i.commit()})(t,h,Object.assign({templateFactory:shadyTemplateFactory(i)},o)),u){const t=EP.get(h);EP.delete(h);const o=t.value instanceof TemplateInstance?t.value.template:void 0;prepareTemplateStyles(i,h,o),removeNodes(r,r.firstChild),r.appendChild(h),EP.set(r,t)}!s&&l&&window.ShadyCSS.styleElement(r.host)},LitElement.shadowRootOptions={mode:"open"};class LocalizationHelper{static get strings(){return this._strings}static set strings(t){this._strings=t,this._stringsEventDispatcher.fire(null)}static getDocumentDirection(){var t,r;return(null===(t=document.body)||void 0===t?void 0:t.getAttribute("dir"))||(null===(r=document.documentElement)||void 0===r?void 0:r.getAttribute("dir"))}static onStringsUpdated(t){this._stringsEventDispatcher.add(t)}static removeOnStringsUpdated(t){this._stringsEventDispatcher.remove(t)}static onDirectionUpdated(t){this._directionEventDispatcher.add(t),this.initDirection()}static removeOnDirectionUpdated(t){this._directionEventDispatcher.remove(t)}static initDirection(){if(this._isDirectionInit)return;this._isDirectionInit=!0,this.mutationObserver=new MutationObserver((t=>{t.forEach((t=>{"dir"==t.attributeName&&this._directionEventDispatcher.fire(null)}))}));const t={attributes:!0,attributeFilter:["dir"]};this.mutationObserver.observe(document.body,t),this.mutationObserver.observe(document.documentElement,t)}static updateStringsForTag(t,r){if((t=t.toLowerCase()).startsWith("mgt-")&&(t=t.substring(4)),this._strings&&r){for(let t of Object.entries(r))this._strings[t[0]]&&(r[t[0]]=this._strings[t[0]]);if(this._strings._components&&this._strings._components[t]){let o=this._strings._components[t];for(let t of Object.keys(o))r[t]&&(r[t]=o[t])}}return r}}LocalizationHelper._stringsEventDispatcher=new EventDispatcher,LocalizationHelper._directionEventDispatcher=new EventDispatcher,LocalizationHelper._isDirectionInit=!1;var LP,__decorate$y=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$v=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$E=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.ComponentMediaQuery=void 0,(LP=exports.ComponentMediaQuery||(exports.ComponentMediaQuery={})).mobile="",LP.tablet="tablet",LP.desktop="desktop";class MgtBaseComponent extends LitElement{get mediaQuery(){return this.offsetWidth<768?exports.ComponentMediaQuery.mobile:this.offsetWidth<1200?exports.ComponentMediaQuery.tablet:exports.ComponentMediaQuery.desktop}get isLoadingState(){return this._isLoadingState}get isFirstUpdated(){return this._isFirstUpdated}get strings(){return{}}constructor(){super(),this.direction="ltr",this._isLoadingState=!1,this._isFirstUpdated=!1,this.handleLocalizationChanged=this.handleLocalizationChanged.bind(this),this.handleDirectionChanged=this.handleDirectionChanged.bind(this),this.handleProviderUpdates=this.handleProviderUpdates.bind(this),this.handleActiveAccountUpdates=this.handleActiveAccountUpdates.bind(this),this.handleDirectionChanged(),this.handleLocalizationChanged()}connectedCallback(){super.connectedCallback(),LocalizationHelper.onStringsUpdated(this.handleLocalizationChanged),LocalizationHelper.onDirectionUpdated(this.handleDirectionChanged)}disconnectedCallback(){super.disconnectedCallback(),LocalizationHelper.removeOnStringsUpdated(this.handleLocalizationChanged),LocalizationHelper.removeOnDirectionUpdated(this.handleDirectionChanged),Providers.removeProviderUpdatedListener(this.handleProviderUpdates),Providers.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}firstUpdated(t){super.firstUpdated(t),this._isFirstUpdated=!0,Providers.onProviderUpdated(this.handleProviderUpdates),Providers.onActiveAccountChanged(this.handleActiveAccountUpdates),this.requestStateUpdate()}loadState(){return Promise.resolve()}clearState(){}fireCustomEvent(t,r,o=!1,i=!1){const s=new CustomEvent(t,{bubbles:o,cancelable:i,detail:r});return this.dispatchEvent(s)}updated(t){super.updated(t);const r=new CustomEvent("updated",{bubbles:!0,cancelable:!0});this.dispatchEvent(r)}requestStateUpdate(t=!1){return __awaiter$E(this,void 0,void 0,(function*(){if(!this._isFirstUpdated)return;this.isLoadingState&&!t&&(yield this._currentLoadStatePromise);const r=Providers.globalProvider;if(!r)return Promise.resolve();if(r.state!==exports.ProviderState.SignedOut){if(r.state===exports.ProviderState.Loading)return Promise.resolve();{const r=new Promise(((o,i)=>__awaiter$E(this,void 0,void 0,(function*(){try{this.setLoadingState(!0),this.fireCustomEvent("loadingInitiated"),yield this.loadState(),this.setLoadingState(!1),this.fireCustomEvent("loadingCompleted"),o()}catch(t){this.clearState(),this.setLoadingState(!1),this.fireCustomEvent("loadingFailed"),i(t)}return this._currentLoadStatePromise=this.isLoadingState&&this._currentLoadStatePromise&&t?this._currentLoadStatePromise.then((()=>r)):r}))))}}else this.clearState()}))}setLoadingState(t){this._isLoadingState!==t&&(this._isLoadingState=t,this.requestUpdate("isLoadingState"))}handleProviderUpdates(){this.requestStateUpdate()}handleActiveAccountUpdates(){return __awaiter$E(this,void 0,void 0,(function*(){this.clearState(),this.requestStateUpdate()}))}handleLocalizationChanged(){LocalizationHelper.updateStringsForTag(this.tagName,this.strings),this.requestUpdate()}handleDirectionChanged(){this.direction=LocalizationHelper.getDocumentDirection()}}__decorate$y([function internalProperty$1(t){return property$1({attribute:!1,hasChanged:null==t?void 0:t.hasChanged})}(),__metadata$v("design:type",Object)],MgtBaseComponent.prototype,"direction",void 0);var __decorate$x=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$u=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};class MgtBaseProvider extends MgtBaseComponent{get provider(){return this._provider}set provider(t){this._provider&&this.provider.removeStateChangedHandler((()=>this.stateChangedHandler)),this._provider=t,this._provider&&this.provider.onStateChanged((()=>this.stateChangedHandler))}get isAvailable(){return!0}firstUpdated(t){super.firstUpdated(t);let r=!1;if(this.dependsOn){let t=this.dependsOn;for(;t;){if(t.isAvailable){r=!0;break}t=t.dependsOn}}!r&&this.isAvailable&&this.initializeProvider()}initializeProvider(){}stateChangedHandler(){this.fireCustomEvent("onStateChanged",this.provider.state)}}function equals(t,r){return equalsInternal(t,r,new Set)}function equalsInternal(t,r,o){const i=Object.prototype.toString.call(t),s=Object.prototype.toString.call(r);if(i===s&&"[object Object]"===i&&!o.has(t)){o.add(t);for(const i in t)if(!equalsInternal(t[i],r[i],o))return!1;for(const o in r)if(!t.hasOwnProperty(o))return!1;return!0}if(i===s&&"[object Array]"===i&&!o.has(t)){if(o.add(t),t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(!equalsInternal(t[i],r[i],o))return!1;return!0}return t===r}function arraysAreEqual(t,r){if(t===r)return!0;if(!t||!r)return!1;if(t.length!==r.length)return!1;if(0===t.length)return!0;const o=new Set(t);for(const t of r)if(!o.has(t))return!1;return!0}__decorate$x([property$1({attribute:"depends-on",converter:t=>document.querySelector(t),type:String}),__metadata$u("design:type",MgtBaseProvider)],MgtBaseProvider.prototype,"dependsOn",void 0);class TemplateHelper{static renderTemplate(t,r,o){let i;if(r.$parentTemplateContext&&(o=Object.assign(Object.assign({},o),{$parent:r.$parentTemplateContext})),r.content&&r.content.childNodes.length){const s=r.content.cloneNode(!0);i=this.renderNode(s,t,o)}else if(r.childNodes.length){const s=document.createElement("div");for(let t=0;t<r.childNodes.length;t++)s.appendChild(this.simpleCloneNode(r.childNodes[t]));i=this.renderNode(s,t,o)}i&&t.appendChild(i)}static setBindingSyntax(t,r){this._startExpression=t,this._endExpression=r;const o=this.escapeRegex(this._startExpression),i=this.escapeRegex(this._endExpression);this._expression=new RegExp(`${o}\\s*([$\\w\\.,'"\\s()\\[\\]]+)\\s*${i}`,"g")}static get globalContext(){return this._globalContext}static get expression(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}static escapeRegex(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}static simpleCloneNode(t){if(!t)return null;const r=t.cloneNode(!1);for(let o=0;o<t.childNodes.length;o++){const i=this.simpleCloneNode(t.childNodes[o]);i&&r.appendChild(i)}return r}static expandExpressionsAsString(t,r){return t.replace(this.expression,((t,o)=>{const i=this.evalInContext(o||this.trimExpression(t),r);return i?"object"==typeof i?JSON.stringify(i):i.toString():""}))}static renderNode(t,r,o){if("#text"===t.nodeName)return t.textContent=this.expandExpressionsAsString(t.textContent,o),t;if("TEMPLATE"===t.nodeName)return t.$parentTemplateContext=o,t;let i=t;if(i.attributes)for(let t=0;t<i.attributes.length;t++){const s=i.attributes[t];if("data-props"===s.name){const t=this.trimExpression(s.value);for(const s of t.split(",")){const t=s.trim().split(":");if(2===t.length){const s=t[0].trim(),l=this.evalInContext(t[1].trim(),o);s.startsWith("@")?"function"==typeof l&&i.addEventListener(s.substring(1),(t=>l(t,o,r))):i[s]=l}}}else i.setAttribute(s.name,this.expandExpressionsAsString(s.value,o))}const s=[],l=[];let u=!1;for(let i=0;i<t.childNodes.length;i++){const h=t.childNodes[i],m=h;let v=!1;if(m.dataset){let t=!1;if(m.dataset.if){const r=m.dataset.if;this.evalBoolInContext(this.trimExpression(r),o)?(m.removeAttribute("data-if"),u=!0,v=!0):(l.push(m),t=!0)}else void 0!==m.dataset.else&&(u?(l.push(m),t=!0):m.removeAttribute("data-else"));m.dataset.for&&!t?s.push(m):t||this.renderNode(h,r,o)}else this.renderNode(h,r,o);v||"#text"===h.nodeName||(u=!1)}for(const t of l)i.removeChild(t);for(let t=0;t<s.length;t++){const l=s[t],u=l.dataset.for,h=this.trimExpression(u).split(/\s(in|of)\s/i);if(3===h.length){const t=h[0].trim(),s=h[2].trim(),u=this.evalInContext(s,o);if(Array.isArray(u)){l.removeAttribute("data-for");for(let s=0;s<u.length;s++){const h=Object.assign({$index:s},o);h[t]=u[s];const m=l.cloneNode(!0);this.renderNode(m,r,h),i.insertBefore(m,l)}}i.removeChild(l)}}return t}static evalBoolInContext(t,r){return r=Object.assign(Object.assign({},r),this.globalContext),new Function("with(this) { return !!("+t+")}").call(r)}static evalInContext(t,r){r=Object.assign(Object.assign({},r),this.globalContext);const o=new Function("with(this) { return "+t+";}");let i;try{i=o.call(r)}catch(t){}return i}static trimExpression(t){return(t=t.trim()).startsWith(this._startExpression)&&t.endsWith(this._endExpression)&&(t=(t=t.substr(this._startExpression.length,t.length-this._startExpression.length-this._endExpression.length)).trim()),t}}TemplateHelper._globalContext={};var __decorate$w=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$t=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};class MgtTemplatedComponent extends MgtBaseComponent{constructor(){super(),this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.templateContext=this.templateContext||{}}update(t){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(t)}updated(t){super.updated(t),this.removeUnusedSlottedElements()}renderTemplate(t,r,o){if(!this.hasTemplate(t))return null;o=o||t,this._slotNamesAddedDuringRender.push(o),this._renderedSlots=!0;const i=html$1`
      <slot name=${o}></slot>
    `,s=Object.assign(Object.assign({},r),this.templateContext);if(this._renderedTemplates.hasOwnProperty(o)){const{context:t,slot:r}=this._renderedTemplates[o];if(equals(t,s))return i;this.removeChild(r)}const l=document.createElement("div");return l.slot=o,l.dataset.generated="template",TemplateHelper.renderTemplate(l,this.templates[t],s),this.appendChild(l),this._renderedTemplates[o]={context:s,slot:l},this.fireCustomEvent("templateRendered",{templateType:t,context:s,element:l}),i}hasTemplate(t){return this.templates&&this.templates[t]}getTemplates(){const t={};for(let r=0;r<this.children.length;r++){const o=this.children[r];if("TEMPLATE"===o.nodeName){const i=o;i.dataset.type?t[i.dataset.type]=i:t.default=i,i.templateOrder=r}}return t}removeUnusedSlottedElements(){if(this._renderedSlots){for(let t=0;t<this.children.length;t++){const r=this.children[t];r.dataset&&r.dataset.generated&&!this._slotNamesAddedDuringRender.includes(r.slot)&&(this.removeChild(r),delete this._renderedTemplates[r.slot],t--)}this._renderedSlots=!1}}}__decorate$w([property$1({attribute:!1}),__metadata$t("design:type",Object)],MgtTemplatedComponent.prototype,"templateContext",void 0);const instanceOfAny=(t,r)=>r.some((r=>t instanceof r));let UP,BP;const HP=new WeakMap,$P=new WeakMap,qP=new WeakMap,jP=new WeakMap,zP=new WeakMap;let GP={get(t,r,o){if(t instanceof IDBTransaction){if("done"===r)return $P.get(t);if("objectStoreNames"===r)return t.objectStoreNames||qP.get(t);if("store"===r)return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return wrap(t[r])},set:(t,r,o)=>(t[r]=o,!0),has:(t,r)=>t instanceof IDBTransaction&&("done"===r||"store"===r)||r in t};function wrapFunction(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function getCursorAdvanceMethods(){return BP||(BP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(t)?function(...r){return t.apply(unwrap(this),r),wrap(HP.get(this))}:function(...r){return wrap(t.apply(unwrap(this),r))}:function(r,...o){const i=t.call(unwrap(this),r,...o);return qP.set(i,r.sort?r.sort():[r]),wrap(i)}}function transformCachableValue(t){return"function"==typeof t?wrapFunction(t):(t instanceof IDBTransaction&&function cacheDonePromiseForTransaction(t){if($P.has(t))return;const r=new Promise(((r,o)=>{const unlisten=()=>{t.removeEventListener("complete",complete),t.removeEventListener("error",error),t.removeEventListener("abort",error)},complete=()=>{r(),unlisten()},error=()=>{o(t.error||new DOMException("AbortError","AbortError")),unlisten()};t.addEventListener("complete",complete),t.addEventListener("error",error),t.addEventListener("abort",error)}));$P.set(t,r)}(t),instanceOfAny(t,function getIdbProxyableTypes(){return UP||(UP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(t,GP):t)}function wrap(t){if(t instanceof IDBRequest)return function promisifyRequest(t){const r=new Promise(((r,o)=>{const unlisten=()=>{t.removeEventListener("success",success),t.removeEventListener("error",error)},success=()=>{r(wrap(t.result)),unlisten()},error=()=>{o(t.error),unlisten()};t.addEventListener("success",success),t.addEventListener("error",error)}));return r.then((r=>{r instanceof IDBCursor&&HP.set(r,t)})).catch((()=>{})),zP.set(r,t),r}(t);if(jP.has(t))return jP.get(t);const r=transformCachableValue(t);return r!==t&&(jP.set(t,r),zP.set(r,t)),r}const unwrap=t=>zP.get(t);const VP=["get","getKey","getAll","getAllKeys","count"],KP=["put","add","delete","clear"],WP=new Map;function getMethod(t,r){if(!(t instanceof IDBDatabase)||r in t||"string"!=typeof r)return;if(WP.get(r))return WP.get(r);const o=r.replace(/FromIndex$/,""),i=r!==o,s=KP.includes(o);if(!(o in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!VP.includes(o))return;const method=async function(t,...r){const l=this.transaction(t,s?"readwrite":"readonly");let u=l.store;return i&&(u=u.index(r.shift())),(await Promise.all([u[o](...r),s&&l.done]))[0]};return WP.set(r,method),method}!function replaceTraps(t){GP=t(GP)}((t=>({...t,get:(r,o,i)=>getMethod(r,o)||t.get(r,o,i),has:(r,o)=>!!getMethod(r,o)||t.has(r,o)})));var __awaiter$D=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class CacheService{static getCache(t,r){const o=`${t.name}/${r}`;return this.isInitialized||this.init(),this.cacheStore.has(r)||this.cacheStore.set(o,new CacheStore(t,r)),this.cacheStore.get(o)}static clearCaches(){this.cacheStore.forEach((t=>indexedDB.deleteDatabase(t.getDBName())))}static get config(){return this.cacheConfig}static init(){let t;Providers.globalProvider&&(t=Providers.globalProvider.state),Providers.onProviderUpdated((()=>{t===exports.ProviderState.SignedIn&&Providers.globalProvider.state===exports.ProviderState.SignedOut&&this.clearCaches(),t=Providers.globalProvider.state})),this.isInitialized=!0}}CacheService.cacheStore=new Map,CacheService.isInitialized=!1,CacheService.cacheConfig={defaultInvalidationPeriod:36e5,groups:{invalidationPeriod:null,isEnabled:!0},isEnabled:!0,people:{invalidationPeriod:null,isEnabled:!0},photos:{invalidationPeriod:null,isEnabled:!0},presence:{invalidationPeriod:3e5,isEnabled:!0},users:{invalidationPeriod:null,isEnabled:!0},response:{invalidationPeriod:null,isEnabled:!0},files:{invalidationPeriod:null,isEnabled:!0},fileLists:{invalidationPeriod:null,isEnabled:!0}};class CacheStore{constructor(t,r){if(!(r in t.stores))throw Error('"store" must be defined in the "schema"');this.schema=t,this.store=r}getValue(t){return __awaiter$D(this,void 0,void 0,(function*(){if(!window.indexedDB)return null;try{return(yield this.getDb()).get(this.store,t)}catch(t){return null}}))}putValue(t,r){return __awaiter$D(this,void 0,void 0,(function*(){if(window.indexedDB)try{yield(yield this.getDb()).put(this.store,Object.assign(Object.assign({},r),{timeCached:Date.now()}),t)}catch(t){return}}))}clearStore(){return __awaiter$D(this,void 0,void 0,(function*(){if(window.indexedDB)try{(yield this.getDb()).clear(this.store)}catch(t){return}}))}getDBName(){return`mgt-${this.schema.name}`}getDb(){return function openDB(t,r,{blocked:o,upgrade:i,blocking:s,terminated:l}={}){const u=indexedDB.open(t,r),h=wrap(u);return i&&u.addEventListener("upgradeneeded",(t=>{i(wrap(u.result),t.oldVersion,t.newVersion,wrap(u.transaction))})),o&&u.addEventListener("blocked",(()=>o())),h.then((t=>{l&&t.addEventListener("close",(()=>l())),s&&t.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),h}(this.getDBName(),this.schema.version,{upgrade:(t,r,o,i)=>{for(const r in this.schema.stores)this.schema.stores.hasOwnProperty(r)&&(t.objectStoreNames.contains(r)||t.createObjectStore(r))}})}}class TeamsHelper{static get microsoftTeamsLib(){return this._microsoftTeamsLib||window.microsoftTeams}static set microsoftTeamsLib(t){this._microsoftTeamsLib=t}static get isAvailable(){return!!this.microsoftTeamsLib&&(!(window.parent!==window.self||!window.nativeInterface)||("embedded-page-container"===window.name||"extension-tab-frame"===window.name))}static executeDeepLink(t,r){const o=this.microsoftTeamsLib;o.initialize(),o.executeDeepLink(t,r)}}var __awaiter$C=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class GraphPageIterator{get value(){return this._value}get hasNext(){return!!this._nextLink}static create(t,r,o){return __awaiter$C(this,void 0,void 0,(function*(){const i=yield r.get();if(i&&i.value){const r=new GraphPageIterator;return r._graph=t,r._value=i.value,r._nextLink=i["@odata.nextLink"],r._version=o||t.version,r}return null}))}static createFromValue(t,r,o){let i=new GraphPageIterator;return i._graph=t,i._value=r,i._nextLink=o||null,i._version=t.version,i||null}next(){return __awaiter$C(this,void 0,void 0,(function*(){if(this._nextLink){const t=this._nextLink.split(this._version)[1],r=yield this._graph.api(t).version(this._version).get();if(r&&r.value&&r.value.length)return this._value=this._value.concat(r.value),this._nextLink=r["@odata.nextLink"],r.value}return null}))}}class SessionCache{constructor(){this.session=window.sessionStorage}setItem(t,r){this.session.setItem(t,r)}getItem(t){return this.session.getItem(t)}clear(){this.session.clear()}}var __awaiter$B=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class MockGraph extends Graph{constructor(t){const r=[new AuthenticationHandler(t),new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new MockMiddleware,new HTTPMessageHandler];super(Client.initWithMiddleware({middleware:chainMiddleware(...r)}))}forComponent(t){return this}}class MockMiddleware{constructor(){(function storageAvailable(t){let r;try{r=window[t];const o="__storage_test__";return r.setItem(o,o),r.removeItem(o),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&r&&0!==r.length}})("sessionStorage")&&(this._session=new SessionCache)}execute(t){return __awaiter$B(this,void 0,void 0,(function*(){try{const r=yield this.getBaseUrl();t.request=r+encodeURIComponent(t.request)}catch(t){}return yield this._nextMiddleware.execute(t)}))}setNext(t){this._nextMiddleware=t}getBaseUrl(){var t,r;return __awaiter$B(this,void 0,void 0,(function*(){if(!this._baseUrl){const o=null===(t=this._session)||void 0===t?void 0:t.getItem("endpointURL");if(o)this._baseUrl=o;else{try{let t=yield fetch("https://cdn.graph.office.net/en-us/graph/api/proxy/endpoint");this._baseUrl=(yield t.json())+"?url="}catch(t){this._baseUrl="https://proxy.apisandbox.msdn.microsoft.com/svc?url="}null===(r=this._session)||void 0===r||r.setItem("endpointURL",this._baseUrl)}}return this._baseUrl}))}}var __awaiter$A=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class MockProvider extends IProvider{constructor(t=!1){super(),this.graph=new MockGraph(this),t?this.setState(exports.ProviderState.SignedIn):this.setState(exports.ProviderState.SignedOut)}login(){return __awaiter$A(this,void 0,void 0,(function*(){this.setState(exports.ProviderState.Loading),yield new Promise((t=>setTimeout(t,3e3))),this.setState(exports.ProviderState.SignedIn)}))}logout(){return __awaiter$A(this,void 0,void 0,(function*(){this.setState(exports.ProviderState.Loading),yield new Promise((t=>setTimeout(t,3e3))),this.setState(exports.ProviderState.SignedOut)}))}getAccessToken(){return Promise.resolve("{token:https://graph.microsoft.com/}")}get name(){return"MgtMockProvider"}}var QP,__decorate$v=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$s=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};exports.MgtMockProvider=class MgtMockProvider extends MgtBaseProvider{initializeProvider(){Providers.globalProvider=new MockProvider(!this.signedOut)}},__decorate$v([property$1({attribute:"signed-out",type:Boolean}),__metadata$s("design:type",Object)],exports.MgtMockProvider.prototype,"signedOut",void 0),exports.MgtMockProvider=__decorate$v([(QP="mgt-mock-provider",t=>"function"==typeof t?((t,r)=>(window.customElements.define(t,r),r))(QP,t):((t,r)=>{const{kind:o,elements:i}=r;return{kind:o,elements:i,finisher(r){window.customElements.define(t,r)}}})(QP,t))],exports.MgtMockProvider),
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
window.JSCompiler_renameProperty=(t,r)=>t
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */;const customElement$1=t=>r=>"function"==typeof r?((t,r)=>(window.customElements.define(t,r),r))(t,r):((t,r)=>{const{kind:o,elements:i}=r;return{kind:o,elements:i,finisher(r){window.customElements.define(t,r)}}})(t,r),standardProperty=(t,r)=>"method"===r.kind&&r.descriptor&&!("value"in r.descriptor)?Object.assign(Object.assign({},r),{finisher(o){o.createProperty(r.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof r.initializer&&(this[r.key]=r.initializer.call(this))},finisher(o){o.createProperty(r.key,t)}},legacyProperty=(t,r,o)=>{r.constructor.createProperty(o,t)};function property(t){return(r,o)=>void 0!==o?legacyProperty(t,r,o):standardProperty(t,r)}function internalProperty(t){return property({attribute:!1,hasChanged:null==t?void 0:t.hasChanged})}const YP=internalProperty,JP=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,XP=Symbol();
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/class CSSResult{constructor(t,r){if(r!==XP)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){return void 0===this._styleSheet&&(JP?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const css$1=(t,...r)=>{const o=r.reduce(((r,o,i)=>r+(t=>{if(t instanceof CSSResult)return t.cssText;if("number"==typeof t)return t;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${t}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(o)+t[i+1]),t[0]);return new CSSResult(o,XP)};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.5.0");const ZP=[css$1`
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--selected-person-background-color:#f3f2f1}.mgt-dark{--selected-person-background-color:#4f4f4f}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{background-color:#fff}.mgt-dark{background-color:#424242}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-list-background-color:#ffffff;--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#4a4a4a;--file-upload-dialog-content-color:white;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}
`],eR=document.createElement("style");eR.type="text/css",eR.appendChild(document.createTextNode("\n@font-face {\n    font-family: 'FabricMDL2Icons';\n    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format(\"woff\"),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format(\"truetype\");;\n}\n")),document.head.appendChild(eR);const tR=document.createElement("style");tR.innerHTML=ZP.toString(),document.head.appendChild(tR);
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class ClassList{constructor(t){this.classes=new Set,this.changed=!1,this.element=t;const r=(t.getAttribute("class")||"").split(/\s+/);for(const t of r)this.classes.add(t)}add(t){this.classes.add(t),this.changed=!0}remove(t){this.classes.delete(t),this.changed=!0}commit(){if(this.changed){let t="";this.classes.forEach((r=>t+=r+" ")),this.element.setAttribute("class",t)}}}const rR=new WeakMap,oR=directive((t=>r=>{if(!(r instanceof AttributePart)||r instanceof PropertyPart||"class"!==r.committer.name||r.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:o}=r,{element:i}=o;let s=rR.get(r);void 0===s&&(i.setAttribute("class",o.strings.join(" ")),rR.set(r,s=new Set));const l=i.classList||new ClassList(i);s.forEach((r=>{r in t||(l.remove(r),s.delete(r))}));for(const r in t){const o=t[r];o!=s.has(r)&&(o?(l.add(r),s.add(r)):(l.remove(r),s.delete(r)))}"function"==typeof l.commit&&l.commit()})),nR=new WeakMap,iR=directive((t=>r=>{const o=nR.get(r);if(void 0===t&&r instanceof AttributePart){if(void 0!==o||!nR.has(r)){const t=r.committer.name;r.committer.element.removeAttribute(t)}}else t!==o&&r.setValue(t);nR.set(r,t)}));function getRelativeDisplayDate(t){const r=new Date,o=new Date(r.getFullYear(),r.getMonth(),r.getDate());if(t>=o)return t.toLocaleString("default",{hour:"numeric",minute:"numeric"});const i=new Date(o);if(i.setDate(r.getDate()-r.getDay()),t>=i)return t.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});const s=new Date(i);return s.setDate(i.getDate()-7),t>=s?t.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):t.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})}function getShortDateString(t){const r=t.getMonth(),o=t.getDate();return`${function getMonthString(t){switch(t){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}}(r)} ${o}`}function debounce(t,r){let o;return function(){clearTimeout(o),o=setTimeout((()=>t.apply(this,arguments)),r)}}function blobToBase64(t){return new Promise(((r,o)=>{const i=new FileReader;i.onerror=o,i.onload=t=>{r(i.result)},i.readAsDataURL(t)}))}function extractEmailAddress(t){return t.startsWith("[")?t.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString():t}function isValidEmail(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)}function formatBytes(t,r=2){if(0===t)return"0 Bytes";const o=r<0?0:r,i=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,i)).toFixed(o))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][i]}const sR={presence:{name:"presence",stores:{presence:"presence"},version:1},users:{name:"users",stores:{users:"users",usersQuery:"usersQuery",userFilters:"userFilters"},version:2},photos:{name:"photos",stores:{contacts:"contacts",users:"users",groups:"groups"},version:1},people:{name:"people",stores:{contacts:"contacts",groupPeople:"groupPeople",peopleQuery:"peopleQuery"},version:2},groups:{name:"groups",stores:{groups:"groups",groupsQuery:"groupsQuery"},version:4},get:{name:"responses",stores:{responses:"responses"},version:1},files:{name:"files",stores:{driveFiles:"driveFiles",groupFiles:"groupFiles",siteFiles:"siteFiles",userFiles:"userFiles",insightFiles:"insightFiles",fileQueries:"fileQueries"},version:1},fileLists:{name:"file-lists",stores:{fileLists:"fileLists",insightfileLists:"insightfileLists"},version:1}};var aR,cR,__awaiter$z=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.PersonType=void 0,(aR=exports.PersonType||(exports.PersonType={}))[aR.any=0]="any",aR.person="person",aR.group="group",exports.UserType=void 0,(cR=exports.UserType||(exports.UserType={})).any="any",cR.user="user",cR.contact="contact";const getPeopleInvalidationTime=()=>CacheService.config.people.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPeopleCacheEnabled=()=>CacheService.config.people.isEnabled&&CacheService.config.isEnabled;function findPeople(t,r,o=10,i=exports.UserType.any,s=""){return __awaiter$z(this,void 0,void 0,(function*(){let l;const u=`${r}:${o}:${i}`;if(getIsPeopleCacheEnabled()){l=CacheService.getCache(sR.people,sR.people.stores.peopleQuery);const t=getIsPeopleCacheEnabled()?yield l.getValue(u):null;if(t&&getPeopleInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let h,m="personType/class eq 'Person'";i!==exports.UserType.any&&(i===exports.UserType.user?m+="and personType/subclass eq 'OrganizationUser'":m+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),""!==s&&(m+=`${m} and ${s}`);try{let s=t.api("/me/people").search('"'+r+'"').top(o).filter(m).middlewareOptions(prepScopes("people.read"));if(i!==exports.UserType.contact&&(s=s.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),h=yield s.get(),getIsPeopleCacheEnabled()&&h){const t={maxResults:o,results:null};t.results=h.value.map((t=>JSON.stringify(t))),l.putValue(u,t)}}catch(t){}return h?h.value:null}))}function getPeople(t,r=exports.UserType.any,o=""){return __awaiter$z(this,void 0,void 0,(function*(){let i;const s=o||`*:${r}`;if(getIsPeopleCacheEnabled()){i=CacheService.getCache(sR.people,sR.people.stores.peopleQuery);const t=yield i.getValue(s);if(t&&getPeopleInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let l,u="personType/class eq 'Person'";r!==exports.UserType.any&&(r===exports.UserType.user?u+="and personType/subclass eq 'OrganizationUser'":u+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),o&&(u+=` and ${o}`);try{let o=t.api("/me/people").middlewareOptions(prepScopes("people.read")).filter(u);r!=exports.UserType.contact&&(o=o.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),l=yield o.get(),getIsPeopleCacheEnabled()&&l&&i.putValue(s,{maxResults:10,results:l.value.map((t=>JSON.stringify(t)))})}catch(t){}return l?l.value:null}))}function getEmailFromGraphEntity(t){const r=t,o=t,i=t;return o.mail?extractEmailAddress(o.mail):r.scoredEmailAddresses&&r.scoredEmailAddresses.length?extractEmailAddress(r.scoredEmailAddresses[0].address):i.emailAddresses&&i.emailAddresses.length?extractEmailAddress(i.emailAddresses[0].address):null}function findContactsByEmail(t,r){return __awaiter$z(this,void 0,void 0,(function*(){let o;if(getIsPeopleCacheEnabled()){o=CacheService.getCache(sR.people,sR.people.stores.contacts);const t=yield o.getValue(r);if(t&&getPeopleInvalidationTime()>Date.now()-t.timeCached)return JSON.parse(t.person)}const i=`${r.replace(/#/g,"%2523")}`,s=yield t.api("/me/contacts").filter(`emailAddresses/any(a:a/address eq '${i}')`).middlewareOptions(prepScopes("contacts.read")).get();return getIsPeopleCacheEnabled()&&s&&o.putValue(r,{person:JSON.stringify(s.value)}),s?s.value:null}))}var __awaiter$y=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};const getUserInvalidationTime=()=>CacheService.config.users.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsUsersCacheEnabled=()=>CacheService.config.users.isEnabled&&CacheService.config.isEnabled;function getMe(t,r){return __awaiter$y(this,void 0,void 0,(function*(){let o;if(getIsUsersCacheEnabled()){o=CacheService.getCache(sR.users,sR.users.stores.users);const t=yield o.getValue("me");if(t&&getUserInvalidationTime()>Date.now()-t.timeCached){const o=JSON.parse(t.user),i=r?r.filter((t=>!Object.keys(o).includes(t))):null;if(!i||i.length<=1)return o}}let i="me";r&&(i=i+"?$select="+r.toString());const s=t.api(i).middlewareOptions(prepScopes("user.read")).get();return getIsUsersCacheEnabled()&&o.putValue("me",{user:JSON.stringify(yield s)}),s}))}function getUser(t,r,o){return __awaiter$y(this,void 0,void 0,(function*(){let i;if(getIsUsersCacheEnabled()){i=CacheService.getCache(sR.users,sR.users.stores.users);const t=yield i.getValue(r);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached){const r=t.user?JSON.parse(t.user):null,i=o&&r?o.filter((t=>!Object.keys(r).includes(t))):null;if(!i||i.length<=1)return r}}let s,l=`/users/${r}`;o&&(l=l+"?$select="+o.toString());try{s=yield t.api(l).middlewareOptions(prepScopes("user.readbasic.all")).get()}catch(t){}return getIsUsersCacheEnabled()&&i.putValue(r,{user:JSON.stringify(s)}),s}))}function getUsersForUserIds(t,r,o="",i=""){return __awaiter$y(this,void 0,void 0,(function*(){if(!r||0===r.length)return[];const s=t.createBatch(),l={},u={},h=[];let m;o=o.toLowerCase(),getIsUsersCacheEnabled()&&(m=CacheService.getCache(sR.users,sR.users.stores.users));for(const v of r){l[v]=null;let r=null;if(getIsUsersCacheEnabled()&&(r=yield m.getValue(v)),r&&getUserInvalidationTime()>Date.now()-r.timeCached){r=JSON.parse(null==r?void 0:r.user);const t=null==r?void 0:r.displayName;if(o){!!(t&&t.toLowerCase().includes(o))&&(u[v]=r||null)}else l[v]=r||null}else if(""!==v)if("me"===v.toString())l[v]=yield getMe(t);else{let t=`/users/${v}`;i&&(t+=`${t}?$filter=${i}`),s.get(v,t,["user.readbasic.all"]),h.push(v)}}try{if(s.hasRequests){const t=yield s.executeAll();for(const i of r){const r=t.get(i);if(r&&r.content){const t=r.content;if(o){(null==t?void 0:t.displayName.toLowerCase()).contains(o)&&(u[i]=t)}else l[i]=t;getIsUsersCacheEnabled()&&m.putValue(i,{user:JSON.stringify(t)})}if(o&&Object.keys(u).length)return Promise.all(Object.values(u))}}return Promise.all(Object.values(l))}catch(o){try{return r.filter((t=>h.includes(t))).forEach((r=>l[r]=getUser(t,r))),getIsUsersCacheEnabled()&&r.filter((t=>h.includes(t))).forEach((t=>__awaiter$y(this,void 0,void 0,(function*(){return m.putValue(t,{user:JSON.stringify(yield l[t])})})))),Promise.all(Object.values(l))}catch(t){return[]}}}))}function findUsers(t,r,o=10,i=""){return __awaiter$y(this,void 0,void 0,(function*(){const s={maxResults:o,results:null};let l;if(getIsUsersCacheEnabled()){l=CacheService.getCache(sR.users,sR.users.stores.usersQuery);const t=yield l.getValue(r);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let u,h=`${r.replace(/#/g,"%2523")}`,m=t.api("users").header("ConsistencyLevel","eventual").count(!0).search(`"displayName:${h}" OR "mail:${h}"`);""!==i&&m.filter(i);try{u=yield m.top(o).middlewareOptions(prepScopes("User.ReadBasic.All")).get()}catch(t){}return getIsUsersCacheEnabled()&&u&&(s.results=u.value.map((t=>JSON.stringify(t))),l.putValue(r,s)),u?u.value:null}))}function findGroupMembers(t,r,o,i=10,s=exports.PersonType.person,l=!1,u="",h=""){return __awaiter$y(this,void 0,void 0,(function*(){const m={maxResults:i,results:null};let v;const C=`${o||"*"}:${r||"*"}:${s}:${l}:${u}`;if(getIsUsersCacheEnabled()){v=CacheService.getCache(sR.users,sR.users.stores.usersQuery);const t=yield v.getValue(C);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let _="";r&&(_=`startswith(displayName,'${r}') or startswith(givenName,'${r}') or startswith(surname,'${r}') or startswith(mail,'${r}') or startswith(userPrincipalName,'${r}')`);let k=`/groups/${o}/${l?"transitiveMembers":"members"}`;s===exports.PersonType.person?k+="/microsoft.graph.user":s===exports.PersonType.group&&(k+="/microsoft.graph.group",r&&(_=`startswith(displayName,'${r}') or startswith(mail,'${r}')`)),u&&(_+=r?` and ${u}`:u),h&&(_+=r?` and ${h}`:h);const E=yield t.api(k).count(!0).top(i).filter(_).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes("user.read.all","people.read")).get();return getIsUsersCacheEnabled()&&E&&(m.results=E.value.map((t=>JSON.stringify(t))),v.putValue(C,m)),E?E.value:null}))}function findUsersFromGroupIds(t,r,o,i=10,s=exports.PersonType.person,l=!1,u=""){return __awaiter$y(this,void 0,void 0,(function*(){const h=[];for(let m=0;m<o.length;m++){const v=o[m];try{const o=yield findGroupMembers(t,r,v,i,s,l,u);h.push(...o)}catch(t){continue}}return h}))}var __awaiter$x=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};const getPhotoInvalidationTime=()=>CacheService.config.photos.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPhotosCacheEnabled=()=>CacheService.config.photos.isEnabled&&CacheService.config.isEnabled;function getPhotoForResource(t,r,o){return __awaiter$x(this,void 0,void 0,(function*(){try{const i=yield t.api(`${r}/photo/$value`).responseType(Ox.RAW).middlewareOptions(prepScopes(...o)).get();if(404===i.status)return{eTag:null,photo:null};if(!i.ok)return null;const s=i.headers.get("eTag");return{eTag:s,photo:yield blobToBase64(yield i.blob())}}catch(t){return null}}))}function getContactPhoto(t,r){return __awaiter$x(this,void 0,void 0,(function*(){let o,i;return getIsPhotosCacheEnabled()&&(o=CacheService.getCache(sR.photos,sR.photos.stores.contacts),i=yield o.getValue(r),i&&getPhotoInvalidationTime()>Date.now()-i.timeCached)?i.photo:(i=yield getPhotoForResource(t,`me/contacts/${r}`,["contacts.read"]),getIsPhotosCacheEnabled()&&i&&o.putValue(r,i),i?i.photo:null)}))}function getUserPhoto(t,r){return __awaiter$x(this,void 0,void 0,(function*(){let o,i;if(getIsPhotosCacheEnabled()){if(o=CacheService.getCache(sR.photos,sR.photos.stores.users),i=yield o.getValue(r),i&&getPhotoInvalidationTime()>Date.now()-i.timeCached)return i.photo;if(i)try{const o=yield t.api(`users/${r}/photo`).get();o&&(o["@odata.mediaEtag"]!==i.eTag||null===o["@odata.mediaEtag"]&&null===o.eTag)&&(i=null)}catch(t){return null}}return i=i||(yield getPhotoForResource(t,`users/${r}`,["user.readbasic.all"])),getIsPhotosCacheEnabled()&&i&&o.putValue(r,i),i?i.photo:null}))}function getPersonImage(t,r,o=!0){return __awaiter$x(this,void 0,void 0,(function*(){if("personType"in r&&"OrganizationUser"!==r.personType.subclass){if("PersonalContact"===r.personType.subclass&&o){const o=getEmailFromGraphEntity(r),i=yield findContactsByEmail(t,o);if(i&&i.length&&i[0].id)return yield getContactPhoto(t,i[0].id)}return null}if(r.userPrincipalName||r.id){const o=r.userPrincipalName||r.id;return yield getUserPhoto(t,o)}if(r.id){const o=yield getUserPhoto(t,r.id);if(o)return o}const i=getEmailFromGraphEntity(r);if(i){const r=yield findUsers(t,i,1);if(r&&r.length)return yield getUserPhoto(t,r[0].id);if(o){const r=yield findContactsByEmail(t,i);if(r&&r.length)return yield getContactPhoto(t,r[0].id)}}return null}))}function storePhotoInCache(t,r,o){return __awaiter$x(this,void 0,void 0,(function*(){CacheService.getCache(sR.photos,r).putValue(t,o)}))}var __awaiter$w=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};const getPresenceInvalidationTime=()=>CacheService.config.presence.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPresenceCacheEnabled=()=>CacheService.config.presence.isEnabled&&CacheService.config.isEnabled;function getUserPresence(t,r){return __awaiter$w(this,void 0,void 0,(function*(){let o;if(getIsPresenceCacheEnabled()){o=CacheService.getCache(sR.presence,sR.presence.stores.presence);const t=yield o.getValue(r||"me");if(t&&getPresenceInvalidationTime()>Date.now()-t.timeCached)return JSON.parse(t.presence)}const i=r?["presence.read.all"]:["presence.read"],s=r?`/users/${r}/presence`:"/me/presence",l=yield t.api(s).middlewareOptions(prepScopes(...i)).get();return getIsPresenceCacheEnabled()&&o.putValue(r||"me",{presence:JSON.stringify(l)}),l}))}var lR,dR,__awaiter$v=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};function getUserWithPhoto(t,r,o){return __awaiter$v(this,void 0,void 0,(function*(){let i,s,l=null,u=null;const h=r?`users/${r}`:"me";let m=h+(o?`?$select=${o.toString()}`:"");const v=r?["user.readbasic.all"]:["user.read"];if(getIsUsersCacheEnabled()){const t=CacheService.getCache(sR.users,sR.users.stores.users);if(s=yield t.getValue(r||"me"),void 0!==s&&getUserInvalidationTime()>Date.now()-s.timeCached){if(u=s.user?JSON.parse(s.user):null,null!==u&&o){o.filter((t=>!Object.keys(u).includes(t))).length>=1&&(u=null,s=null)}}else s=null}if(getIsPhotosCacheEnabled())if(i=yield function getPhotoFromCache(t,r){return __awaiter$x(this,void 0,void 0,(function*(){const o=CacheService.getCache(sR.photos,r);return yield o.getValue(t)}))}(r||"me",sR.photos.stores.users),i&&getPhotoInvalidationTime()>Date.now()-i.timeCached)l=i.photo;else if(i)try{const o=yield t.api(`${h}/photo`).get();o&&o["@odata.mediaEtag"]&&o["@odata.mediaEtag"]===i.eTag?(storePhotoInCache(r||"me",sR.photos.stores.users,i),l=i.photo):i=null}catch(t){"ErrorItemNotFound"!==t.code&&"ImageNotFound"!==t.code||storePhotoInCache(r||"me",sR.photos.stores.users,{eTag:null,photo:null})}if(i||s)if(i){if(!s)try{const o=yield t.api(m).middlewareOptions(prepScopes(...v)).get();if(o){if(getIsUsersCacheEnabled()){CacheService.getCache(sR.users,sR.users.stores.users).putValue(r||"me",{user:JSON.stringify(o)})}u=o}}catch(t){}}else try{const o=yield getPhotoForResource(t,h,v);o&&(getIsPhotosCacheEnabled()&&storePhotoInCache(r||"me",sR.photos.stores.users,{eTag:o.eTag,photo:o.photo}),l=o.photo)}catch(t){}else{let i;const s=t.createBatch();r?(s.get("user",`/users/${r}${o?"?$select="+o.toString():""}`,["user.readbasic.all"]),s.get("photo",`users/${r}/photo/$value`,["user.readbasic.all"])):(s.get("user","me",["user.read"]),s.get("photo","me/photo/$value",["user.read"]));const h=yield s.executeAll(),m=h.get("photo");m&&(i=m.headers.ETag,l=m.content);const v=h.get("user");if(v&&(u=v.content),getIsUsersCacheEnabled()){CacheService.getCache(sR.users,sR.users.stores.users).putValue(r||"me",{user:JSON.stringify(u)})}getIsPhotosCacheEnabled()&&storePhotoInCache(r||"me",sR.photos.stores.users,{eTag:i,photo:l})}return u&&(u.personImage=l),u}))}function getSvg(t,r){switch(t){case dR.ArrowRight:return html$1`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 7L4.46481 10.5359L4.46481 7L4.46481 3.46413L8 7Z" />
        </svg>
      `;case dR.ArrowDown:return html$1`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />
        </svg>
      `;case dR.TeamSeparator:return html$1`
        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"
            fill=${r}
          />
        </svg>
      `;case dR.Search:return html$1`
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0)">
            <circle cx="5.36377" cy="5.36396" r="4" transform="rotate(45 5.36377 5.36396)" stroke="#B3B0AD" />
            <path
              d="M8.19189 7.48529L12.7881 12.0815C12.9834 12.2767 12.9834 12.5933 12.7881 12.7886V12.7886C12.5928 12.9839 12.2762 12.9839 12.081 12.7886L7.48479 8.1924L8.19189 7.48529Z"
              fill="#B3B0AD"
            />
          </g>
          <defs>
            <clipPath id="clip0">
              <rect width="14" height="14" fill="white" />
            </clipPath>
          </defs>
        </svg>
      `;case dR.SkypeArrow:return html$1`
        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"
            fill="#B4009E"
          />
        </svg>
      `;case dR.SmallEmail:return html$1`
        <svg width="14" height="10" viewBox="0 0 14 10" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M11.8473 1H2.04886L6.47364 4.18916C6.64273 4.31103 6.86969 4.31522 7.04316 4.19968L11.8473 1ZM1 1.47671V9H13V1.43376L7.59749 5.03198C7.07706 5.3786 6.39621 5.36601 5.88894 5.0004L1 1.47671ZM0 1C0 0.447715 0.447715 0 1 0H13C13.5523 0 14 0.447715 14 1V9C14 9.55228 13.5523 10 13 10H1C0.447716 10 0 9.55229 0 9V1Z"
          />
        </svg>
      `;case dR.SmallChat:return html$1`
        <svg width="13" height="13" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M9.5781 8.26403L9.57811 8.26403C9.68611 8.29867 9.8455 8.36364 10.0125 8.50479C10.1405 8.61294 10.2409 8.73883 10.3235 8.86465L11.9634 10.9944C11.9701 10.9924 11.9753 10.9904 11.9785 10.9889C11.9841 10.9864 11.9918 10.9823 12 10.9768V1.32284C12 1.18078 11.8731 1 11.6207 1H1.37926C1.12692 1 1 1.18078 1 1.32284V7.37377C1 7.45357 1.01415 7.49036 1.02102 7.50507C1.02778 7.51955 1.04342 7.54689 1.09159 7.58705L1.10485 7.5981L1.11771 7.6096C1.13526 7.62529 1.21707 7.69076 1.33937 7.76027C1.46122 7.82952 1.58119 7.87864 1.67944 7.89966L1.69102 7.90214L1.691 7.9022C3.32106 8.27116 6.2626 8.27688 8.67896 8.18036L8.69908 8.17955L8.71921 8.17956L8.7627 8.17954C9.01362 8.17932 9.31313 8.17907 9.5781 8.26403ZM11.2376 11.6908L9.50506 9.44081C9.39493 9.26422 9.32445 9.23285 9.27276 9.21627C9.17534 9.18504 9.0401 9.17966 8.71888 9.17956C6.31879 9.27543 3.24831 9.27999 1.47024 8.87753C1.01314 8.77974 0.600449 8.48852 0.451238 8.35513C0.15593 8.10893 0 7.78958 0 7.37377V1.32284C0 0.593147 0.610664 0 1.37926 0H11.6207C12.3893 0 13 0.593147 13 1.32284V11.0441C13 11.4686 12.6828 11.7689 12.3881 11.9012C12.1048 12.0284 11.673 12.0728 11.3387 11.7993C11.3003 11.7679 11.2678 11.7301 11.2376 11.6908ZM3 3.5C3 3.22386 3.22386 3 3.5 3H9.5C9.77614 3 10 3.22386 10 3.5C10 3.77614 9.77614 4 9.5 4H3.5C3.22386 4 3 3.77614 3 3.5ZM3.5 5C3.22386 5 3 5.22386 3 5.5C3 5.77614 3.22386 6 3.5 6H6.5C6.77614 6 7 5.77614 7 5.5C7 5.22386 6.77614 5 6.5 5H3.5Z"
          />
        </svg>
      `;case dR.ExpandDown:return html$1`
        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 1L7.5 7L1 1" stroke="#3078CD" />
        </svg>
      `;case dR.Overview:return html$1`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12 4V9H2V4H12ZM11 8V5H3V8H11ZM13 4H18V9H13V4ZM17 8V5H14V8H17ZM8 15V10H18V15H8ZM9 11V14H17V11H9ZM2 15V10H7V15H2ZM3 11V14H6V11H3Z"
          />
        </svg>
      `;case dR.Send:return html$1`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"
          />
        </svg>
      `;case dR.Contact:return html$1`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M11.3315 11.7855L11.3452 11.7913L11.3591 11.7967C11.4057 11.8149 11.4421 11.8389 11.4762 11.8729L12.8836 13.2797C12.9177 13.3137 12.9416 13.35 12.9597 13.3965L12.9651 13.4104L12.971 13.4241C12.9902 13.4693 13 13.5151 13 13.5699C13 13.6248 12.9901 13.6759 12.9676 13.7303L12.9675 13.7302L12.9628 13.7419C12.9458 13.7844 12.9218 13.822 12.8836 13.8602L12.7941 13.9497C12.57 14.1736 12.3673 14.37 12.1855 14.5396C12.0445 14.6712 11.9037 14.7767 11.7639 14.8601C11.6429 14.9284 11.499 14.9865 11.3265 15.0296C11.1716 15.0683 10.9523 15.0957 10.6541 15.0957C10.226 15.0957 9.77339 15.0291 9.29316 14.8873C8.79837 14.7411 8.29897 14.537 7.79466 14.2716C7.29099 14.0043 6.7904 13.6843 6.2931 13.3097C5.79797 12.9334 5.32815 12.5234 4.88351 12.0793C4.44215 11.6299 4.03516 11.1575 3.66219 10.6619C3.2916 10.1652 2.97561 9.66531 2.71228 9.16232C2.44987 8.65684 2.24939 8.16115 2.1072 7.67496C1.96889 7.20203 1.9043 6.75953 1.9043 6.34426C1.9043 6.04676 1.92945 5.8283 1.96505 5.67477C2.00758 5.51024 2.06491 5.36965 2.13346 5.24839C2.21771 5.10725 2.32161 4.96874 2.44802 4.83312C2.61763 4.65148 2.814 4.44899 3.03788 4.22522L3.14024 4.12291C3.18256 4.08061 3.22694 4.05101 3.2785 4.0291C3.32105 4.01103 3.36887 4 3.43131 4C3.48634 4 3.53235 4.00983 3.57773 4.0291L3.57771 4.02914L3.58585 4.03251C3.6411 4.05541 3.68414 4.08469 3.72239 4.12291L5.12984 5.52968C5.16387 5.56369 5.18781 5.60004 5.20594 5.64649L5.21136 5.66038L5.2172 5.6741C5.23642 5.71931 5.24622 5.76513 5.24622 5.81992C5.24622 5.88591 5.23631 5.9178 5.23225 5.92835C5.20132 5.99698 5.16601 6.05438 5.12738 6.10352C5.07447 6.17083 5.01613 6.23146 4.95179 6.28625L4.94467 6.2923L4.93768 6.29849C4.81323 6.40852 4.69584 6.51839 4.58605 6.62811C4.45174 6.76237 4.32909 6.90895 4.22378 7.06908C4.0535 7.32254 3.96032 7.61696 3.96032 7.93007C3.96032 8.35888 4.12439 8.75141 4.42612 9.05299L7.95115 12.5763C8.25285 12.8779 8.64535 13.0417 9.07392 13.0417C9.38687 13.0417 9.68121 12.9486 9.9347 12.7785C10.0949 12.6733 10.2415 12.5507 10.3758 12.4164C10.4856 12.3067 10.5955 12.1894 10.7056 12.065L10.7118 12.058L10.7179 12.0509C10.7727 11.9866 10.8333 11.9283 10.9007 11.8754C10.9499 11.8367 11.0074 11.8014 11.0761 11.7704C11.0868 11.7663 11.1189 11.7564 11.1851 11.7564C11.2401 11.7564 11.2861 11.7662 11.3315 11.7855ZM11.5689 15.9998C11.8248 15.9358 12.0573 15.8442 12.2663 15.7248C12.4753 15.6012 12.6757 15.4499 12.8676 15.2708C13.0596 15.0918 13.2707 14.8872 13.501 14.657L13.5906 14.5674C13.7228 14.4353 13.823 14.284 13.8912 14.1134C13.9637 13.9387 14 13.7575 14 13.5699C14 13.3824 13.9637 13.2033 13.8912 13.0328C13.823 12.858 13.7228 12.7045 13.5906 12.5724L12.1831 11.1656C12.0509 11.0335 11.8974 10.9333 11.7225 10.8651C11.5519 10.7926 11.3728 10.7564 11.1851 10.7564C10.9974 10.7564 10.829 10.7884 10.6797 10.8523C10.5347 10.9163 10.4025 10.9951 10.283 11.0889C10.1636 11.1827 10.0549 11.2871 9.95677 11.4022C9.85868 11.5131 9.76272 11.6154 9.66889 11.7092C9.57506 11.8029 9.47909 11.8818 9.381 11.9457C9.28717 12.0097 9.18481 12.0417 9.07392 12.0417C8.91185 12.0417 8.77323 11.9841 8.65808 11.869L5.13305 8.34571C5.0179 8.23061 4.96032 8.09206 4.96032 7.93007C4.96032 7.81924 4.99231 7.71693 5.05628 7.62314C5.12026 7.52509 5.19916 7.42918 5.29299 7.33539C5.38682 7.24161 5.48918 7.14569 5.60007 7.04765C5.71522 6.9496 5.81972 6.84089 5.91355 6.72153C6.00738 6.60217 6.08628 6.47002 6.15026 6.32508C6.21423 6.17588 6.24622 6.00749 6.24622 5.81992C6.24622 5.63236 6.20997 5.45331 6.13746 5.2828C6.06922 5.10802 5.96899 4.95455 5.83678 4.8224L4.42932 3.41564C4.29711 3.28348 4.14357 3.18117 3.9687 3.1087C3.7981 3.03623 3.61897 3 3.43131 3C3.23939 3 3.05813 3.03623 2.88752 3.1087C2.71692 3.18117 2.56552 3.28348 2.4333 3.41564L2.33094 3.51795C2.10063 3.74814 1.89591 3.95916 1.71678 4.15099C1.54192 4.33856 1.39264 4.53678 1.26895 4.74567C1.14953 4.95455 1.05784 5.18475 0.993862 5.43626C0.934152 5.68777 0.904297 5.99044 0.904297 6.34426C0.904297 6.86434 0.985332 7.40147 1.1474 7.95565C1.30947 8.50983 1.53552 9.06614 1.82554 9.62458C2.11556 10.1788 2.46102 10.7244 2.86193 11.2615C3.26285 11.7944 3.70001 12.3017 4.17342 12.7834C4.65111 13.2609 5.15651 13.7021 5.68963 14.107C6.22703 14.512 6.77295 14.8616 7.3274 15.1557C7.88611 15.4499 8.44696 15.6801 9.00994 15.8463C9.57292 16.0126 10.121 16.0957 10.6541 16.0957C11.0081 16.0957 11.313 16.0637 11.5689 15.9998ZM14.9616 14H17.0002C17.5525 14 18.0002 13.5523 18.0002 13V5C18.0002 4.44772 17.5525 4 17.0002 4H6.43555L6.54385 4.11514C6.77073 4.34192 6.94536 4.60775 7.06365 4.90525C7.07677 4.93665 7.08919 4.96824 7.10089 5H16.8821L10.2238 8.32913C10.083 8.39951 9.91736 8.39951 9.7766 8.32913L7.22381 7.05273L6.7766 7.94716L9.32938 9.22355C9.75167 9.4347 10.2487 9.4347 10.671 9.22356L17.0002 6.05895V13H14.9314C14.9772 13.1858 15.0001 13.3764 15.0001 13.5699C15.0001 13.7154 14.9872 13.8589 14.9616 14Z"
          />
        </svg>
      `;case dR.Copy:return html$1`
        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"
          />
        </svg>
      `;case dR.Phone:return html$1`
        <svg width="15" height="15" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048" fill="none">
            <path d="M1607 1213q44 0 84 16t72 48l220 220q31 31 47 71t17 85q0 44-16 84t-48 72l-14 14q-54 54-99 96t-94 70-109 44-143 15q-125 0-257-39t-262-108-256-164-237-207-206-238-162-256T38 775 0 523q0-83 14-142t43-108 70-93 96-99l16-16q31-31 71-48t85-17q44 0 84 17t72 48l220 220q31 31 47 71t17 85q0 44-15 78t-37 63-48 51-49 45-37 44-15 49q0 38 27 65l551 551q27 27 65 27 26 0 48-15t45-37 45-48 51-49 62-37 79-15zm-83 707q72 0 120-13t88-39 76-64 85-86q27-27 27-65 0-18-14-42t-38-52-51-55-56-54-51-47-37-35q-27-27-66-27-26 0-48 15t-44 37-45 48-52 49-62 37-79 15q-44 0-84-16t-72-48L570 927q-31-31-47-71t-17-85q0-44 15-78t37-63 48-51 49-46 37-44 15-48q0-39-27-66-13-13-34-36t-47-51-54-56-56-52-51-37-43-15q-38 0-65 27l-85 85q-37 37-64 76t-40 87-14 120q0 112 36 231t101 238 153 234 192 219 219 190 234 150 236 99 226 36z" fill="${r}"></path>
        </svg>
      `;case dR.CellPhone:return html$1`
        <svg width="10" height="15" viewBox="0 0 10 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="0.5" y="0.5" width="9" height="14" rx="0.9" stroke="${r}" />
          <rect x="3" y="12" width="4" height="1" rx="0.5" fill="${r}" />
        </svg>
      `;case dR.Chat:return html$1`
        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M2.67824 0C2.3824 0 2.14258 0.239826 2.14258 0.535665C2.14258 0.831505 2.3824 1.07133 2.67824 1.07133H13.9985C14.5508 1.07133 14.9985 1.51905 14.9985 2.07133V12.3203C14.9985 12.6161 15.2384 12.856 15.5342 12.856C15.8301 12.856 16.0699 12.6161 16.0699 12.3203V2C16.0699 0.895431 15.1744 0 14.0699 0H2.67824Z"
            fill="${r}"
          />
          <path
            d="M9.34097 11.4769L9.3309 11.4769L9.32085 11.4773C6.74142 11.5804 3.51639 11.5801 1.6855 11.1657L1.6855 11.1657L1.67972 11.1644C1.30373 11.084 0.937799 10.8292 0.816663 10.7209L0.81023 10.7152L0.803602 10.7096C0.601843 10.5414 0.5 10.3403 0.5 10.0423V3.55978C0.5 3.07185 0.912353 2.64258 1.47765 2.64258H12.4497C13.0149 2.64258 13.4273 3.07185 13.4273 3.55978V13.9745C13.4273 14.1578 13.2827 14.3397 13.067 14.4366C12.8614 14.5288 12.6204 14.5275 12.457 14.3904L10.5932 11.9699C10.5218 11.8587 10.4457 11.7646 10.3579 11.6904C10.2528 11.6015 10.1556 11.5622 10.0869 11.5401L9.93419 12.0163L10.0869 11.5401C9.89097 11.4773 9.65413 11.477 9.34097 11.4769Z"
            stroke="${r}"
          />
        </svg>
      `;case dR.Department:return html$1`
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M9.625 3.5H14V11.375H0V3.5H4.375V1.75H9.625V3.5ZM5.25 2.625V3.5H8.75V2.625H5.25ZM13.125 4.375H0.875V6.125H3.5V5.25H4.375V6.125H9.625V5.25H10.5V6.125H13.125V4.375ZM0.875 10.5H13.125V7H10.5V7.875H9.625V7H4.375V7.875H3.5V7H0.875V10.5Z"
            fill="${r}"
          />
        </svg>
      `;case dR.Email:return html$1`
        <svg width="14" height="10" viewBox="0 0 14 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M0.5 0.772727C0.5 0.622104 0.622104 0.5 0.772727 0.5H13.2273C13.3779 0.5 13.5 0.622104 13.5 0.772727V9.22727C13.5 9.3779 13.3779 9.5 13.2273 9.5H0.772727C0.622104 9.5 0.5 9.3779 0.5 9.22727V0.772727Z"
            stroke="${r}"
          />
          <path d="M13.5 0.5L7.18923 4.70314C6.92113 4.8817 6.57039 4.87522 6.30907 4.68687L0.5 0.5" stroke="#929292" />
        </svg>
      `;case dR.OfficeLocation:return html$1`
        <svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M6.78489 16.3832L6.78263 16.3859C6.75278 16.4216 6.71543 16.4503 6.67324 16.4701L6.88498 16.923L6.67324 16.4701C6.63105 16.4898 6.58504 16.5 6.53846 16.5C6.49188 16.5 6.44588 16.4898 6.40368 16.4701C6.36149 16.4503 6.32415 16.4216 6.2943 16.3859L6.29202 16.3832C5.47882 15.4241 4.01597 13.6289 2.75914 11.7172C2.13055 10.7611 1.56021 9.78597 1.14862 8.87887C0.732553 7.96189 0.5 7.15987 0.5 6.53687C0.5 3.20251 3.20343 0.5 6.53846 0.5C9.87349 0.5 12.5769 3.20251 12.5769 6.53687C12.5769 7.16011 12.3444 7.96225 11.9283 8.87925C11.5167 9.78639 10.9464 10.7615 10.3178 11.7175C9.06097 13.6291 7.59812 15.424 6.78489 16.3832Z"
            stroke="${r}"
          />
          <path
            d="M4.40039 6.53921C4.40039 5.37092 5.34748 4.42383 6.51577 4.42383C7.68407 4.42383 8.63116 5.37092 8.63116 6.53921C8.63116 7.70751 7.68407 8.6546 6.51577 8.6546C5.34748 8.6546 4.40039 7.70751 4.40039 6.53921Z"
            stroke="${r}"
          />
        </svg>
      `;case dR.Person:return html$1`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M8.91699 4C8.91699 5.65685 7.57385 7 5.91699 7C4.26014 7 2.91699 5.65685 2.91699 4C2.91699 2.34315 4.26014 1 5.91699 1C7.57385 1 8.91699 2.34315 8.91699 4ZM8.04431 7.38803C9.16935 6.68014 9.91699 5.42738 9.91699 4C9.91699 1.79086 8.12613 0 5.91699 0C3.70785 0 1.91699 1.79086 1.91699 4C1.91699 5.42739 2.66465 6.68016 3.78972 7.38805C1.82681 8.13254 0.356122 9.8773 0 12H1.01706C1.48033 9.71776 3.49808 8 5.91704 8C8.336 8 10.3538 9.71776 10.817 12H11.8341C11.478 9.87728 10.0072 8.1325 8.04431 7.38803Z"
            fill="${r}"
          />
        </svg>
      `;case dR.Messages:return html$1`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M4 3.5C4 3.22386 4.22386 3 4.5 3H16C17.1046 3 18 3.89543 18 5V12.5C18 12.7761 17.7761 13 17.5 13C17.2239 13 17 12.7761 17 12.5V5C17 4.44772 16.5523 4 16 4H4.5C4.22386 4 4 3.77614 4 3.5ZM4.04886 6H13.8473L9.04316 9.19968C8.86969 9.31522 8.64273 9.31103 8.47364 9.18916L4.04886 6ZM3 14V6.47671L7.88894 10.0004C8.39621 10.366 9.07706 10.3786 9.59749 10.032L15 6.43376V14H3ZM3 5C2.44772 5 2 5.44772 2 6V14C2 14.5523 2.44772 15 3 15H15C15.5523 15 16 14.5523 16 14V6C16 5.44772 15.5523 5 15 5H3Z"
          />
        </svg>
      `;case dR.Organization:return html$1`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M13 4H8V7H13V4ZM8 3C7.44772 3 7 3.44772 7 4V7C7 7.55228 7.44772 8 8 8H10V9H7.5C6.67157 9 6 9.67157 6 10.5V11H4C3.44772 11 3 11.4477 3 12V15C3 15.5523 3.44772 16 4 16H9C9.55228 16 10 15.5523 10 15V12C10 11.4477 9.55228 11 9 11H7V10.5C7 10.2239 7.22386 10 7.5 10H13.5C13.7761 10 14 10.2239 14 10.5V11H12C11.4477 11 11 11.4477 11 12V15C11 15.5523 11.4477 16 12 16H17C17.5523 16 18 15.5523 18 15V12C18 11.4477 17.5523 11 17 11H15V10.5C15 9.67157 14.3284 9 13.5 9H11V8H13C13.5523 8 14 7.55228 14 7V4C14 3.44772 13.5523 3 13 3H8ZM9 12H4L4 15H9V12ZM12 12H17V15H12V12Z"
          />
        </svg>
      `;case dR.ExpandRight:return html$1`
        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />
        </svg>
      `;case dR.Profile:return html$1`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M13 8C13 9.65685 11.6569 11 10 11C8.34315 11 7 9.65685 7 8C7 6.34315 8.34315 5 10 5C11.6569 5 13 6.34315 13 8ZM12.1273 11.388C13.2524 10.6801 14 9.42738 14 8C14 5.79086 12.2091 4 10 4C7.79086 4 6 5.79086 6 8C6 9.42739 6.74766 10.6802 7.87272 11.3881C5.90981 12.1325 4.43913 13.8773 4.08301 16H5.10007C5.56334 13.7178 7.58109 12 10 12C12.419 12 14.4368 13.7178 14.9 16H15.9171C15.561 13.8773 14.0903 12.1325 12.1273 11.388Z"
          />
        </svg>
      `;case dR.Profile:return html$1`
        <svg width="12" height="14" viewBox="0 0 12 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.5"
            d="M5.125 10.0625C5.125 10.2448 5.15918 10.4157 5.22754 10.5752C5.2959 10.7347 5.38932 10.8737 5.50781 10.9922C5.6263 11.1107 5.7653 11.2041 5.9248 11.2725C6.08431 11.3408 6.25521 11.375 6.4375 11.375H9.0625C9.35872 11.375 9.63672 11.4297 9.89648 11.5391C10.1608 11.6484 10.3978 11.8079 10.6074 12.0176C10.8171 12.2272 10.9766 12.4642 11.0859 12.7285C11.1953 12.9883 11.25 13.2663 11.25 13.5625C11.25 13.681 11.2067 13.7835 11.1201 13.8701C11.0335 13.9567 10.931 14 10.8125 14C10.694 14 10.5915 13.9567 10.5049 13.8701C10.4183 13.7835 10.375 13.681 10.375 13.5625C10.375 13.3802 10.3408 13.2093 10.2725 13.0498C10.2041 12.8903 10.1107 12.7513 9.99219 12.6328C9.8737 12.5143 9.7347 12.4209 9.5752 12.3525C9.41569 12.2842 9.24479 12.25 9.0625 12.25H6.4375C6.14128 12.25 5.861 12.1953 5.59668 12.0859C5.33691 11.9766 5.10221 11.8171 4.89258 11.6074C4.68294 11.3978 4.52344 11.1631 4.41406 10.9033C4.30469 10.639 4.25 10.3587 4.25 10.0625V9.46777C3.7168 9.21712 3.23372 8.89811 2.80078 8.51074C2.36784 8.12337 1.9987 7.69043 1.69336 7.21191C1.39258 6.72884 1.16016 6.21159 0.996094 5.66016C0.832031 5.10417 0.75 4.52995 0.75 3.9375C0.75 3.39518 0.852539 2.88477 1.05762 2.40625C1.26725 1.92773 1.5498 1.51074 1.90527 1.15527C2.26074 0.799805 2.67773 0.519531 3.15625 0.314453C3.63477 0.104818 4.14518 0 4.6875 0C5.22982 0 5.74023 0.104818 6.21875 0.314453C6.69727 0.519531 7.11426 0.799805 7.46973 1.15527C7.8252 1.51074 8.10547 1.92773 8.31055 2.40625C8.52018 2.88477 8.625 3.39518 8.625 3.9375C8.625 4.52995 8.54297 5.10417 8.37891 5.66016C8.21484 6.21615 7.98014 6.7334 7.6748 7.21191C7.37402 7.69043 7.00716 8.12337 6.57422 8.51074C6.14583 8.89811 5.66276 9.21712 5.125 9.46777V10.0625ZM1.625 3.9375C1.625 4.45247 1.69564 4.9515 1.83691 5.43457C1.98275 5.91309 2.18783 6.3597 2.45215 6.77441C2.72103 7.18913 3.04232 7.56283 3.41602 7.89551C3.79427 8.22363 4.2181 8.49479 4.6875 8.70898C5.1569 8.49479 5.57845 8.22363 5.95215 7.89551C6.3304 7.56283 6.65169 7.18913 6.91602 6.77441C7.1849 6.3597 7.38997 5.91309 7.53125 5.43457C7.67708 4.9515 7.75 4.45247 7.75 3.9375C7.75 3.51367 7.66797 3.11719 7.50391 2.74805C7.3444 2.37435 7.12565 2.05078 6.84766 1.77734C6.57422 1.49935 6.25065 1.2806 5.87695 1.12109C5.50781 0.957031 5.11133 0.875 4.6875 0.875C4.26367 0.875 3.86491 0.957031 3.49121 1.12109C3.12207 1.2806 2.7985 1.49935 2.52051 1.77734C2.24707 2.05078 2.02832 2.37435 1.86426 2.74805C1.70475 3.11719 1.625 3.51367 1.625 3.9375ZM6.4375 4.375C6.31901 4.375 6.21647 4.33171 6.12988 4.24512C6.04329 4.15853 6 4.05599 6 3.9375C6 3.75521 5.96582 3.58431 5.89746 3.4248C5.8291 3.2653 5.73568 3.1263 5.61719 3.00781C5.4987 2.88932 5.3597 2.7959 5.2002 2.72754C5.04069 2.65918 4.86979 2.625 4.6875 2.625C4.56901 2.625 4.46647 2.58171 4.37988 2.49512C4.29329 2.40853 4.25 2.30599 4.25 2.1875C4.25 2.06901 4.29329 1.96647 4.37988 1.87988C4.46647 1.79329 4.56901 1.75 4.6875 1.75C4.98828 1.75 5.27083 1.80697 5.53516 1.9209C5.80404 2.03483 6.03646 2.19206 6.23242 2.39258C6.43294 2.58854 6.59017 2.82096 6.7041 3.08984C6.81803 3.35417 6.875 3.63672 6.875 3.9375C6.875 4.05599 6.83171 4.15853 6.74512 4.24512C6.65853 4.33171 6.55599 4.375 6.4375 4.375Z"
            fill="black"
          />
        </svg>
      `;case dR.File:return html$1`
        <svg width="20" height="26" viewBox="0 0 20 26" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.64"
            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"
            fill="#605E5C"
          />
          <path
            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"
            fill="white"
          />
          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />
        </svg>
      `;case dR.Files:return html$1`
        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M17 8C17.1354 8 17.263 8.02604 17.3828 8.07812C17.5078 8.13021 17.6146 8.20312 17.7031 8.29688C17.7969 8.38542 17.8698 8.48958 17.9219 8.60938C17.974 8.72917 18 8.85677 18 8.99219C18 9.14844 17.9635 9.29948 17.8906 9.44531L14.6172 16H2V5C2 4.85938 2.02604 4.72917 2.07812 4.60938C2.13021 4.48958 2.20052 4.38542 2.28906 4.29688C2.38281 4.20312 2.48958 4.13021 2.60938 4.07812C2.72917 4.02604 2.85938 4 3 4H5.75C5.98438 4 6.1849 4.02604 6.35156 4.07812C6.52344 4.125 6.67448 4.1849 6.80469 4.25781C6.9401 4.33073 7.0599 4.41146 7.16406 4.5C7.26823 4.58854 7.3724 4.66927 7.47656 4.74219C7.58594 4.8151 7.70052 4.8776 7.82031 4.92969C7.94531 4.97656 8.08854 5 8.25 5H14C14.1406 5 14.2708 5.02604 14.3906 5.07812C14.5104 5.13021 14.6146 5.20312 14.7031 5.29688C14.7969 5.38542 14.8698 5.48958 14.9219 5.60938C14.974 5.72917 15 5.85938 15 6V8H17ZM3 13.3828L5.41406 8.55469C5.5026 8.38281 5.625 8.2474 5.78125 8.14844C5.94271 8.04948 6.11979 8 6.3125 8H14V6H8.25C8.01562 6 7.8125 5.97656 7.64062 5.92969C7.47396 5.8776 7.32292 5.8151 7.1875 5.74219C7.05729 5.66927 6.9401 5.58854 6.83594 5.5C6.73177 5.41146 6.625 5.33073 6.51562 5.25781C6.41146 5.1849 6.29688 5.125 6.17188 5.07812C6.05208 5.02604 5.91146 5 5.75 5H3V13.3828ZM17 9H6.3125L3.3125 15H14L17 9Z"
          />
        </svg>
      `;case dR.Back:return html$1`
        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"
          />
        </svg>
      `;case dR.Upload:return html$1`
    <svg class="upload-icon" width="10" height="12"  xmlns="http://www.w3.org/2000/svg">
      <path
        d="m9.58733,0l0,0.74599l-9.22101,0l0,-0.74599l9.22101,0zm0.3602,5.70569l-0.72039,0.52453l-3.73803,-2.7392l0,8.44489l-1.02456,0l0,-8.44489l-3.73803,2.7392l-0.72039,-0.52453l4.9707,-3.64838l4.9707,3.64838z"
      />
    </svg>
  `;case dR.FileCloud:return html$1`
    <svg width="16" height="16"  xmlns="http://www.w3.org/2000/svg">
      <path
        d="m8,0c2.8166,0 4.4145,1.9233 4.6469,4.246l0.071,0c1.8127,0 3.2821,1.5119 3.2821,3.377c0,0.0953 -0.0038,0.1897 -0.0114,0.283c-0.322,-0.4017 -0.6967,-0.7591 -1.1138,-1.062c-0.3104,-0.9329 -1.1627,-1.598 -2.1568,-1.598l-0.0711,0c-0.5137,0 -0.9439,-0.3893 -0.9951,-0.9005c-0.2021,-2.0206 -1.5433,-3.3455 -3.6518,-3.3455c-2.1139,0 -3.4489,1.3159 -3.6518,3.3455c-0.0511,0.5112 -0.4813,0.9005 -0.9951,0.9005l-0.071,0c-1.2539,0 -2.2821,1.0579 -2.2821,2.377c0,1.3191 1.0282,2.377 2.2821,2.377l2.6655,0c-0.087,0.323 -0.1466,0.6572 -0.1762,1l-2.4893,0c-1.8127,0 -3.2821,-1.5119 -3.2821,-3.377c0,-1.8029 1.3731,-3.2758 3.102,-3.372l0.2511,-0.005c0.2338,-2.338 1.8303,-4.246 4.6469,-4.246zm3.5,16c2.4853,0 4.5,-2.0147 4.5,-4.5c0,-2.4853 -2.0147,-4.5 -4.5,-4.5c-2.4853,0 -4.5,2.0147 -4.5,4.5c0,2.4853 2.0147,4.5 4.5,4.5zm0,-7c0.2761,0 0.5,0.2239 0.5,0.5l0,1.5l1.5,0c0.2761,0 0.5,0.2239 0.5,0.5c0,0.2761 -0.2239,0.5 -0.5,0.5l-1.5,0l0,1.5c0,0.2761 -0.2239,0.5 -0.5,0.5c-0.2761,0 -0.5,-0.2239 -0.5,-0.5l0,-1.5l-1.5,0c-0.2761,0 -0.5,-0.2239 -0.5,-0.5c0,-0.2761 0.2239,-0.5 0.5,-0.5l1.5,0l0,-1.5c0,-0.2761 0.2239,-0.5 0.5,-0.5z" fill="#0078D4"
      />
    </svg>
  `;case dR.DragFile:return html$1`
    <svg width="13" height="16" xmlns="http://www.w3.org/2000/svg">
      <path
        d="m0,1.00189c0,-0.8451 0.983,-1.3091 1.636,-0.772l11.006,9.0622c0.724,0.5964 0.302,1.772 -0.636,1.772l-5.592,0c-0.435,0 -0.849,0.1892 -1.134,0.5185l-3.524,4.0725c-0.606,0.7003 -1.756,0.2717 -1.756,-0.6544l0,-13.9988zm12.006,9.0622l-11.006,-9.0622l0,13.9988l3.524,-4.0724c0.475,-0.5488 1.164,-0.8642 1.89,-0.8642l5.592,0z"
      />
    </svg>
  `;case dR.Cancel:return html$1`
    <svg class="cancel-icon" width="10" height="10" xmlns="http://www.w3.org/2000/svg">
      <path
        d="m5.52795,4.92946l4.37418,4.36141l-0.57055,0.56806l-4.38052,-4.35509l-4.38052,4.35509l-0.57055,-0.56806l4.37418,-4.36141l-4.37418,-4.36141l0.57055,-0.56806l4.38052,4.35509l4.38052,-4.35509l0.57055,0.56806l-4.37418,4.36141z"
      />
    </svg>
  `;case dR.Success:return html$1`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path fill="#009E00" d="m6.322,12c3.492,0 6.323,-2.6863 6.323,-6c0,-3.3137 -2.831,-6 -6.323,-6c-3.491,0 -6.322,2.6863 -6.322,6c0,3.3137 2.831,6 6.322,6z"/>
      <path fill="white" d="m9.629,3.7509c-0.131,-0.125 -0.31,-0.1952 -0.496,-0.1952c-0.187,0 -0.365,0.0702 -0.497,0.1952l-3.267,3.1l-1.393,-1.3222c-0.177,-0.1695 -0.436,-0.2361 -0.68,-0.1746c-0.243,0.0615 -0.433,0.2418 -0.497,0.4725c-0.065,0.2307 0.005,0.4767 0.184,0.6449l1.807,1.7154c0.019,0.0331 0.041,0.0646 0.066,0.094c0.289,0.2562 0.738,0.2562 1.027,0c0.024,-0.0294 0.047,-0.0609 0.065,-0.0941l3.681,-3.4931c0.275,-0.2603 0.275,-0.6824 0,-0.9428z"/>
    </svg>
  `;case dR.Fail:return html$1`
    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
      <path fill="#EF355D" d="m6,12c3.314,0 6,-2.6863 6,-6c0,-3.3137 -2.686,-6 -6,-6c-3.314,0 -6,2.6863 -6,6c0,3.3137 2.686,6 6,6z"/>
      <path fill="white" d="m6.943,6.0004l1.544,-1.5444c0.169,-0.1683 0.236,-0.4142 0.174,-0.6448c-0.061,-0.2306 -0.241,-0.4107 -0.472,-0.4722c-0.231,-0.0616 -0.477,0.0049 -0.645,0.1742l-1.544,1.5443l-1.545,-1.5443c-0.26,-0.259 -0.681,-0.2583 -0.941,0.0014c-0.26,0.2598 -0.26,0.6808 -0.001,0.9414l1.544,1.5444l-1.544,1.5444c-0.259,0.2606 -0.259,0.6815 0.001,0.9413c0.26,0.2598 0.681,0.2604 0.941,0.0015l1.545,-1.5444l1.544,1.5444c0.261,0.2589 0.682,0.2583 0.942,-0.0015c0.259,-0.2598 0.26,-0.6807 0.001,-0.9413l-1.544,-1.5444z" />
    </svg>
  `}}function isWindowSegmentAware(){return void 0!==window.getWindowSegments}exports.ViewType=void 0,(lR=exports.ViewType||(exports.ViewType={}))[lR.image=2]="image",lR[lR.oneline=3]="oneline",lR[lR.twolines=4]="twolines",lR[lR.threelines=5]="threelines",function(t){t[t.ArrowRight=0]="ArrowRight",t[t.ArrowDown=1]="ArrowDown",t[t.TeamSeparator=2]="TeamSeparator",t[t.Search=3]="Search",t[t.SkypeArrow=4]="SkypeArrow",t[t.SmallEmail=5]="SmallEmail",t[t.SmallChat=6]="SmallChat",t[t.ExpandDown=7]="ExpandDown",t[t.Overview=8]="Overview",t[t.Send=9]="Send",t[t.Contact=10]="Contact",t[t.Copy=11]="Copy",t[t.Phone=12]="Phone",t[t.CellPhone=13]="CellPhone",t[t.Chat=14]="Chat",t[t.Department=15]="Department",t[t.Email=16]="Email",t[t.OfficeLocation=17]="OfficeLocation",t[t.Person=18]="Person",t[t.Messages=19]="Messages",t[t.Organization=20]="Organization",t[t.ExpandRight=21]="ExpandRight",t[t.Profile=22]="Profile",t[t.Birthday=23]="Birthday",t[t.File=24]="File",t[t.Files=25]="Files",t[t.Back=26]="Back",t[t.Upload=27]="Upload",t[t.FileCloud=28]="FileCloud",t[t.DragFile=29]="DragFile",t[t.Cancel=30]="Cancel",t[t.Success=31]="Success",t[t.Fail=32]="Fail"}(dR||(dR={}));const uR=[css$1`
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));border-radius:8px}.root .flyout.small{overflow-y:auto;overflow-x:hidden}.root.visible .flyout{display:inline-block;animation-name:fadeIn;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}.root.visible .flyout.small{overflow-y:auto;overflow-x:hidden}@keyframes fadeIn{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}
`];var __decorate$u=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$r=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};let hR=class MgtFlyout extends MgtBaseComponent{static get styles(){return uR}get isOpen(){return this._isOpen}set isOpen(t){const r=this._isOpen;r!==t&&(this._isOpen=t,window.requestAnimationFrame((()=>{this.setupWindowEvents(this.isOpen);const t=this._flyout;!this.isOpen&&t&&(t.style.width=null,t.style.setProperty("--mgt-flyout-set-width",null),t.style.setProperty("--mgt-flyout-set-height",null),t.style.maxHeight=null,t.style.top=null,t.style.left=null,t.style.bottom=null)})),this.requestUpdate("isOpen",r),this.dispatchEvent(new Event(t?"opened":"closed")))}get _flyout(){return this.renderRoot.querySelector(".flyout")}get _anchor(){return this.renderRoot.querySelector(".anchor")}get _topScout(){return this.renderRoot.querySelector(".scout-top")}get _bottomScout(){return this.renderRoot.querySelector(".scout-bottom")}constructor(){super(),this._edgePadding=24,this._renderedOnce=!1,this.avoidHidingAnchor=!0,this.handleWindowEvent=this.handleWindowEvent.bind(this),this.handleResize=this.handleResize.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.addEventListener("expanded",(()=>{window.requestAnimationFrame((()=>{this.updateFlyout()}))}))}open(){this.isOpen=!0}close(){this.isOpen=!1}disconnectedCallback(){this.setupWindowEvents(!1),super.disconnectedCallback()}updated(t){super.updated(t),window.requestAnimationFrame((()=>{this.updateFlyout()}))}render(){const t={dir:this.direction,root:!0,visible:this.isOpen},r=this.renderAnchor();let o=null;return this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0),(this.isOpen||this._renderedOnce)&&(this._renderedOnce=!0,o=html$1`
        <div class=${this._smallView?"flyout small":"flyout"} @wheel=${this.handleFlyoutWheel}>
          ${this.renderFlyout()}
        </div>
      `),html$1`
      <div class=${oR(t)}>
        <div class="anchor">
          ${r}
        </div>
        <div class="scout-top"></div>
        <div class="scout-bottom"></div>
        ${o}
      </div>
    `}renderAnchor(){return html$1`
      <slot></slot>
    `}renderFlyout(){return html$1`
      <slot name="flyout"></slot>
    `}updateFlyout(){if(!this.isOpen)return;const t=this._anchor,r=this._flyout;if(r&&t){const o=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth;this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight;let i,s,l,u=0,h=0;const m=r.getBoundingClientRect(),v=t.getBoundingClientRect(),C=this._topScout.getBoundingClientRect(),_=this._bottomScout.getBoundingClientRect(),k={height:this._windowHeight,left:0,top:0,width:o};if(isWindowSegmentAware()){const t=function getSegmentAwareWindow(){return isWindowSegmentAware()?window:null}().getWindowSegments();let r;const o=v.left+v.width/2,i=v.top+v.height/2;for(const s of t)if(o>=s.left&&i>=s.top){r=s;break}r&&(k.left=r.left,k.top=r.top,k.width=r.width,k.height=r.height)}m.width+2*this._edgePadding>k.width?m.width>k.width?(l=k.width,u=0):u=(k.width-m.width)/2:u=v.left+m.width+this._edgePadding>k.width?v.left-(v.left+m.width+this._edgePadding-k.width):v.left<this._edgePadding?this._edgePadding:v.left;const E=k.height-(v.top+v.height),R=v.top;this.avoidHidingAnchor?E<=m.height?R<m.height?R>E?(i=k.height-v.top,s=R):(h=v.bottom,s=E):(i=k.height-v.top,s=R):(h=v.bottom,s=E):m.height+2*this._edgePadding>k.height?m.height>=k.height?(s=k.height,h=0):h=(k.height-m.height)/2:h=v.top+v.height+m.height+this._edgePadding>k.height?k.height-m.height-this._edgePadding:Math.max(v.top+v.height,this._edgePadding),0===C.top&&0===C.left||(u-=C.left,void 0!==i?i+=_.top-this._windowHeight:h-=C.top),"rtl"===this.direction?u>100&&this.offsetLeft>100&&(r.style.left=k.width-u+m.left-m.width-30+"px"):r.style.left=`${u+k.left}px`,void 0!==i?(r.style.top="unset",r.style.bottom=`${i}px`):(r.style.bottom="unset",r.style.top=`${h+k.top}px`),l&&(r.style.width=`${l}px`,r.style.setProperty("--mgt-flyout-set-width",`${l}px`),window.requestAnimationFrame((()=>this.updateFlyout()))),s?(r.style.maxHeight=`${s}px`,r.style.setProperty("--mgt-flyout-set-height",`${s}px`)):(r.style.maxHeight=null,r.style.setProperty("--mgt-flyout-set-height","unset"))}}setupWindowEvents(t){t&&this.isLightDismiss?(window.addEventListener("wheel",this.handleWindowEvent),window.addEventListener("pointerdown",this.handleWindowEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("keyup",this.handleKeyUp)):(window.removeEventListener("wheel",this.handleWindowEvent),window.removeEventListener("pointerdown",this.handleWindowEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("keyup",this.handleKeyUp))}handleWindowEvent(t){const r=this._flyout;if(r)if(t.composedPath){const o=t.composedPath();if(o.includes(r)||"pointerdown"===t.type&&o.includes(this))return}else{let o=t.target;for(;o;)if(o=o.parentElement,o===r||"pointerdown"===t.type&&o===this)return}this.close()}handleResize(t){this.close()}handleKeyUp(t){"Escape"===t.key&&this.close()}handleFlyoutWheel(t){t.preventDefault()}};var pR;__decorate$u([property({attribute:"light-dismiss",type:Boolean}),__metadata$r("design:type",Boolean)],hR.prototype,"isLightDismiss",void 0),__decorate$u([property({attribute:null,type:Boolean}),__metadata$r("design:type",Boolean)],hR.prototype,"avoidHidingAnchor",void 0),__decorate$u([property({attribute:"isOpen",type:Boolean}),__metadata$r("design:type",Boolean),__metadata$r("design:paramtypes",[Boolean])],hR.prototype,"isOpen",null),hR=__decorate$u([customElement$1("mgt-flyout"),__metadata$r("design:paramtypes",[])],hR),exports.PersonCardInteraction=void 0,(pR=exports.PersonCardInteraction||(exports.PersonCardInteraction={}))[pR.none=0]="none",pR[pR.hover=1]="hover",pR[pR.click=2]="click";const fR=[css$1`
@charset "UTF-8";:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host([hidden]){display:none}:host{display:inline-block;font-family:var(--font-family,var(--default-font-family));vertical-align:top}:host .root{display:block;margin:-11px -13px;padding:11px 13px}:host .root:focus-visible{outline:0}:host svg,mgt-person svg{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root,mgt-person .person-root{position:relative;display:flex;align-items:center;color:var(--color,var(--color-sub1,#323130))}:host .person-root.clickable,mgt-person .person-root.clickable{cursor:pointer}:host .person-root.small:focus-visible,mgt-person .person-root.small:focus-visible{outline:auto}:host .person-root .user-avatar,mgt-person .person-root .user-avatar{position:relative;width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));display:flex;justify-content:center;align-items:center;flex-shrink:0;cursor:var(--avatar-cursor,inherit)}:host .person-root .user-avatar .user-presence,mgt-person .person-root .user-avatar .user-presence{margin:0;position:absolute;left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);top:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);border:2px solid var(--presence-background-color,var(--background-color,#fff));border-radius:50%}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#b4009e}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg{color:#b4009e;width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-basic,mgt-person .person-root .user-avatar .user-presence .presence-basic{width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);border-style:solid;border-width:2px;border-radius:50%;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);vertical-align:top;display:flex;align-items:center}:host .person-root .user-avatar .user-presence .presence-basic.presence-offline,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-offline{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#8a8886}:host .person-root .user-avatar .user-presence .presence-basic.presence-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-available{background-color:#6bb700;border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-available{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-away,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-away{background-color:#fa4;border-color:#fa4}:host .person-root .user-avatar .user-presence .presence-basic.presence-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-dnd{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-busy{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-offline::before,mgt-person .person-root .user-avatar .user-presence .presence-offline::before{content:"ï½";color:#8a8886;font-weight:700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-available::before,mgt-person .person-root .user-avatar .user-presence .presence-available::before{content:"î¾";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-available::before{content:"î¾";color:#6bb700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-away::before,mgt-person .person-root .user-avatar .user-presence .presence-away::before{content:"î¾";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-dnd::before{content:"î¾";color:var(--presence-icon-color,var(--background-color,#fff));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-dnd::before{content:"î¾";color:#c50f1f;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar.initials,mgt-person .person-root .user-avatar.initials{color:var(--initials-color,#fff);border-radius:var(--avatar-border-radius,50%);font-weight:400}:host .person-root .user-avatar.initials .contact-icon,:host .person-root .user-avatar.initials .initials-text,mgt-person .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .initials-text{cursor:var(--avatar-cursor,inherit);margin-top:-1px;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .4)}:host .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .contact-icon{display:inline}:host .person-root .user-avatar.small,mgt-person .person-root .user-avatar.small{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root .user-avatar.small .contact-icon,:host .person-root .user-avatar.small .initials-text,mgt-person .person-root .user-avatar.small .contact-icon,mgt-person .person-root .user-avatar.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}:host .person-root .user-avatar.small .user-presence,mgt-person .person-root .user-avatar.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}:host .person-root .user-avatar.small .user-presence .presence-basic,mgt-person .person-root .user-avatar.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}:host .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}:host .person-root .user-avatar.small .user-presence .presence-available::before,:host .person-root .user-avatar.small .user-presence .presence-away::before,:host .person-root .user-avatar.small .user-presence .presence-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-offline::before,:host .person-root .user-avatar.small .user-presence .presence-oof-available::before,:host .person-root .user-avatar.small .user-presence .presence-oof-away::before,:host .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-offline::before{content:''}:host .person-root .user-avatar .img-wrapper,mgt-person .person-root .user-avatar .img-wrapper{height:100%;width:100%;display:flex;overflow:hidden;border:var(--avatar-border,0);border-radius:var(--avatar-border-radius,50%);position:relative;box-sizing:border-box}:host .person-root .user-avatar .img-wrapper img,mgt-person .person-root .user-avatar .img-wrapper img{position:absolute;display:block;top:-100%;right:-100%;bottom:-100%;left:-100%;margin:auto;height:100%;width:100%;object-fit:cover;object-position:top}:host .person-root .user-avatar .img-wrapper img:focus(),mgt-person .person-root .user-avatar .img-wrapper img:focus(){outline:0}:host .person-root .user-avatar.pinkRed10,mgt-person .person-root .user-avatar.pinkRed10{background-color:var(--initials-background-color,#750b1c)}:host .person-root .user-avatar.red20,mgt-person .person-root .user-avatar.red20{background-color:var(--initials-background-color,#a4262c)}:host .person-root .user-avatar.red10,mgt-person .person-root .user-avatar.red10{background-color:var(--initials-background-color,#d13438)}:host .person-root .user-avatar.orange20,mgt-person .person-root .user-avatar.orange20{background-color:var(--initials-background-color,#ca5010)}:host .person-root .user-avatar.orangeYellow20,mgt-person .person-root .user-avatar.orangeYellow20{background-color:var(--initials-background-color,#986f0b)}:host .person-root .user-avatar.green10,mgt-person .person-root .user-avatar.green10{background-color:var(--initials-background-color,#498205)}:host .person-root .user-avatar.green20,mgt-person .person-root .user-avatar.green20{background-color:var(--initials-background-color,#0b6a0b)}:host .person-root .user-avatar.cyan20,mgt-person .person-root .user-avatar.cyan20{background-color:var(--initials-background-color,#038387)}:host .person-root .user-avatar.cyan30,mgt-person .person-root .user-avatar.cyan30{background-color:var(--initials-background-color,#005b70)}:host .person-root .user-avatar.cyanBlue10,mgt-person .person-root .user-avatar.cyanBlue10{background-color:var(--initials-background-color,#0078d4)}:host .person-root .user-avatar.cyanBlue20,mgt-person .person-root .user-avatar.cyanBlue20{background-color:var(--initials-background-color,#004e8c)}:host .person-root .user-avatar.blue10,mgt-person .person-root .user-avatar.blue10{background-color:var(--initials-background-color,#4f6bed)}:host .person-root .user-avatar.blueMagenta30,mgt-person .person-root .user-avatar.blueMagenta30{background-color:var(--initials-background-color,#5c2e91)}:host .person-root .user-avatar.blueMagenta20,mgt-person .person-root .user-avatar.blueMagenta20{background-color:var(--initials-background-color,#8764b8)}:host .person-root .user-avatar.magenta20,mgt-person .person-root .user-avatar.magenta20{background-color:var(--initials-background-color,#881798)}:host .person-root .user-avatar.magenta10,mgt-person .person-root .user-avatar.magenta10{background-color:var(--initials-background-color,#c239b3)}:host .person-root .user-avatar.magentaPink10,mgt-person .person-root .user-avatar.magentaPink10{background-color:var(--initials-background-color,#e3008c)}:host .person-root .user-avatar.orange30,mgt-person .person-root .user-avatar.orange30{background-color:var(--initials-background-color,#8e562e)}:host .person-root .user-avatar.gray30,mgt-person .person-root .user-avatar.gray30{background-color:var(--initials-background-color,#7a7574)}:host .person-root .user-avatar.gray20,mgt-person .person-root .user-avatar.gray20{background-color:var(--initials-background-color,#69797e)}:host .person-root .details,mgt-person .person-root .details{flex-shrink:1;display:flex;flex-direction:column;overflow:hidden;line-height:1.4;margin:var(--details-spacing,0 0 0 12px)}:host .person-root .details.small,mgt-person .person-root .details.small{margin:var(--details-spacing,0 0 0 6px)}:host .person-root .details>div,mgt-person .person-root .details>div{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}:host .person-root .details .line1,mgt-person .person-root .details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,600);text-transform:var(text-transform,none)}:host .person-root .details .line2,mgt-person .person-root .details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--email-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none))}:host .person-root .details .line3,mgt-person .person-root .details .line3{color:var(--line3-color,var(--color-sub2,#717171));font-size:var(--line3-font-size,var(--email-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none))}:host .avatar-icon,mgt-person .avatar-icon{display:flex;align-items:center;justify-content:center;line-height:1;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .5);width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));overflow:hidden;border-radius:var(--avatar-border-radius,50%)}:host .avatar-icon.small,mgt-person .avatar-icon.small{font-size:var(--avatar-size-s,var(--avatar-size,24px));width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}[dir=rtl] .root{direction:rtl}[dir=rtl] svg{direction:rtl}[dir=rtl] .person-root .user-avatar{position:relative}[dir=rtl] .person-root .details{margin:var(--details-spacing,0 12px 0 0)}[dir=rtl] .person-root .details.small{margin:var(--details-spacing,0 6px 0 0)}[dir=rtl] .person-root .user-presence .presence-oof-offline svg{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-offline::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-away::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root.small .contact-icon,[dir=rtl] .person-root.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}[dir=rtl] .person-root.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}[dir=rtl] .person-root.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}[dir=rtl] .person-root.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path,mgt-person svg,mgt-person svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path,mgt-person svg,mgt-person svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`],gR={photoFor:"Photo for",emailAddress:"Email address",initials:"Initials"};var mR,vR,yR,__decorate$t=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$q=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$u=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.PersonViewType=void 0,(vR=exports.PersonViewType||(exports.PersonViewType={}))[vR.avatar=2]="avatar",vR[vR.oneline=3]="oneline",vR[vR.twolines=4]="twolines",vR[vR.threelines=5]="threelines",exports.avatarType=void 0,(yR=exports.avatarType||(exports.avatarType={})).photo="photo",yR.initials="initials";const bR=["businessPhones","displayName","givenName","jobTitle","mail","mobilePhone","officeLocation","preferredLanguage","surname","userPrincipalName","id"];exports.MgtPerson=mR=class MgtPerson extends MgtTemplatedComponent{static get styles(){return fR}get strings(){return gR}get personQuery(){return this._personQuery}set personQuery(t){t!==this._personQuery&&(this._personQuery=t,this.personDetailsInternal=null,this.requestStateUpdate())}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(t){t!==this._fallbackDetails&&(this._fallbackDetails=t,this.personDetailsInternal||(t&&t.displayName?this._personAvatarBg=this.getColorFromName(t.displayName):this._personAvatarBg="gray20",this.requestStateUpdate()))}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.personDetailsInternal=null,this.requestStateUpdate())}get personDetailsInternal(){return this._personDetailsInternal}set personDetailsInternal(t){this._personDetailsInternal!==t&&(this._personDetailsInternal=t,t&&t.displayName?this._personAvatarBg=this.getColorFromName(t.displayName):this._personAvatarBg="gray20",this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetailsInternal"))}get personDetails(){return this._personDetails}set personDetails(t){this._personDetails!==t&&(this._personDetails=t,t&&t.displayName?this._personAvatarBg=this.getColorFromName(t.displayName):this._personAvatarBg="gray20",this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetails"))}get personImage(){return this._personImage||this._fetchedImage}set personImage(t){if(t===this._personImage)return;this._isInvalidImageSrc=!t;const r=this._personImage;this._personImage=t,this.requestUpdate("personImage",r)}get avatarType(){return this._avatarType}set avatarType(t){t!==this._avatarType&&(this._avatarType=t,this.requestStateUpdate())}get personPresence(){return this._personPresence||this._fetchedPresence}set personPresence(t){if(t===this._personPresence)return;const r=this._personPresence;this._personPresence=t,this.requestUpdate("personPresence",r)}static get requiredScopes(){const t=["user.readbasic.all","user.read","people.read","presence.read.all","presence.read"];return mR.config.useContactApis&&t.push("contacts.read"),t}get flyout(){return this.renderRoot.querySelector(".flyout")}constructor(){super(),this.personCardInteraction=exports.PersonCardInteraction.none,this.line1Property="displayName",this.line2Property="email",this.line3Property="jobTitle",this.view=exports.ViewType.image,this.avatarSize="auto",this.disableImageFetch=!1,this._isInvalidImageSrc=!1,this._avatarType="photo"}render(){if(this.isLoadingState&&!this.personDetails&&!this.personDetailsInternal&&!this.fallbackDetails)return this.renderLoading();const t=this.personDetails||this.personDetailsInternal||this.fallbackDetails,r=this.getImage(),o=this.personPresence||this._fetchedPresence;if(!t&&!r)return this.renderNoData();t&&t.personImage||!r||(t.personImage=r);let i=this.renderTemplate("default",{person:t,personImage:r,personPresence:o});if(!i){const s=this.renderDetails(t,o),l=this.renderAvatar(t,r,o),u={"person-root":!0,clickable:this.personCardInteraction===exports.PersonCardInteraction.click,small:!this.isLargeAvatar()};i=html$1`
        <div 
          class=${oR(u)}
          tabindex=${iR(this.personCardInteraction===exports.PersonCardInteraction.click?"0":void 0)}
        >
          ${l} ${s}
        </div>
      `}return this.personCardInteraction!==exports.PersonCardInteraction.none&&(i=this.renderFlyout(i,t,r,o)),html$1`
      <div
        class="root"
        dir=${this.direction}
        @click=${this.handleMouseClick}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
        @keydown=${this.handleKeyDown}
      >
        ${i}
      </div>
    `}renderLoading(){return this.renderTemplate("loading",null)||html$1``}clearState(){this._personImage="",this._personDetailsInternal=null,this._fetchedImage=null,this._fetchedPresence=null}renderNoData(){const t=this.renderTemplate("no-data",null);if(t)return t;const r={"avatar-icon":!0,"ms-Icon":!0,"ms-Icon--Contact":!0,small:!this.isLargeAvatar()};return html$1`
      <i class=${oR(r)}></i>
    `}renderImage(t,r){if(r&&!this._isInvalidImageSrc&&"photo"===this._avatarType){const o=`${this.strings.photoFor} ${t.displayName}`;return html$1`
        <div class="img-wrapper">
          <img alt=${o} src=${r} @error=${()=>this._isInvalidImageSrc=!0} />
        </div>
      `}if(t){const r=this.getInitials(t);return html$1`
        <span class="initials-text" aria-label="${this.strings.initials} ${r}">
          ${r&&r.length?html$1`
                ${r}
              `:html$1`
                <i class="ms-Icon ms-Icon--Contact contact-icon"></i>
              `}
        </span>
      `}}renderPresence(t){if(!this.showPresence||!t)return html$1``;let r=null;switch(t.availability){case"DoNotDisturb":if("OutOfOffice"===t.activity)r="presence-oof-dnd";else r="presence-dnd";break;case"BeRightBack":r="presence-away";break;case"Available":switch(t.activity){case"Available":r="presence-available";break;case"OutOfOffice":r="presence-oof-available"}break;case"Busy":if("OutOfOffice"===t.activity)r="presence-oof-busy";else r="presence-busy";break;case"Away":switch(t.activity){case"Away":r="presence-away";break;case"OutOfOffice":r="presence-oof-offline"}break;case"Offline":switch(t.activity){case"Offline":case"OffWork":r="presence-offline";break;case"OutOfOffice":r="presence-oof-offline"}break;default:r="presence-offline"}const o={"ms-Icon":!0,"presence-basic":!0};o[r]=!0;let i=null;return i="presence-oof-offline"===r?html$1`
        <div class="ms-Icon presence-basic presence-oof-offline-wrapper">
          <i class="presence-oof-offline">
            ${getSvg(dR.SkypeArrow,"#666666")}
          </i>
        </div>
      `:html$1`
        <i class=${oR(o)} aria-hidden="true"></i>
      `,html$1`
      <div class="user-presence" title=${t.activity} aria-label=${t.activity} role="img">
        ${i}
      </div>
    `}renderAvatar(t,r,o){const i=!r||this._isInvalidImageSrc||this._avatarType===exports.avatarType.initials,s={initials:i,small:!this.isLargeAvatar(),"user-avatar":!0};let l="";if(i&&t?(s[this._personAvatarBg]=!0,l=`${this.strings.initials} ${this.getInitials(t)}`):(l=t&&t.displayName||"",""!==l&&(l=`${this.strings.photoFor} ${l}`)),""===l){const r=getEmailFromGraphEntity(t);null!==r&&(l=`${this.strings.emailAddress} ${r}`)}const u=this.renderImage(t,r),h=this.renderPresence(o);return html$1`
      <div class=${oR(s)} title=${l} aria-label=${l}>
        ${u} ${h}
      </div>
    `}handleLine1Clicked(){this.fireCustomEvent("line1clicked",this.personDetailsInternal)}handleLine2Clicked(){this.fireCustomEvent("line2clicked",this.personDetailsInternal)}handleLine3Clicked(){this.fireCustomEvent("line3clicked",this.personDetailsInternal)}renderDetails(t,r){if(!t||this.view===exports.ViewType.image||this.view===exports.PersonViewType.avatar)return html$1``;let o=t;r&&(o.presenceActivity=null==r?void 0:r.activity,o.presenceAvailability=null==r?void 0:r.availability);const i=[];if(this.view>exports.ViewType.image)if(this.hasTemplate("line1")){const t=this.renderTemplate("line1",{person:o});i.push(html$1`
          <div class="line1" @click=${()=>this.handleLine1Clicked()}>${t}</div>
        `)}else{const t=this.getTextFromProperty(o,this.line1Property);t&&i.push(html$1`
            <div class="line1" @click=${()=>this.handleLine1Clicked()} role="presentation" aria-label="${t}">${t}</div>
          `)}if(this.view>exports.ViewType.oneline)if(this.hasTemplate("line2")){const t=this.renderTemplate("line2",{person:o});i.push(html$1`
          <div class="line2" @click=${()=>this.handleLine2Clicked()}>${t}</div>
        `)}else{const t=this.getTextFromProperty(o,this.line2Property);t&&i.push(html$1`
            <div class="line2" @click=${()=>this.handleLine2Clicked()} role="presentation" aria-label="${t}">${t}</div>
          `)}if(this.view>exports.ViewType.twolines)if(this.hasTemplate("line3")){const t=this.renderTemplate("line3",{person:o});i.push(html$1`
          <div class="line3" @click=${()=>this.handleLine3Clicked()}>${t}</div>
        `)}else{const t=this.getTextFromProperty(o,this.line3Property);t&&i.push(html$1`
            <div class="line3" @click=${()=>this.handleLine3Clicked()} role="presentation" aria-label="${t}">${t}</div>
          `)}const s=oR({details:!0,small:!this.isLargeAvatar()});return html$1`
      <div class="${s}">
        ${i}
      </div>
    `}renderFlyout(t,r,o,i){const s=this._personCardShouldRender?html$1`
          <div slot="flyout">
            ${this.renderFlyoutContent(r,o,i)}
          </div>
        `:html$1``;return html$1`
      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=${!1}>
        ${t} ${s}
      </mgt-flyout>
    `}renderFlyoutContent(t,r,o){return this.renderTemplate("person-card",{person:t,personImage:r})||html$1`
        <mgt-person-card
          lock-tab-navigation
          .personDetails=${t}
          .personImage=${r}
          .personPresence=${o}
          .showPresence=${this.showPresence}
        ></mgt-person-card>
      `}loadState(){return __awaiter$u(this,void 0,void 0,(function*(){const t=Providers.globalProvider;if(!t||t.state===exports.ProviderState.Loading)return;if(t&&t.state===exports.ProviderState.SignedOut)return void(this.personDetailsInternal=null);const r=t.graph.forComponent(this);let o=[...bR,this.line1Property,this.line2Property,this.line3Property];o=o.filter((t=>"email"!==t));let i=this.personDetailsInternal||this.personDetails;if(i){if(!i.personImage&&this.fetchImage&&"photo"===this._avatarType&&!this.personImage&&!this._fetchedImage){let t;t="groupTypes"in i?yield function getGroupImage(t,r,o=!0){return __awaiter$x(this,void 0,void 0,(function*(){let o,i,s=r.id;if(getIsPhotosCacheEnabled()){if(i=CacheService.getCache(sR.photos,sR.photos.stores.groups),o=yield i.getValue(s),o&&getPhotoInvalidationTime()>Date.now()-o.timeCached)return o.photo;if(o)try{const r=yield t.api(`groups/${s}/photo`).get();r&&(r["@odata.mediaEtag"]!==o.eTag||null===r["@odata.mediaEtag"]&&null===r.eTag)&&(o=null)}catch(t){return null}}return o=o||(yield getPhotoForResource(t,`groups/${s}`,["user.readbasic.all"])),getIsPhotosCacheEnabled()&&o&&i.putValue(s,o),o?o.photo:null}))}(r,i,mR.config.useContactApis):yield getPersonImage(r,i,mR.config.useContactApis),t&&(i.personImage=t,this._fetchedImage=t)}}else if(this.userId||"me"===this.personQuery){let t;t="photo"!==this._avatarType||this.disableImageFetch?"me"===this.personQuery?yield getMe(r,o):yield getUser(r,this.userId,o):yield getUserWithPhoto(r,this.userId,o),this.personDetailsInternal=t,this.personDetails=t,this._fetchedImage=this.getImage()}else if(this.personQuery){let t=yield findPeople(r,this.personQuery,1);if(t&&0!==t.length||(t=(yield findUsers(r,this.personQuery,1))||[]),t&&t.length&&(this.personDetailsInternal=t[0],this.personDetails=t[0],"photo"===this._avatarType&&!this.disableImageFetch)){const o=yield getPersonImage(r,t[0],mR.config.useContactApis);o&&(this.personDetailsInternal.personImage=o,this.personDetails.personImage=o,this._fetchedImage=o)}}const s={activity:"Offline",availability:"Offline",id:null};if(this.showPresence&&!this.personPresence&&!this._fetchedPresence)try{if(i=this.personDetailsInternal||this.personDetails,i){const t="me"!==this.personQuery?null==i?void 0:i.id:null;this._fetchedPresence=yield getUserPresence(r,t)}else this._fetchedPresence=s}catch(t){this._fetchedPresence=s}}))}getInitials(t){if(t||(t=this.personDetailsInternal),t.initials)return t.initials;let r="";if(t.givenName&&(r+=t.givenName[0].toUpperCase()),t.surname&&(r+=t.surname[0].toUpperCase()),!r&&t.displayName){const o=t.displayName.split(/\s+/);for(let t=0;t<2&&t<o.length;t++)o[t][0]&&this.isLetter(o[t][0])&&(r+=o[t][0].toUpperCase())}return r}getColorFromName(t){const r=t.split("").map((t=>t.charCodeAt(0))).join(""),o=["pinkRed10","red20","red10","orange20","orangeYellow20","green10","green20","cyan20","cyan30","cyanBlue10","cyanBlue20","blue10","blueMagenta30","blueMagenta20","magenta20","magenta10","magentaPink10","orange30","gray30","gray20"];return o[parseInt(r,10)%o.length]}getImage(){if(this.personImage)return this.personImage;if(this._fetchedImage)return this._fetchedImage;const t=this.personDetailsInternal||this.personDetails;return t&&t.personImage?t.personImage:null}isLetter(t){try{return t.match(new RegExp("\\p{L}","u"))}catch(r){return t.toLowerCase()!==t.toUpperCase()}}getTextFromProperty(t,r){if(!r||0===r.length)return null;const o=r.trim().split(",");let i,s=0;for(;!i&&s<o.length;){const r=o[s].trim();switch(r){case"mail":case"email":i=getEmailFromGraphEntity(t);break;default:i=t[r]}s++}return i}isLargeAvatar(){return"large"===this.avatarSize||"auto"===this.avatarSize&&this.view>exports.ViewType.oneline}handleMouseClick(t){this.personCardInteraction===exports.PersonCardInteraction.click&&this.showPersonCard()}handleKeyDown(t){t&&"Enter"===t.key&&this.showPersonCard()}handleMouseEnter(t){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this.personCardInteraction===exports.PersonCardInteraction.hover&&(this._mouseEnterTimeout=setTimeout(this.showPersonCard.bind(this),500))}handleMouseLeave(t){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=setTimeout(this.hidePersonCard.bind(this),500)}hidePersonCard(){const t=this.flyout;t&&t.close();const r=this.querySelector("mgt-person-card")||this.renderRoot.querySelector("mgt-person-card");r&&(r.isExpanded=!1,r.clearHistory())}showPersonCard(){this._personCardShouldRender||(this._personCardShouldRender=!0);const t=this.flyout;t&&t.open()}},exports.MgtPerson.config={useContactApis:!0},__decorate$t([property({attribute:"person-query"}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[String])],exports.MgtPerson.prototype,"personQuery",null),__decorate$t([property({attribute:"fallback-details",type:Object}),__metadata$q("design:type",Object),__metadata$q("design:paramtypes",[Object])],exports.MgtPerson.prototype,"fallbackDetails",null),__decorate$t([property({attribute:"user-id"}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[String])],exports.MgtPerson.prototype,"userId",null),__decorate$t([property({attribute:"show-presence",type:Boolean}),__metadata$q("design:type",Boolean)],exports.MgtPerson.prototype,"showPresence",void 0),__decorate$t([property({attribute:"avatar-size",type:String}),__metadata$q("design:type",String)],exports.MgtPerson.prototype,"avatarSize",void 0),__decorate$t([property({attribute:null,type:Object}),__metadata$q("design:type",Object),__metadata$q("design:paramtypes",[Object])],exports.MgtPerson.prototype,"personDetailsInternal",null),__decorate$t([property({attribute:"person-details",type:Object}),__metadata$q("design:type",Object),__metadata$q("design:paramtypes",[Object])],exports.MgtPerson.prototype,"personDetails",null),__decorate$t([property({attribute:"person-image",type:String}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[String])],exports.MgtPerson.prototype,"personImage",null),__decorate$t([property({attribute:"fetch-image",type:Boolean}),__metadata$q("design:type",Boolean)],exports.MgtPerson.prototype,"fetchImage",void 0),__decorate$t([property({attribute:"disable-image-fetch",type:Boolean}),__metadata$q("design:type",Boolean)],exports.MgtPerson.prototype,"disableImageFetch",void 0),__decorate$t([property({attribute:"avatar-type",converter:t=>"initials"===(t=t.toLowerCase())?exports.avatarType.initials:exports.avatarType.photo}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[String])],exports.MgtPerson.prototype,"avatarType",null),__decorate$t([property({attribute:"person-presence",type:Object}),__metadata$q("design:type",Object),__metadata$q("design:paramtypes",[Object])],exports.MgtPerson.prototype,"personPresence",null),__decorate$t([property({attribute:"person-card",converter:(t,r)=>(t=t.toLowerCase(),void 0===exports.PersonCardInteraction[t]?exports.PersonCardInteraction.none:exports.PersonCardInteraction[t])}),__metadata$q("design:type",Number)],exports.MgtPerson.prototype,"personCardInteraction",void 0),__decorate$t([property({attribute:"line1-property"}),__metadata$q("design:type",String)],exports.MgtPerson.prototype,"line1Property",void 0),__decorate$t([property({attribute:"line2-property"}),__metadata$q("design:type",String)],exports.MgtPerson.prototype,"line2Property",void 0),__decorate$t([property({attribute:"line3-property"}),__metadata$q("design:type",String)],exports.MgtPerson.prototype,"line3Property",void 0),__decorate$t([property({converter:t=>t&&0!==t.length?(t=t.toLowerCase(),void 0===exports.ViewType[t]?exports.ViewType.image:exports.ViewType[t]):exports.ViewType.image}),__metadata$q("design:type",Number)],exports.MgtPerson.prototype,"view",void 0),__decorate$t([internalProperty(),__metadata$q("design:type",String)],exports.MgtPerson.prototype,"_fetchedImage",void 0),__decorate$t([internalProperty(),__metadata$q("design:type",Object)],exports.MgtPerson.prototype,"_fetchedPresence",void 0),__decorate$t([internalProperty(),__metadata$q("design:type",Boolean)],exports.MgtPerson.prototype,"_isInvalidImageSrc",void 0),__decorate$t([internalProperty(),__metadata$q("design:type",Boolean)],exports.MgtPerson.prototype,"_personCardShouldRender",void 0),exports.MgtPerson=mR=__decorate$t([customElement$1("mgt-person"),__metadata$q("design:paramtypes",[])],exports.MgtPerson);const wR=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}:host .header,mgt-agenda .header{margin:var(--agenda-header-margin,40px 10px 14px 10px);font-family:var(--default-font-family);font-size:var(--agenda-header-font-size,24px);color:var(--agenda-header-color,var(--color-sub1,#323130))}:host .agenda>.group:first-child>.header,mgt-agenda .agenda>.group:first-child>.header{margin-top:0}:host .agenda-list,mgt-agenda .agenda-list{list-style-type:none;padding:0;margin:0;font-family:var(--default-font-family);font-style:normal;font-weight:400}:host .event,mgt-agenda .event{background:var(--event-background-color,#fff);border:var(--event-border,solid 2px transparent);box-shadow:var(--event-box-shadow,0 2px 8px var(--box-shadow-color,rgba(0,0,0,.092)));margin:var(--event-margin,0 10px 14px 10px);padding:var(--event-padding,0);display:flex;border-radius:8px}:host .narrow .event,mgt-agenda .narrow .event{flex-direction:column}:host .event-time-container,mgt-agenda .event-time-container{display:flex;flex-direction:column;margin:18px 38px 18px 18px;width:125px}:host .narrow .event-time-container,mgt-agenda .narrow .event-time-container{margin:14px 18px 8px 18px}:host .event-time,mgt-agenda .event-time{font-size:var(--event-time-font-size,12px);color:var(--event-time-color,var(--color,#000));font-weight:600}:host .event-duration,mgt-agenda .event-duration{color:rgba(16,16,16,.3)}:host .event-details-container,mgt-agenda .event-details-container{margin:14px 18px 14px 0}:host .narrow .event-details-container,mgt-agenda .narrow .event-details-container{margin:0 18px 14px 18px}:host .event-subject,mgt-agenda .event-subject{margin:0 18px 0 0;font-size:var(--event-subject-font-size,19px);color:var(--event-subject-color,var(--color-sub1,#323130))}:host .event-location-container,mgt-agenda .event-location-container{display:flex;margin:8px 18px 0 0}:host .event-location-icon svg,mgt-agenda .event-location-icon svg{height:12px}:host .event-location-icon svg path,mgt-agenda .event-location-icon svg path{stroke:var(--event-location-color,var(--color,#000))}:host .event-location,mgt-agenda .event-location{font-size:var(--event-location-font-size,12px);color:var(--event-location-color,var(--color,#000));margin:0 0 0 4px;line-height:17px}:host .event-attendees,mgt-agenda .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}:host .event-other-container,mgt-agenda .event-other-container{margin:2px 16px 4px 16px;margin-left:auto}:host .loading-element,mgt-agenda .loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .event-time-loading,mgt-agenda .event-time-loading{width:100px;height:10px}:host .event-subject-loading,mgt-agenda .event-subject-loading{width:263px;height:16px}:host .event-location-icon-loading,mgt-agenda .event-location-icon-loading{width:14px;height:14px}:host .event-location-loading,mgt-agenda .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .event-attendee-loading,mgt-agenda .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}[dir=rtl] .event-location{margin:0 4px 0 0}[dir=rtl] .event-time-container{direction:ltr;margin:18px 18px 18px 38px}[dir=rtl] .event-details-container{margin:14px 0 14px 18px}[dir=rtl] .event-details-container .event-subject{margin:0 0 0 18px}[dir=rtl] .event-details-container .event-location-container{margin:8px 0 0 18px}@media (forced-colors:active) and (prefers-color-scheme:dark){svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#000!important}}
`];var __awaiter$t=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const createAndInsertPart=(t,r)=>{const o=t.startNode.parentNode,i=void 0===r?t.endNode:r.startNode,s=o.insertBefore(createMarker(),i);o.insertBefore(createMarker(),i);const l=new NodePart(t.options);return l.insertAfterNode(s),l},updatePart=(t,r)=>(t.setValue(r),t.commit(),t),insertPartBefore=(t,r,o)=>{const i=t.startNode.parentNode,s=o?o.startNode:t.endNode,l=r.endNode.nextSibling;l!==s&&((t,r,o=null,i=null)=>{for(;r!==o;){const o=r.nextSibling;t.insertBefore(r,i),r=o}})(i,r.startNode,l,s)},removePart=t=>{removeNodes(t.startNode.parentNode,t.startNode,t.endNode.nextSibling)},generateMap=(t,r,o)=>{const i=new Map;for(let s=r;s<=o;s++)i.set(t[s],s);return i},CR=new WeakMap,_R=new WeakMap,kR=directive(((t,r,o)=>{let i;return void 0===o?o=r:void 0!==r&&(i=r),r=>{if(!(r instanceof NodePart))throw new Error("repeat can only be used in text bindings");const s=CR.get(r)||[],l=_R.get(r)||[],u=[],h=[],m=[];let v,C,_=0;for(const r of t)m[_]=i?i(r,_):_,h[_]=o(r,_),_++;let k=0,E=s.length-1,R=0,N=h.length-1;for(;k<=E&&R<=N;)if(null===s[k])k++;else if(null===s[E])E--;else if(l[k]===m[R])u[R]=updatePart(s[k],h[R]),k++,R++;else if(l[E]===m[N])u[N]=updatePart(s[E],h[N]),E--,N--;else if(l[k]===m[N])u[N]=updatePart(s[k],h[N]),insertPartBefore(r,s[k],u[N+1]),k++,N--;else if(l[E]===m[R])u[R]=updatePart(s[E],h[R]),insertPartBefore(r,s[E],s[k]),E--,R++;else if(void 0===v&&(v=generateMap(m,R,N),C=generateMap(l,k,E)),v.has(l[k]))if(v.has(l[E])){const t=C.get(m[R]),o=void 0!==t?s[t]:null;if(null===o){const t=createAndInsertPart(r,s[k]);updatePart(t,h[R]),u[R]=t}else u[R]=updatePart(o,h[R]),insertPartBefore(r,o,s[k]),s[t]=null;R++}else removePart(s[E]),E--;else removePart(s[k]),k++;for(;R<=N;){const t=createAndInsertPart(r,u[N+1]);updatePart(t,h[R]),u[R++]=t}for(;k<=E;){const t=s[k++];null!==t&&removePart(t)}CR.set(r,u),_R.set(r,m)}})),SR=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host .people-list,mgt-people .people-list{list-style-type:none;margin:var(--list-margin,8px 4px 8px 8px);padding:0;font-family:var(--default-font-family);color:var(--color,#000);font-style:normal;font-weight:400;display:flex;align-items:center}:host .people-person,mgt-people .people-person{margin:var(--avatar-margin,0 4px 0 0);display:flex}:host .overflow span,mgt-people .overflow span{vertical-align:middle}
`];var __decorate$s=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$p=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$s=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.MgtPeople=class MgtPeople extends MgtTemplatedComponent{static get styles(){return SR}get groupId(){return this._groupId}set groupId(t){this._groupId!==t&&(this._groupId=t,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(t){arraysAreEqual(this._userIds,t)||(this._userIds=t,this.requestStateUpdate(!0))}get peopleQueries(){return this._peopleQueries}set peopleQueries(t){arraysAreEqual(this._peopleQueries,t)||(this._peopleQueries=t,this.requestStateUpdate(!0))}get resource(){return this._resource}set resource(t){this._resource!==t&&(this._resource=t,this.requestStateUpdate(!0))}get version(){return this._version}set version(t){this._version!==t&&(this._version=t,this.requestStateUpdate(!0))}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(t){t!==this._fallbackDetails&&(this._fallbackDetails=t,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read",...exports.MgtPerson.requiredScopes])]}constructor(){super(),this.personCardInteraction=exports.PersonCardInteraction.hover,this.scopes=[],this._version="v1.0",this.showMax=3}clearState(){this.people=null}requestStateUpdate(t){return t&&(this.people=null),super.requestStateUpdate(t)}render(){return this.isLoadingState?this.renderLoading():this.people&&0!==this.people.length?this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople():this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||html$1``}renderPeople(){const t=this.people.slice(0,this.showMax).filter((t=>t));return html$1`
      <ul class="people-list" aria-label="people">
        ${kR(t,(t=>t.id?t.id:t.displayName),(t=>html$1`
            <li class="people-person">
              ${this.renderPerson(t)}
            </li>
          `))}
        ${this.people.length>this.showMax?this.renderOverflow():null}
      </ul>
    `}renderOverflow(){const t=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:t,max:this.showMax,people:this.people})||html$1`
        <li aria-label="and ${t} more attendees" class="overflow"><span>+${t}<span></li>
      `}renderPerson(t){let r={activity:"Offline",availability:"Offline",id:null};this.showPresence&&this._peoplePresence&&(r=this._peoplePresence[t.id]);return this.renderTemplate("person",{person:t},t.id)||html$1`
        <mgt-person
          .personDetails=${t}
          .fetchImage=${!0}
          .avatarSize=${"small"}
          .personCardInteraction=${this.personCardInteraction}
          .showPresence=${this.showPresence}
          .personPresence=${r}
        ></mgt-person>
      `}renderNoData(){return this.renderTemplate("no-data",null)||html$1``}loadState(){return __awaiter$s(this,void 0,void 0,(function*(){if(!this.people){const t=Providers.globalProvider;if(t&&t.state===exports.ProviderState.SignedIn){const r=t.graph.forComponent(this);this.groupId?this.people=yield findGroupMembers(r,null,this.groupId,this.showMax,exports.PersonType.person):this.userIds||this.peopleQueries?(this.userIds?this.people=yield getUsersForUserIds(r,this.userIds):this.people=yield function getUsersForPeopleQueries(t,r){return __awaiter$y(this,void 0,void 0,(function*(){if(!r||0===r.length)return[];const o=t.createBatch(),i=[];let s,l;getIsUsersCacheEnabled()&&(l=CacheService.getCache(sR.users,sR.users.stores.usersQuery));for(const t of r)getIsUsersCacheEnabled()&&(s=yield l.getValue(t)),getIsUsersCacheEnabled()&&s&&getUserInvalidationTime()>Date.now()-s.timeCached?i.push(JSON.parse(s.results[0])):""!==t&&o.get(t,`/me/people?$search="${t}"`,["people.read"],{"X-PeopleQuery-QuerySources":"Mailbox,Directory"});try{const t=yield o.executeAll();for(const o of r){const r=t.get(o);r&&r.content&&r.content.value&&r.content.value.length>0?(i.push(r.content.value[0]),getIsUsersCacheEnabled()&&l.putValue(o,{maxResults:1,results:[JSON.stringify(r.content.value[0])]})):i.push(null)}return i}catch(o){try{return Promise.all(r.filter((t=>t&&""!==t)).map((r=>__awaiter$y(this,void 0,void 0,(function*(){const o=yield findPeople(t,r,1);if(o&&o.length)return getIsUsersCacheEnabled()&&l.putValue(r,{maxResults:1,results:[JSON.stringify(o[0])]}),o[0]})))))}catch(t){return[]}}}))}(r,this.peopleQueries),this._fallbackDetails?this.people=this.people.map(((t,r)=>t||(r<this._fallbackDetails.length?this._fallbackDetails[r]:null))):this.people=this.people.filter((t=>null!==t))):this.resource?this.people=yield function getPeopleFromResource(t,r,o,i){return __awaiter$z(this,void 0,void 0,(function*(){let s;const l=`${r}${o}`;if(getIsPeopleCacheEnabled()){s=CacheService.getCache(sR.people,sR.people.stores.peopleQuery);const t=yield s.getValue(l);if(t&&getPeopleInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let u=t.api(o).version(r);i&&i.length&&(u=u.middlewareOptions(prepScopes(...i)));let h=yield u.get();if(h&&Array.isArray(h.value)&&h["@odata.nextLink"]){let o=h;for(;o&&o["@odata.nextLink"];){const i=o["@odata.nextLink"].split(r)[1];o=yield t.client.api(i).version(r).get(),o&&o.value&&o.value.length&&(o.value=h.value.concat(o.value),h=o)}}if(getIsPeopleCacheEnabled()&&h){const t={results:null};Array.isArray(h.value)?t.results=h.value.map((t=>JSON.stringify(t))):t.results=[JSON.stringify(h)],s.putValue(l,t)}return h?Array.isArray(h.value)?h.value:[h]:null}))}(r,this.version,this.resource,this.scopes):this.people=yield getPeople(r),this.showPresence?this._peoplePresence=yield function getUsersPresenceByPeople(t,r){return __awaiter$w(this,void 0,void 0,(function*(){if(!r||0===r.length)return{};const o={},i=[],s=["presence.read.all"];let l;getIsPresenceCacheEnabled()&&(l=CacheService.getCache(sR.presence,sR.presence.stores.presence));for(const t of r)if(null==t?void 0:t.id){const r=t.id;let s;o[r]=null,getIsPresenceCacheEnabled()&&(s=yield l.getValue(r)),getIsPresenceCacheEnabled()&&s&&getPresenceInvalidationTime()>Date.now()-(yield s).timeCached?o[r]=JSON.parse(s.presence):i.push(r)}try{if(i.length>0){const r=yield t.api("/communications/getPresencesByUserId").middlewareOptions(prepScopes(...s)).post({ids:i});for(const t of r.value)o[t.id]=t,getIsPresenceCacheEnabled()&&l.putValue(t.id,{presence:JSON.stringify(t)})}return o}catch(i){try{const i=yield Promise.all(r.filter((t=>t&&t.id&&!o[t.id]&&"personType"in t&&"OrganizationUser"===t.personType.subclass)).map((r=>getUserPresence(t,r.id))));for(const t of i)o[t.id]=t;return o}catch(t){return null}}}))}(r,this.people):this._peoplePresence=null}}}))}},__decorate$s([property({attribute:"group-id",type:String}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[Object])],exports.MgtPeople.prototype,"groupId",null),__decorate$s([property({attribute:"user-ids",converter:(t,r)=>t.split(",").map((t=>t.trim()))}),__metadata$p("design:type",Array),__metadata$p("design:paramtypes",[Array])],exports.MgtPeople.prototype,"userIds",null),__decorate$s([property({attribute:"people",type:Object}),__metadata$p("design:type",Array)],exports.MgtPeople.prototype,"people",void 0),__decorate$s([property({attribute:"people-queries",converter:(t,r)=>t.split(",").map((t=>t.trim()))}),__metadata$p("design:type",Array),__metadata$p("design:paramtypes",[Array])],exports.MgtPeople.prototype,"peopleQueries",null),__decorate$s([property({attribute:"show-max",type:Number}),__metadata$p("design:type",Number)],exports.MgtPeople.prototype,"showMax",void 0),__decorate$s([property({attribute:"show-presence",type:Boolean}),__metadata$p("design:type",Boolean)],exports.MgtPeople.prototype,"showPresence",void 0),__decorate$s([property({attribute:"person-card",converter:(t,r)=>(t=t.toLowerCase(),void 0===exports.PersonCardInteraction[t]?exports.PersonCardInteraction.hover:exports.PersonCardInteraction[t])}),__metadata$p("design:type",Number)],exports.MgtPeople.prototype,"personCardInteraction",void 0),__decorate$s([property({attribute:"resource",type:String}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[Object])],exports.MgtPeople.prototype,"resource",null),__decorate$s([property({attribute:"version",type:String}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[Object])],exports.MgtPeople.prototype,"version",null),__decorate$s([property({attribute:"scopes",converter:t=>t?t.toLowerCase().split(","):null,reflect:!0}),__metadata$p("design:type",Array)],exports.MgtPeople.prototype,"scopes",void 0),__decorate$s([property({attribute:"fallback-details",type:Array}),__metadata$p("design:type",Array),__metadata$p("design:paramtypes",[Array])],exports.MgtPeople.prototype,"fallbackDetails",null),exports.MgtPeople=__decorate$s([customElement$1("mgt-people"),__metadata$p("design:paramtypes",[])],exports.MgtPeople);var __decorate$r=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$o=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$r=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.MgtAgenda=class MgtAgenda extends MgtTemplatedComponent{static get styles(){return wR}get date(){return this._date}set date(t){this._date!==t&&(this._date=t,this.reloadState())}get groupId(){return this._groupId}set groupId(t){this._groupId!==t&&(this._groupId=t,this.reloadState())}get days(){return this._days}set days(t){this._days!==t&&(this._days=t,this.reloadState())}get eventQuery(){return this._eventQuery}set eventQuery(t){this._eventQuery!==t&&(this._eventQuery=t,this.reloadState())}get preferredTimezone(){return this._preferredTimezone}set preferredTimezone(t){this._preferredTimezone!==t&&(this._preferredTimezone=t,this.reloadState())}static get requiredScopes(){return[...new Set(["calendars.read",...exports.MgtPeople.requiredScopes])]}constructor(){super(),this._days=3,this.onResize=this.onResize.bind(this)}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){if(!this.events&&this.isLoadingState)return this.renderLoading();if(!this.events||0===this.events.length)return this.renderNoData();const t=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,r=this.renderTemplate("default",{events:t});return r||(this._isNarrow=this.offsetWidth<600,html$1`
      <div dir=${this.direction} class="agenda${this._isNarrow?" narrow":""}${this.groupByDay?" grouped":""}">
        ${this.groupByDay?this.renderGroups(t):this.renderEvents(t)}
        ${this.isLoadingState?this.renderLoading():html$1``}
      </div>
    `)}reload(){return __awaiter$r(this,void 0,void 0,(function*(){this.events=yield this.loadEvents()}))}renderLoading(){return this.renderTemplate("loading",null)||html$1`
        <div class="event">
          <div class="event-time-container">
            <div class="event-time-loading loading-element"></div>
          </div>
          <div class="event-details-container">
            <div class="event-subject-loading loading-element"></div>
            <div class="event-location-container">
              <div class="event-location-icon-loading loading-element"></div>
              <div class="event-location-loading loading-element"></div>
            </div>
            <div class="event-location-container">
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
            </div>
          </div>
        </div>
      `}clearState(){this.events=null}renderNoData(){return this.renderTemplate("no-data",null)||html$1``}renderEvent(t){return html$1`
      <div class="event">
        <div class="event-time-container">
          <div class="event-time" aria-label="${this.getEventTimeString(t)}">${this.getEventTimeString(t)}</div>
        </div>
        <div class="event-details-container">
          ${this.renderTitle(t)} ${this.renderLocation(t)} ${this.renderAttendees(t)}
        </div>
        <div class="event-other-container">${this.renderOther(t)}</div>
      </div>
    `}renderHeader(t){return this.renderTemplate("header",{header:t},"header-"+t)||html$1`
        <div class="header" aria-label="${t}">${t}</div>
      `}renderTitle(t){return html$1`
      <div aria-label=${t.subject} class="event-subject">${t.subject}</div>
    `}renderLocation(t){return t.location.displayName?html$1`
      <div class="event-location-container">
        <div class="event-location-icon">${getSvg(dR.OfficeLocation)}</div>
        <div class="event-location" aria-label="${t.location.displayName}">${t.location.displayName}</div>
      </div>
    `:null}renderAttendees(t){return t.attendees.length?html$1`
      <mgt-people
        class="event-attendees"
        .peopleQueries=${t.attendees.map((t=>t.emailAddress.address))}
      ></mgt-people>
    `:null}renderOther(t){return this.hasTemplate("event-other")?html$1`
          ${this.renderTemplate("event-other",{event:t},t.id+"-other")}
        `:null}renderGroups(t){const r={};return t.forEach((t=>{var o;let i=null===(o=null==t?void 0:t.start)||void 0===o?void 0:o.dateTime;"UTC"===t.end.timeZone&&(i+="Z");const s=this.getDateHeaderFromDateTimeString(i);r[s]=r[s]||[],r[s].push(t)})),html$1`
      ${Object.keys(r).map((t=>html$1`
            <div class="group">${this.renderHeader(t)} ${this.renderEvents(r[t])}</div>
          `))}
    `}renderEvents(t){return html$1`
      <ul class="agenda-list">
        ${t.map((t=>html$1`
              <li @click=${()=>this.eventClicked(t)}>
                ${this.renderTemplate("event",{event:t},t.id)||this.renderEvent(t)}
              </li>
            `))}
      </ul>
    `}loadState(){return __awaiter$r(this,void 0,void 0,(function*(){if(this.events)return;const t=yield this.loadEvents();t&&t.length>0&&(this.events=t)}))}reloadState(){return __awaiter$r(this,void 0,void 0,(function*(){this.events=null,this.requestStateUpdate(!0)}))}onResize(){this._isNarrow=this.offsetWidth<600}eventClicked(t){this.fireCustomEvent("eventClick",{event:t})}getEventTimeString(t){if(t.isAllDay)return"ALL DAY";let r=t.start.dateTime;"UTC"===t.start.timeZone&&(r+="Z");let o=t.end.dateTime;"UTC"===t.end.timeZone&&(o+="Z");return`${this.prettyPrintTimeFromDateTime(new Date(r))} - ${this.prettyPrintTimeFromDateTime(new Date(o))}`}loadEvents(){return __awaiter$r(this,void 0,void 0,(function*(){const t=Providers.globalProvider;let r=[];if(t&&t.state===exports.ProviderState.SignedIn){const o=t.graph.forComponent(this);if(this.eventQuery)try{const t=this.eventQuery.split("|");let i,s;t.length>1?(s=t[0].trim(),i=t[1].trim()):s=this.eventQuery;let l=o.api(s);i&&(l=l.middlewareOptions(prepScopes(i)));const u=yield l.get();u&&u.value&&(r=u.value)}catch(t){}else{const t=this.date?new Date(this.date):new Date,i=new Date(t.getTime());i.setDate(t.getDate()+this.days);try{const s=yield function getEventsPageIterator(t,r,o,i){return __awaiter$t(this,void 0,void 0,(function*(){const s=`startdatetime=${r.toISOString()}`,l=`enddatetime=${o.toISOString()}`;let u;u=i?`groups/${i}/calendar`:"me",u+=`/calendarview?${s}&${l}`;let h=t.api(u).middlewareOptions(prepScopes("calendars.read")).orderby("start/dateTime");return GraphPageIterator.create(t,h)}))}(o,t,i,this.groupId);if(s&&s.value)for(r=s.value;s.hasNext;)yield s.next(),r=s.value}catch(t){}}}return r}))}prettyPrintTimeFromDateTime(t){return t.toLocaleTimeString(navigator.language,{timeStyle:"short",timeZone:this.preferredTimezone})}getDateHeaderFromDateTimeString(t){return new Date(t).toLocaleDateString(navigator.language,{dateStyle:"full",timeZone:this.preferredTimezone})}},__decorate$r([property({attribute:"date",type:String}),__metadata$o("design:type",String),__metadata$o("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"date",null),__decorate$r([property({attribute:"group-id",type:String}),__metadata$o("design:type",String),__metadata$o("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"groupId",null),__decorate$r([property({attribute:"days",type:Number}),__metadata$o("design:type",Number),__metadata$o("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"days",null),__decorate$r([property({attribute:"event-query",type:String}),__metadata$o("design:type",String),__metadata$o("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"eventQuery",null),__decorate$r([property({attribute:"events",type:Array}),__metadata$o("design:type",Array)],exports.MgtAgenda.prototype,"events",void 0),__decorate$r([property({attribute:"show-max",type:Number}),__metadata$o("design:type",Number)],exports.MgtAgenda.prototype,"showMax",void 0),__decorate$r([property({attribute:"group-by-day",type:Boolean}),__metadata$o("design:type",Boolean)],exports.MgtAgenda.prototype,"groupByDay",void 0),__decorate$r([property({attribute:"preferred-timezone",type:String}),__metadata$o("design:type",String),__metadata$o("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"preferredTimezone",null),__decorate$r([property({attribute:!1}),__metadata$o("design:type",Boolean)],exports.MgtAgenda.prototype,"_isNarrow",void 0),exports.MgtAgenda=__decorate$r([customElement$1("mgt-agenda"),__metadata$o("design:paramtypes",[])],exports.MgtAgenda);const TR=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{background-color:#fff}.mgt-dark{background-color:#424242}:host{font-family:var(--font-family,var(--default-font-family))}:host .item,mgt-file .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(background-color,#fff)}:host .item__file-type-icon,mgt-file .item__file-type-icon{padding:16px;width:var(--file-type-icon-size,28px);min-width:var(--file-type-icon-size,28px);height:var(--file-type-icon-size,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img,mgt-file .item__file-type-icon img{height:var(--file-type-icon-size,28px);width:var(--file-type-icon-size,28px)}:host .item__details,mgt-file .item__details{padding:10px 0}:host .item__details .line1,mgt-file .item__details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,400);text-transform:var(text-transform,none);line-height:20px;color:var(--color-sub1,#323130)}:host .item__details .line2,mgt-file .item__details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none));line-height:16px}:host .item__details .line3,mgt-file .item__details .line3{color:var(--line3-color,var(--color-sub1,#323130));font-size:var(--line3-font-size,var(--size-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none));line-height:16px}[dir=rtl] .item__details{direction:ltr}
`];var __awaiter$q=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};function clearFilesCache(){let t;t=CacheService.getCache(sR.fileLists,sR.fileLists.stores.fileLists),t.clearStore()}const getFileInvalidationTime=()=>CacheService.config.files.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsFilesCacheEnabled=()=>CacheService.config.files.isEnabled&&CacheService.config.isEnabled,getFileListInvalidationTime=()=>CacheService.config.fileLists.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsFileListsCacheEnabled=()=>CacheService.config.fileLists.isEnabled&&CacheService.config.isEnabled;function getDriveItemByQuery(t,r){return __awaiter$q(this,void 0,void 0,(function*(){let o;o=CacheService.getCache(sR.files,sR.files.stores.fileQueries);const i=yield getFileFromCache(o,r);if(i)return i;let s;try{s=yield t.api(r).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&o.putValue(r,{file:JSON.stringify(s)})}catch(t){}return s||null}))}function getDriveItemsByInsights(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){if(!r)return[];const i=r.value,s=t.createBatch(),l=[];for(const t of i){const r=t.resourceReference.id;""!==r&&s.get(r,r,o)}try{const t=yield s.executeAll();for(const r of i){const o=t.get(r.resourceReference.id);o&&o.content&&l.push(o.content)}return l}catch(r){try{return Promise.all(i.filter((t=>t.resourceReference.id&&""!==t.resourceReference.id)).map((r=>__awaiter$q(this,void 0,void 0,(function*(){const i=yield t.api(r.resourceReference.id).middlewareOptions(prepScopes(...o)).get();if(i&&i.length)return i[0].content})))))}catch(t){return[]}}}))}function getFilesPageIteratorFromRequest(t,r){return __awaiter$q(this,void 0,void 0,(function*(){return GraphPageIterator.create(t,r)}))}function getFilesPageIteratorFromCache(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){return GraphPageIterator.createFromValue(t,r,o)}))}function getFileFromCache(t,r){return __awaiter$q(this,void 0,void 0,(function*(){if(getIsFilesCacheEnabled()){const o=yield t.getValue(r);if(o&&getFileInvalidationTime()>Date.now()-o.timeCached){return JSON.parse(o.file)}}return null}))}function getFileListFromCache(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){if(t||(t=CacheService.getCache(sR.fileLists,r)),getIsFileListsCacheEnabled()){const r=yield t.getValue(o);if(r&&getFileListInvalidationTime()>Date.now()-r.timeCached)return r}return null}))}function fetchNextAndCacheForFilesPageIterator(t){return __awaiter$q(this,void 0,void 0,(function*(){const r=t._nextLink;if(t.hasNext&&(yield t.next()),getIsFileListsCacheEnabled()){let o;o=CacheService.getCache(sR.fileLists,sR.fileLists.stores.fileLists);const i=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(r)[3];o.putValue(i,{files:t.value,nextLink:t._nextLink})}}))}function sendFileChunck(t,r,o,i,s){return __awaiter$q(this,void 0,void 0,(function*(){try{const l="files.readwrite",u={"Content-Length":o,"Content-Range":i};let h;try{h=yield t.client.api(r).middlewareOptions(prepScopes(l)).headers(u).put(s)}catch(t){}return h||null}catch(t){return null}}))}const ER={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},xR="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types";const IR={modifiedSubtitle:"Modified",sizeSubtitle:"Size"};var __decorate$q=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$n=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$p=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.MgtFile=class MgtFile extends MgtTemplatedComponent{static get styles(){return TR}get strings(){return IR}get fileQuery(){return this._fileQuery}set fileQuery(t){t!==this._fileQuery&&(this._fileQuery=t,this.requestStateUpdate())}get siteId(){return this._siteId}set siteId(t){t!==this._siteId&&(this._siteId=t,this.requestStateUpdate())}get driveId(){return this._driveId}set driveId(t){t!==this._driveId&&(this._driveId=t,this.requestStateUpdate())}get groupId(){return this._groupId}set groupId(t){t!==this._groupId&&(this._groupId=t,this.requestStateUpdate())}get listId(){return this._listId}set listId(t){t!==this._listId&&(this._listId=t,this.requestStateUpdate())}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.requestStateUpdate())}get itemId(){return this._itemId}set itemId(t){t!==this._itemId&&(this._itemId=t,this.requestStateUpdate())}get itemPath(){return this._itemPath}set itemPath(t){t!==this._itemPath&&(this._itemPath=t,this.requestStateUpdate())}get insightType(){return this._insightType}set insightType(t){t!==this._insightType&&(this._insightType=t,this.requestStateUpdate())}get insightId(){return this._insightId}set insightId(t){t!==this._insightId&&(this._insightId=t,this.requestStateUpdate())}get fileDetails(){return this._fileDetails}set fileDetails(t){t!==this._fileDetails&&(this._fileDetails=t,this.requestStateUpdate())}get fileIcon(){return this._fileIcon}set fileIcon(t){t!==this._fileIcon&&(this._fileIcon=t,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["files.read","files.read.all","sites.read.all"])]}constructor(){super(),this.line1Property="name",this.line2Property="lastModifiedDateTime",this.line3Property="size",this.view=exports.ViewType.threelines}render(){if(!this.driveItem&&this.isLoadingState)return this.renderLoading();if(!this.driveItem)return this.renderNoData();const t=this.driveItem;let r;if(r=this.renderTemplate("default",{file:t}),!r){const o=this.renderDetails(t),i=this.renderFileTypeIcon();r=html$1`
        <div class="item">
          ${i} ${o}
        </div>
      `}return html$1`
      <span dir=${this.direction}>
        ${r}
      </span>
    `}renderLoading(){return this.renderTemplate("loading",null)||html$1``}renderNoData(){return this.renderTemplate("no-data",null)||html$1``}renderFileTypeIcon(){if(!this.fileIcon&&!this.driveItem.name)return html$1``;let t;if(this.fileIcon)t=this.fileIcon;else{const r=/(?:\.([^.]+))?$/;t=function getFileTypeIconUriByExtension(t,r,o){const i=Object.keys(ER).find((r=>ER[r]===t));return i?`${xR}/${r.toString()}/${t}.${o}`:"jpg"===t||"png"===t?(t="photo",`${xR}/${r.toString()}/${t}.${o}`):null}(void 0===this.driveItem.package&&void 0===this.driveItem.folder?r.exec(this.driveItem.name)[1]?r.exec(this.driveItem.name)[1].toLowerCase():"null":void 0!==this.driveItem.package&&"oneNote"===this.driveItem.package.type?"onetoc":"folder",48,"svg")}return html$1`
      <div class="item__file-type-icon">
        ${t?html$1`
              <img src=${t} alt="File icon" />
            `:html$1`
              ${getSvg(dR.File)}
            `}
      </div>
    `}renderDetails(t){if(!t||this.view===exports.ViewType.image)return html$1``;const r=[];if(this.view>exports.ViewType.image){const o=this.getTextFromProperty(t,this.line1Property);o&&r.push(html$1`
          <div class="line1" aria-label="${o}">${o}</div>
        `)}if(this.view>exports.ViewType.oneline){const o=this.getTextFromProperty(t,this.line2Property);o&&r.push(html$1`
          <div class="line2" aria-label="${o}">${o}</div>
        `)}if(this.view>exports.ViewType.twolines){const o=this.getTextFromProperty(t,this.line3Property);o&&r.push(html$1`
          <div class="line3" aria-label="${o}">${o}</div>
        `)}return html$1`
      <div class="item__details">
        ${r}
      </div>
    `}loadState(){return __awaiter$p(this,void 0,void 0,(function*(){if(this.fileDetails)return void(this.driveItem=this.fileDetails);const t=Providers.globalProvider;if(!t||t.state===exports.ProviderState.Loading)return;if(t.state===exports.ProviderState.SignedOut)return void(this.driveItem=null);const r=t.graph.forComponent(this);let o;const i=!(this.driveId||this.siteId||this.groupId||this.listId||this.userId);this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId||this.userId&&!this.itemId&&!this.itemPath&&!this.insightType&&!this.insightId?o=null:this.fileQuery?o=yield getDriveItemByQuery(r,this.fileQuery):this.itemId&&i?o=yield function getMyDriveItemById(t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/me/drive/items/${r}`;let i;i=CacheService.getCache(sR.files,sR.files.stores.userFiles);const s=yield getFileFromCache(i,o);if(s)return s;let l;try{l=yield t.api(o).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&i.putValue(o,{file:JSON.stringify(l)})}catch(t){}return l||null}))}(r,this.itemId):this.itemPath&&i?o=yield function getMyDriveItemByPath(t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/me/drive/root:/${r}`;let i;i=CacheService.getCache(sR.files,sR.files.stores.userFiles);const s=yield getFileFromCache(i,o);if(s)return s;let l;try{l=yield t.api(o).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&i.putValue(o,{file:JSON.stringify(l)})}catch(t){}return l||null}))}(r,this.itemPath):this.userId?this.itemId?o=yield function getUserDriveItemById(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/users/${r}/drive/items/${o}`;let s;s=CacheService.getCache(sR.files,sR.files.stores.userFiles);const l=yield getFileFromCache(s,i);if(l)return l;let u;try{u=yield t.api(i).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&s.putValue(i,{file:JSON.stringify(u)})}catch(t){}return u||null}))}(r,this.userId,this.itemId):this.itemPath?o=yield function getUserDriveItemByPath(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/users/${r}/drive/root:/${o}`;let s;s=CacheService.getCache(sR.files,sR.files.stores.userFiles);const l=yield getFileFromCache(s,i);if(l)return l;let u;try{u=yield t.api(i).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&s.putValue(i,{file:JSON.stringify(u)})}catch(t){}return u||null}))}(r,this.userId,this.itemPath):this.insightType&&this.insightId&&(o=yield function getUserInsightsDriveItemById(t,r,o,i){return __awaiter$q(this,void 0,void 0,(function*(){const s=`/users/${r}/insights/${o}/${i}/resource`;let l;l=CacheService.getCache(sR.files,sR.files.stores.insightFiles);const u=yield getFileFromCache(l,s);if(u)return u;let h;try{h=yield t.api(s).middlewareOptions(prepScopes("sites.read.all")).get(),getIsFilesCacheEnabled()&&l.putValue(s,{file:JSON.stringify(h)})}catch(t){}return h||null}))}(r,this.userId,this.insightType,this.insightId)):this.driveId?this.itemId?o=yield function getDriveItemById(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/drives/${r}/items/${o}`;let s;s=CacheService.getCache(sR.files,sR.files.stores.driveFiles);const l=yield getFileFromCache(s,i);if(l)return l;let u;try{u=yield t.api(i).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&s.putValue(i,{file:JSON.stringify(u)})}catch(t){}return u||null}))}(r,this.driveId,this.itemId):this.itemPath&&(o=yield function getDriveItemByPath(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/drives/${r}/root:/${o}`;let s;s=CacheService.getCache(sR.files,sR.files.stores.driveFiles);const l=yield getFileFromCache(s,i);if(l)return l;let u;try{u=yield t.api(i).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&s.putValue(i,{file:JSON.stringify(u)})}catch(t){}return u||null}))}(r,this.driveId,this.itemPath)):this.siteId&&!this.listId?this.itemId?o=yield function getSiteDriveItemById(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/sites/${r}/drive/items/${o}`;let s;s=CacheService.getCache(sR.files,sR.files.stores.siteFiles);const l=yield getFileFromCache(s,i);if(l)return l;let u;try{u=yield t.api(i).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&s.putValue(i,{file:JSON.stringify(u)})}catch(t){}return u||null}))}(r,this.siteId,this.itemId):this.itemPath&&(o=yield function getSiteDriveItemByPath(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/sites/${r}/drive/root:/${o}`;let s;s=CacheService.getCache(sR.files,sR.files.stores.siteFiles);const l=yield getFileFromCache(s,i);if(l)return l;let u;try{u=yield t.api(i).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&s.putValue(i,{file:JSON.stringify(u)})}catch(t){}return u||null}))}(r,this.siteId,this.itemPath)):this.listId?o=yield function getListDriveItemById(t,r,o,i){return __awaiter$q(this,void 0,void 0,(function*(){const s=`/sites/${r}/lists/${o}/items/${i}/driveItem`;let l;l=CacheService.getCache(sR.files,sR.files.stores.siteFiles);const u=yield getFileFromCache(l,s);if(u)return u;let h;try{h=yield t.api(s).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&l.putValue(s,{file:JSON.stringify(h)})}catch(t){}return h||null}))}(r,this.siteId,this.listId,this.itemId):this.groupId?this.itemId?o=yield function getGroupDriveItemById(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/groups/${r}/drive/items/${o}`;let s;s=CacheService.getCache(sR.files,sR.files.stores.groupFiles);const l=yield getFileFromCache(s,i);if(l)return l;let u;try{u=yield t.api(i).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&s.putValue(i,{file:JSON.stringify(u)})}catch(t){}return u||null}))}(r,this.groupId,this.itemId):this.itemPath&&(o=yield function getGroupDriveItemByPath(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/groups/${r}/drive/root:/${o}`;let s;s=CacheService.getCache(sR.files,sR.files.stores.groupFiles);const l=yield getFileFromCache(s,i);if(l)return l;let u;try{u=yield t.api(i).middlewareOptions(prepScopes("files.read")).get(),getIsFilesCacheEnabled()&&s.putValue(i,{file:JSON.stringify(u)})}catch(t){}return u||null}))}(r,this.groupId,this.itemPath)):this.insightType&&!this.userId&&(o=yield function getMyInsightsDriveItemById(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/me/insights/${r}/${o}/resource`;let s;s=CacheService.getCache(sR.files,sR.files.stores.insightFiles);const l=yield getFileFromCache(s,i);if(l)return l;let u;try{u=yield t.api(i).middlewareOptions(prepScopes("sites.read.all")).get(),getIsFilesCacheEnabled()&&s.putValue(i,{file:JSON.stringify(u)})}catch(t){}return u||null}))}(r,this.insightType,this.insightId)),this.driveItem=o}))}getTextFromProperty(t,r){if(!r||0===r.length)return null;const o=r.trim().split(",");let i,s=0;for(;!i&&s<o.length;){const r=o[s].trim();switch(r){case"size":let o;o=t.size?this.formatBytes(t.size):"0",i=`${this.strings.sizeSubtitle}: ${o}`;break;case"lastModifiedDateTime":let s,l;if(t.lastModifiedDateTime){s=getRelativeDisplayDate(new Date(t.lastModifiedDateTime)),l=`${this.strings.modifiedSubtitle} ${s}`}else l="";i=l;break;default:i=t[r]}s++}return i}formatBytes(t,r=2){if(0===t)return"0 Bytes";const o=r<0?0:r,i=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,i)).toFixed(o))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][i]}},__decorate$q([property({attribute:"file-query"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFile.prototype,"fileQuery",null),__decorate$q([property({attribute:"site-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFile.prototype,"siteId",null),__decorate$q([property({attribute:"drive-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFile.prototype,"driveId",null),__decorate$q([property({attribute:"group-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFile.prototype,"groupId",null),__decorate$q([property({attribute:"list-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFile.prototype,"listId",null),__decorate$q([property({attribute:"user-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFile.prototype,"userId",null),__decorate$q([property({attribute:"item-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFile.prototype,"itemId",null),__decorate$q([property({attribute:"item-path"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFile.prototype,"itemPath",null),__decorate$q([property({attribute:"insight-type"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFile.prototype,"insightType",null),__decorate$q([property({attribute:"insight-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFile.prototype,"insightId",null),__decorate$q([property({type:Object}),__metadata$n("design:type",Object),__metadata$n("design:paramtypes",[Object])],exports.MgtFile.prototype,"fileDetails",null),__decorate$q([property({attribute:"file-icon"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFile.prototype,"fileIcon",null),__decorate$q([property({type:Object}),__metadata$n("design:type",Object)],exports.MgtFile.prototype,"driveItem",void 0),__decorate$q([property({attribute:"line1-property"}),__metadata$n("design:type",String)],exports.MgtFile.prototype,"line1Property",void 0),__decorate$q([property({attribute:"line2-property"}),__metadata$n("design:type",String)],exports.MgtFile.prototype,"line2Property",void 0),__decorate$q([property({attribute:"line3-property"}),__metadata$n("design:type",String)],exports.MgtFile.prototype,"line3Property",void 0),__decorate$q([property({attribute:"view",converter:t=>t&&0!==t.length?(t=t.toLowerCase(),void 0===exports.ViewType[t]?exports.ViewType.threelines:exports.ViewType[t]):exports.ViewType.threelines}),__metadata$n("design:type",Number)],exports.MgtFile.prototype,"view",void 0),exports.MgtFile=__decorate$q([customElement$1("mgt-file"),__metadata$n("design:paramtypes",[])],exports.MgtFile);const AR=[css$1`
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#4a4a4a;--file-upload-dialog-content-color:white;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}:host .file-upload-area-button{width:100%}:host .file-upload-area-button div{float:var(--file-upload-button-float,right);text-align:center;display:table;margin-top:39px;margin-right:16px;margin-left:16px}:host .file-upload-area-button fluent-button.file-upload-button{color:var(--file-upload-button-color,inherit);vertical-align:middle;display:table-cell;background-color:var(--file-upload-button-background-color,#f3f2f1);width:120px;height:32px;cursor:pointer;font-size:var(--default-font-size);font-family:var(--default-font-family);position:relative}:host .file-upload-area-button fluent-button.file-upload-button:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1))}:host .file-upload-area-button input{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}:host .file-upload-table{margin:var(--file-item-margin,0)}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;width:50%;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;top:12px;left:16px}:host .file-upload-table .file-upload-cell fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-left:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-button-color,var(--color,inherit))}:host .file-upload-table.upload{display:table;width:260px}:host .mgt-file-item{--file-background-color:transparent}:host .upload-icon{fill:var(--file-upload-button-color,var(--color,inherit));height:12px}:host .file-upload-Template{clear:both}:host .file-upload-Template .file-upload-folder-tab{padding-left:20px}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border,dashed #0078d4 1px);background-color:var(--file-upload-background-color,rgba(0,120,212,.1));position:absolute;top:0;bottom:0;left:0;right:0;z-index:1;display:inline-block}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-content-background-color,#fff);margin:auto;padding:24px;width:294px;height:auto;margin-top:165px;font-size:var(--default-font-size);font-family:var(--default-font-family);box-shadow:var(--file-list-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));line-height:20px}:host .file-upload-dialog .file-upload-dialog-content div{color:var(--file-upload-dialog-content-color,#323130)}:host .file-upload-dialog .file-upload-dialog-check-wrapper{margin-top:12px}:host .file-upload-dialog fluent-checkbox.file-upload-dialog-check{--neutral-fill-input-rest:$file-upload-dialog-content-color}:host .file-upload-dialog fluent-checkbox.file-upload-dialog-check span{color:var(--file-upload-dialog-content-color,#323130)}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{text-align:right}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-button-color,var(--color,inherit));padding-right:5px}:host .file-upload-dialog .file-upload-dialog-ok{height:32px;min-width:60px;border:1px solid var(--file-upload-dialog-primarybutton-background-color,#006cbe);background-color:var(--file-upload-dialog-primarybutton-background-color,#006cbe);color:var(--file-upload-dialog-primarybutton-color,#fff);font-size:var(--default-font-size);margin-right:5px}:host .file-upload-dialog .file-upload-dialog-cancel{height:32px;min-width:82px;border:1px solid #8a8886;background-color:var(--file-upload-dialog-content-background-color,#fff);color:var(--file-upload-dialog-content-color,#323130);font-size:var(--default-font-size)}:host .file-upload-dialog.visible{position:absolute;z-index:1;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:var(--file-upload-dialog-background-color,rgba(0,0,0,.1));display:inline-block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{border-top:var(--file-item-border-top,none);border-left:var(--file-item-border-left,none);border-right:var(--file-item-border-right,none);border-bottom:var(--file-item-border-bottom,none);border-radius:var(--file-item-border-radius,2px);cursor:pointer}:host .file-upload-dialog-success.focused,:host .file-upload-dialog-success:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1))}:host .file-upload-dialog-success.focused mgt-file,:host .file-upload-dialog-success:hover mgt-file{--file-background-color:$file-item-background-color--hover}:host .file-upload-dialog-success.selected,:host .file-upload-dialog-success:active{background-color:var(--file-item-background-color--active,rgba(0,0,0,.05))}:host .file-upload-dialog-success.selected mgt-file,:host .file-upload-dialog-success:active mgt-file{--file-background-color:$file-item-background-color--active}
`],PR={failUploadFile:"File upload fail.",cancelUploadFile:"File cancel.",buttonUploadFile:"Upload Files",maximumFilesTitle:"Maximum files",maximumFiles:"Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?",maximumFileSizeTitle:"Maximum files size",maximumFileSize:'Sorry, the maximum file size to upload is {FileSize}. The file "{FileName}" has ',fileTypeTitle:"File type",fileType:'Sorry, the format of following file "{FileName}" cannot be uploaded.',checkAgain:"Don't show again",checkApplyAll:"Apply to all",buttonOk:"OK",buttonCancel:"Cancel",buttonUpload:"Upload",buttonKeep:"Keep",buttonReplace:"Replace",buttonReselect:"Reselect",fileReplaceTitle:"Replace file",fileReplace:'Do you want to replace the file "{FileName}" or keep file with new name?'};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function __decorate$p(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u}const RR=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof global)return global;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;try{return new Function("return this")()}catch(t){return{}}}();void 0===RR.trustedTypes&&(RR.trustedTypes={createPolicy:(t,r)=>r});const OR={configurable:!1,enumerable:!1,writable:!1};void 0===RR.FAST&&Reflect.defineProperty(RR,"FAST",Object.assign({value:Object.create(null)},OR));const NR=RR.FAST;if(void 0===NR.getById){const t=Object.create(null);Reflect.defineProperty(NR,"getById",Object.assign({value(r,o){let i=t[r];return void 0===i&&(i=o?t[r]=o():null),i}},OR))}const MR=Object.freeze([]);function createMetadataLocator(){const t=new WeakMap;return function(r){let o=t.get(r);if(void 0===o){let i=Reflect.getPrototypeOf(r);for(;void 0===o&&null!==i;)o=t.get(i),i=Reflect.getPrototypeOf(i);o=void 0===o?[]:o.slice(0),t.set(r,o)}return o}}const DR=RR.FAST.getById(1,(()=>{const t=[],r=[];function throwFirstError(){if(r.length)throw r.shift()}function tryRunTask(t){try{t.call()}catch(t){r.push(t),setTimeout(throwFirstError,0)}}function process(){let r=0;for(;r<t.length;)if(tryRunTask(t[r]),r++,r>1024){for(let o=0,i=t.length-r;o<i;o++)t[o]=t[o+r];t.length-=r,r=0}t.length=0}return Object.freeze({enqueue:function enqueue(r){t.length<1&&RR.requestAnimationFrame(process),t.push(r)},process:process})})),FR=RR.trustedTypes.createPolicy("fast-html",{createHTML:t=>t});let LR=FR;const UR=`fast-${Math.random().toString(36).substring(2,8)}`,BR=`${UR}{`,HR=`}${UR}`,$R=Object.freeze({supportsAdoptedStyleSheets:Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype,setHTMLPolicy(t){if(LR!==FR)throw new Error("The HTML policy can only be set once.");LR=t},createHTML:t=>LR.createHTML(t),isMarker:t=>t&&8===t.nodeType&&t.data.startsWith(UR),extractDirectiveIndexFromMarker:t=>parseInt(t.data.replace(`${UR}:`,"")),createInterpolationPlaceholder:t=>`${BR}${t}${HR}`,createCustomAttributePlaceholder(t,r){return`${t}="${this.createInterpolationPlaceholder(r)}"`},createBlockPlaceholder:t=>`\x3c!--${UR}:${t}--\x3e`,queueUpdate:DR.enqueue,processUpdates:DR.process,nextUpdate:()=>new Promise(DR.enqueue),setAttribute(t,r,o){null==o?t.removeAttribute(r):t.setAttribute(r,o)},setBooleanAttribute(t,r,o){o?t.setAttribute(r,""):t.removeAttribute(r)},removeChildNodes(t){for(let r=t.firstChild;null!==r;r=t.firstChild)t.removeChild(r)},createTemplateWalker:t=>document.createTreeWalker(t,133,null,!1)});class SubscriberSet{constructor(t,r){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.source=t,this.sub1=r}has(t){return void 0===this.spillover?this.sub1===t||this.sub2===t:-1!==this.spillover.indexOf(t)}subscribe(t){const r=this.spillover;if(void 0===r){if(this.has(t))return;if(void 0===this.sub1)return void(this.sub1=t);if(void 0===this.sub2)return void(this.sub2=t);this.spillover=[this.sub1,this.sub2,t],this.sub1=void 0,this.sub2=void 0}else{-1===r.indexOf(t)&&r.push(t)}}unsubscribe(t){const r=this.spillover;if(void 0===r)this.sub1===t?this.sub1=void 0:this.sub2===t&&(this.sub2=void 0);else{const o=r.indexOf(t);-1!==o&&r.splice(o,1)}}notify(t){const r=this.spillover,o=this.source;if(void 0===r){const r=this.sub1,i=this.sub2;void 0!==r&&r.handleChange(o,t),void 0!==i&&i.handleChange(o,t)}else for(let i=0,s=r.length;i<s;++i)r[i].handleChange(o,t)}}class PropertyChangeNotifier{constructor(t){this.subscribers={},this.sourceSubscribers=null,this.source=t}notify(t){var r;const o=this.subscribers[t];void 0!==o&&o.notify(t),null===(r=this.sourceSubscribers)||void 0===r||r.notify(t)}subscribe(t,r){var o;if(r){let o=this.subscribers[r];void 0===o&&(this.subscribers[r]=o=new SubscriberSet(this.source)),o.subscribe(t)}else this.sourceSubscribers=null!==(o=this.sourceSubscribers)&&void 0!==o?o:new SubscriberSet(this.source),this.sourceSubscribers.subscribe(t)}unsubscribe(t,r){var o;if(r){const o=this.subscribers[r];void 0!==o&&o.unsubscribe(t)}else null===(o=this.sourceSubscribers)||void 0===o||o.unsubscribe(t)}}const qR=NR.getById(2,(()=>{const t=/(:|&&|\|\||if)/,r=new WeakMap,o=$R.queueUpdate;let i,createArrayObserver=t=>{throw new Error("Must call enableArrayObservation before observing arrays.")};function getNotifier(t){let o=t.$fastController||r.get(t);return void 0===o&&(Array.isArray(t)?o=createArrayObserver(t):r.set(t,o=new PropertyChangeNotifier(t))),o}const s=createMetadataLocator();class DefaultObservableAccessor{constructor(t){this.name=t,this.field=`_${t}`,this.callback=`${t}Changed`}getValue(t){return void 0!==i&&i.watch(t,this.name),t[this.field]}setValue(t,r){const o=this.field,i=t[o];if(i!==r){t[o]=r;const s=t[this.callback];"function"==typeof s&&s.call(t,i,r),getNotifier(t).notify(this.name)}}}class BindingObserverImplementation extends SubscriberSet{constructor(t,r,o=!1){super(t,r),this.binding=t,this.isVolatileBinding=o,this.needsRefresh=!0,this.needsQueue=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}observe(t,r){this.needsRefresh&&null!==this.last&&this.disconnect();const o=i;i=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;const s=this.binding(t,r);return i=o,s}disconnect(){if(null!==this.last){let t=this.first;for(;void 0!==t;)t.notifier.unsubscribe(this,t.propertyName),t=t.next;this.last=null,this.needsRefresh=this.needsQueue=!0}}watch(t,r){const o=this.last,s=getNotifier(t),l=null===o?this.first:{};if(l.propertySource=t,l.propertyName=r,l.notifier=s,s.subscribe(this,r),null!==o){if(!this.needsRefresh){let r;i=void 0,r=o.propertySource[o.propertyName],i=this,t===r&&(this.needsRefresh=!0)}o.next=l}this.last=l}handleChange(){this.needsQueue&&(this.needsQueue=!1,o(this))}call(){null!==this.last&&(this.needsQueue=!0,this.notify(this))}records(){let t=this.first;return{next:()=>{const r=t;return void 0===r?{value:void 0,done:!0}:(t=t.next,{value:r,done:!1})},[Symbol.iterator]:function(){return this}}}}return Object.freeze({setArrayObserverFactory(t){createArrayObserver=t},getNotifier:getNotifier,track(t,r){void 0!==i&&i.watch(t,r)},trackVolatile(){void 0!==i&&(i.needsRefresh=!0)},notify(t,r){getNotifier(t).notify(r)},defineProperty(t,r){"string"==typeof r&&(r=new DefaultObservableAccessor(r)),s(t).push(r),Reflect.defineProperty(t,r.name,{enumerable:!0,get:function(){return r.getValue(this)},set:function(t){r.setValue(this,t)}})},getAccessors:s,binding(t,r,o=this.isVolatileBinding(t)){return new BindingObserverImplementation(t,r,o)},isVolatileBinding:r=>t.test(r.toString())})}));function observable(t,r){qR.defineProperty(t,r)}const jR=NR.getById(3,(()=>{let t=null;return{get:()=>t,set(r){t=r}}}));class ExecutionContext{constructor(){this.index=0,this.length=0,this.parent=null,this.parentContext=null}get event(){return jR.get()}get isEven(){return this.index%2==0}get isOdd(){return this.index%2!=0}get isFirst(){return 0===this.index}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}static setEvent(t){jR.set(t)}}qR.defineProperty(ExecutionContext.prototype,"index"),qR.defineProperty(ExecutionContext.prototype,"length");const zR=Object.seal(new ExecutionContext);class HTMLDirective{constructor(){this.targetIndex=0}}class TargetedHTMLDirective extends HTMLDirective{constructor(){super(...arguments),this.createPlaceholder=$R.createInterpolationPlaceholder}}class AttachedBehaviorHTMLDirective extends HTMLDirective{constructor(t,r,o){super(),this.name=t,this.behavior=r,this.options=o}createPlaceholder(t){return $R.createCustomAttributePlaceholder(this.name,t)}createBehavior(t){return new this.behavior(t,this.options)}}function normalBind(t,r){this.source=t,this.context=r,null===this.bindingObserver&&(this.bindingObserver=qR.binding(this.binding,this,this.isBindingVolatile)),this.updateTarget(this.bindingObserver.observe(t,r))}function triggerBind(t,r){this.source=t,this.context=r,this.target.addEventListener(this.targetName,this)}function normalUnbind(){this.bindingObserver.disconnect(),this.source=null,this.context=null}function contentUnbind(){this.bindingObserver.disconnect(),this.source=null,this.context=null;const t=this.target.$fastView;void 0!==t&&t.isComposed&&(t.unbind(),t.needsBindOnly=!0)}function triggerUnbind(){this.target.removeEventListener(this.targetName,this),this.source=null,this.context=null}function updateAttributeTarget(t){$R.setAttribute(this.target,this.targetName,t)}function updateBooleanAttributeTarget(t){$R.setBooleanAttribute(this.target,this.targetName,t)}function updateContentTarget(t){if(null==t&&(t=""),t.create){this.target.textContent="";let r=this.target.$fastView;void 0===r?r=t.create():this.target.$fastTemplate!==t&&(r.isComposed&&(r.remove(),r.unbind()),r=t.create()),r.isComposed?r.needsBindOnly&&(r.needsBindOnly=!1,r.bind(this.source,this.context)):(r.isComposed=!0,r.bind(this.source,this.context),r.insertBefore(this.target),this.target.$fastView=r,this.target.$fastTemplate=t)}else{const r=this.target.$fastView;void 0!==r&&r.isComposed&&(r.isComposed=!1,r.remove(),r.needsBindOnly?r.needsBindOnly=!1:r.unbind()),this.target.textContent=t}}function updatePropertyTarget(t){this.target[this.targetName]=t}function updateClassTarget(t){const r=this.classVersions||Object.create(null),o=this.target;let i=this.version||0;if(null!=t&&t.length){const s=t.split(/\s+/);for(let t=0,l=s.length;t<l;++t){const l=s[t];""!==l&&(r[l]=i,o.classList.add(l))}}if(this.classVersions=r,this.version=i+1,0!==i){i-=1;for(const t in r)r[t]===i&&o.classList.remove(t)}}class HTMLBindingDirective extends TargetedHTMLDirective{constructor(t){super(),this.binding=t,this.bind=normalBind,this.unbind=normalUnbind,this.updateTarget=updateAttributeTarget,this.isBindingVolatile=qR.isVolatileBinding(this.binding)}get targetName(){return this.originalTargetName}set targetName(t){if(this.originalTargetName=t,void 0!==t)switch(t[0]){case":":if(this.cleanedTargetName=t.substr(1),this.updateTarget=updatePropertyTarget,"innerHTML"===this.cleanedTargetName){const t=this.binding;this.binding=(r,o)=>$R.createHTML(t(r,o))}break;case"?":this.cleanedTargetName=t.substr(1),this.updateTarget=updateBooleanAttributeTarget;break;case"@":this.cleanedTargetName=t.substr(1),this.bind=triggerBind,this.unbind=triggerUnbind;break;default:this.cleanedTargetName=t,"class"===t&&(this.updateTarget=updateClassTarget)}}targetAtContent(){this.updateTarget=updateContentTarget,this.unbind=contentUnbind}createBehavior(t){return new BindingBehavior(t,this.binding,this.isBindingVolatile,this.bind,this.unbind,this.updateTarget,this.cleanedTargetName)}}class BindingBehavior{constructor(t,r,o,i,s,l,u){this.source=null,this.context=null,this.bindingObserver=null,this.target=t,this.binding=r,this.isBindingVolatile=o,this.bind=i,this.unbind=s,this.updateTarget=l,this.targetName=u}handleChange(){this.updateTarget(this.bindingObserver.observe(this.source,this.context))}handleEvent(t){ExecutionContext.setEvent(t);const r=this.binding(this.source,this.context);ExecutionContext.setEvent(null),!0!==r&&t.preventDefault()}}let GR=null;class CompilationContext{addFactory(t){t.targetIndex=this.targetIndex,this.behaviorFactories.push(t)}captureContentBinding(t){t.targetAtContent(),this.addFactory(t)}reset(){this.behaviorFactories=[],this.targetIndex=-1}release(){GR=this}static borrow(t){const r=GR||new CompilationContext;return r.directives=t,r.reset(),GR=null,r}}function createAggregateBinding(t){if(1===t.length)return t[0];let r;const o=t.length,i=t.map((t=>"string"==typeof t?()=>t:(r=t.targetName||r,t.binding))),s=new HTMLBindingDirective(((t,r)=>{let s="";for(let l=0;l<o;++l)s+=i[l](t,r);return s}));return s.targetName=r,s}const VR=HR.length;function parseContent(t,r){const o=r.split(BR);if(1===o.length)return null;const i=[];for(let r=0,s=o.length;r<s;++r){const s=o[r],l=s.indexOf(HR);let u;if(-1===l)u=s;else{const r=parseInt(s.substring(0,l));i.push(t.directives[r]),u=s.substring(l+VR)}""!==u&&i.push(u)}return i}function compileAttributes(t,r,o=!1){const i=r.attributes;for(let s=0,l=i.length;s<l;++s){const u=i[s],h=u.value,m=parseContent(t,h);let v=null;null===m?o&&(v=new HTMLBindingDirective((()=>h)),v.targetName=u.name):v=createAggregateBinding(m),null!==v&&(r.removeAttributeNode(u),s--,l--,t.addFactory(v))}}function compileContent(t,r,o){const i=parseContent(t,r.textContent);if(null!==i){let s=r;for(let l=0,u=i.length;l<u;++l){const u=i[l],h=0===l?r:s.parentNode.insertBefore(document.createTextNode(""),s.nextSibling);"string"==typeof u?h.textContent=u:(h.textContent=" ",t.captureContentBinding(u)),s=h,t.targetIndex++,h!==r&&o.nextNode()}t.targetIndex--}}const KR=document.createRange();class HTMLView{constructor(t,r){this.fragment=t,this.behaviors=r,this.source=null,this.context=null,this.firstChild=t.firstChild,this.lastChild=t.lastChild}appendTo(t){t.appendChild(this.fragment)}insertBefore(t){if(this.fragment.hasChildNodes())t.parentNode.insertBefore(this.fragment,t);else{const r=this.lastChild;if(t.previousSibling===r)return;const o=t.parentNode;let i,s=this.firstChild;for(;s!==r;)i=s.nextSibling,o.insertBefore(s,t),s=i;o.insertBefore(r,t)}}remove(){const t=this.fragment,r=this.lastChild;let o,i=this.firstChild;for(;i!==r;)o=i.nextSibling,t.appendChild(i),i=o;t.appendChild(r)}dispose(){const t=this.firstChild.parentNode,r=this.lastChild;let o,i=this.firstChild;for(;i!==r;)o=i.nextSibling,t.removeChild(i),i=o;t.removeChild(r);const s=this.behaviors,l=this.source;for(let t=0,r=s.length;t<r;++t)s[t].unbind(l)}bind(t,r){const o=this.behaviors;if(this.source!==t)if(null!==this.source){const i=this.source;this.source=t,this.context=r;for(let s=0,l=o.length;s<l;++s){const l=o[s];l.unbind(i),l.bind(t,r)}}else{this.source=t,this.context=r;for(let i=0,s=o.length;i<s;++i)o[i].bind(t,r)}}unbind(){if(null===this.source)return;const t=this.behaviors,r=this.source;for(let o=0,i=t.length;o<i;++o)t[o].unbind(r);this.source=null}static disposeContiguousBatch(t){if(0!==t.length){KR.setStartBefore(t[0].firstChild),KR.setEndAfter(t[t.length-1].lastChild),KR.deleteContents();for(let r=0,o=t.length;r<o;++r){const o=t[r],i=o.behaviors,s=o.source;for(let t=0,r=i.length;t<r;++t)i[t].unbind(s)}}}}class ViewTemplate{constructor(t,r){this.behaviorCount=0,this.hasHostBehaviors=!1,this.fragment=null,this.targetOffset=0,this.viewBehaviorFactories=null,this.hostBehaviorFactories=null,this.html=t,this.directives=r}create(t){if(null===this.fragment){let t;const r=this.html;if("string"==typeof r){t=document.createElement("template"),t.innerHTML=$R.createHTML(r);const o=t.content.firstElementChild;null!==o&&"TEMPLATE"===o.tagName&&(t=o)}else t=r;const o=function compileTemplate(t,r){const o=t.content;document.adoptNode(o);const i=CompilationContext.borrow(r);compileAttributes(i,t,!0);const s=i.behaviorFactories;i.reset();const l=$R.createTemplateWalker(o);let u;for(;u=l.nextNode();)switch(i.targetIndex++,u.nodeType){case 1:compileAttributes(i,u);break;case 3:compileContent(i,u,l);break;case 8:$R.isMarker(u)&&i.addFactory(r[$R.extractDirectiveIndexFromMarker(u)])}let h=0;($R.isMarker(o.firstChild)||1===o.childNodes.length&&r.length)&&(o.insertBefore(document.createComment(""),o.firstChild),h=-1);const m=i.behaviorFactories;return i.release(),{fragment:o,viewBehaviorFactories:m,hostBehaviorFactories:s,targetOffset:h}}(t,this.directives);this.fragment=o.fragment,this.viewBehaviorFactories=o.viewBehaviorFactories,this.hostBehaviorFactories=o.hostBehaviorFactories,this.targetOffset=o.targetOffset,this.behaviorCount=this.viewBehaviorFactories.length+this.hostBehaviorFactories.length,this.hasHostBehaviors=this.hostBehaviorFactories.length>0}const r=this.fragment.cloneNode(!0),o=this.viewBehaviorFactories,i=new Array(this.behaviorCount),s=$R.createTemplateWalker(r);let l=0,u=this.targetOffset,h=s.nextNode();for(let t=o.length;l<t;++l){const t=o[l],r=t.targetIndex;for(;null!==h;){if(u===r){i[l]=t.createBehavior(h);break}h=s.nextNode(),u++}}if(this.hasHostBehaviors){const r=this.hostBehaviorFactories;for(let o=0,s=r.length;o<s;++o,++l)i[l]=r[o].createBehavior(t)}return new HTMLView(r,i)}render(t,r,o){"string"==typeof r&&(r=document.getElementById(r)),void 0===o&&(o=r);const i=this.create(o);return i.bind(t,zR),i.appendTo(r),i}}const WR=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function html(t,...r){const o=[];let i="";for(let s=0,l=t.length-1;s<l;++s){const l=t[s];let u=r[s];if(i+=l,u instanceof ViewTemplate){const t=u;u=()=>t}if("function"==typeof u&&(u=new HTMLBindingDirective(u)),u instanceof TargetedHTMLDirective){const t=WR.exec(l);null!==t&&(u.targetName=t[2])}u instanceof HTMLDirective?(i+=u.createPlaceholder(o.length),o.push(u)):i+=u}return i+=t[t.length-1],new ViewTemplate(i,o)}class ElementStyles{constructor(){this.targets=new WeakSet}addStylesTo(t){this.targets.add(t)}removeStylesFrom(t){this.targets.delete(t)}isAttachedTo(t){return this.targets.has(t)}withBehaviors(...t){return this.behaviors=null===this.behaviors?t:this.behaviors.concat(t),this}}function reduceStyles(t){return t.map((t=>t instanceof ElementStyles?reduceStyles(t.styles):[t])).reduce(((t,r)=>t.concat(r)),[])}function reduceBehaviors(t){return t.map((t=>t instanceof ElementStyles?t.behaviors:null)).reduce(((t,r)=>null===r?t:(null===t&&(t=[]),t.concat(r))),null)}ElementStyles.create=(()=>{if($R.supportsAdoptedStyleSheets){const t=new Map;return r=>new AdoptedStyleSheetsStyles(r,t)}return t=>new StyleElementStyles(t)})();let addAdoptedStyleSheets=(t,r)=>{t.adoptedStyleSheets=[...t.adoptedStyleSheets,...r]},removeAdoptedStyleSheets=(t,r)=>{t.adoptedStyleSheets=t.adoptedStyleSheets.filter((t=>-1===r.indexOf(t)))};if($R.supportsAdoptedStyleSheets)try{document.adoptedStyleSheets.push(),document.adoptedStyleSheets.splice(),addAdoptedStyleSheets=(t,r)=>{t.adoptedStyleSheets.push(...r)},removeAdoptedStyleSheets=(t,r)=>{for(const o of r){const r=t.adoptedStyleSheets.indexOf(o);-1!==r&&t.adoptedStyleSheets.splice(r,1)}}}catch(t){}class AdoptedStyleSheetsStyles extends ElementStyles{constructor(t,r){super(),this.styles=t,this.styleSheetCache=r,this._styleSheets=void 0,this.behaviors=reduceBehaviors(t)}get styleSheets(){if(void 0===this._styleSheets){const t=this.styles,r=this.styleSheetCache;this._styleSheets=reduceStyles(t).map((t=>{if(t instanceof CSSStyleSheet)return t;let o=r.get(t);return void 0===o&&(o=new CSSStyleSheet,o.replaceSync(t),r.set(t,o)),o}))}return this._styleSheets}addStylesTo(t){addAdoptedStyleSheets(t,this.styleSheets),super.addStylesTo(t)}removeStylesFrom(t){removeAdoptedStyleSheets(t,this.styleSheets),super.removeStylesFrom(t)}}let QR=0;class StyleElementStyles extends ElementStyles{constructor(t){super(),this.styles=t,this.behaviors=null,this.behaviors=reduceBehaviors(t),this.styleSheets=reduceStyles(t),this.styleClass=function getNextStyleClass(){return"fast-style-class-"+ ++QR}()}addStylesTo(t){const r=this.styleSheets,o=this.styleClass;t=this.normalizeTarget(t);for(let i=0;i<r.length;i++){const s=document.createElement("style");s.innerHTML=r[i],s.className=o,t.append(s)}super.addStylesTo(t)}removeStylesFrom(t){const r=(t=this.normalizeTarget(t)).querySelectorAll(`.${this.styleClass}`);for(let o=0,i=r.length;o<i;++o)t.removeChild(r[o]);super.removeStylesFrom(t)}isAttachedTo(t){return super.isAttachedTo(this.normalizeTarget(t))}normalizeTarget(t){return t===document?document.body:t}}const YR=Object.freeze({locate:createMetadataLocator()}),JR={toView:t=>t?"true":"false",fromView:t=>null!=t&&"false"!==t&&!1!==t&&0!==t},XR={toView(t){if(null==t)return null;const r=1*t;return isNaN(r)?null:r.toString()},fromView(t){if(null==t)return null;const r=1*t;return isNaN(r)?null:r}};class AttributeDefinition{constructor(t,r,o=r.toLowerCase(),i="reflect",s){this.guards=new Set,this.Owner=t,this.name=r,this.attribute=o,this.mode=i,this.converter=s,this.fieldName=`_${r}`,this.callbackName=`${r}Changed`,this.hasCallback=this.callbackName in t.prototype,"boolean"===i&&void 0===s&&(this.converter=JR)}setValue(t,r){const o=t[this.fieldName],i=this.converter;void 0!==i&&(r=i.fromView(r)),o!==r&&(t[this.fieldName]=r,this.tryReflectToAttribute(t),this.hasCallback&&t[this.callbackName](o,r),t.$fastController.notify(this.name))}getValue(t){return qR.track(t,this.name),t[this.fieldName]}onAttributeChangedCallback(t,r){this.guards.has(t)||(this.guards.add(t),this.setValue(t,r),this.guards.delete(t))}tryReflectToAttribute(t){const r=this.mode,o=this.guards;o.has(t)||"fromView"===r||$R.queueUpdate((()=>{o.add(t);const i=t[this.fieldName];switch(r){case"reflect":const r=this.converter;$R.setAttribute(t,this.attribute,void 0!==r?r.toView(i):i);break;case"boolean":$R.setBooleanAttribute(t,this.attribute,i)}o.delete(t)}))}static collect(t,...r){const o=[];r.push(YR.locate(t));for(let i=0,s=r.length;i<s;++i){const s=r[i];if(void 0!==s)for(let r=0,i=s.length;r<i;++r){const i=s[r];"string"==typeof i?o.push(new AttributeDefinition(t,i)):o.push(new AttributeDefinition(t,i.property,i.attribute,i.mode,i.converter))}}return o}}function attr(t,r){let o;function decorator(t,r){arguments.length>1&&(o.property=r),YR.locate(t.constructor).push(o)}return arguments.length>1?(o={},void decorator(t,r)):(o=void 0===t?{}:t,decorator)}const ZR={mode:"open"},eO={},tO=NR.getById(4,(()=>{const t=new Map;return Object.freeze({register:r=>!t.has(r.type)&&(t.set(r.type,r),!0),getByType:r=>t.get(r)})}));class FASTElementDefinition{constructor(t,r=t.definition){"string"==typeof r&&(r={name:r}),this.type=t,this.name=r.name,this.template=r.template;const o=AttributeDefinition.collect(t,r.attributes),i=new Array(o.length),s={},l={};for(let t=0,r=o.length;t<r;++t){const r=o[t];i[t]=r.attribute,s[r.name]=r,l[r.attribute]=r}this.attributes=o,this.observedAttributes=i,this.propertyLookup=s,this.attributeLookup=l,this.shadowOptions=void 0===r.shadowOptions?ZR:null===r.shadowOptions?void 0:Object.assign(Object.assign({},ZR),r.shadowOptions),this.elementOptions=void 0===r.elementOptions?eO:Object.assign(Object.assign({},eO),r.elementOptions),this.styles=void 0===r.styles?void 0:Array.isArray(r.styles)?ElementStyles.create(r.styles):r.styles instanceof ElementStyles?r.styles:ElementStyles.create([r.styles])}get isDefined(){return!!tO.getByType(this.type)}define(t=customElements){const r=this.type;if(tO.register(this)){const t=this.attributes,o=r.prototype;for(let r=0,i=t.length;r<i;++r)qR.defineProperty(o,t[r]);Reflect.defineProperty(r,"observedAttributes",{value:this.observedAttributes,enumerable:!0})}return t.get(this.name)||t.define(this.name,r,this.elementOptions),this}}FASTElementDefinition.forType=tO.getByType;const rO=new WeakMap,oO={bubbles:!0,composed:!0,cancelable:!0};function getShadowRoot(t){return t.shadowRoot||rO.get(t)||null}class Controller extends PropertyChangeNotifier{constructor(t,r){super(t),this.boundObservables=null,this.behaviors=null,this.needsInitialization=!0,this._template=null,this._styles=null,this._isConnected=!1,this.$fastController=this,this.view=null,this.element=t,this.definition=r;const o=r.shadowOptions;if(void 0!==o){const r=t.attachShadow(o);"closed"===o.mode&&rO.set(t,r)}const i=qR.getAccessors(t);if(i.length>0){const r=this.boundObservables=Object.create(null);for(let o=0,s=i.length;o<s;++o){const s=i[o].name,l=t[s];void 0!==l&&(delete t[s],r[s]=l)}}}get isConnected(){return qR.track(this,"isConnected"),this._isConnected}setIsConnected(t){this._isConnected=t,qR.notify(this,"isConnected")}get template(){return this._template}set template(t){this._template!==t&&(this._template=t,this.needsInitialization||this.renderTemplate(t))}get styles(){return this._styles}set styles(t){this._styles!==t&&(null!==this._styles&&this.removeStyles(this._styles),this._styles=t,this.needsInitialization||null===t||this.addStyles(t))}addStyles(t){const r=getShadowRoot(this.element)||this.element.getRootNode();if(t instanceof HTMLStyleElement)r.append(t);else if(!t.isAttachedTo(r)){const o=t.behaviors;t.addStylesTo(r),null!==o&&this.addBehaviors(o)}}removeStyles(t){const r=getShadowRoot(this.element)||this.element.getRootNode();if(t instanceof HTMLStyleElement)r.removeChild(t);else if(t.isAttachedTo(r)){const o=t.behaviors;t.removeStylesFrom(r),null!==o&&this.removeBehaviors(o)}}addBehaviors(t){const r=this.behaviors||(this.behaviors=new Map),o=t.length,i=[];for(let s=0;s<o;++s){const o=t[s];r.has(o)?r.set(o,r.get(o)+1):(r.set(o,1),i.push(o))}if(this._isConnected){const t=this.element;for(let r=0;r<i.length;++r)i[r].bind(t,zR)}}removeBehaviors(t,r=!1){const o=this.behaviors;if(null===o)return;const i=t.length,s=[];for(let l=0;l<i;++l){const i=t[l];if(o.has(i)){const t=o.get(i)-1;0===t||r?o.delete(i)&&s.push(i):o.set(i,t)}}if(this._isConnected){const t=this.element;for(let r=0;r<s.length;++r)s[r].unbind(t)}}onConnectedCallback(){if(this._isConnected)return;const t=this.element;this.needsInitialization?this.finishInitialization():null!==this.view&&this.view.bind(t,zR);const r=this.behaviors;if(null!==r)for(const[o]of r)o.bind(t,zR);this.setIsConnected(!0)}onDisconnectedCallback(){if(!this._isConnected)return;this.setIsConnected(!1);const t=this.view;null!==t&&t.unbind();const r=this.behaviors;if(null!==r){const t=this.element;for(const[o]of r)o.unbind(t)}}onAttributeChangedCallback(t,r,o){const i=this.definition.attributeLookup[t];void 0!==i&&i.onAttributeChangedCallback(this.element,o)}emit(t,r,o){return!!this._isConnected&&this.element.dispatchEvent(new CustomEvent(t,Object.assign(Object.assign({detail:r},oO),o)))}finishInitialization(){const t=this.element,r=this.boundObservables;if(null!==r){const o=Object.keys(r);for(let i=0,s=o.length;i<s;++i){const s=o[i];t[s]=r[s]}this.boundObservables=null}const o=this.definition;null===this._template&&(this.element.resolveTemplate?this._template=this.element.resolveTemplate():o.template&&(this._template=o.template||null)),null!==this._template&&this.renderTemplate(this._template),null===this._styles&&(this.element.resolveStyles?this._styles=this.element.resolveStyles():o.styles&&(this._styles=o.styles||null)),null!==this._styles&&this.addStyles(this._styles),this.needsInitialization=!1}renderTemplate(t){const r=this.element,o=getShadowRoot(r)||r;null!==this.view?(this.view.dispose(),this.view=null):this.needsInitialization||$R.removeChildNodes(o),t&&(this.view=t.render(r,o,r))}static forCustomElement(t){const r=t.$fastController;if(void 0!==r)return r;const o=FASTElementDefinition.forType(t.constructor);if(void 0===o)throw new Error("Missing FASTElement definition.");return t.$fastController=new Controller(t,o)}}function createFASTElement(t){return class extends t{constructor(){super(),Controller.forCustomElement(this)}$emit(t,r,o){return this.$fastController.emit(t,r,o)}connectedCallback(){this.$fastController.onConnectedCallback()}disconnectedCallback(){this.$fastController.onDisconnectedCallback()}attributeChangedCallback(t,r,o){this.$fastController.onAttributeChangedCallback(t,r,o)}}}const nO=Object.assign(createFASTElement(HTMLElement),{from:t=>createFASTElement(t),define:(t,r)=>new FASTElementDefinition(t,r).define().type});function customElement(t){return function(r){new FASTElementDefinition(r,t).define()}}class CSSDirective{createCSS(){return""}createBehavior(){}}function css(t,...r){const{styles:o,behaviors:i}=function collectStyles(t,r){const o=[];let i="";const s=[];for(let l=0,u=t.length-1;l<u;++l){i+=t[l];let u=r[l];if(u instanceof CSSDirective){const t=u.createBehavior();u=u.createCSS(),t&&s.push(t)}u instanceof ElementStyles||u instanceof CSSStyleSheet?(""!==i.trim()&&(o.push(i),i=""),o.push(u)):i+=u}return i+=t[t.length-1],""!==i.trim()&&o.push(i),{styles:o,behaviors:s}}(t,r),s=ElementStyles.create(o);return i.length&&s.withBehaviors(...i),s}class RefBehavior{constructor(t,r){this.target=t,this.propertyName=r}bind(t){t[this.propertyName]=this.target}unbind(){}}function ref(t){return new AttachedBehaviorHTMLDirective("fast-ref",RefBehavior,t)}function when(t,r){const o="function"==typeof r?r:()=>r;return(r,i)=>t(r,i)?o(r,i):null}class NodeObservationBehavior{constructor(t,r){this.target=t,this.options=r,this.source=null}bind(t){const r=this.options.property;this.shouldUpdate=qR.getAccessors(t).some((t=>t.name===r)),this.source=t,this.updateTarget(this.computeNodes()),this.shouldUpdate&&this.observe()}unbind(){this.updateTarget(MR),this.source=null,this.shouldUpdate&&this.disconnect()}handleEvent(){this.updateTarget(this.computeNodes())}computeNodes(){let t=this.getNodes();return void 0!==this.options.filter&&(t=t.filter(this.options.filter)),t}updateTarget(t){this.source[this.options.property]=t}}class SlottedBehavior extends NodeObservationBehavior{constructor(t,r){super(t,r)}observe(){this.target.addEventListener("slotchange",this)}disconnect(){this.target.removeEventListener("slotchange",this)}getNodes(){return this.target.assignedNodes(this.options)}}function slotted(t){return"string"==typeof t&&(t={property:t}),new AttachedBehaviorHTMLDirective("fast-slotted",SlottedBehavior,t)}const iO=html`
    <span part="end" ${ref("endContainer")}>
        <slot
            name="end"
            ${ref("end")}
            @slotchange="${t=>t.handleEndContentChange()}"
        ></slot>
    </span>
`,sO=html`
    <span part="start" ${ref("startContainer")}>
        <slot
            name="start"
            ${ref("start")}
            @slotchange="${t=>t.handleStartContentChange()}"
        ></slot>
    </span>
`
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */;function __decorate$o(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u}function applyMixins(t,...r){r.forEach((r=>{if(Object.getOwnPropertyNames(r.prototype).forEach((o=>{Object.defineProperty(t.prototype,o,Object.getOwnPropertyDescriptor(r.prototype,o))})),r.attributes){const o=t.attributes||[];t.attributes=o.concat(r.attributes)}}))}var aO="object"==typeof global&&global&&global.Object===Object&&global,cO="object"==typeof self&&self&&self.Object===Object&&self,lO=aO||cO||Function("return this")(),dO=lO.Symbol,uO=Object.prototype,hO=uO.hasOwnProperty,pO=uO.toString,fO=dO?dO.toStringTag:void 0;var gO=Object.prototype.toString;var mO="[object Null]",vO="[object Undefined]",yO=dO?dO.toStringTag:void 0;function baseGetTag(t){return null==t?void 0===t?vO:mO:yO&&yO in Object(t)?function getRawTag(t){var r=hO.call(t,fO),o=t[fO];try{t[fO]=void 0;var i=!0}catch(t){}var s=pO.call(t);return i&&(r?t[fO]=o:delete t[fO]),s}(t):function objectToString(t){return gO.call(t)}(t)}function isObjectLike(t){return null!=t&&"object"==typeof t}var bO="[object Symbol]";var wO=/\s/;var CO=/^\s+/;function baseTrim(t){return t?t.slice(0,function trimmedEndIndex(t){for(var r=t.length;r--&&wO.test(t.charAt(r)););return r}(t)+1).replace(CO,""):t}function isObject(t){var r=typeof t;return null!=t&&("object"==r||"function"==r)}var _O=NaN,kO=/^[-+]0x[0-9a-f]+$/i,SO=/^0b[01]+$/i,TO=/^0o[0-7]+$/i,EO=parseInt;function toNumber(t){if("number"==typeof t)return t;if(function isSymbol(t){return"symbol"==typeof t||isObjectLike(t)&&baseGetTag(t)==bO}(t))return _O;if(isObject(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=isObject(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=baseTrim(t);var o=SO.test(t);return o||TO.test(t)?EO(t.slice(2),o?2:8):kO.test(t)?_O:+t}var xO=1/0,IO=17976931348623157e292;function toFinite(t){return t?(t=toNumber(t))===xO||t===-xO?(t<0?-1:1)*IO:t==t?t:0:0===t?t:0}var AO="[object AsyncFunction]",PO="[object Function]",RO="[object GeneratorFunction]",OO="[object Proxy]";var NO=lO["__core-js_shared__"],MO=function(){var t=/[^.]+$/.exec(NO&&NO.keys&&NO.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();var DO=Function.prototype.toString;var FO=/^\[object .+?Constructor\]$/,LO=Function.prototype,UO=Object.prototype,BO=LO.toString,HO=UO.hasOwnProperty,$O=RegExp("^"+BO.call(HO).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(t){if(!isObject(t)||function isMasked(t){return!!MO&&MO in t}(t))return!1;var r=function isFunction(t){if(!isObject(t))return!1;var r=baseGetTag(t);return r==PO||r==RO||r==AO||r==OO}(t)?$O:FO;return r.test(function toSource(t){if(null!=t){try{return DO.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function getNative(t,r){var o=function getValue(t,r){return null==t?void 0:t[r]}(t,r);return baseIsNative(o)?o:void 0}var qO=getNative(Object,"create");var jO=Object.prototype.hasOwnProperty;var zO=Object.prototype.hasOwnProperty;function Hash(t){var r=-1,o=null==t?0:t.length;for(this.clear();++r<o;){var i=t[r];this.set(i[0],i[1])}}function assocIndexOf(t,r){for(var o,i,s=t.length;s--;)if((o=t[s][0])===(i=r)||o!=o&&i!=i)return s;return-1}Hash.prototype.clear=function hashClear(){this.__data__=qO?qO(null):{},this.size=0},Hash.prototype.delete=function hashDelete(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},Hash.prototype.get=function hashGet(t){var r=this.__data__;if(qO){var o=r[t];return"__lodash_hash_undefined__"===o?void 0:o}return jO.call(r,t)?r[t]:void 0},Hash.prototype.has=function hashHas(t){var r=this.__data__;return qO?void 0!==r[t]:zO.call(r,t)},Hash.prototype.set=function hashSet(t,r){var o=this.__data__;return this.size+=this.has(t)?0:1,o[t]=qO&&void 0===r?"__lodash_hash_undefined__":r,this};var GO=Array.prototype.splice;function ListCache(t){var r=-1,o=null==t?0:t.length;for(this.clear();++r<o;){var i=t[r];this.set(i[0],i[1])}}ListCache.prototype.clear=function listCacheClear(){this.__data__=[],this.size=0},ListCache.prototype.delete=function listCacheDelete(t){var r=this.__data__,o=assocIndexOf(r,t);return!(o<0)&&(o==r.length-1?r.pop():GO.call(r,o,1),--this.size,!0)},ListCache.prototype.get=function listCacheGet(t){var r=this.__data__,o=assocIndexOf(r,t);return o<0?void 0:r[o][1]},ListCache.prototype.has=function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1},ListCache.prototype.set=function listCacheSet(t,r){var o=this.__data__,i=assocIndexOf(o,t);return i<0?(++this.size,o.push([t,r])):o[i][1]=r,this};var VO=getNative(lO,"Map");function getMapData(t,r){var o=t.__data__;return function isKeyable(t){var r=typeof t;return"string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t}(r)?o["string"==typeof r?"string":"hash"]:o.map}function MapCache(t){var r=-1,o=null==t?0:t.length;for(this.clear();++r<o;){var i=t[r];this.set(i[0],i[1])}}MapCache.prototype.clear=function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(VO||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(t){var r=getMapData(this,t).delete(t);return this.size-=r?1:0,r},MapCache.prototype.get=function mapCacheGet(t){return getMapData(this,t).get(t)},MapCache.prototype.has=function mapCacheHas(t){return getMapData(this,t).has(t)},MapCache.prototype.set=function mapCacheSet(t,r){var o=getMapData(this,t),i=o.size;return o.set(t,r),this.size+=o.size==i?0:1,this};var KO="Expected a function";function memoize(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError(KO);var memoized=function(){var o=arguments,i=r?r.apply(this,o):o[0],s=memoized.cache;if(s.has(i))return s.get(i);var l=t.apply(this,o);return memoized.cache=s.set(i,l)||s,l};return memoized.cache=new(memoize.Cache||MapCache),memoized}memoize.Cache=MapCache;var WO=Math.max,QO=Math.min;function inRange(t,r,o){return r=toFinite(r),void 0===o?(o=r,r=0):o=toFinite(o),function baseInRange(t,r,o){return t>=QO(r,o)&&t<WO(r,o)}(t=toNumber(t),r,o)}var YO="[object Boolean]";let JO;var XO;!function(t){t[t.alt=18]="alt",t[t.arrowDown=40]="arrowDown",t[t.arrowLeft=37]="arrowLeft",t[t.arrowRight=39]="arrowRight",t[t.arrowUp=38]="arrowUp",t[t.back=8]="back",t[t.backSlash=220]="backSlash",t[t.break=19]="break",t[t.capsLock=20]="capsLock",t[t.closeBracket=221]="closeBracket",t[t.colon=186]="colon",t[t.colon2=59]="colon2",t[t.comma=188]="comma",t[t.ctrl=17]="ctrl",t[t.delete=46]="delete",t[t.end=35]="end",t[t.enter=13]="enter",t[t.equals=187]="equals",t[t.equals2=61]="equals2",t[t.equals3=107]="equals3",t[t.escape=27]="escape",t[t.forwardSlash=191]="forwardSlash",t[t.function1=112]="function1",t[t.function10=121]="function10",t[t.function11=122]="function11",t[t.function12=123]="function12",t[t.function2=113]="function2",t[t.function3=114]="function3",t[t.function4=115]="function4",t[t.function5=116]="function5",t[t.function6=117]="function6",t[t.function7=118]="function7",t[t.function8=119]="function8",t[t.function9=120]="function9",t[t.home=36]="home",t[t.insert=45]="insert",t[t.menu=93]="menu",t[t.minus=189]="minus",t[t.minus2=109]="minus2",t[t.numLock=144]="numLock",t[t.numPad0=96]="numPad0",t[t.numPad1=97]="numPad1",t[t.numPad2=98]="numPad2",t[t.numPad3=99]="numPad3",t[t.numPad4=100]="numPad4",t[t.numPad5=101]="numPad5",t[t.numPad6=102]="numPad6",t[t.numPad7=103]="numPad7",t[t.numPad8=104]="numPad8",t[t.numPad9=105]="numPad9",t[t.numPadDivide=111]="numPadDivide",t[t.numPadDot=110]="numPadDot",t[t.numPadMinus=109]="numPadMinus",t[t.numPadMultiply=106]="numPadMultiply",t[t.numPadPlus=107]="numPadPlus",t[t.openBracket=219]="openBracket",t[t.pageDown=34]="pageDown",t[t.pageUp=33]="pageUp",t[t.period=190]="period",t[t.print=44]="print",t[t.quote=222]="quote",t[t.scrollLock=145]="scrollLock",t[t.shift=16]="shift",t[t.space=32]="space",t[t.tab=9]="tab",t[t.tilde=192]="tilde",t[t.windowsLeft=91]="windowsLeft",t[t.windowsOpera=219]="windowsOpera",t[t.windowsRight=92]="windowsRight"}(XO||(XO={}));var ZO,eN;!function(t){t.ltr="ltr",t.rtl="rtl"}(ZO||(ZO={})),function(t){t.Canvas="Canvas",t.CanvasText="CanvasText",t.LinkText="LinkText",t.VisitedText="VisitedText",t.ActiveText="ActiveText",t.ButtonFace="ButtonFace",t.ButtonText="ButtonText",t.Field="Field",t.FieldText="FieldText",t.Highlight="Highlight",t.HighlightText="HighlightText",t.GrayText="GrayText"}(eN||(eN={}));class ARIAGlobalStatesAndProperties{}function composedParent(t){const r=t.parentElement;if(r)return r;{const r=t.getRootNode();if(r.host instanceof HTMLElement)return r.host}return null}__decorate$o([attr({attribute:"aria-atomic",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaAtomic",void 0),__decorate$o([attr({attribute:"aria-busy",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaBusy",void 0),__decorate$o([attr({attribute:"aria-controls",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaControls",void 0),__decorate$o([attr({attribute:"aria-current",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaCurrent",void 0),__decorate$o([attr({attribute:"aria-describedby",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaDescribedby",void 0),__decorate$o([attr({attribute:"aria-details",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaDetails",void 0),__decorate$o([attr({attribute:"aria-disabled",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaDisabled",void 0),__decorate$o([attr({attribute:"aria-errormessage",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaErrormessage",void 0),__decorate$o([attr({attribute:"aria-flowto",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaFlowto",void 0),__decorate$o([attr({attribute:"aria-haspopup",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaHaspopup",void 0),__decorate$o([attr({attribute:"aria-hidden",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaHidden",void 0),__decorate$o([attr({attribute:"aria-invalid",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaInvalid",void 0),__decorate$o([attr({attribute:"aria-keyshortcuts",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaKeyshortcuts",void 0),__decorate$o([attr({attribute:"aria-label",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaLabel",void 0),__decorate$o([attr({attribute:"aria-labelledby",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaLabelledby",void 0),__decorate$o([attr({attribute:"aria-live",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaLive",void 0),__decorate$o([attr({attribute:"aria-owns",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaOwns",void 0),__decorate$o([attr({attribute:"aria-relevant",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaRelevant",void 0),__decorate$o([attr({attribute:"aria-roledescription",mode:"fromView"})],ARIAGlobalStatesAndProperties.prototype,"ariaRoledescription",void 0);class MatchMediaBehavior{constructor(t){this.listenerCache=new WeakMap,this.query=t}bind(t){const{query:r}=this,o=this.constructListener(t);o.bind(r)(),r.addListener(o),this.listenerCache.set(t,o)}unbind(t){const r=this.listenerCache.get(t);r&&(this.query.removeListener(r),this.listenerCache.delete(t))}}class MatchMediaStyleSheetBehavior extends MatchMediaBehavior{constructor(t,r){super(t),this.styles=r}static with(t){return r=>new MatchMediaStyleSheetBehavior(t,r)}constructListener(t){let r=!1;const o=this.styles;return function listener(){const{matches:i}=this;i&&!r?(t.$fastController.addStyles(o),r=i):!i&&r&&(t.$fastController.removeStyles(o),r=i)}}unbind(t){super.unbind(t),t.$fastController.removeStyles(this.styles)}}const tN=MatchMediaStyleSheetBehavior.with(window.matchMedia("(forced-colors)"));MatchMediaStyleSheetBehavior.with(window.matchMedia("(prefers-color-scheme: dark)")),MatchMediaStyleSheetBehavior.with(window.matchMedia("(prefers-color-scheme: light)"));class PropertyStyleSheetBehavior{constructor(t,r,o){this.propertyName=t,this.value=r,this.styles=o}bind(t){qR.getNotifier(t).subscribe(this,this.propertyName),this.handleChange(t,this.propertyName)}unbind(t){qR.getNotifier(t).unsubscribe(this,this.propertyName),t.$fastController.removeStyles(this.styles)}handleChange(t,r){t[r]===this.value?t.$fastController.addStyles(this.styles):t.$fastController.removeStyles(this.styles)}}const rN="not-allowed";function display(t){return`:host([hidden]){display:none}:host{display:${t}}`}const oN=function canUseFocusVisible(){if(function isBoolean(t){return!0===t||!1===t||isObjectLike(t)&&baseGetTag(t)==YO}(JO))return JO;if(!function canUseDOM(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}())return JO=!1,JO;const t=document.createElement("style"),r=function getNonce(){const t=document.querySelector('meta[property="csp-nonce"]');return t?t.getAttribute("content"):null}();null!==r&&t.setAttribute("nonce",r),document.head.appendChild(t);try{t.sheet.insertRule("foo:focus-visible {color:inherit}",0),JO=!0}catch(t){JO=!1}finally{document.head.removeChild(t)}return JO}()?"focus-visible":"focus",nN=":host{}";class CustomPropertyManagerBase{constructor(){this.queue=new Set,this.customPropertyTarget=null,this._owner=null,this.ticking=!1,this.cssCustomPropertyDefinitions=new Map}get owner(){return this._owner}register(t){const r=this.cssCustomPropertyDefinitions.get(t.name);r?r.count+=1:(this.cssCustomPropertyDefinitions.set(t.name,Object.assign(Object.assign({},t),{count:1})),this.set(t))}unregister(t){const r=this.cssCustomPropertyDefinitions.get(t);r&&(r.count-=1,0===r.count&&(this.cssCustomPropertyDefinitions.delete(t),this.remove(t)))}set(t){this.owner&&(this.customPropertyTarget?this.customPropertyTarget.setProperty(`--${t.name}`,this.owner.evaluate(t)):this.queue.add(this.set.bind(this,t)))}remove(t){this.customPropertyTarget?this.customPropertyTarget.removeProperty(`--${t}`):this.queue.add(this.remove.bind(this,t))}setAll(){this.ticking||(this.ticking=!0,$R.queueUpdate((()=>{this.ticking=!1,this.cssCustomPropertyDefinitions.forEach((t=>{this.set(t)}))})))}}class ConstructableStylesCustomPropertyManager extends CustomPropertyManagerBase{constructor(t){super(),this.subscribers=new Set,this.sheet=t,this.styles=ElementStyles.create([t]),this.customPropertyTarget=t.cssRules[t.insertRule(nN)].style}subscribe(t){this.subscribers.add(t),1===this.subscribers.size&&(this._owner=t),t.cssCustomPropertyDefinitions.forEach((t=>{this.register(t)})),t.$fastController.addStyles(this.styles)}unsubscribe(t){this.subscribers.delete(t),t.cssCustomPropertyDefinitions.forEach((t=>this.unregister(t.name))),this.owner===t&&(this._owner=this.subscribers.size?this.subscribers.values().next().value:null),!this.sheet.ownerNode&&this.styles&&t.$fastController.removeStyles(this.styles)}isSubscribed(t){return this.subscribers.has(t)}}class StyleElementCustomPropertyManager extends CustomPropertyManagerBase{constructor(t,r){super(),this._sheet=null,this.handleConnection={handleChange:()=>{var t;this._sheet=this.styles.sheet;const r=this.sheet.insertRule(nN);this.customPropertyTarget=this.sheet.rules[r].style,qR.getNotifier(null===(t=this._owner)||void 0===t?void 0:t.$fastController).unsubscribe(this.handleConnection,"isConnected")}};const o=r.$fastController;o.addStyles(t),this.styles=t,this._owner=r,r.isConnected?this.handleConnection.handleChange():qR.getNotifier(o).subscribe(this.handleConnection,"isConnected"),r.cssCustomPropertyDefinitions.forEach((t=>{this.register(t)}))}get sheet(){return this._sheet}customPropertyTargetChanged(t,r){!t&&this.queue.size&&(this.queue.forEach((t=>t())),this.queue.clear())}}function isDesignSystemConsumer(t){const r=t.provider;return null!=r&&DesignSystemProvider.isDesignSystemProvider(r)}__decorate$o([observable],StyleElementCustomPropertyManager.prototype,"customPropertyTarget",void 0);const iN={bind(t){t.provider=DesignSystemProvider.findProvider(t)},unbind(t){}};class DesignSystemProvider extends nO{constructor(){super(),this.isDesignSystemProvider=!0,this.designSystem={},this.useDefaults=!1,this.provider=null,this.cssCustomPropertyDefinitions=new Map,this.attributeChangeHandler={handleChange:(t,r)=>{const o=this[r],i=this.customPropertyManager;if(this.isValidDesignSystemValue(o)){this.designSystem[r]=o;const t=this.designSystemProperties[r];t&&t.cssCustomProperty&&i&&i.set({name:t.cssCustomProperty,value:o})}else{this.syncDesignSystemWithProvider();const t=this.designSystemProperties[r].cssCustomProperty;i&&("string"==typeof t&&i.remove(t),i.setAll())}}},this.localDesignSystemChangeHandler={handleChange:()=>{const t=this.customPropertyManager;t&&t.owner===this&&t.setAll()}},this.providerDesignSystemChangeHandler={handleChange:(t,r)=>{t[r]===this.designSystem[r]||this.isValidDesignSystemValue(this[r])||(this.designSystem[r]=t[r])}},$R.supportsAdoptedStyleSheets?this.customPropertyManager=new ConstructableStylesCustomPropertyManager(new CSSStyleSheet):this.customPropertyManager=new StyleElementCustomPropertyManager(document.createElement("style"),this),void 0===this.designSystemProperties&&(this.designSystemProperties={}),this.$fastController.addBehaviors([iN])}static get tagNames(){return DesignSystemProvider._tagNames}static isDesignSystemProvider(t){return t.isDesignSystemProvider||-1!==DesignSystemProvider.tagNames.indexOf(t.tagName)}static findProvider(t){if(isDesignSystemConsumer(t))return t.provider;let r=composedParent(t);for(;null!==r;){if(DesignSystemProvider.isDesignSystemProvider(r))return t.provider=r,r;if(isDesignSystemConsumer(r))return t.provider=r.provider,r.provider;r=composedParent(r)}return null}static registerTagName(t){const r=t.toUpperCase();-1===DesignSystemProvider.tagNames.indexOf(r)&&DesignSystemProvider._tagNames.push(r)}useDefaultsChanged(){if(this.useDefaults){const t=this.designSystemProperties;Object.keys(t).forEach((r=>{void 0===this[r]&&(this[r]=t[r].default)}))}}providerChanged(t,r){if(t instanceof HTMLElement){const r=qR.getNotifier(t.designSystem);qR.getAccessors(t.designSystem).forEach((t=>{r.unsubscribe(this.providerDesignSystemChangeHandler,t.name)}))}if(r instanceof HTMLElement&&DesignSystemProvider.isDesignSystemProvider(r)){const t=qR.getNotifier(r.designSystem),o=qR.getAccessors(this.designSystem).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r.name]:r})),{}),i=qR.getNotifier(this.designSystem);qR.getAccessors(r.designSystem).forEach((r=>{t.subscribe(this.providerDesignSystemChangeHandler,r.name),o[r.name]||(observable(this.designSystem,r.name),i.subscribe(this.localDesignSystemChangeHandler,r.name))})),this.syncDesignSystemWithProvider()}}customPropertyManagerChanged(t,r){t&&t.unsubscribe&&t.unsubscribe(this),r.subscribe&&r.subscribe(this)}connectedCallback(){super.connectedCallback(),this.customPropertyManager.subscribe&&this.customPropertyManager.isSubscribed&&!this.customPropertyManager.isSubscribed(this)&&this.customPropertyManager.subscribe(this);const t=qR.getNotifier(this),r=qR.getNotifier(this.designSystem);if(Object.keys(this.designSystemProperties).forEach((o=>{observable(this.designSystem,o),t.subscribe(this.attributeChangeHandler,o),r.subscribe(this.localDesignSystemChangeHandler,o);const i=this[o];if(this.isValidDesignSystemValue(i)){this.designSystem[o]=i;const{cssCustomProperty:t}=this.designSystemProperties[o];"string"==typeof t&&this.customPropertyManager&&this.customPropertyManager.owner===this&&this.customPropertyManager.set({name:t,value:this[o]})}})),Array.isArray(this.disconnectedCSSCustomPropertyRegistry)){for(let t=0;t<this.disconnectedCSSCustomPropertyRegistry.length;t++)this.registerCSSCustomProperty(this.disconnectedCSSCustomPropertyRegistry[t]);delete this.disconnectedCSSCustomPropertyRegistry}if(Array.isArray(this.disconnectedRegistry)){for(let t=0;t<this.disconnectedRegistry.length;t++)this.disconnectedRegistry[t](this);delete this.disconnectedRegistry}}disconnectedCallback(){super.disconnectedCallback(),this.customPropertyManager.unsubscribe&&this.customPropertyManager.unsubscribe(this)}registerCSSCustomProperty(t){this.cssCustomPropertyDefinitions.set(t.name,t),this.customPropertyManager.register(t)}unregisterCSSCustomProperty(t){this.cssCustomPropertyDefinitions.delete(t.name),this.customPropertyManager.unregister(t.name)}evaluate(t){return"function"==typeof t.value?t.value(Object.assign({},this.designSystem)):t.value}syncDesignSystemWithProvider(){if(this.provider){const t=qR.getAccessors(this.designSystem).reduce(((t,r)=>(t[r.name]=r,t)),{});qR.getAccessors(this.provider.designSystem).forEach((r=>{var o;this.designSystemProperties.hasOwnProperty(r.name)&&this.isValidDesignSystemValue(this[r.name])||!this.isValidDesignSystemValue(null===(o=this.provider)||void 0===o?void 0:o.designSystem[r.name])||(t[r.name]||qR.defineProperty(this.designSystem,r.name),this.designSystem[r.name]=this.provider.designSystem[r.name])}))}}isValidDesignSystemValue(t){return null!=t}}DesignSystemProvider._tagNames=[],__decorate$o([attr({attribute:"use-defaults",mode:"boolean"})],DesignSystemProvider.prototype,"useDefaults",void 0),__decorate$o([observable],DesignSystemProvider.prototype,"provider",void 0),__decorate$o([observable],DesignSystemProvider.prototype,"customPropertyManager",void 0);const sN=function defineDesignSystemProvider(t){return r=>{customElement(t)(r),r.registerTagName("string"==typeof t?t:t.name)}};function designSystemProperty(t){return(r,o)=>{((t,r,o)=>{const{cssCustomProperty:i,attribute:s}=o;t.designSystemProperties||(t.designSystemProperties={}),!1===s?observable(t,r):(void 0===o.mode&&(o=Object.assign(Object.assign({},o),{mode:"fromView"})),attr(o)(t,r)),t.designSystemProperties[r]={cssCustomProperty:!1!==i&&("string"==typeof i?i:"string"==typeof s?s:r),default:o.default}})(r,o,t)}}const aN=html`
    <slot></slot>
`,cN=html`
    <button
        class="control"
        part="control"
        ?autofocus="${t=>t.autofocus}"
        ?disabled="${t=>t.disabled}"
        form="${t=>t.formId}"
        formaction="${t=>t.formaction}"
        formenctype="${t=>t.formenctype}"
        formmethod="${t=>t.formmethod}"
        formnovalidate="${t=>t.formnovalidate}"
        formtarget="${t=>t.formtarget}"
        name="${t=>t.name}"
        type="${t=>t.type}"
        value="${t=>t.value}"
        aria-atomic="${t=>t.ariaAtomic}"
        aria-busy="${t=>t.ariaBusy}"
        aria-controls="${t=>t.ariaControls}"
        aria-current="${t=>t.ariaCurrent}"
        aria-describedBy="${t=>t.ariaDescribedby}"
        aria-details="${t=>t.ariaDetails}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-errormessage="${t=>t.ariaErrormessage}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-flowto="${t=>t.ariaFlowto}"
        aria-haspopup="${t=>t.ariaHaspopup}"
        aria-hidden="${t=>t.ariaHidden}"
        aria-invalid="${t=>t.ariaInvalid}"
        aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-live="${t=>t.ariaLive}"
        aria-owns="${t=>t.ariaOwns}"
        aria-pressed="${t=>t.ariaPressed}"
        aria-relevant="${t=>t.ariaRelevant}"
        aria-roledescription="${t=>t.ariaRoledescription}"
        ${ref("control")}
    >
        ${sO}
        <span class="content" part="content">
            <slot ${slotted("defaultSlottedContent")}></slot>
        </span>
        ${iO}
    </button>
`,lN="form-associated-proxy",dN="ElementInternals",uN=dN in window&&"setFormValue"in window[dN].prototype,hN=new Map;function FormAssociated(t){const r=class extends t{constructor(...t){super(...t),this.dirtyValue=!1,this.disabled=!1,this.proxyEventsToBlock=["change","click"],this.formDisabledCallback=t=>{this.disabled=t},this.formResetCallback=()=>{this.value=this.initialValue,this.dirtyValue=!1},this.proxyInitialized=!1,this.required=!1,this.initialValue=this.initialValue||""}static get formAssociated(){return uN}get validity(){return this.elementInternals?this.elementInternals.validity:this.proxy.validity}get form(){return this.elementInternals?this.elementInternals.form:this.proxy.form}get validationMessage(){return this.elementInternals?this.elementInternals.validationMessage:this.proxy.validationMessage}get willValidate(){return this.elementInternals?this.elementInternals.willValidate:this.proxy.willValidate}get labels(){if(this.elementInternals)return Object.freeze(Array.from(this.elementInternals.labels));if(this.proxy instanceof HTMLElement&&this.proxy.ownerDocument&&this.id){const t=this.proxy.labels,r=Array.from(this.proxy.getRootNode().querySelectorAll(`[for='${this.id}']`)),o=t?r.concat(Array.from(t)):r;return Object.freeze(o)}return MR}valueChanged(t,r){this.dirtyValue=!0,this.proxy instanceof HTMLElement&&(this.proxy.value=this.value),this.setFormValue(this.value),this.validate()}initialValueChanged(t,r){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}disabledChanged(t,r){this.proxy instanceof HTMLElement&&(this.proxy.disabled=this.disabled),$R.queueUpdate((()=>this.classList.toggle("disabled",this.disabled)))}nameChanged(t,r){this.proxy instanceof HTMLElement&&(this.proxy.name=this.name)}requiredChanged(t,r){this.proxy instanceof HTMLElement&&(this.proxy.required=this.required),$R.queueUpdate((()=>this.classList.toggle("required",this.required))),this.validate()}get elementInternals(){if(!uN)return null;let t=hN.get(this);return t||(t=this.attachInternals(),hN.set(this,t)),t}connectedCallback(){super.connectedCallback(),this.addEventListener("keypress",this._keypressHandler),this.value||(this.value=this.initialValue,this.dirtyValue=!1),this.elementInternals||this.attachProxy(),this.form&&this.form.addEventListener("reset",this.formResetCallback)}disconnectedCallback(){this.proxyEventsToBlock.forEach((t=>this.proxy.removeEventListener(t,this.stopPropagation))),this.form&&this.form.removeEventListener("reset",this.formResetCallback)}checkValidity(){return this.elementInternals?this.elementInternals.checkValidity():this.proxy.checkValidity()}reportValidity(){return this.elementInternals?this.elementInternals.reportValidity():this.proxy.reportValidity()}setValidity(t,r,o){this.elementInternals?this.elementInternals.setValidity(t,r,o):"string"==typeof r&&this.proxy.setCustomValidity(r)}attachProxy(){var t;this.proxyInitialized||(this.proxyInitialized=!0,this.proxy.style.display="none",this.proxyEventsToBlock.forEach((t=>this.proxy.addEventListener(t,this.stopPropagation))),this.proxy.disabled=this.disabled,this.proxy.required=this.required,"string"==typeof this.name&&(this.proxy.name=this.name),"string"==typeof this.value&&(this.proxy.value=this.value),this.proxy.setAttribute("slot",lN),this.proxySlot=document.createElement("slot"),this.proxySlot.setAttribute("name",lN)),null===(t=this.shadowRoot)||void 0===t||t.appendChild(this.proxySlot),this.appendChild(this.proxy)}detachProxy(){var t;this.removeChild(this.proxy),null===(t=this.shadowRoot)||void 0===t||t.removeChild(this.proxySlot)}validate(){this.proxy instanceof HTMLElement&&this.setValidity(this.proxy.validity,this.proxy.validationMessage)}setFormValue(t,r){this.elementInternals&&this.elementInternals.setFormValue(t,r||t)}_keypressHandler(t){if(13===t.keyCode)if(this.form instanceof HTMLFormElement){const t=this.form.querySelector("[type=submit]");null==t||t.click()}}stopPropagation(t){t.stopPropagation()}};return attr({mode:"boolean"})(r.prototype,"disabled"),attr({mode:"fromView",attribute:"value"})(r.prototype,"initialValue"),attr(r.prototype,"name"),attr({mode:"boolean"})(r.prototype,"required"),observable(r.prototype,"value"),r}class _Button extends nO{}class FormAssociatedButton extends(FormAssociated(_Button)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Button extends FormAssociatedButton{constructor(){super(...arguments),this.handleSubmission=()=>{if(!this.form)return;const t=this.proxy.isConnected;t||this.attachProxy(),"function"==typeof this.form.requestSubmit?this.form.requestSubmit(this.proxy):this.proxy.click(),t||this.detachProxy()},this.handleFormReset=()=>{var t;null===(t=this.form)||void 0===t||t.reset()}}formactionChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formAction=this.formaction)}formenctypeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formEnctype=this.formenctype)}formmethodChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formMethod=this.formmethod)}formnovalidateChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formNoValidate=this.formnovalidate)}formtargetChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formTarget=this.formtarget)}typeChanged(t,r){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type),"submit"===r&&this.addEventListener("click",this.handleSubmission),"submit"===t&&this.removeEventListener("click",this.handleSubmission),"reset"===r&&this.addEventListener("click",this.handleFormReset),"reset"===t&&this.removeEventListener("click",this.handleFormReset)}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type",this.type)}get root(){return this.control}}__decorate$o([attr({mode:"boolean"})],Button.prototype,"autofocus",void 0),__decorate$o([attr({attribute:"form"})],Button.prototype,"formId",void 0),__decorate$o([attr],Button.prototype,"formaction",void 0),__decorate$o([attr],Button.prototype,"formenctype",void 0),__decorate$o([attr],Button.prototype,"formmethod",void 0),__decorate$o([attr({mode:"boolean"})],Button.prototype,"formnovalidate",void 0),__decorate$o([attr],Button.prototype,"formtarget",void 0),__decorate$o([attr],Button.prototype,"type",void 0),__decorate$o([observable],Button.prototype,"defaultSlottedContent",void 0);class DelegatesARIAButton{}__decorate$o([attr({attribute:"aria-expanded",mode:"fromView"})],DelegatesARIAButton.prototype,"ariaExpanded",void 0),__decorate$o([attr({attribute:"aria-pressed",mode:"fromView"})],DelegatesARIAButton.prototype,"ariaPressed",void 0),applyMixins(DelegatesARIAButton,ARIAGlobalStatesAndProperties),applyMixins(Button,class StartEnd{handleStartContentChange(){this.startContainer.classList.toggle("start",this.start.assignedNodes().length>0)}handleEndContentChange(){this.endContainer.classList.toggle("end",this.end.assignedNodes().length>0)}},DelegatesARIAButton);const pN=html`
    <slot></slot>
`,fN=html`
    <template
        role="checkbox"
        aria-checked="${t=>t.checked}"
        aria-required="${t=>t.required}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        tabindex="${t=>t.disabled?null:0}"
        @keypress="${(t,r)=>t.keypressHandler(r.event)}"
        @click="${(t,r)=>t.clickHandler(r.event)}"
        class="${t=>t.readOnly?"readonly":""} ${t=>t.checked?"checked":""} ${t=>t.indeterminate?"indeterminate":""}"
    >
        <div part="control" class="control">
            <slot name="checked-indicator">
                <svg
                    aria-hidden="true"
                    part="checked-indicator"
                    class="checked-indicator"
                    viewBox="0 0 20 20"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        fill-rule="evenodd"
                        clip-rule="evenodd"
                        d="M8.143 12.6697L15.235 4.5L16.8 5.90363L8.23812 15.7667L3.80005 11.2556L5.27591 9.7555L8.143 12.6697Z"
                    />
                </svg>
            </slot>
            <slot name="indeterminate-indicator">
                <div part="indeterminate-indicator" class="indeterminate-indicator"></div>
            </slot>
        </div>
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${slotted("defaultSlottedNodes")}></slot>
        </label>
    </template>
`;class _Checkbox extends nO{}class FormAssociatedCheckbox extends(FormAssociated(_Checkbox)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Checkbox extends FormAssociatedCheckbox{constructor(){super(),this.initialValue="on",this.indeterminate=!1,this.dirtyChecked=!1,this.constructed=!1,this.formResetCallback=()=>{this.checked=this.checkedAttribute,this.dirtyChecked=!1},this.keypressHandler=t=>{if(32===t.keyCode)this.checked=!this.checked},this.clickHandler=t=>{this.disabled||this.readOnly||(this.checked=!this.checked)},this.defaultChecked=!!this.checkedAttribute,this.checked=this.defaultChecked,this.constructed=!0}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}checkedAttributeChanged(){this.defaultChecked=this.checkedAttribute}defaultCheckedChanged(){this.dirtyChecked||(this.checked=this.defaultChecked,this.dirtyChecked=!1)}checkedChanged(){this.dirtyChecked||(this.dirtyChecked=!0),this.updateForm(),this.proxy instanceof HTMLInputElement&&(this.proxy.checked=this.checked),this.constructed&&this.$emit("change"),this.validate()}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type","checkbox"),this.updateForm()}updateForm(){const t=this.checked?this.value:null;this.setFormValue(t,t)}}__decorate$o([attr({attribute:"readonly",mode:"boolean"})],Checkbox.prototype,"readOnly",void 0),__decorate$o([attr({attribute:"checked",mode:"boolean"})],Checkbox.prototype,"checkedAttribute",void 0),__decorate$o([observable],Checkbox.prototype,"defaultSlottedNodes",void 0),__decorate$o([observable],Checkbox.prototype,"defaultChecked",void 0),__decorate$o([observable],Checkbox.prototype,"checked",void 0),__decorate$o([observable],Checkbox.prototype,"indeterminate",void 0);class CSSCustomPropertyBehavior{constructor(t,r,o){this.name=t,this.value=r,this.host=o,this.propertyName=`--${t}`,this.var=`var(${this.propertyName})`}bind(t){const r=this.host(t);null!==r&&("function"==typeof r.registerCSSCustomProperty?r.registerCSSCustomProperty(this):(Array.isArray(r.disconnectedCSSCustomPropertyRegistry)||(r.disconnectedCSSCustomPropertyRegistry=[]),r.disconnectedCSSCustomPropertyRegistry.push(this)))}unbind(t){const r=this.host(t);null!==r&&"function"==typeof r.unregisterCSSCustomProperty&&r.unregisterCSSCustomProperty(this)}}function cssCustomPropertyBehaviorFactory(t,r,o){return new CSSCustomPropertyBehavior(t,r,o)}const gN=html`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${when((t=>"number"==typeof t.value),html`
                <svg
                    class="progress"
                    part="progress"
                    viewBox="0 0 16 16"
                    slot="determinate"
                >
                    <circle
                        class="background"
                        part="background"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                    <circle
                        class="determinate"
                        part="determinate"
                        style="stroke-dasharray: ${t=>44*t.value/100}px 44px"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                </svg>
            `)}
        ${when((t=>"number"!=typeof t.value),html`
                <slot name="indeterminate" slot="indeterminate">
                    <svg class="progress" part="progress" viewBox="0 0 16 16">
                        <circle
                            class="background"
                            part="background"
                            cx="8px"
                            cy="8px"
                            r="7px"
                        ></circle>
                        <circle
                            class="indeterminate-indicator-1"
                            part="indeterminate-indicator-1"
                            cx="8px"
                            cy="8px"
                            r="7px"
                        ></circle>
                    </svg>
                </slot>
            `)}
    </template>
`;class BaseProgress extends nO{}__decorate$o([attr({converter:XR})],BaseProgress.prototype,"value",void 0),__decorate$o([attr({converter:XR})],BaseProgress.prototype,"min",void 0),__decorate$o([attr({converter:XR})],BaseProgress.prototype,"max",void 0),__decorate$o([attr({mode:"boolean"})],BaseProgress.prototype,"paused",void 0);const mN=html`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${when((t=>"number"==typeof t.value),html`
                <div class="progress" part="progress" slot="determinate">
                    <div
                        class="determinate"
                        part="determinate"
                        style="width: ${t=>t.value}%"
                    ></div>
                </div>
            `)}
        ${when((t=>"number"!=typeof t.value),html`
                <div class="progress" part="progress" slot="indeterminate">
                    <slot class="indeterminate" name="indeterminate">
                        <span
                            class="indeterminate-indicator-1"
                            part="indeterminate-indicator-1"
                        ></span>
                        <span
                            class="indeterminate-indicator-2"
                            part="indeterminate-indicator-2"
                        ></span>
                    </slot>
                </div>
            `)}
    </template>
`,vN={typeRampMinus2FontSize:"10px",typeRampMinus2LineHeight:"16px",typeRampMinus1FontSize:"12px",typeRampMinus1LineHeight:"16px",typeRampBaseFontSize:"14px",typeRampBaseLineHeight:"20px",typeRampPlus1FontSize:"16px",typeRampPlus1LineHeight:"24px",typeRampPlus2FontSize:"20px",typeRampPlus2LineHeight:"28px",typeRampPlus3FontSize:"28px",typeRampPlus3LineHeight:"36px",typeRampPlus4FontSize:"34px",typeRampPlus4LineHeight:"44px",typeRampPlus5FontSize:"46px",typeRampPlus5LineHeight:"56px",typeRampPlus6FontSize:"60px",typeRampPlus6LineHeight:"72px",accentBaseColor:"#0078D4",accentPalette:["#FFFFFF","#FBFDFE","#F6FAFE","#F2F8FD","#EEF6FC","#E9F4FB","#E5F1FB","#E1EFFA","#DCEDF9","#D8EAF8","#D4E8F8","#CFE6F7","#CBE4F6","#C7E1F6","#C2DFF5","#BEDDF4","#BADAF3","#B6D8F3","#B1D6F2","#ADD4F1","#A9D1F0","#A4CFF0","#A0CDEF","#9CCAEE","#97C8EE","#93C6ED","#8FC4EC","#8AC1EB","#86BFEB","#82BDEA","#7DBAE9","#79B8E8","#75B6E8","#70B3E7","#6CB1E6","#68AFE5","#63ADE5","#5FAAE4","#5BA8E3","#56A6E3","#52A3E2","#4EA1E1","#499FE0","#459DE0","#419ADF","#3D98DE","#3896DD","#3493DD","#3091DC","#2B8FDB","#278DDB","#238ADA","#1E88D9","#1A86D8","#1683D8","#1181D7","#0D7FD6","#097DD5","#047AD5","#0078D4","#0075CF","#0072C9","#006FC4","#006CBE","#0069B9","#0066B4","#0063AE","#0060A9","#005CA3","#00599E","#005699","#005393","#00508E","#004D88","#004A83","#00477D","#004478","#004173","#003E6D","#003B68","#003862","#00355D","#003258","#002F52","#002B4D","#002847","#002542","#00223C","#001F36","#001B30","#00182B","#001525","#00121F","#000000"],backgroundColor:"#FFFFFF",baseHeightMultiplier:8,baseHorizontalSpacingMultiplier:3,cornerRadius:2,elevatedCornerRadius:4,density:0,designUnit:4,direction:ZO.ltr,disabledOpacity:.3,focusOutlineWidth:2,neutralBaseColor:"#808080",neutralPalette:["#FFFFFF","#FCFCFC","#FAFAFA","#F7F7F7","#F5F5F5","#F2F2F2","#EFEFEF","#EDEDED","#EAEAEA","#E8E8E8","#E5E5E5","#E2E2E2","#E0E0E0","#DDDDDD","#DBDBDB","#D8D8D8","#D6D6D6","#D3D3D3","#D0D0D0","#CECECE","#CBCBCB","#C9C9C9","#C6C6C6","#C3C3C3","#C1C1C1","#BEBEBE","#BCBCBC","#B9B9B9","#B6B6B6","#B4B4B4","#B1B1B1","#AFAFAF","#ACACAC","#A9A9A9","#A7A7A7","#A4A4A4","#A2A2A2","#9F9F9F","#9D9D9D","#9A9A9A","#979797","#959595","#929292","#909090","#8D8D8D","#8A8A8A","#888888","#858585","#838383","#808080","#7D7D7D","#7B7B7B","#787878","#767676","#737373","#717171","#6E6E6E","#6B6B6B","#696969","#666666","#646464","#616161","#5F5F5F","#5C5C5C","#5A5A5A","#575757","#545454","#525252","#4F4F4F","#4D4D4D","#4A4A4A","#484848","#454545","#424242","#404040","#3D3D3D","#3B3B3B","#383838","#363636","#333333","#313131","#2E2E2E","#2B2B2B","#292929","#262626","#242424","#212121","#1E1E1E","#1B1B1B","#181818","#151515","#121212","#101010","#000000"],outlineWidth:1,accentFillRestDelta:0,accentFillHoverDelta:4,accentFillActiveDelta:-5,accentFillFocusDelta:0,accentFillSelectedDelta:12,accentForegroundRestDelta:0,accentForegroundHoverDelta:6,accentForegroundActiveDelta:-4,accentForegroundFocusDelta:0,neutralFillRestDelta:7,neutralFillHoverDelta:10,neutralFillActiveDelta:5,neutralFillFocusDelta:0,neutralFillSelectedDelta:7,neutralFillInputRestDelta:0,neutralFillInputHoverDelta:0,neutralFillInputActiveDelta:0,neutralFillInputFocusDelta:0,neutralFillInputSelectedDelta:0,neutralFillStealthRestDelta:0,neutralFillStealthHoverDelta:5,neutralFillStealthActiveDelta:3,neutralFillStealthFocusDelta:0,neutralFillStealthSelectedDelta:7,neutralFillToggleHoverDelta:8,neutralFillToggleActiveDelta:-5,neutralFillToggleFocusDelta:0,baseLayerLuminance:-1,neutralFillCardDelta:3,neutralForegroundHoverDelta:0,neutralForegroundActiveDelta:0,neutralForegroundFocusDelta:0,neutralDividerRestDelta:8,neutralOutlineRestDelta:25,neutralOutlineHoverDelta:40,neutralOutlineActiveDelta:16,neutralOutlineFocusDelta:25,neutralContrastFillRestDelta:0,neutralContrastFillHoverDelta:-3,neutralContrastFillActiveDelta:7,neutralContrastFillFocusDelta:0};function evaluateDesignSystemResolver(t,r){return"function"==typeof t?t(r):t}function getDesignSystemValue(t){return r=>r&&void 0!==r[t]?r[t]:vN[t]}const yN=getDesignSystemValue("backgroundColor"),bN=getDesignSystemValue("accentBaseColor"),wN=getDesignSystemValue("neutralPalette"),CN=getDesignSystemValue("accentPalette"),_N=getDesignSystemValue("direction"),kN=getDesignSystemValue("accentFillHoverDelta"),SN=getDesignSystemValue("accentFillActiveDelta"),TN=getDesignSystemValue("accentFillFocusDelta"),EN=getDesignSystemValue("accentFillSelectedDelta"),xN=getDesignSystemValue("accentForegroundRestDelta"),IN=getDesignSystemValue("accentForegroundHoverDelta"),AN=getDesignSystemValue("accentForegroundActiveDelta"),PN=getDesignSystemValue("accentForegroundFocusDelta"),RN=getDesignSystemValue("neutralFillRestDelta"),ON=getDesignSystemValue("neutralFillHoverDelta"),NN=getDesignSystemValue("neutralFillActiveDelta"),MN=getDesignSystemValue("neutralFillFocusDelta"),DN=getDesignSystemValue("neutralFillSelectedDelta"),FN=getDesignSystemValue("neutralFillInputRestDelta"),LN=getDesignSystemValue("neutralFillInputHoverDelta"),UN=getDesignSystemValue("neutralFillInputActiveDelta"),BN=getDesignSystemValue("neutralFillInputFocusDelta"),HN=getDesignSystemValue("neutralFillInputSelectedDelta"),$N=getDesignSystemValue("neutralFillStealthRestDelta"),qN=getDesignSystemValue("neutralFillStealthHoverDelta"),jN=getDesignSystemValue("neutralFillStealthActiveDelta"),zN=getDesignSystemValue("neutralFillStealthFocusDelta"),GN=getDesignSystemValue("neutralFillStealthSelectedDelta"),VN=getDesignSystemValue("neutralFillToggleHoverDelta"),KN=getDesignSystemValue("neutralFillToggleActiveDelta"),WN=getDesignSystemValue("neutralFillToggleFocusDelta"),QN=getDesignSystemValue("baseLayerLuminance"),YN=getDesignSystemValue("neutralFillCardDelta"),JN=getDesignSystemValue("neutralForegroundHoverDelta"),XN=getDesignSystemValue("neutralForegroundActiveDelta"),ZN=getDesignSystemValue("neutralForegroundFocusDelta"),eM=getDesignSystemValue("neutralDividerRestDelta"),tM=getDesignSystemValue("neutralOutlineRestDelta"),rM=getDesignSystemValue("neutralOutlineHoverDelta"),oM=getDesignSystemValue("neutralOutlineActiveDelta"),nM=getDesignSystemValue("neutralOutlineFocusDelta"),iM=getDesignSystemValue("neutralContrastFillHoverDelta"),sM=getDesignSystemValue("neutralContrastFillActiveDelta"),aM=getDesignSystemValue("neutralContrastFillFocusDelta");function clamp$1(t,r,o){return isNaN(t)||t<=r?r:t>=o?o:t}function normalize(t,r,o){return isNaN(t)||t<=r?0:t>=o?1:t/(o-r)}function denormalize(t,r,o){return isNaN(t)?r:r+t*(o-r)}function degreesToRadians(t){return t*(Math.PI/180)}function lerp(t,r,o){return isNaN(t)||t<=0?r:t>=1?o:r+t*(o-r)}function lerpAnglesInDegrees(t,r,o){if(t<=0)return r%360;if(t>=1)return o%360;const i=(r-o+360)%360;return i<=(o-r+360)%360?(r-i*t+360)%360:(r+i*t+360)%360}function roundToPrecisionSmall(t,r){const o=Math.pow(10,r);return Math.round(t*o)/o}class ColorHSL{constructor(t,r,o){this.h=t,this.s=r,this.l=o}static fromObject(t){return!t||isNaN(t.h)||isNaN(t.s)||isNaN(t.l)?null:new ColorHSL(t.h,t.s,t.l)}equalValue(t){return this.h===t.h&&this.s===t.s&&this.l===t.l}roundToPrecision(t){return new ColorHSL(roundToPrecisionSmall(this.h,t),roundToPrecisionSmall(this.s,t),roundToPrecisionSmall(this.l,t))}toObject(){return{h:this.h,s:this.s,l:this.l}}}class ColorHSV{constructor(t,r,o){this.h=t,this.s=r,this.v=o}static fromObject(t){return!t||isNaN(t.h)||isNaN(t.s)||isNaN(t.v)?null:new ColorHSV(t.h,t.s,t.v)}equalValue(t){return this.h===t.h&&this.s===t.s&&this.v===t.v}roundToPrecision(t){return new ColorHSV(roundToPrecisionSmall(this.h,t),roundToPrecisionSmall(this.s,t),roundToPrecisionSmall(this.v,t))}toObject(){return{h:this.h,s:this.s,v:this.v}}}class ColorLAB{constructor(t,r,o){this.l=t,this.a=r,this.b=o}static fromObject(t){return!t||isNaN(t.l)||isNaN(t.a)||isNaN(t.b)?null:new ColorLAB(t.l,t.a,t.b)}equalValue(t){return this.l===t.l&&this.a===t.a&&this.b===t.b}roundToPrecision(t){return new ColorLAB(roundToPrecisionSmall(this.l,t),roundToPrecisionSmall(this.a,t),roundToPrecisionSmall(this.b,t))}toObject(){return{l:this.l,a:this.a,b:this.b}}}ColorLAB.epsilon=216/24389,ColorLAB.kappa=24389/27;class ColorLCH{constructor(t,r,o){this.l=t,this.c=r,this.h=o}static fromObject(t){return!t||isNaN(t.l)||isNaN(t.c)||isNaN(t.h)?null:new ColorLCH(t.l,t.c,t.h)}equalValue(t){return this.l===t.l&&this.c===t.c&&this.h===t.h}roundToPrecision(t){return new ColorLCH(roundToPrecisionSmall(this.l,t),roundToPrecisionSmall(this.c,t),roundToPrecisionSmall(this.h,t))}toObject(){return{l:this.l,c:this.c,h:this.h}}}class ColorRGBA64{constructor(t,r,o,i){this.r=t,this.g=r,this.b=o,this.a="number"!=typeof i||isNaN(i)?1:i}static fromObject(t){return!t||isNaN(t.r)||isNaN(t.g)||isNaN(t.b)?null:new ColorRGBA64(t.r,t.g,t.b,t.a)}equalValue(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}toStringHexRGB(){return"#"+[this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringHexRGBA(){return this.toStringHexRGB()+this.formatHexValue(this.a)}toStringHexARGB(){return"#"+[this.a,this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringWebRGB(){return`rgb(${Math.round(denormalize(this.r,0,255))},${Math.round(denormalize(this.g,0,255))},${Math.round(denormalize(this.b,0,255))})`}toStringWebRGBA(){return`rgba(${Math.round(denormalize(this.r,0,255))},${Math.round(denormalize(this.g,0,255))},${Math.round(denormalize(this.b,0,255))},${clamp$1(this.a,0,1)})`}roundToPrecision(t){return new ColorRGBA64(roundToPrecisionSmall(this.r,t),roundToPrecisionSmall(this.g,t),roundToPrecisionSmall(this.b,t),roundToPrecisionSmall(this.a,t))}clamp(){return new ColorRGBA64(clamp$1(this.r,0,1),clamp$1(this.g,0,1),clamp$1(this.b,0,1),clamp$1(this.a,0,1))}toObject(){return{r:this.r,g:this.g,b:this.b,a:this.a}}formatHexValue(t){return function getHexStringForByte(t){const r=Math.round(clamp$1(t,0,255)).toString(16);return 1===r.length?"0"+r:r}(denormalize(t,0,255))}}class ColorXYZ{constructor(t,r,o){this.x=t,this.y=r,this.z=o}static fromObject(t){return!t||isNaN(t.x)||isNaN(t.y)||isNaN(t.z)?null:new ColorXYZ(t.x,t.y,t.z)}equalValue(t){return this.x===t.x&&this.y===t.y&&this.z===t.z}roundToPrecision(t){return new ColorXYZ(roundToPrecisionSmall(this.x,t),roundToPrecisionSmall(this.y,t),roundToPrecisionSmall(this.z,t))}toObject(){return{x:this.x,y:this.y,z:this.z}}}function rgbToLinearLuminance(t){return.2126*t.r+.7152*t.g+.0722*t.b}function rgbToRelativeLuminance(t){function luminanceHelper(t){return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}return rgbToLinearLuminance(new ColorRGBA64(luminanceHelper(t.r),luminanceHelper(t.g),luminanceHelper(t.b),1))}ColorXYZ.whitePoint=new ColorXYZ(.95047,1,1.08883);const calculateContrastRatio=(t,r)=>(t+.05)/(r+.05);function contrastRatio(t,r){const o=rgbToRelativeLuminance(t),i=rgbToRelativeLuminance(r);return o>i?calculateContrastRatio(o,i):calculateContrastRatio(i,o)}function rgbToHSL(t){const r=Math.max(t.r,t.g,t.b),o=Math.min(t.r,t.g,t.b),i=r-o;let s=0;0!==i&&(s=r===t.r?(t.g-t.b)/i%6*60:r===t.g?60*((t.b-t.r)/i+2):60*((t.r-t.g)/i+4)),s<0&&(s+=360);const l=(r+o)/2;let u=0;return 0!==i&&(u=i/(1-Math.abs(2*l-1))),new ColorHSL(s,u,l)}function hslToRGB(t,r=1){const o=(1-Math.abs(2*t.l-1))*t.s,i=o*(1-Math.abs(t.h/60%2-1)),s=t.l-o/2;let l=0,u=0,h=0;return t.h<60?(l=o,u=i,h=0):t.h<120?(l=i,u=o,h=0):t.h<180?(l=0,u=o,h=i):t.h<240?(l=0,u=i,h=o):t.h<300?(l=i,u=0,h=o):t.h<360&&(l=o,u=0,h=i),new ColorRGBA64(l+s,u+s,h+s,r)}function rgbToHSV(t){const r=Math.max(t.r,t.g,t.b),o=r-Math.min(t.r,t.g,t.b);let i=0;0!==o&&(i=r===t.r?(t.g-t.b)/o%6*60:r===t.g?60*((t.b-t.r)/o+2):60*((t.r-t.g)/o+4)),i<0&&(i+=360);let s=0;return 0!==r&&(s=o/r),new ColorHSV(i,s,r)}function labToLCH(t){let r=0;(Math.abs(t.b)>.001||Math.abs(t.a)>.001)&&(r=function radiansToDegrees(t){return t*(180/Math.PI)}(Math.atan2(t.b,t.a))),r<0&&(r+=360);const o=Math.sqrt(t.a*t.a+t.b*t.b);return new ColorLCH(t.l,o,r)}function rgbToXYZ(t){function rgbToXYZHelper(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}const r=rgbToXYZHelper(t.r),o=rgbToXYZHelper(t.g),i=rgbToXYZHelper(t.b);return new ColorXYZ(.4124564*r+.3575761*o+.1804375*i,.2126729*r+.7151522*o+.072175*i,.0193339*r+.119192*o+.9503041*i)}function xyzToRGB(t,r=1){function xyzToRGBHelper(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055}const o=xyzToRGBHelper(3.2404542*t.x-1.5371385*t.y-.4985314*t.z),i=xyzToRGBHelper(-.969266*t.x+1.8760108*t.y+.041556*t.z),s=xyzToRGBHelper(.0556434*t.x-.2040259*t.y+1.0572252*t.z);return new ColorRGBA64(o,i,s,r)}function rgbToLAB(t){return function xyzToLAB(t){function xyzToLABHelper(t){return t>ColorLAB.epsilon?Math.pow(t,1/3):(ColorLAB.kappa*t+16)/116}const r=xyzToLABHelper(t.x/ColorXYZ.whitePoint.x),o=xyzToLABHelper(t.y/ColorXYZ.whitePoint.y),i=xyzToLABHelper(t.z/ColorXYZ.whitePoint.z);return new ColorLAB(116*o-16,500*(r-o),200*(o-i))}(rgbToXYZ(t))}function labToRGB(t,r=1){return xyzToRGB(function labToXYZ(t){const r=(t.l+16)/116,o=r+t.a/500,i=r-t.b/200,s=Math.pow(o,3),l=Math.pow(r,3),u=Math.pow(i,3);let h=0;h=s>ColorLAB.epsilon?s:(116*o-16)/ColorLAB.kappa;let m=0;m=t.l>ColorLAB.epsilon*ColorLAB.kappa?l:t.l/ColorLAB.kappa;let v=0;return v=u>ColorLAB.epsilon?u:(116*i-16)/ColorLAB.kappa,h=ColorXYZ.whitePoint.x*h,m=ColorXYZ.whitePoint.y*m,v=ColorXYZ.whitePoint.z*v,new ColorXYZ(h,m,v)}(t),r)}function rgbToLCH(t){return labToLCH(rgbToLAB(t))}function lchToRGB(t,r=1){return labToRGB(function lchToLAB(t){let r=0,o=0;return 0!==t.h&&(r=Math.cos(degreesToRadians(t.h))*t.c,o=Math.sin(degreesToRadians(t.h))*t.c),new ColorLAB(t.l,r,o)}(t),r)}function saturateViaLCH(t,r,o=18){const i=rgbToLCH(t);let s=i.c+r*o;return s<0&&(s=0),lchToRGB(new ColorLCH(i.l,s,i.h))}function blendMultiplyChannel(t,r){return t*r}function blendMultiply(t,r){return new ColorRGBA64(blendMultiplyChannel(t.r,r.r),blendMultiplyChannel(t.g,r.g),blendMultiplyChannel(t.b,r.b),1)}function blendOverlayChannel(t,r){return clamp$1(t<.5?2*r*t:1-2*(1-r)*(1-t),0,1)}function blendOverlay(t,r){return new ColorRGBA64(blendOverlayChannel(t.r,r.r),blendOverlayChannel(t.g,r.g),blendOverlayChannel(t.b,r.b),1)}var cM,lM;function interpolateByColorSpace(t,r,o,i){if(isNaN(t)||t<=0)return o;if(t>=1)return i;switch(r){case lM.HSL:return hslToRGB(function interpolateHSL(t,r,o){return isNaN(t)||t<=0?r:t>=1?o:new ColorHSL(lerpAnglesInDegrees(t,r.h,o.h),lerp(t,r.s,o.s),lerp(t,r.l,o.l))}(t,rgbToHSL(o),rgbToHSL(i)));case lM.HSV:return function hsvToRGB(t,r=1){const o=t.s*t.v,i=o*(1-Math.abs(t.h/60%2-1)),s=t.v-o;let l=0,u=0,h=0;return t.h<60?(l=o,u=i,h=0):t.h<120?(l=i,u=o,h=0):t.h<180?(l=0,u=o,h=i):t.h<240?(l=0,u=i,h=o):t.h<300?(l=i,u=0,h=o):t.h<360&&(l=o,u=0,h=i),new ColorRGBA64(l+s,u+s,h+s,r)}(function interpolateHSV(t,r,o){return isNaN(t)||t<=0?r:t>=1?o:new ColorHSV(lerpAnglesInDegrees(t,r.h,o.h),lerp(t,r.s,o.s),lerp(t,r.v,o.v))}(t,rgbToHSV(o),rgbToHSV(i)));case lM.XYZ:return xyzToRGB(function interpolateXYZ(t,r,o){return isNaN(t)||t<=0?r:t>=1?o:new ColorXYZ(lerp(t,r.x,o.x),lerp(t,r.y,o.y),lerp(t,r.z,o.z))}(t,rgbToXYZ(o),rgbToXYZ(i)));case lM.LAB:return labToRGB(function interpolateLAB(t,r,o){return isNaN(t)||t<=0?r:t>=1?o:new ColorLAB(lerp(t,r.l,o.l),lerp(t,r.a,o.a),lerp(t,r.b,o.b))}(t,rgbToLAB(o),rgbToLAB(i)));case lM.LCH:return lchToRGB(function interpolateLCH(t,r,o){return isNaN(t)||t<=0?r:t>=1?o:new ColorLCH(lerp(t,r.l,o.l),lerp(t,r.c,o.c),lerpAnglesInDegrees(t,r.h,o.h))}(t,rgbToLCH(o),rgbToLCH(i)));default:return function interpolateRGB(t,r,o){return isNaN(t)||t<=0?r:t>=1?o:new ColorRGBA64(lerp(t,r.r,o.r),lerp(t,r.g,o.g),lerp(t,r.b,o.b),lerp(t,r.a,o.a))}(t,o,i)}}!function(t){t[t.Burn=0]="Burn",t[t.Color=1]="Color",t[t.Darken=2]="Darken",t[t.Dodge=3]="Dodge",t[t.Lighten=4]="Lighten",t[t.Multiply=5]="Multiply",t[t.Overlay=6]="Overlay",t[t.Screen=7]="Screen"}(cM||(cM={})),function(t){t[t.RGB=0]="RGB",t[t.HSL=1]="HSL",t[t.HSV=2]="HSV",t[t.XYZ=3]="XYZ",t[t.LAB=4]="LAB",t[t.LCH=5]="LCH"}(lM||(lM={}));class ColorScale{constructor(t){if(null==t||0===t.length)throw new Error("The stops argument must be non-empty");this.stops=this.sortColorScaleStops(t)}static createBalancedColorScale(t){if(null==t||0===t.length)throw new Error("The colors argument must be non-empty");const r=new Array(t.length);for(let o=0;o<t.length;o++)0===o?r[o]={color:t[o],position:0}:o===t.length-1?r[o]={color:t[o],position:1}:r[o]={color:t[o],position:o*(1/(t.length-1))};return new ColorScale(r)}getColor(t,r=lM.RGB){if(1===this.stops.length)return this.stops[0].color;if(t<=0)return this.stops[0].color;if(t>=1)return this.stops[this.stops.length-1].color;let o=0;for(let r=0;r<this.stops.length;r++)this.stops[r].position<=t&&(o=r);let i=o+1;i>=this.stops.length&&(i=this.stops.length-1);return interpolateByColorSpace((t-this.stops[o].position)*(1/(this.stops[i].position-this.stops[o].position)),r,this.stops[o].color,this.stops[i].color)}trim(t,r,o=lM.RGB){if(t<0||r>1||r<t)throw new Error("Invalid bounds");if(t===r)return new ColorScale([{color:this.getColor(t,o),position:0}]);const i=[];for(let o=0;o<this.stops.length;o++)this.stops[o].position>=t&&this.stops[o].position<=r&&i.push(this.stops[o]);if(0===i.length)return new ColorScale([{color:this.getColor(t),position:t},{color:this.getColor(r),position:r}]);i[0].position!==t&&i.unshift({color:this.getColor(t),position:t}),i[i.length-1].position!==r&&i.push({color:this.getColor(r),position:r});const s=r-t,l=new Array(i.length);for(let r=0;r<i.length;r++)l[r]={color:i[r].color,position:(i[r].position-t)/s};return new ColorScale(l)}findNextColor(t,r,o=!1,i=lM.RGB,s=.005,l=32){isNaN(t)||t<=0?t=0:t>=1&&(t=1);const u=this.getColor(t,i),h=o?0:1;if(contrastRatio(u,this.getColor(h,i))<=r)return h;let m=o?0:t,v=o?t:0,C=h,_=0;for(;_<=l;){C=Math.abs(v-m)/2+m;const t=contrastRatio(u,this.getColor(C,i));if(Math.abs(t-r)<=s)return C;t>r?o?m=C:v=C:o?v=C:m=C,_++}return C}clone(){const t=new Array(this.stops.length);for(let r=0;r<t.length;r++)t[r]={color:this.stops[r].color,position:this.stops[r].position};return new ColorScale(t)}sortColorScaleStops(t){return t.sort(((t,r)=>{const o=t.position,i=r.position;return o<i?-1:o>i?1:0}))}}const dM=/^rgb\(\s*((?:(?:25[0-5]|2[0-4]\d|1\d\d|\d{1,2})\s*,\s*){2}(?:25[0-5]|2[0-4]\d|1\d\d|\d{1,2})\s*)\)$/i,uM=/^#((?:[0-9a-f]{6}|[0-9a-f]{3}))$/i;function parseColorHexRGB(t){const r=uM.exec(t);if(null===r)return null;let o=r[1];if(3===o.length){const t=o.charAt(0),r=o.charAt(1),i=o.charAt(2);o=t.concat(t,r,r,i,i)}const i=parseInt(o,16);return isNaN(i)?null:new ColorRGBA64(normalize((16711680&i)>>>16,0,255),normalize((65280&i)>>>8,0,255),normalize(255&i,0,255),1)}class ColorPalette{constructor(t){this.config=Object.assign({},ColorPalette.defaultPaletteConfig,t),this.palette=[],this.updatePaletteColors()}updatePaletteGenerationValues(t){let r=!1;for(const o in t)this.config[o]&&(this.config[o].equalValue?this.config[o].equalValue(t[o])||(this.config[o]=t[o],r=!0):t[o]!==this.config[o]&&(this.config[o]=t[o],r=!0));return r&&this.updatePaletteColors(),r}updatePaletteColors(){const t=this.generatePaletteColorScale();for(let r=0;r<this.config.steps;r++)this.palette[r]=t.getColor(r/(this.config.steps-1),this.config.interpolationMode)}generatePaletteColorScale(){const t=rgbToHSL(this.config.baseColor),r=new ColorScale([{position:0,color:this.config.scaleColorLight},{position:.5,color:this.config.baseColor},{position:1,color:this.config.scaleColorDark}]).trim(this.config.clipLight,1-this.config.clipDark);let o=r.getColor(0),i=r.getColor(1);if(t.s>=this.config.saturationAdjustmentCutoff&&(o=saturateViaLCH(o,this.config.saturationLight),i=saturateViaLCH(i,this.config.saturationDark)),0!==this.config.multiplyLight){const t=blendMultiply(this.config.baseColor,o);o=interpolateByColorSpace(this.config.multiplyLight,this.config.interpolationMode,o,t)}if(0!==this.config.multiplyDark){const t=blendMultiply(this.config.baseColor,i);i=interpolateByColorSpace(this.config.multiplyDark,this.config.interpolationMode,i,t)}if(0!==this.config.overlayLight){const t=blendOverlay(this.config.baseColor,o);o=interpolateByColorSpace(this.config.overlayLight,this.config.interpolationMode,o,t)}if(0!==this.config.overlayDark){const t=blendOverlay(this.config.baseColor,i);i=interpolateByColorSpace(this.config.overlayDark,this.config.interpolationMode,i,t)}return this.config.baseScalePosition?this.config.baseScalePosition<=0?new ColorScale([{position:0,color:this.config.baseColor},{position:1,color:i.clamp()}]):this.config.baseScalePosition>=1?new ColorScale([{position:0,color:o.clamp()},{position:1,color:this.config.baseColor}]):new ColorScale([{position:0,color:o.clamp()},{position:this.config.baseScalePosition,color:this.config.baseColor},{position:1,color:i.clamp()}]):new ColorScale([{position:0,color:o.clamp()},{position:.5,color:this.config.baseColor},{position:1,color:i.clamp()}])}}ColorPalette.defaultPaletteConfig={baseColor:parseColorHexRGB("#808080"),steps:11,interpolationMode:lM.RGB,scaleColorLight:new ColorRGBA64(1,1,1,1),scaleColorDark:new ColorRGBA64(0,0,0,1),clipLight:.185,clipDark:.16,saturationAdjustmentCutoff:.05,saturationLight:.35,saturationDark:1.25,overlayLight:0,overlayDark:.25,multiplyLight:0,multiplyDark:0,baseScalePosition:.5},ColorPalette.greyscalePaletteConfig={baseColor:parseColorHexRGB("#808080"),steps:11,interpolationMode:lM.RGB,scaleColorLight:new ColorRGBA64(1,1,1,1),scaleColorDark:new ColorRGBA64(0,0,0,1),clipLight:0,clipDark:0,saturationAdjustmentCutoff:0,saturationLight:0,saturationDark:0,overlayLight:0,overlayDark:0,multiplyLight:0,multiplyDark:0,baseScalePosition:.5},ColorPalette.defaultPaletteConfig.scaleColorLight,ColorPalette.defaultPaletteConfig.scaleColorDark;class ComponentStateColorPalette{constructor(t){this.palette=[],this.config=Object.assign({},ComponentStateColorPalette.defaultPaletteConfig,t),this.regenPalettes()}regenPalettes(){let t=this.config.steps;(isNaN(t)||t<3)&&(t=3);const r=.14,o=new ColorRGBA64(r,r,r,1),i=new ColorPalette(Object.assign(Object.assign({},ColorPalette.greyscalePaletteConfig),{baseColor:o,baseScalePosition:86/94,steps:t})).palette,s=(rgbToLinearLuminance(this.config.baseColor)+rgbToHSL(this.config.baseColor).l)/2,l=this.matchRelativeLuminanceIndex(s,i)/(t-1),u=this.matchRelativeLuminanceIndex(r,i)/(t-1),h=rgbToHSL(this.config.baseColor),m=hslToRGB(ColorHSL.fromObject({h:h.h,s:h.s,l:r})),v=hslToRGB(ColorHSL.fromObject({h:h.h,s:h.s,l:.06})),C=new Array(5);C[0]={position:0,color:new ColorRGBA64(1,1,1,1)},C[1]={position:l,color:this.config.baseColor},C[2]={position:u,color:m},C[3]={position:.99,color:v},C[4]={position:1,color:new ColorRGBA64(0,0,0,1)};const _=new ColorScale(C);this.palette=new Array(t);for(let r=0;r<t;r++){const o=_.getColor(r/(t-1),lM.RGB);this.palette[r]=o}}matchRelativeLuminanceIndex(t,r){let o=Number.MAX_VALUE,i=0,s=0;const l=r.length;for(;s<l;s++){const l=Math.abs(rgbToLinearLuminance(r[s])-t);l<o&&(o=l,i=s)}return i}}var hM;function colorRecipeFactory(t){const r=memoize(t);return function curryRecipe(t){return"function"==typeof t?o=>r(Object.assign({},o,{backgroundColor:t(o)})):r(t)}}function swatchFamilyToSwatchRecipeFactory(t,r){const o=memoize(r);return r=>"function"==typeof r?i=>o(Object.assign({},i,{backgroundColor:r(i)}))[t]:o(r)[t]}ComponentStateColorPalette.defaultPaletteConfig={baseColor:parseColorHexRGB("#808080"),steps:94},function(t){t.rest="rest",t.hover="hover",t.active="active",t.focus="focus",t.selected="selected"}(hM||(hM={}));const pM=new Map;function parseColorString(t){const r=pM.get(t);if(!r){let r=parseColorHexRGB(t);if(null===r&&(r=function parseColorWebRGB(t){const r=dM.exec(t);if(null===r)return null;const o=r[1].split(",");return new ColorRGBA64(normalize(Number(o[0]),0,255),normalize(Number(o[1]),0,255),normalize(Number(o[2]),0,255),1)}(t)),null===r)throw new Error(`${t} cannot be converted to a ColorRGBA64. Color strings must be one of the following formats: "#RGB", "#RRGGBB", or "rgb(r, g, b)"`);return pM.set(t,r),r}return r}function isValidColor(t){return function isColorStringHexRGB(t){return uM.test(t)}(t)||function isColorStringWebRGB(t){return dM.test(t)}(t)}const fM=memoize(((t,r)=>contrastRatio(parseColorString(t),parseColorString(r))),((t,r)=>t+r));function luminance(t){return rgbToRelativeLuminance(parseColorString(t))}function designSystemResolverMax(...t){return r=>Math.max.apply(null,t.map((t=>t(r))))}const clamp=(t,r,o)=>Math.min(Math.max(t,r),o);var gM;function findSwatchIndex(t,r){return o=>{if(!isValidColor(r))return-1;const i=evaluateDesignSystemResolver(t,o),s=i.indexOf(r);return-1!==s?s:i.findIndex((t=>isValidColor(t)&&function colorMatches(t,r){return parseColorString(t).equalValue(parseColorString(r))}(r,t)))}}function findClosestSwatchIndex(t,r){return o=>{const i=evaluateDesignSystemResolver(t,o),s=evaluateDesignSystemResolver(r,o),l=findSwatchIndex(i,s)(o);let u;if(-1!==l)return l;try{u=luminance(s)}catch(t){u=-1}return-1===u?0:i.map(((t,r)=>({luminance:luminance(t),index:r}))).reduce(((t,r)=>Math.abs(r.luminance-u)<Math.abs(t.luminance-u)?r:t)).index}}function isDarkMode(t){return luminance(yN(t))<=(-.1+Math.sqrt(.21))/2}function getSwatch(t,r){return"function"==typeof t?o=>r(o)[clamp(t(o),0,r(o).length-1)]:r[clamp(t,0,r.length-1)]}function swatchByMode(t){return(r,o)=>i=>getSwatch(isDarkMode(i)?evaluateDesignSystemResolver(o,i):evaluateDesignSystemResolver(r,i),t(i))}function binarySearch(t,r,o=0,i=t.length-1){if(i===o)return t[o];const s=Math.floor((i-o)/2)+o;return r(t[s])?binarySearch(t,r,o,s):binarySearch(t,r,s+1,i)}function swatchByContrast(t){return r=>o=>i=>s=>l=>{const u=evaluateDesignSystemResolver(t,l),h=evaluateDesignSystemResolver(r,l),m=h.length,v=clamp(o(u,h,l),0,m-1),C=i(v,h,l);const _=[].concat(h),k=m-1;let E=v;return-1===C&&(_.reverse(),E=k-E),binarySearch(_,(function contrastSearchCondition(t){return s(fM(u,t))}),E,k)}}function referenceColorInitialIndexResolver(t,r,o){return findClosestSwatchIndex(r,t)(o)}function findClosestBackgroundIndex(t){return findClosestSwatchIndex(wN,yN(t))(t)}function accessibleAlgorithm(t,r,o,i,s,l){return u=>{const h=evaluateDesignSystemResolver(t,u),m=isDarkMode(u)?-1:1,v=swatchByContrast(yN)(h)(referenceColorInitialIndexResolver)((()=>m))(function minContrastTargetFactory(t){return r=>r>=t}(evaluateDesignSystemResolver(r,u)))(u),C=findSwatchIndex(t,v)(u),_=evaluateDesignSystemResolver(o,u),k=evaluateDesignSystemResolver(i,u),E=evaluateDesignSystemResolver(s,u),R=evaluateDesignSystemResolver(l,u);return function indexToSwatchFamily(t,r,o,i,s,l,u){const h=t+o*Math.abs(i-s),m=1===o?i<s:o*i>o*s,v=m?t:h,C=m?h:t,_=v+o*l,k=v+o*u;return{rest:getSwatch(v,r),hover:getSwatch(C,r),active:getSwatch(_,r),focus:getSwatch(k,r)}}(C,h,m,_,k,E,R)}}!function(t){t.neutral="neutral",t.accent="accent"}(gM||(gM={}));const mM=colorRecipeFactory(accessibleAlgorithm(wN,14,0,JN,XN,ZN)),vM=swatchFamilyToSwatchRecipeFactory(hM.rest,mM);swatchFamilyToSwatchRecipeFactory(hM.hover,mM),swatchFamilyToSwatchRecipeFactory(hM.active,mM),swatchFamilyToSwatchRecipeFactory(hM.focus,mM);const yM="#FFFFFF",bM="#000000",wM=colorRecipeFactory(accessibleAlgorithm(wN,4.5,0,VN,KN,WN)),CM=swatchFamilyToSwatchRecipeFactory(hM.rest,wM);swatchFamilyToSwatchRecipeFactory(hM.hover,wM),swatchFamilyToSwatchRecipeFactory(hM.active,wM),swatchFamilyToSwatchRecipeFactory(hM.focus,wM);const neutralForegroundToggleAlgorithm=(t,r)=>fM(yM,t)>=r?yM:bM;function neutralForegroundToggleFactory(t){return function neutralForegroundToggleInternal(r){return"function"==typeof r?o=>neutralForegroundToggleAlgorithm(r(o),t):neutralForegroundToggleAlgorithm(CM(r),t)}}const _M=neutralForegroundToggleFactory(4.5),kM=neutralForegroundToggleFactory(3),accentForegroundCutAlgorithm=(t,r)=>fM(yM,t)>=r?yM:bM;const SM=function accentForegroundCutFactory(t){return function accentForegroundCutInternal(r){return"function"==typeof r?o=>accentForegroundCutAlgorithm(r(o),t):accentForegroundCutAlgorithm(bN(r),t)}}(4.5);function neutralForegroundHintAlgorithm(t){return accessibleAlgorithm(wN,t,0,0,0,0)}const TM=swatchFamilyToSwatchRecipeFactory(hM.rest,colorRecipeFactory(neutralForegroundHintAlgorithm(4.5))),EM=swatchFamilyToSwatchRecipeFactory(hM.rest,colorRecipeFactory(neutralForegroundHintAlgorithm(3)));function accentForegroundAlgorithm(t){return r=>{const o=CN(r),i=bN(r),s=findClosestSwatchIndex(CN,i)(r),l={rest:xN(r),hover:IN(r),active:AN(r),focus:PN(r)},u=isDarkMode(r)?-1:1,h=s+(1===u?Math.min(l.rest,l.hover):Math.max(u*l.rest,u*l.hover)),m=swatchByContrast(yN)(CN)((()=>h))((()=>u))((r=>r>=t))(r),v=findSwatchIndex(CN,m)(r),C=v+u*Math.abs(l.rest-l.hover),_=1===u?l.rest<l.hover:u*l.rest>u*l.hover,k=_?v:C,E=_?C:v,R=k+u*l.active,N=k+u*l.focus;return{rest:getSwatch(k,o),hover:getSwatch(E,o),active:getSwatch(R,o),focus:getSwatch(N,o)}}}const xM=colorRecipeFactory(accentForegroundAlgorithm(4.5)),IM=colorRecipeFactory(accentForegroundAlgorithm(3));swatchFamilyToSwatchRecipeFactory(hM.rest,xM),swatchFamilyToSwatchRecipeFactory(hM.hover,xM),swatchFamilyToSwatchRecipeFactory(hM.active,xM),swatchFamilyToSwatchRecipeFactory(hM.focus,xM),swatchFamilyToSwatchRecipeFactory(hM.rest,IM),swatchFamilyToSwatchRecipeFactory(hM.hover,IM),swatchFamilyToSwatchRecipeFactory(hM.active,IM),swatchFamilyToSwatchRecipeFactory(hM.focus,IM);const AM=designSystemResolverMax(RN,ON,NN,MN);function neutralFillAlgorithm(t){return r=>{const o=findClosestBackgroundIndex(r);return getSwatch(o+(o>=AM(r)?-1:1)*t(r),wN(r))}}const PM=colorRecipeFactory(neutralFillAlgorithm(RN)),RM=colorRecipeFactory(neutralFillAlgorithm(ON)),OM=colorRecipeFactory(neutralFillAlgorithm(NN)),NM=colorRecipeFactory(neutralFillAlgorithm(MN)),MM=colorRecipeFactory(neutralFillAlgorithm(DN)),DM=colorRecipeFactory((t=>({rest:PM(t),hover:RM(t),active:OM(t),focus:NM(t),selected:MM(t)}))),FM=designSystemResolverMax(RN,ON,NN,MN,$N,qN,jN,zN);function neutralFillStealthAlgorithm(t){return r=>{const o=findClosestBackgroundIndex(r);return getSwatch(o+(o>=FM(r)?-1:1)*t(r),wN(r))}}const LM=colorRecipeFactory(neutralFillStealthAlgorithm($N)),UM=colorRecipeFactory(neutralFillStealthAlgorithm(qN)),BM=colorRecipeFactory(neutralFillStealthAlgorithm(jN)),HM=colorRecipeFactory(neutralFillStealthAlgorithm(zN)),$M=colorRecipeFactory(neutralFillStealthAlgorithm(GN)),qM=colorRecipeFactory((t=>({rest:LM(t),hover:UM(t),active:BM(t),focus:HM(t),selected:$M(t)})));function neutralFillInputAlgorithm(t){return r=>{const o=isDarkMode(r)?-1:1;return getSwatch(findClosestBackgroundIndex(r)-t(r)*o,wN(r))}}const jM=colorRecipeFactory(neutralFillInputAlgorithm(FN)),zM=colorRecipeFactory(neutralFillInputAlgorithm(LN)),GM=colorRecipeFactory(neutralFillInputAlgorithm(UN)),VM=colorRecipeFactory(neutralFillInputAlgorithm(BN)),KM=colorRecipeFactory(neutralFillInputAlgorithm(HN)),WM=colorRecipeFactory((t=>({rest:jM(t),hover:zM(t),active:GM(t),focus:VM(t),selected:KM(t)}))),QM=designSystemResolverMax(RN,ON,NN);function accentFillAlgorithm(t){return r=>{const o=CN(r),i=o.length,s=bN(r),l=SM(Object.assign({},r,{backgroundColor:s})),u=kN(r),h=findClosestBackgroundIndex(r)>=QM(r)?-1:1,m=i-1,v=findClosestSwatchIndex(CN,s)(r);let C=0;for(;C<h*u&&inRange(v+C+h,0,i)&&fM(o[v+C+h],l)>=t&&inRange(v+C+h+h,0,m);)C+=h;const _=v+C,k=_+-1*h*u,E=k+h*SN(r),R=k+h*TN(r);return{rest:getSwatch(k,o),hover:getSwatch(_,o),active:getSwatch(E,o),focus:getSwatch(R,o),selected:getSwatch(k+(isDarkMode(r)?-1*EN(r):EN(r)),o)}}}const YM=colorRecipeFactory(accentFillAlgorithm(4.5)),JM=colorRecipeFactory(accentFillAlgorithm(3));swatchFamilyToSwatchRecipeFactory(hM.rest,YM),swatchFamilyToSwatchRecipeFactory(hM.hover,YM),swatchFamilyToSwatchRecipeFactory(hM.active,YM),swatchFamilyToSwatchRecipeFactory(hM.focus,YM),swatchFamilyToSwatchRecipeFactory(hM.selected,YM),swatchFamilyToSwatchRecipeFactory(hM.rest,JM),swatchFamilyToSwatchRecipeFactory(hM.hover,JM),swatchFamilyToSwatchRecipeFactory(hM.active,JM),swatchFamilyToSwatchRecipeFactory(hM.focus,JM),swatchFamilyToSwatchRecipeFactory(hM.selected,JM);const XM=colorRecipeFactory(accessibleAlgorithm(wN,14,0,iM,sM,aM)),ZM=swatchFamilyToSwatchRecipeFactory(hM.rest,XM);swatchFamilyToSwatchRecipeFactory(hM.hover,XM),swatchFamilyToSwatchRecipeFactory(hM.active,XM),swatchFamilyToSwatchRecipeFactory(hM.focus,XM);const neutralCardFillAlgorithm=t=>{const r=YN(t);return getSwatch(findClosestSwatchIndex(wN,yN(t))(t)-r,wN(t))};function neutralFillCard(t){return"function"==typeof t?r=>neutralCardFillAlgorithm(Object.assign({},r,{backgroundColor:t(r)})):neutralCardFillAlgorithm(t)}function performOperation(t){return(...r)=>o=>{const i=r[0];let s="function"==typeof i?i(o):i;for(let i=1;i<r.length;i++){const l=r[i];s=t(s,"function"==typeof l?l(o):l)}return s}}const eD=performOperation(((t,r)=>t+r)),tD=performOperation(((t,r)=>t-r)),rD=performOperation(((t,r)=>t*r));function add(...t){return eD.apply(this,t)}function subtract(...t){return tD.apply(this,t)}function multiply(...t){return rD.apply(this,t)}const oD=colorRecipeFactory((t=>{const r=wN(t),o=findClosestBackgroundIndex(t),i=isDarkMode(t)?-1:1,s=tM(t),l=o+i*s,u=l+i*(rM(t)-s),h=l+i*(oM(t)-s),m=l+i*(nM(t)-s);return{rest:getSwatch(l,r),hover:getSwatch(u,r),active:getSwatch(h,r),focus:getSwatch(m,r)}}));swatchFamilyToSwatchRecipeFactory(hM.rest,oD),swatchFamilyToSwatchRecipeFactory(hM.hover,oD),swatchFamilyToSwatchRecipeFactory(hM.active,oD),swatchFamilyToSwatchRecipeFactory(hM.focus,oD);const nD=colorRecipeFactory((t=>{const r=wN(t),o=findClosestBackgroundIndex(t),i=eM(t);return getSwatch(o+(isDarkMode(t)?-1:1)*i,r)}));var iD;function luminanceOrBackgroundColor(t,r){return o=>-1===QN(o)?r(o):t(o)}!function(t){t[t.LightMode=1]="LightMode",t[t.DarkMode=.23]="DarkMode"}(iD||(iD={}));const sD=findClosestSwatchIndex(wN,(t=>{const r=QN(t);return new ColorRGBA64(r,r,r,1).toStringHexRGB()})),neutralLayerCardIndex=t=>clamp$1(subtract(sD,YN)(t),0,wN(t).length-1),aD=designSystemResolverMax(RN,ON,NN),cD=designSystemResolverMax(add(sD,YN),aD),darkNeutralLayerL4=t=>{const r=.14,o=new ColorRGBA64(r,r,r,1);return findClosestSwatchIndex(wN,o.toStringHexRGB())(t)},lD=colorRecipeFactory(luminanceOrBackgroundColor(getSwatch(subtract(neutralLayerCardIndex,YN),wN),swatchByMode(wN)(0,subtract(darkNeutralLayerL4,multiply(YN,5))))),dD=colorRecipeFactory(luminanceOrBackgroundColor(getSwatch(neutralLayerCardIndex,wN),swatchByMode(wN)(0,subtract(darkNeutralLayerL4,multiply(YN,4))))),uD=colorRecipeFactory(luminanceOrBackgroundColor(getSwatch(add(neutralLayerCardIndex,YN),wN),swatchByMode(wN)(YN,subtract(darkNeutralLayerL4,multiply(YN,3))))),hD=colorRecipeFactory(luminanceOrBackgroundColor(getSwatch(sD,wN),swatchByMode(wN)(0,subtract(darkNeutralLayerL4,multiply(YN,3))))),pD=uD,fD=colorRecipeFactory(luminanceOrBackgroundColor(getSwatch(cD,wN),swatchByMode(wN)(aD,subtract(darkNeutralLayerL4,multiply(YN,2))))),gD=colorRecipeFactory(luminanceOrBackgroundColor(getSwatch(add(cD,YN),wN),swatchByMode(wN)(add(aD,YN),subtract(darkNeutralLayerL4,YN)))),mD=colorRecipeFactory(luminanceOrBackgroundColor(getSwatch(add(cD,multiply(YN,2)),wN),swatchByMode(wN)(add(aD,multiply(YN,2)),darkNeutralLayerL4))),vD=3.5;function neutralFocusContrastCondition(t){return t>vD}const yD=colorRecipeFactory(swatchByContrast(yN)(wN)((function neutralFocusIndexResolver(t,r,o){return findClosestSwatchIndex(wN,t)(o)}))((function neutralFocusDirectionResolver(t,r,o){return isDarkMode(o)?-1:1}))(neutralFocusContrastCondition));function neutralFocusInnerAccentDirectionResolver(t,r,o){return isDarkMode(o)?1:-1}function createColorPalette(t){return new ComponentStateColorPalette({baseColor:t}).palette.map((t=>t.toStringHexRGB().toUpperCase()))}const bD=css`
  ${display("block")};
`,wD=new CSSCustomPropertyBehavior("neutral-foreground-rest",vM,(t=>t)),CD=css`
  :host {
    background-color: var(--background-color);
    color: ${wD.var};
  }
`.withBehaviors(wD,tN(css`
      :host {
        background-color: ${eN.ButtonFace};
        box-shadow: 0 0 0 1px ${eN.CanvasText};
        color: ${eN.ButtonText};
      }
    `));exports.FluentDesignSystemProvider=class FluentDesignSystemProvider extends DesignSystemProvider{constructor(){super(...arguments),this.noPaint=!1}noPaintChanged(){this.noPaint||void 0===this.backgroundColor?this.$fastController.removeStyles(CD):this.$fastController.addStyles(CD)}backgroundColorChanged(){this.noPaintChanged()}neutralBaseColorChanged(t,r){const o=parseColorHexRGB(r);o&&(this.neutralPalette=createColorPalette(o))}accentBaseColorChanged(t,r){const o=parseColorHexRGB(r);o&&(this.accentPalette=createColorPalette(o))}},__decorate$p([attr({attribute:"no-paint",mode:"boolean"})],exports.FluentDesignSystemProvider.prototype,"noPaint",void 0),__decorate$p([designSystemProperty({attribute:"background-color",default:vN.backgroundColor})],exports.FluentDesignSystemProvider.prototype,"backgroundColor",void 0),__decorate$p([designSystemProperty({attribute:"neutral-base-color",cssCustomProperty:!1,default:vN.neutralBaseColor})],exports.FluentDesignSystemProvider.prototype,"neutralBaseColor",void 0),__decorate$p([designSystemProperty({attribute:"accent-base-color",cssCustomProperty:!1,default:vN.accentBaseColor})],exports.FluentDesignSystemProvider.prototype,"accentBaseColor",void 0),__decorate$p([designSystemProperty({attribute:!1,cssCustomProperty:!1,default:vN.neutralPalette})],exports.FluentDesignSystemProvider.prototype,"neutralPalette",void 0),__decorate$p([designSystemProperty({attribute:!1,cssCustomProperty:!1,default:vN.accentPalette})],exports.FluentDesignSystemProvider.prototype,"accentPalette",void 0),__decorate$p([designSystemProperty({default:vN.density,converter:XR})],exports.FluentDesignSystemProvider.prototype,"density",void 0),__decorate$p([designSystemProperty({attribute:"design-unit",converter:XR,default:vN.designUnit})],exports.FluentDesignSystemProvider.prototype,"designUnit",void 0),__decorate$p([designSystemProperty({attribute:"direction",cssCustomProperty:!1,default:vN.direction})],exports.FluentDesignSystemProvider.prototype,"direction",void 0),__decorate$p([designSystemProperty({attribute:"base-height-multiplier",default:vN.baseHeightMultiplier,converter:XR})],exports.FluentDesignSystemProvider.prototype,"baseHeightMultiplier",void 0),__decorate$p([designSystemProperty({attribute:"base-horizontal-spacing-multiplier",converter:XR,default:vN.baseHorizontalSpacingMultiplier})],exports.FluentDesignSystemProvider.prototype,"baseHorizontalSpacingMultiplier",void 0),__decorate$p([designSystemProperty({attribute:"corner-radius",converter:XR,default:vN.cornerRadius})],exports.FluentDesignSystemProvider.prototype,"cornerRadius",void 0),__decorate$p([designSystemProperty({attribute:"elevated-corner-radius",converter:XR,default:vN.elevatedCornerRadius})],exports.FluentDesignSystemProvider.prototype,"elevatedCornerRadius",void 0),__decorate$p([designSystemProperty({attribute:"outline-width",converter:XR,default:vN.outlineWidth})],exports.FluentDesignSystemProvider.prototype,"outlineWidth",void 0),__decorate$p([designSystemProperty({attribute:"focus-outline-width",converter:XR,default:vN.focusOutlineWidth})],exports.FluentDesignSystemProvider.prototype,"focusOutlineWidth",void 0),__decorate$p([designSystemProperty({attribute:"disabled-opacity",converter:XR,default:vN.disabledOpacity})],exports.FluentDesignSystemProvider.prototype,"disabledOpacity",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-minus-2-font-size",default:vN.typeRampMinus2FontSize})],exports.FluentDesignSystemProvider.prototype,"typeRampMinus2FontSize",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-minus-2-line-height",default:vN.typeRampMinus2LineHeight})],exports.FluentDesignSystemProvider.prototype,"typeRampMinus2LineHeight",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-minus-1-font-size",default:vN.typeRampMinus1FontSize})],exports.FluentDesignSystemProvider.prototype,"typeRampMinus1FontSize",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-minus-1-line-height",default:vN.typeRampMinus1LineHeight})],exports.FluentDesignSystemProvider.prototype,"typeRampMinus1LineHeight",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-base-font-size",default:vN.typeRampBaseFontSize})],exports.FluentDesignSystemProvider.prototype,"typeRampBaseFontSize",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-base-line-height",default:vN.typeRampBaseLineHeight})],exports.FluentDesignSystemProvider.prototype,"typeRampBaseLineHeight",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-1-font-size",default:vN.typeRampPlus1FontSize})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus1FontSize",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-1-line-height",default:vN.typeRampPlus1LineHeight})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus1LineHeight",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-2-font-size",default:vN.typeRampPlus2FontSize})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus2FontSize",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-2-line-height",default:vN.typeRampPlus2LineHeight})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus2LineHeight",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-3-font-size",default:vN.typeRampPlus3FontSize})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus3FontSize",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-3-line-height",default:vN.typeRampPlus3LineHeight})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus3LineHeight",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-4-font-size",default:vN.typeRampPlus4FontSize})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus4FontSize",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-4-line-height",default:vN.typeRampPlus4LineHeight})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus4LineHeight",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-5-font-size",default:vN.typeRampPlus5FontSize})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus5FontSize",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-5-line-height",default:vN.typeRampPlus5LineHeight})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus5LineHeight",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-6-font-size",default:vN.typeRampPlus6FontSize})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus6FontSize",void 0),__decorate$p([designSystemProperty({attribute:"type-ramp-plus-6-line-height",default:vN.typeRampPlus6LineHeight})],exports.FluentDesignSystemProvider.prototype,"typeRampPlus6LineHeight",void 0),__decorate$p([designSystemProperty({attribute:"accent-fill-rest-delta",converter:XR,cssCustomProperty:!1,default:vN.accentFillRestDelta})],exports.FluentDesignSystemProvider.prototype,"accentFillRestDelta",void 0),__decorate$p([designSystemProperty({attribute:"accent-fill-hover-delta",converter:XR,cssCustomProperty:!1,default:vN.accentFillHoverDelta})],exports.FluentDesignSystemProvider.prototype,"accentFillHoverDelta",void 0),__decorate$p([designSystemProperty({attribute:"accent-fill-active-delta",cssCustomProperty:!1,converter:XR,default:vN.accentFillActiveDelta})],exports.FluentDesignSystemProvider.prototype,"accentFillActiveDelta",void 0),__decorate$p([designSystemProperty({attribute:"accent-fill-focus-delta",converter:XR,cssCustomProperty:!1,default:vN.accentFillFocusDelta})],exports.FluentDesignSystemProvider.prototype,"accentFillFocusDelta",void 0),__decorate$p([designSystemProperty({attribute:"accent-fill-selected-delta",converter:XR,cssCustomProperty:!1,default:vN.accentFillSelectedDelta})],exports.FluentDesignSystemProvider.prototype,"accentFillSelectedDelta",void 0),__decorate$p([designSystemProperty({attribute:"accent-foreground-rest-delta",converter:XR,cssCustomProperty:!1,default:vN.accentForegroundRestDelta})],exports.FluentDesignSystemProvider.prototype,"accentForegroundRestDelta",void 0),__decorate$p([designSystemProperty({attribute:"accent-foreground-hover-delta",converter:XR,cssCustomProperty:!1,default:vN.accentForegroundHoverDelta})],exports.FluentDesignSystemProvider.prototype,"accentForegroundHoverDelta",void 0),__decorate$p([designSystemProperty({attribute:"accent-foreground-active-delta",converter:XR,cssCustomProperty:!1,default:vN.accentForegroundActiveDelta})],exports.FluentDesignSystemProvider.prototype,"accentForegroundActiveDelta",void 0),__decorate$p([designSystemProperty({attribute:"accent-foreground-focus-delta",converter:XR,cssCustomProperty:!1,default:vN.accentForegroundFocusDelta})],exports.FluentDesignSystemProvider.prototype,"accentForegroundFocusDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-rest-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillRestDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillRestDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-hover-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillHoverDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillHoverDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-active-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillActiveDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillActiveDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-focus-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillFocusDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillFocusDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-selected-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillSelectedDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillSelectedDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-input-rest-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillInputRestDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillInputRestDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-input-hover-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillInputHoverDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillInputHoverDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-input-active-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillInputActiveDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillInputActiveDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-input-focus-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillInputFocusDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillInputFocusDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-input-selected-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillInputSelectedDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillInputSelectedDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-stealth-rest-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillStealthRestDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillStealthRestDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-stealth-hover-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillStealthHoverDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillStealthHoverDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-stealth-active-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillStealthActiveDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillStealthActiveDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-stealth-focus-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillStealthFocusDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillStealthFocusDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-stealth-selected-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillStealthSelectedDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillStealthSelectedDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-toggle-hover-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillToggleHoverDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillToggleHoverDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-toggle-hover-active",converter:XR,cssCustomProperty:!1,default:vN.neutralFillToggleActiveDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillToggleActiveDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-toggle-hover-focus",converter:XR,cssCustomProperty:!1,default:vN.neutralFillToggleFocusDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillToggleFocusDelta",void 0),__decorate$p([designSystemProperty({attribute:"base-layer-luminance",converter:XR,cssCustomProperty:!1,default:vN.baseLayerLuminance})],exports.FluentDesignSystemProvider.prototype,"baseLayerLuminance",void 0),__decorate$p([designSystemProperty({attribute:"neutral-fill-card-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralFillCardDelta})],exports.FluentDesignSystemProvider.prototype,"neutralFillCardDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-foreground-hover-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralForegroundHoverDelta})],exports.FluentDesignSystemProvider.prototype,"neutralForegroundHoverDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-foreground-active-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralForegroundActiveDelta})],exports.FluentDesignSystemProvider.prototype,"neutralForegroundActiveDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-foreground-focus-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralForegroundFocusDelta})],exports.FluentDesignSystemProvider.prototype,"neutralForegroundFocusDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-divider-rest-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralDividerRestDelta})],exports.FluentDesignSystemProvider.prototype,"neutralDividerRestDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-outline-rest-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralOutlineRestDelta})],exports.FluentDesignSystemProvider.prototype,"neutralOutlineRestDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-outline-hover-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralOutlineHoverDelta})],exports.FluentDesignSystemProvider.prototype,"neutralOutlineHoverDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-outline-active-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralOutlineActiveDelta})],exports.FluentDesignSystemProvider.prototype,"neutralOutlineActiveDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-outline-focus-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralOutlineFocusDelta})],exports.FluentDesignSystemProvider.prototype,"neutralOutlineFocusDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-contrast-fill-rest-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralContrastFillRestDelta})],exports.FluentDesignSystemProvider.prototype,"neutralContrastFillRestDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-contrast-fill-hover-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralContrastFillHoverDelta})],exports.FluentDesignSystemProvider.prototype,"neutralContrastFillHoverDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-contrast-fill-active-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralContrastFillActiveDelta})],exports.FluentDesignSystemProvider.prototype,"neutralContrastFillActiveDelta",void 0),__decorate$p([designSystemProperty({attribute:"neutral-contrast-fill-focus-delta",converter:XR,cssCustomProperty:!1,default:vN.neutralContrastFillFocusDelta})],exports.FluentDesignSystemProvider.prototype,"neutralContrastFillFocusDelta",void 0),exports.FluentDesignSystemProvider=__decorate$p([sN({name:"fluent-design-system-provider",template:aN,styles:bD,shadowOptions:{mode:"closed"}})],exports.FluentDesignSystemProvider);const _D=cssCustomPropertyBehaviorFactory("neutral-foreground-rest",(t=>mM(t).rest),exports.FluentDesignSystemProvider.findProvider);cssCustomPropertyBehaviorFactory("neutral-foreground-hover",(t=>mM(t).hover),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-foreground-active",(t=>mM(t).active),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-foreground-focus",(t=>mM(t).focus),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-foreground-toggle",_M,exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-foreground-toggle-large",kM,exports.FluentDesignSystemProvider.findProvider);const kD=cssCustomPropertyBehaviorFactory("neutral-foreground-hint",TM,exports.FluentDesignSystemProvider.findProvider);cssCustomPropertyBehaviorFactory("neutral-foreground-hint-large",EM,exports.FluentDesignSystemProvider.findProvider);const SD=cssCustomPropertyBehaviorFactory("accent-foreground-rest",(t=>xM(t).rest),exports.FluentDesignSystemProvider.findProvider),TD=cssCustomPropertyBehaviorFactory("accent-foreground-hover",(t=>xM(t).hover),exports.FluentDesignSystemProvider.findProvider),ED=cssCustomPropertyBehaviorFactory("accent-foreground-active",(t=>xM(t).active),exports.FluentDesignSystemProvider.findProvider);cssCustomPropertyBehaviorFactory("accent-foreground-focus",(t=>xM(t).focus),exports.FluentDesignSystemProvider.findProvider);const xD=cssCustomPropertyBehaviorFactory("accent-foreground-cut-rest",(t=>SM(t)),exports.FluentDesignSystemProvider.findProvider);cssCustomPropertyBehaviorFactory("accent-foreground-large-rest",(t=>IM(t).rest),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("accent-foreground-large-hover",(t=>IM(t).hover),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("accent-foreground-large-active",(t=>IM(t).active),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("accent-foreground-large-focus",(t=>IM(t).focus),exports.FluentDesignSystemProvider.findProvider);const ID=cssCustomPropertyBehaviorFactory("neutral-fill-rest",(t=>DM(t).rest),exports.FluentDesignSystemProvider.findProvider),AD=cssCustomPropertyBehaviorFactory("neutral-fill-hover",(t=>DM(t).hover),exports.FluentDesignSystemProvider.findProvider),PD=cssCustomPropertyBehaviorFactory("neutral-fill-active",(t=>DM(t).active),exports.FluentDesignSystemProvider.findProvider);cssCustomPropertyBehaviorFactory("neutral-fill-focus",(t=>DM(t).focus),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-fill-selected",(t=>DM(t).selected),exports.FluentDesignSystemProvider.findProvider);const RD=cssCustomPropertyBehaviorFactory("neutral-fill-stealth-rest",(t=>qM(t).rest),exports.FluentDesignSystemProvider.findProvider),OD=cssCustomPropertyBehaviorFactory("neutral-fill-stealth-hover",(t=>qM(t).hover),exports.FluentDesignSystemProvider.findProvider),ND=cssCustomPropertyBehaviorFactory("neutral-fill-stealth-active",(t=>qM(t).active),exports.FluentDesignSystemProvider.findProvider);cssCustomPropertyBehaviorFactory("neutral-fill-stealth-focus",(t=>qM(t).focus),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-fill-stealth-selected",(t=>qM(t).selected),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-fill-toggle-rest",(t=>wM(t).rest),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-fill-toggle-hover",(t=>wM(t).hover),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-fill-toggle-active",(t=>wM(t).active),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-fill-toggle-focus",(t=>wM(t).focus),exports.FluentDesignSystemProvider.findProvider);const MD=cssCustomPropertyBehaviorFactory("neutral-fill-input-rest",(t=>WM(t).rest),exports.FluentDesignSystemProvider.findProvider),DD=cssCustomPropertyBehaviorFactory("neutral-fill-input-hover",(t=>WM(t).hover),exports.FluentDesignSystemProvider.findProvider),FD=cssCustomPropertyBehaviorFactory("neutral-fill-input-active",(t=>WM(t).active),exports.FluentDesignSystemProvider.findProvider);cssCustomPropertyBehaviorFactory("neutral-fill-input-focus",(t=>WM(t).focus),exports.FluentDesignSystemProvider.findProvider);const LD=cssCustomPropertyBehaviorFactory("accent-fill-rest",(t=>YM(t).rest),exports.FluentDesignSystemProvider.findProvider),UD=cssCustomPropertyBehaviorFactory("accent-fill-hover",(t=>YM(t).hover),exports.FluentDesignSystemProvider.findProvider),BD=cssCustomPropertyBehaviorFactory("accent-fill-active",(t=>YM(t).active),exports.FluentDesignSystemProvider.findProvider);cssCustomPropertyBehaviorFactory("accent-fill-focus",(t=>YM(t).focus),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("accent-fill-selected",(t=>YM(t).selected),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("accent-fill-large-rest",(t=>JM(t).rest),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("accent-fill-large-hover",(t=>JM(t).hover),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("accent-fill-large-active",(t=>JM(t).active),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("accent-fill-large-focus",(t=>JM(t).focus),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("accent-fill-large-selected",(t=>JM(t).selected),exports.FluentDesignSystemProvider.findProvider);const HD=cssCustomPropertyBehaviorFactory("neutral-fill-card-rest",(t=>neutralFillCard(t)),exports.FluentDesignSystemProvider.findProvider),$D=cssCustomPropertyBehaviorFactory("neutral-outline-rest",(t=>oD(t).rest),exports.FluentDesignSystemProvider.findProvider),qD=cssCustomPropertyBehaviorFactory("neutral-outline-hover",(t=>oD(t).hover),exports.FluentDesignSystemProvider.findProvider),jD=cssCustomPropertyBehaviorFactory("neutral-outline-active",(t=>oD(t).active),exports.FluentDesignSystemProvider.findProvider);cssCustomPropertyBehaviorFactory("neutral-outline-focus",(t=>oD(t).focus),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-divider-rest",nD,exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-layer-floating",lD,exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-layer-card",dD,exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-layer-card-container",uD,exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-layer-l1",hD,exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-layer-l1-alt",pD,exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-layer-l2",fD,exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-layer-l3",gD,exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-layer-l4",mD,exports.FluentDesignSystemProvider.findProvider);const zD=cssCustomPropertyBehaviorFactory("neutral-focus",yD,exports.FluentDesignSystemProvider.findProvider),GD=cssCustomPropertyBehaviorFactory("neutral-focus-inner-accent",function neutralFocusInnerAccent(t){return swatchByContrast(yD)(CN)(function neutralFocusInnerAccentIndexResolver(t){return(r,o,i)=>o.indexOf(t(i))}(t))(neutralFocusInnerAccentDirectionResolver)(neutralFocusContrastCondition)}(bN),exports.FluentDesignSystemProvider.findProvider);cssCustomPropertyBehaviorFactory("neutral-contrast-foreground-rest",(t=>vM(ZM)(t)),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-contrast-fill-rest",(t=>XM(t).rest),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-contrast-fill-hover",(t=>XM(t).hover),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-contrast-fill-active",(t=>XM(t).active),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("neutral-contrast-fill-focus",(t=>XM(t).focus),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("inline-start",(t=>_N(t)===ZO.ltr?"left":"right"),exports.FluentDesignSystemProvider.findProvider),cssCustomPropertyBehaviorFactory("inline-end",(t=>_N(t)===ZO.ltr?"right":"left"),exports.FluentDesignSystemProvider.findProvider);const VD="(var(--base-height-multiplier) + var(--density)) * var(--design-unit)",KD=css`
  ${display("inline-flex")} :host {
    font-family: var(--body-font);
    outline: none;
    font-size: var(--type-ramp-base-font-size);
    line-height: var(--type-ramp-base-line-height);
    height: calc(${VD} * 1px);
    min-width: calc(${VD} * 1px);
    background-color: ${ID.var};
    color: ${_D.var};
    border-radius: calc(var(--corner-radius) * 1px);
    fill: currentcolor;
    cursor: pointer;
  }

  .control {
    background: transparent;
    height: inherit;
    flex-grow: 1;
    box-sizing: border-box;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    padding: 0 calc((10 + (var(--design-unit) * 2 * var(--density))) * 1px);
    white-space: nowrap;
    outline: none;
    text-decoration: none;
    border: calc(var(--outline-width) * 1px) solid transparent;
    color: inherit;
    border-radius: inherit;
    fill: inherit;
    cursor: inherit;
    font-family: inherit;
  }

  .control,
  .end,
  .start {
    font: inherit;
  }

  .control.icon-only {
    padding: 0;
    line-height: 0;
  }

  :host(:hover) {
    background-color: ${AD.var};
  }

  :host(:active) {
    background-color: ${PD.var};
  }

  .control:${oN} {
    border: calc(var(--outline-width) * 1px) solid ${zD.var};
    box-shadow: 0 0 0 calc((var(--focus-outline-width) - var(--outline-width)) * 1px) ${zD.var};
  }

  .control::-moz-focus-inner {
    border: 0;
  }

  .content {
    pointer-events: none;
  }

  .start,
  .end {
    display: flex;
    pointer-events: none;
  }

  ::slotted(svg) {
    ${""} width: 16px;
    height: 16px;
    pointer-events: none;
  }

  .start {
    margin-inline-end: 11px;
  }

  .end {
    margin-inline-start: 11px;
  }
`.withBehaviors(ID,zD,_D,AD,PD,tN(css`
        :host,
        :host([appearance="neutral"]) .control {
          background-color: ${eN.ButtonFace};
          border-color: ${eN.ButtonText};
          color: ${eN.ButtonText};
          fill: currentcolor;
        }

        :host(:not([disabled][href]):hover),
        :host([appearance="neutral"]:not([disabled]):hover) .control {
          forced-color-adjust: none;
          background-color: ${eN.Highlight};
          color: ${eN.HighlightText};
        }

        .control:${oN},
        :host([appearance="outline"]) .control:${oN},
        :host([appearance="neutral"]:${oN}) .control {
          forced-color-adjust: none;
          background-color: ${eN.Highlight};
          border-color: ${eN.ButtonText};
          box-shadow: 0 0 0 calc((var(--focus-outline-width) - var(--outline-width)) * 1px) ${eN.ButtonText};
          color: ${eN.HighlightText};
        }

        .control:not([disabled]):hover,
        :host([appearance="outline"]) .control:hover {
          border-color: ${eN.ButtonText};
        }

        :host([href]) .control {
          border-color: ${eN.LinkText};
          color: ${eN.LinkText};
        }

        :host([href]) .control:hover,
        :host(.neutral[href]) .control:hover,
        :host(.outline[href]) .control:hover,
        :host([href]) .control:${oN}{
          forced-color-adjust: none;
          background: ${eN.ButtonFace};
          border-color: ${eN.LinkText};
          box-shadow: 0 0 0 1px ${eN.LinkText} inset;
          color: ${eN.LinkText};
          fill: currentcolor;
        }
    `)),WD=css`
    :host([appearance="accent"]) {
        background: ${LD.var};
        color: ${xD.var};
    }

    :host([appearance="accent"]:hover) {
        background: ${UD.var};
    }

    :host([appearance="accent"]:active) .control:active {
        background: ${BD.var};
    }

    :host([appearance="accent"]) .control:${oN} {
        box-shadow: 0 0 0 calc(var(--focus-outline-width) * 1px) inset ${GD.var}, 0 0 0 calc((var(--focus-outline-width) - var(--outline-width)) * 1px) ${zD.var}
    }
`.withBehaviors(LD,xD,UD,BD,GD,tN(css`
        :host([appearance="accent"]) .control {
            forced-color-adjust: none;
            background: ${eN.Highlight};
            color: ${eN.HighlightText};
        }

        :host([appearance="accent"]) .control:hover,
        :host([appearance="accent"]:active) .control:active {
            background: ${eN.HighlightText};
            border-color: ${eN.Highlight};
            color: ${eN.Highlight};
        }

        :host([appearance="accent"]) .control:${oN} {
            border-color: ${eN.ButtonText};
            box-shadow: 0 0 0 2px ${eN.HighlightText} inset;
        }

        :host([appearance="accent"][href]) .control{
            background: ${eN.LinkText};
            color: ${eN.HighlightText};
        }

        :host([appearance="accent"][href]) .control:hover {
            background: ${eN.ButtonFace};
            border-color: ${eN.LinkText};
            box-shadow: none;
            color: ${eN.LinkText};
            fill: currentcolor;
        }

        :host([appearance="accent"][href]) .control:${oN} {
          border-color: ${eN.LinkText};
          box-shadow: 0 0 0 2px ${eN.HighlightText} inset;
      }
    `));css`
    :host([appearance="hypertext"]) {
        height: auto;
        font-size: inherit;
        line-height: inherit;
        background: transparent;
        min-width: 0;
    }

    :host([appearance="hypertext"]) .control {
        display: inline;
        padding: 0;
        border: none;
        box-shadow: none;
        border-radius: 0;
        line-height: 1;
    }
    :host a.control:not(:link) {
        background-color: transparent;
        cursor: default;
    }
    :host([appearance="hypertext"]) .control:link,
    :host([appearance="hypertext"]) .control:visited {
        background: transparent;
        color: ${SD.var};
        border-bottom: calc(var(--outline-width) * 1px) solid ${SD.var};
    }
    :host([appearance="hypertext"]) .control:hover {
        border-bottom-color: ${TD.var};
    }
    :host([appearance="hypertext"]) .control:active {
        border-bottom-color: ${ED.var};
    }
    :host([appearance="hypertext"]) .control:${oN} {
        border-bottom: calc(var(--focus-outline-width) * 1px) solid ${zD.var};
        margin-bottom: calc(calc(var(--outline-width) - var(--focus-outline-width)) * 1px);
    }
`.withBehaviors(SD,TD,ED,zD,tN(css`
      :host([appearance="hypertext"]) .control:${oN} {
        color: ${eN.LinkText};
        border-bottom-color: ${eN.LinkText};
      }
    `));const QD=css`
    :host([appearance="lightweight"]) {
        background: transparent;
        color: ${SD.var};
    }

    :host([appearance="lightweight"]) .control {
        padding: 0;
        height: initial;
        border: none;
        box-shadow: none;
        border-radius: 0;
    }

    :host([appearance="lightweight"]:hover) {
        color: ${TD.var};
    }

    :host([appearance="lightweight"]:active) {
        color: ${ED.var};
    }

    :host([appearance="lightweight"]) .content {
        position: relative;
    }

    :host([appearance="lightweight"]) .content::before {
        content: "";
        display: block;
        height: calc(var(--outline-width) * 1px);
        position: absolute;
        top: calc(1em + 3px);
        width: 100%;
    }

    :host([appearance="lightweight"]:hover) .content::before {
        background: ${TD.var};
    }

    :host([appearance="lightweight"]:active) .content::before {
        background: ${ED.var};
    }

    :host([appearance="lightweight"]) .control:${oN} .content::before {
        background: ${_D.var};
        height: calc(var(--focus-outline-width) * 1px);
    }
`.withBehaviors(SD,TD,ED,TD,_D,tN(css`
        :host([appearance="lightweight"]) {
            color: ${eN.ButtonText};
        }
        :host([appearance="lightweight"]) .control:hover,
        :host([appearance="lightweight"]) .control:${oN} {
            forced-color-adjust: none;
            background: ${eN.ButtonFace};
            color: ${eN.Highlight};
        }
        :host([appearance="lightweight"]) .control:hover .content::before,
        :host([appearance="lightweight"]) .control:${oN} .content::before {
            background: ${eN.Highlight};
        }

        :host([appearance="lightweight"][href]) .control:hover,
        :host([appearance="lightweight"][href]) .control:${oN} {
            background: ${eN.ButtonFace};
            box-shadow: none;
            color: ${eN.LinkText};
        }

        :host([appearance="lightweight"][href]) .control:hover .content::before,
        :host([appearance="lightweight"][href]) .control:${oN} .content::before {
            background: ${eN.LinkText};
        }
    `)),YD=css`
    :host([appearance="outline"]) {
        background: transparent;
        border-color: ${$D.var};
    }

    :host([appearance="outline"]:hover) {
        border-color: ${qD.var};
    }

    :host([appearance="outline"]:active) {
        border-color: ${jD.var};
    }

    :host([appearance="outline"]) .control {
        border-color: inherit;
    }

    :host([appearance="outline"]) .control:${oN} {
        box-shadow: 0 0 0 calc((var(--focus-outline-width) - var(--outline-width)) * 1px) ${zD.var};
        border-color: ${zD.var};
    }
`.withBehaviors($D,qD,jD,zD,tN(css`
      :host([appearance='outline']) {
        border-color: ${eN.ButtonText};
      }
      :host([appearance='outline'][href]) {
        border-color: ${eN.LinkText};
      }
    `)),JD=css`
  :host([appearance='stealth']) {
    background: ${RD.var};
  }

  :host([appearance='stealth']:hover) {
    background: ${OD.var};
  }

  :host([appearance='stealth']:active) {
    background: ${ND.var};
  }
`.withBehaviors(RD,OD,ND,tN(css`
        :host([appearance="stealth"]),
        :host([appearance="stealth"]) .control {
            forced-color-adjust: none;
            background: ${eN.ButtonFace};
            border-color: transparent;
            color: ${eN.ButtonText};
            fill: currentcolor;
        }

        :host([appearance="stealth"]:hover) .control {
            background: ${eN.Highlight};
            border-color: ${eN.Highlight};
            color: ${eN.HighlightText};
            fill: currentcolor;
        }

        :host([appearance="stealth"]:${oN}) .control {
            background: ${eN.Highlight};
            box-shadow: 0 0 0 1px ${eN.Highlight};
            color: ${eN.HighlightText};
            fill: currentcolor;
        }

        :host([appearance="stealth"][href]) .control {
            color: ${eN.LinkText};
        }

        :host([appearance="stealth"]:hover[href]) .control,
        :host([appearance="stealth"]:${oN}[href]) .control {
            background: ${eN.LinkText};
            border-color: ${eN.LinkText};
            color: ${eN.HighlightText};
            fill: currentcolor;
        }

      :host([appearance="stealth"]:${oN}[href]) .control {
          box-shadow: 0 0 0 1px ${eN.LinkText};
      }
    `));function appearanceBehavior(t,r){return new PropertyStyleSheetBehavior("appearance",t,r)}const XD=css`
  :host([disabled]),
  :host([disabled]:hover),
  :host([disabled]:active) {
    opacity: var(--disabled-opacity);
    background-color: ${ID.var};
    cursor: ${rN};
  }

  ${KD}
`.withBehaviors(tN(css`
      :host([disabled]),
      :host([disabled]:hover),
      :host([disabled]:active),
      :host([disabled]) .control,
      :host([disabled]) .control:hover,
      :host([appearance='neutral'][disabled]:hover) .control {
        forced-color-adjust: none;
        background-color: ${eN.ButtonFace};
        border-color: ${eN.GrayText};
        color: ${eN.GrayText};
        opacity: 1;
      }
    `),appearanceBehavior("accent",css`
      :host([appearance='accent'][disabled]),
      :host([appearance='accent'][disabled]:hover),
      :host([appearance='accent'][disabled]:active) {
        background: ${LD.var};
      }

      ${WD}
    `.withBehaviors(tN(css`
          :host([appearance='accent'][disabled]) .control,
          :host([appearance='accent'][disabled]) .control:hover {
            background: ${eN.ButtonFace};
            border-color: ${eN.GrayText};
            color: ${eN.GrayText};
          }
        `))),appearanceBehavior("lightweight",css`
      :host([appearance='lightweight'][disabled]:hover),
      :host([appearance='lightweight'][disabled]:active) {
        background-color: transparent;
        color: ${SD.var};
      }

      :host([appearance='lightweight'][disabled]) .content::before,
      :host([appearance='lightweight'][disabled]:hover) .content::before,
      :host([appearance='lightweight'][disabled]:active) .content::before {
        background: transparent;
      }

      ${QD}
    `.withBehaviors(tN(css`
          :host([appearance='lightweight'][disabled]) .control {
            forced-color-adjust: none;
            color: ${eN.GrayText};
          }

          :host([appearance='lightweight'][disabled]) .control:hover .content::before {
            background: none;
          }
        `))),appearanceBehavior("outline",css`
      :host([appearance='outline'][disabled]:hover),
      :host([appearance='outline'][disabled]:active) {
        background: transparent;
        border-color: ${$D.var};
      }

      ${YD}
    `.withBehaviors(tN(css`
          :host([appearance='outline'][disabled]) .control {
            border-color: ${eN.GrayText};
          }
        `))),appearanceBehavior("stealth",css`
      :host([appearance='stealth'][disabled]),
      :host([appearance='stealth'][disabled]:hover),
      :host([appearance='stealth'][disabled]:active) {
        background: ${RD.var};
      }

      ${JD}
    `.withBehaviors(tN(css`
          :host([appearance='stealth'][disabled]),
          :host([appearance='stealth'][disabled]:hover) {
            background: ${eN.ButtonFace};
          }

          :host([appearance='stealth'][disabled]) .control {
            background: ${eN.ButtonFace};
            border-color: transparent;
            color: ${eN.GrayText};
          }
        `))));exports.FluentButton=class FluentButton extends Button{appearanceChanged(t,r){t!==r&&(this.classList.add(r),this.classList.remove(t))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="neutral")}defaultSlottedContentChanged(){const t=this.defaultSlottedContent.filter((t=>t.nodeType===Node.ELEMENT_NODE));1===t.length&&t[0]instanceof SVGElement?this.control.classList.add("icon-only"):this.control.classList.remove("icon-only")}},__decorate$p([attr],exports.FluentButton.prototype,"appearance",void 0),exports.FluentButton=__decorate$p([customElement({name:"fluent-button",template:cN,styles:XD,shadowOptions:{delegatesFocus:!0,mode:"closed"}})],exports.FluentButton);const ZD=css`
  ${display("block")} :host {
    --elevation: 4;
    display: block;
    contain: content;
    height: var(--card-height, 100%);
    width: var(--card-width, 100%);
    box-sizing: border-box;
    border-radius: calc(var(--elevated-corner-radius) * 1px);
    ${"box-shadow: 0 0 calc((var(--elevation) * 0.225px) + 2px) rgba(0, 0, 0, calc(.11 * (2 - var(--background-luminance, 1)))), 0 calc(var(--elevation) * 0.4px) calc((var(--elevation) * 0.9px)) rgba(0, 0, 0, calc(.13 * (2 - var(--background-luminance, 1))));"}
  }

  :host(:hover) {
    --elevation: 8;
  }

  :host(:focus-within) {
    --elevation: 8;
  }

  :host {
    content-visibility: auto;
  }
`.withBehaviors(HD,tN(css`
      :host {
        forced-color-adjust: none;
        background: ${eN.Canvas};
        box-shadow: 0 0 0 1px ${eN.CanvasText};
      }
    `));exports.FluentCard=class FluentCard extends exports.FluentDesignSystemProvider{cardBackgroundColorChanged(t,r){if(r){null!==parseColorHexRGB(this.cardBackgroundColor)&&(this.neutralBaseColor=this.cardBackgroundColor,this.backgroundColor=this.cardBackgroundColor)}else this.provider&&this.provider.designSystem&&this.handleChange(this.provider.designSystem,"backgroundColor")}handleChange(t,r){this.cardBackgroundColor||(this.neutralBaseColor?this.backgroundColor=neutralFillCard(this.designSystem):this.backgroundColor=neutralFillCard(t))}connectedCallback(){var t,r;super.connectedCallback();const o=qR.getNotifier(null===(t=this.provider)||void 0===t?void 0:t.designSystem);o.subscribe(this,"backgroundColor"),o.subscribe(this,"neutralPalette"),this.handleChange(null===(r=this.provider)||void 0===r?void 0:r.designSystem,"backgroundColor")}},__decorate$p([attr({attribute:"card-background-color",mode:"fromView"})],exports.FluentCard.prototype,"cardBackgroundColor",void 0),exports.FluentCard=__decorate$p([sN({name:"fluent-card",template:pN,styles:ZD,shadowOptions:{mode:"closed"}})],exports.FluentCard);const eF=css`
    ${display("inline-flex")} :host {
        align-items: center;
        outline: none;
        margin: calc(var(--design-unit) * 1px) 0;
        ${""} user-select: none;
    }

    .control {
        position: relative;
        width: calc((${VD} / 2 + var(--design-unit)) * 1px);
        height: calc((${VD} / 2 + var(--design-unit)) * 1px);
        box-sizing: border-box;
        border-radius: calc(var(--corner-radius) * 1px);
        border: calc(var(--outline-width) * 1px) solid ${$D.var};
        background: ${MD.var};
        outline: none;
        cursor: pointer;
    }

    .label__hidden {
        display: none;
        visibility: hidden;
    }

    .label {
        font-family: var(--body-font);
        color: ${_D.var};
        ${""} padding-inline-start: calc(var(--design-unit) * 2px + 2px);
        margin-inline-end: calc(var(--design-unit) * 2px + 2px);
        cursor: pointer;
        font-size: var(--type-ramp-base-font-size);
        line-height: var(--type-ramp-base-line-height);
    }

    .checked-indicator {
        width: 100%;
        height: 100%;
        display: block;
        fill: ${_D.var};
        opacity: 0;
        pointer-events: none;
    }

    .indeterminate-indicator {
        border-radius: calc(var(--corner-radius) * 1px);
        background: ${_D.var};
        position: absolute;
        top: 50%;
        left: 50%;
        width: 50%;
        height: 50%;
        transform: translate(-50%, -50%);
        opacity: 0;
    }

    :host(:enabled) .control:hover {
        background: ${DD.var};
        border-color: ${qD.var};
    }

    :host(:enabled) .control:active {
        background: ${FD.var};
        border-color: ${jD.var};
    }

    :host(:${oN}) .control {
        box-shadow: 0 0 0 2px var(--background-color), 0 0 0 4px ${zD.var};
        border-color: ${zD.var};
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.readonly) .control,
    :host(.disabled) .control {
        cursor: ${rN};
    }

    :host(.checked:not(.indeterminate)) .checked-indicator,
    :host(.indeterminate) .indeterminate-indicator {
        opacity: 1;
    }

    :host(.disabled) {
        opacity: var(--disabled-opacity);
    }
`.withBehaviors(FD,DD,MD,zD,_D,jD,qD,$D,tN(css`
            .control {
                forced-color-adjust: none;
                border-color: ${eN.FieldText};
                background: ${eN.Field};
            }
            :host(:enabled) .control:hover, .control:active {
                border-color: ${eN.Highlight};
                background: ${eN.Field};
            }
            .checked-indicator {
                fill: ${eN.FieldText};
            }
            .indeterminate-indicator {
                background: ${eN.FieldText};
            }
            :host(:${oN}) .control {
                border-color: ${eN.Highlight};
                box-shadow: 0 0 0 2px ${eN.Field}, 0 0 0 4px ${eN.FieldText};
            }
            :host(.checked:${oN}:enabled) .control {
                box-shadow: 0 0 0 2px ${eN.Field}, 0 0 0 4px ${eN.FieldText};
            }
            :host(.checked) .control {
                background: ${eN.Highlight};
                border-color: ${eN.Highlight};
            }
            :host(.checked) .control:hover, .control:active {
                background: ${eN.HighlightText};
            }
            :host(.checked) .checked-indicator {
                fill: ${eN.HighlightText};
            }
            :host(.checked) .control:hover .checked-indicator {
                fill: ${eN.Highlight}
            }
            :host(.checked) .indeterminate-indicator {
                background: ${eN.HighlightText};
            }
            :host(.checked) .control:hover .indeterminate-indicator {
                background: ${eN.Highlight}
            }
            :host(.disabled) {
                opacity: 1;
            }
            :host(.disabled) .control {
                forced-color-adjust: none;
                border-color: ${eN.GrayText};
                background: ${eN.Field};
            }
            :host(.disabled) .indeterminate-indicator,
            :host(.checked.disabled) .control:hover .indeterminate-indicator {
                forced-color-adjust: none;
                background: ${eN.GrayText};
            }
            :host(.disabled) .checked-indicator,
            :host(.checked.disabled) .control:hover .checked-indicator {
                forced-color-adjust: none;
                fill: ${eN.GrayText};
            }
        `));exports.FluentCheckbox=class FluentCheckbox extends Checkbox{},exports.FluentCheckbox=__decorate$p([customElement({name:"fluent-checkbox",template:fN,styles:eF,shadowOptions:{mode:"closed"}})],exports.FluentCheckbox);const tF=css`
  ${display("flex")} :host {
    align-items: center;
    outline: none;
    height: calc(var(--design-unit) * 1px);
    margin: calc(var(--design-unit) * 1px) 0;
  }

  .progress {
    background-color: ${ID.var};
    border-radius: calc(var(--design-unit) * 1px);
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    position: relative;
  }

  .determinate {
    background-color: ${SD.var};
    border-radius: calc(var(--design-unit) * 1px);
    height: 100%;
    transition: all 0.2s ease-in-out;
    display: flex;
  }

  .indeterminate {
    height: 100%;
    border-radius: calc(var(--design-unit) * 1px);
    display: flex;
    width: 100%;
    position: relative;
    overflow: hidden;
  }

  .indeterminate-indicator-1 {
    position: absolute;
    opacity: 0;
    height: 100%;
    background-color: ${SD.var};
    border-radius: calc(var(--design-unit) * 1px);
    animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
    width: 40%;
    animation: indeterminate-1 2s infinite;
  }

  .indeterminate-indicator-2 {
    position: absolute;
    opacity: 0;
    height: 100%;
    background-color: ${SD.var};
    border-radius: calc(var(--design-unit) * 1px);
    animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
    width: 60%;
    animation: indeterminate-2 2s infinite;
  }

  :host(.paused) .indeterminate-indicator-1,
  :host(.paused) .indeterminate-indicator-2 {
    animation-play-state: paused;
    background-color: ${ID.var};
  }

  :host(.paused) .determinate {
    background-color: ${kD.var};
  }

  @keyframes indeterminate-1 {
    0% {
      opacity: 1;
      transform: translateX(-100%);
    }
    70% {
      opacity: 1;
      transform: translateX(300%);
    }
    70.01% {
      opacity: 0;
    }
    100% {
      opacity: 0;
      transform: translateX(300%);
    }
  }

  @keyframes indeterminate-2 {
    0% {
      opacity: 0;
      transform: translateX(-150%);
    }
    29.99% {
      opacity: 0;
    }
    30% {
      opacity: 1;
      transform: translateX(-150%);
    }
    100% {
      transform: translateX(166.66%);
      opacity: 1;
    }
  }
`.withBehaviors(SD,ID,kD,tN(css`
      .indeterminate-indicator-1,
      .indeterminate-indicator-2,
      .determinate {
        forced-color-adjust: none;
        background-color: ${eN.FieldText};
      }
      .progress {
        background-color: ${eN.Field};
        border: calc(var(--outline-width) * 1px) solid ${eN.FieldText};
      }
      :host(.paused) .indeterminate-indicator-1,
      .indeterminate-indicator-2 {
        background-color: ${eN.Field};
      }
      :host(.paused) .determinate {
        background-color: ${eN.GrayText};
      }
    `));exports.FluentProgress=class FluentProgress extends BaseProgress{},exports.FluentProgress=__decorate$p([customElement({name:"fluent-progress",template:mN,styles:tF,shadowOptions:{mode:"closed"}})],exports.FluentProgress);const rF=css`
  ${display("flex")} :host {
    align-items: center;
    outline: none;
    height: calc(${VD} * 1px);
    width: calc(${VD} * 1px);
    margin: calc(${VD} * 1px) 0;
  }

  .progress {
    height: 100%;
    width: 100%;
  }

  .background {
    stroke: ${ID.var};
    fill: none;
    stroke-width: 2px;
  }

  .determinate {
    stroke: ${SD.var};
    fill: none;
    stroke-width: 2px;
    stroke-linecap: round;
    transform-origin: 50% 50%;
    transform: rotate(-90deg);
    transition: all 0.2s ease-in-out;
  }

  .indeterminate-indicator-1 {
    stroke: ${SD.var};
    fill: none;
    stroke-width: 2px;
    stroke-linecap: round;
    transform-origin: 50% 50%;
    transform: rotate(-90deg);
    transition: all 0.2s ease-in-out;
    animation: spin-infinite 2s linear infinite;
  }

  :host(.paused) .indeterminate-indicator-1 {
    animation-play-state: paused;
    stroke: ${ID.var};
  }

  :host(.paused) .determinate {
    stroke: ${kD.var};
  }

  @keyframes spin-infinite {
    0% {
      stroke-dasharray: 0.01px 43.97px;
      transform: rotate(0deg);
    }
    50% {
      stroke-dasharray: 21.99px 21.99px;
      transform: rotate(450deg);
    }
    100% {
      stroke-dasharray: 0.01px 43.97px;
      transform: rotate(1080deg);
    }
  }
`.withBehaviors(SD,ID,kD,tN(css`
      .indeterminate-indicator-1,
      .determinate {
        stroke: ${eN.FieldText};
      }
      .background {
        stroke: ${eN.Field};
      }
      :host(.paused) .indeterminate-indicator-1 {
        stroke: ${eN.Field};
      }
      :host(.paused) .determinate {
        stroke: ${eN.GrayText};
      }
    `));exports.FluentProgressRing=class FluentProgressRing extends BaseProgress{},exports.FluentProgressRing=__decorate$p([customElement({name:"fluent-progress-ring",template:gN,styles:rF,shadowOptions:{mode:"closed"}})],exports.FluentProgressRing);var __decorate$n=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$m=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$o=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.MgtFileUpload=class MgtFileUpload extends MgtBaseComponent{static get styles(){return AR}get strings(){return PR}static get requiredScopes(){return[...new Set(["files.readwrite","files.readwrite.all","sites.readwrite.all"])]}constructor(){super(),this._dragCounter=0,this._dropEffect="copy",this._maxChunckSize=4194304,this._dialogTitle="",this._dialogContent="",this._dialogPrimaryButton="",this._dialogSecondaryButton="",this._dialogCheckBox="",this._applyAll=!1,this._applyAllConflitBehavior=null,this._maximumFiles=!1,this._maximumFileSize=!1,this._excludedFileType=!1,this.handleonDragOver=t=>__awaiter$o(this,void 0,void 0,(function*(){t.preventDefault(),t.stopPropagation(),t.dataTransfer.items&&t.dataTransfer.items.length>0&&(t.dataTransfer.dropEffect=t.dataTransfer.dropEffect=this._dropEffect)})),this.handleonDragEnter=t=>__awaiter$o(this,void 0,void 0,(function*(){if(t.preventDefault(),t.stopPropagation(),this._dragCounter++,t.dataTransfer.items&&t.dataTransfer.items.length>0){t.dataTransfer.dropEffect=this._dropEffect;this.renderRoot.querySelector("#file-upload-border").classList.add("visible")}})),this.handleonDragLeave=t=>{if(t.preventDefault(),t.stopPropagation(),this._dragCounter--,0===this._dragCounter){this.renderRoot.querySelector("#file-upload-border").classList.remove("visible")}},this.handleonDrop=t=>__awaiter$o(this,void 0,void 0,(function*(){t.preventDefault(),t.stopPropagation();this.renderRoot.querySelector("#file-upload-border").classList.remove("visible"),t.dataTransfer&&t.dataTransfer.items&&this.getSelectedFiles(yield this.getFilesFromUploadArea(t.dataTransfer.items)),t.dataTransfer.clearData(),this._dragCounter=0})),this.filesToUpload=[]}render(){if(null!==this.parentElement){const t=this.parentElement;t.addEventListener("dragenter",this.handleonDragEnter),t.addEventListener("dragleave",this.handleonDragLeave),t.addEventListener("dragover",this.handleonDragOver),t.addEventListener("drop",this.handleonDrop)}return html$1`
        <div id="file-upload-dialog" class="file-upload-dialog">
          <!-- Modal content -->
          <fluent-card class="file-upload-dialog-content">
            <span class="file-upload-dialog-close" id="file-upload-dialog-close" >${getSvg(dR.Cancel)}</span>
            <div class="file-upload-dialog-content-text">
              <h2 class="file-upload-dialog-title">${this._dialogTitle}</h2>
              <div>${this._dialogContent}</div>
              <div class="file-upload-dialog-check-wrapper">
                <fluent-checkbox id="file-upload-dialog-check" class="file-upload-dialog-check" >
                  <span>${this._dialogCheckBox}</span>
                </fluent-checkbox>
              </div>
            </div>
            <div class="file-upload-dialog-editor">
              <fluent-button class="file-upload-dialog-ok">
              ${this._dialogPrimaryButton}
              </fluent-button>
              <fluent-button class="file-upload-dialog-cancel">
              ${this._dialogSecondaryButton}
              </fluent-button>
            </div>
          </fluent-card>
        </div>
        <div id="file-upload-border" >
        </div>
        <div class="file-upload-area-button">
        <div>
          <input
            id="file-upload-input"
            aria-label="file upload input"
            type="file"
            multiple="true"
            @change="${this.onFileUploadChange}"
          />
          <fluent-button class="file-upload-button" @click=${this.onFileUploadClick}>
            ${getSvg(dR.Upload)}${PR.buttonUploadFile}
          </fluent-button>
        </div>
        </div>
        <div class="file-upload-Template">
        ${this.renderFolderTemplate(this.filesToUpload)}
        </div>
       `}renderFolderTemplate(t){let r=[];if(t.length>0){const o=t.map((t=>-1===r.indexOf(t.fullPath.substring(0,t.fullPath.lastIndexOf("/")))?""!==t.fullPath.substring(0,t.fullPath.lastIndexOf("/"))?(r.push(t.fullPath.substring(0,t.fullPath.lastIndexOf("/"))),html$1`
            <div class='file-upload-table'>
              <div class='file-upload-cell'>
                <mgt-file
                  .fileDetails=${{name:t.fullPath.substring(1,t.fullPath.lastIndexOf("/")),folder:"Folder"}}
                  .view=${exports.ViewType.oneline}
                  class="mgt-file-item"
                >
                </mgt-file>
              </div>
            </div>
            ${this.renderFileTemplate(t,"file-upload-folder-tab")}`):html$1`${this.renderFileTemplate(t,"")}`:html$1`${this.renderFileTemplate(t,"file-upload-folder-tab")}`));return html$1`${o}`}return null}renderFileTemplate(t,r){return html$1`
        <div class="${t.completed?"file-upload-table":"file-upload-table upload"}">
          <div class="${r+("lastModifiedDateTime"===t.fieldUploadResponse?" file-upload-dialog-success":"")}">
            <div class='file-upload-cell'>
              <div style=${"description"===t.fieldUploadResponse?"opacity: 0.5;":""}>
                <div class="file-upload-status">
                  ${t.iconStatus}
                </div>
                <mgt-file
                  .fileDetails=${t.driveItem}
                  .view=${t.view}
                  .line2Property=${t.fieldUploadResponse}
                  class="mgt-file-item"
                  >
                </mgt-file>
              </div>
            </div>
              ${!1===t.completed?this.renderFileUploadTemplate(t):null}
            </div>
          </div>
        </div>
        `}renderFileUploadTemplate(t){return html$1`
    <div class='file-upload-cell'>
      <div class='file-upload-table file-upload-name' >
        <div class='file-upload-cell'>
          <div title="${t.file.name}" class='file-upload-filename'>${t.file.name}</div>
        </div>
      </div>
      <div class='file-upload-table'>
        <div class='file-upload-cell'>
          <div class="${t.completed?"file-upload-table":"file-upload-table upload"}">
            <fluent-progress class="file-upload-bar" value="${t.percent}" ></fluent-progress>
            <div class='file-upload-cell' style="padding-left:5px">
              <span>${t.percent}%</span>
              <span
                class="file-upload-cancel"
                @click=${r=>this.deleteFileUploadSession(t)}>
                ${getSvg(dR.Cancel)}
              </span>
            </div>
          <div>
        </div>
      </div>
    </div>
    `}onFileUploadChange(t){return __awaiter$o(this,void 0,void 0,(function*(){!t||t.target.files.length<1||(this.getSelectedFiles(yield this.getFilesFromUploadArea(t.target.files)),t.target.value=null)}))}onFileUploadClick(){this.renderRoot.querySelector("#file-upload-input").click()}deleteFileUploadSession(t){return __awaiter$o(this,void 0,void 0,(function*(){try{if(void 0!==t.uploadUrl){yield function deleteSessionFile(t,r){return __awaiter$q(this,void 0,void 0,(function*(){try{const o="files.readwrite";let i;try{i=yield t.client.api(r).middlewareOptions(prepScopes(o)).delete((t=>t))}catch(t){}return i||null}catch(t){return null}}))}(this.fileUploadList.graph,t.uploadUrl);t.uploadUrl=void 0,t.completed=!0,this.setUploadFail(t,PR.cancelUploadFile)}else t.uploadUrl=void 0,t.completed=!0,this.setUploadFail(t,PR.cancelUploadFile)}catch(r){t.uploadUrl=void 0,t.completed=!0,this.setUploadFail(t,PR.cancelUploadFile)}}))}getSelectedFiles(t){return __awaiter$o(this,void 0,void 0,(function*(){let r=[],o=[];this._applyAll=!1,this._applyAllConflitBehavior=null,this._maximumFiles=!1,this._maximumFileSize=!1,this._excludedFileType=!1,this.filesToUpload.forEach((t=>__awaiter$o(this,void 0,void 0,(function*(){t.completed?o.push(t):r.push(t)}))));for(var i=0;i<t.length;i++){const o=t[i],s=""===o.fullPath?"/"+o.name:o.fullPath;if(0===r.filter((t=>t.fullPath===s)).length){let o=!0;if(r.length>=this.fileUploadList.maxUploadFile&&(o=!1,!this._maximumFiles)){const r=yield this.getFileUploadStatus(t[i],s,"MaxFiles",this.fileUploadList);if(null!==r){if(0===r[0])return null;1===r[0]&&(this._maximumFiles=!0)}}if(void 0!==this.fileUploadList.maxFileSize&&o&&t[i].size>1024*this.fileUploadList.maxFileSize&&(o=!1,!1===this._maximumFileSize)){const r=yield this.getFileUploadStatus(t[i],s,"MaxFileSize",this.fileUploadList);null!==r&&1===r[0]&&(this._maximumFileSize=!0)}if(void 0!==this.fileUploadList.excludedFileExtensions&&this.fileUploadList.excludedFileExtensions.length>0&&o&&this.fileUploadList.excludedFileExtensions.filter((r=>t[i].name.toLowerCase().indexOf(r.toLowerCase())>-1)).length>0&&(o=!1,!1===this._excludedFileType)){const r=yield this.getFileUploadStatus(t[i],s,"ExcludedFileType",this.fileUploadList);null!==r&&1===r[0]&&(this._excludedFileType=!0)}if(o){const o=yield this.getFileUploadStatus(t[i],s,"Upload",this.fileUploadList);let l=!1;null!==o&&(-1===o[0]?l=!0:(this._applyAll=Boolean(o[0]),this._applyAllConflitBehavior=o[1]?1:0)),r.push({file:t[i],driveItem:{name:t[i].name},fullPath:s,conflictBehavior:null!==o?o[1]?1:0:null,iconStatus:null,percent:1,view:exports.ViewType.image,completed:l,maxSize:this._maxChunckSize,minSize:0})}}}r=r.sort(((t,r)=>t.fullPath.substring(0,t.fullPath.lastIndexOf("/")).localeCompare(r.fullPath.substring(0,r.fullPath.lastIndexOf("/"))))),r.forEach((t=>{if(0!==o.filter((r=>r.fullPath===t.fullPath)).length){let r=o.findIndex((r=>r.fullPath===t.fullPath));o.splice(r,1)}})),r.push(...o),this.filesToUpload=r,this.filesToUpload.forEach((t=>__awaiter$o(this,void 0,void 0,(function*(){yield this.sendFileItemGraph(t)}))))}))}getFileUploadStatus(t,r,o,i){const s=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return __awaiter$o(this,void 0,void 0,(function*(){const l=this.renderRoot.querySelector("#file-upload-dialog");switch(o){case"Upload":return null!==(yield function getGraphfile(t,r){return __awaiter$q(this,void 0,void 0,(function*(){try{const o="files.read";let i;try{i=yield t.api(r).middlewareOptions(prepScopes(o)).get().catch((t=>null))}catch(t){}return i||null}catch(t){return null}}))}(this.fileUploadList.graph,`${this.getGrapQuery(r)}?$select=id`))?!0===this._applyAll?[this._applyAll,this._applyAllConflitBehavior]:(l.classList.add("visible"),this._dialogTitle=PR.fileReplaceTitle,this._dialogContent=PR.fileReplace.replace("{FileName}",t.name),this._dialogCheckBox=PR.checkApplyAll,this._dialogPrimaryButton=PR.buttonReplace,this._dialogSecondaryButton=PR.buttonKeep,s.requestStateUpdate.call(this,!0),new Promise((t=>__awaiter$o(this,void 0,void 0,(function*(){let r=this.renderRoot.querySelector(".file-upload-dialog-close"),o=this.renderRoot.querySelector(".file-upload-dialog-ok"),i=this.renderRoot.querySelector(".file-upload-dialog-cancel"),s=this.renderRoot.querySelector("#file-upload-dialog-check");function onOkDialogClick(){l.classList.remove("visible"),t([s.checked?1:0,1])}function onCancelDialogClick(){l.classList.remove("visible"),t([s.checked?1:0,0])}function onCloseDialogClick(){l.classList.remove("visible"),t([-1])}s.checked=!1,s.classList.remove("hide"),o.removeEventListener("click",onOkDialogClick),i.removeEventListener("click",onCancelDialogClick),r.removeEventListener("click",onCloseDialogClick),o.addEventListener("click",onOkDialogClick),i.addEventListener("click",onCancelDialogClick),r.addEventListener("click",onCloseDialogClick)}))))):null;case"MaxFiles":return l.classList.add("visible"),this._dialogTitle=PR.maximumFilesTitle,this._dialogContent=PR.maximumFiles.split("{MaxNumber}").join(i.maxUploadFile.toString()),this._dialogCheckBox=PR.checkApplyAll,this._dialogPrimaryButton=PR.buttonUpload,this._dialogSecondaryButton=PR.buttonReselect,s.requestStateUpdate.call(this,!0),new Promise((t=>__awaiter$o(this,void 0,void 0,(function*(){let r=this.renderRoot.querySelector(".file-upload-dialog-ok"),o=this.renderRoot.querySelector(".file-upload-dialog-cancel"),i=this.renderRoot.querySelector(".file-upload-dialog-close"),s=this.renderRoot.querySelector("#file-upload-dialog-check");function onOkDialogClick(){l.classList.remove("visible"),t([1])}function onCancelDialogClick(){l.classList.remove("visible"),t([0])}s.checked=!1,s.classList.add("hide"),r.removeEventListener("click",onOkDialogClick),o.removeEventListener("click",onCancelDialogClick),i.removeEventListener("click",onCancelDialogClick),r.addEventListener("click",onOkDialogClick),o.addEventListener("click",onCancelDialogClick),i.addEventListener("click",onCancelDialogClick)}))));case"ExcludedFileType":return l.classList.add("visible"),this._dialogTitle=PR.fileTypeTitle,this._dialogContent=PR.fileType.replace("{FileName}",t.name)+" ("+i.excludedFileExtensions.join(",")+")",this._dialogCheckBox=PR.checkAgain,this._dialogPrimaryButton=PR.buttonOk,this._dialogSecondaryButton=PR.buttonCancel,s.requestStateUpdate.call(this,!0),new Promise((t=>__awaiter$o(this,void 0,void 0,(function*(){let r=this.renderRoot.querySelector(".file-upload-dialog-ok"),o=this.renderRoot.querySelector(".file-upload-dialog-cancel"),i=this.renderRoot.querySelector(".file-upload-dialog-close"),s=this.renderRoot.querySelector("#file-upload-dialog-check");function onOkDialogClick(){l.classList.remove("visible"),t([s.checked?1:0])}function onCancelDialogClick(){l.classList.remove("visible"),t([0])}s.checked=!1,s.classList.remove("hide"),r.removeEventListener("click",onOkDialogClick),o.removeEventListener("click",onCancelDialogClick),i.removeEventListener("click",onCancelDialogClick),r.addEventListener("click",onOkDialogClick),o.addEventListener("click",onCancelDialogClick),i.addEventListener("click",onCancelDialogClick)}))));case"MaxFileSize":return l.classList.add("visible"),this._dialogTitle=PR.maximumFileSizeTitle,this._dialogContent=PR.maximumFileSize.replace("{FileSize}",formatBytes(i.maxFileSize)).replace("{FileName}",t.name)+formatBytes(t.size)+".",this._dialogCheckBox=PR.checkAgain,this._dialogPrimaryButton=PR.buttonOk,this._dialogSecondaryButton=PR.buttonCancel,s.requestStateUpdate.call(this,!0),new Promise((t=>__awaiter$o(this,void 0,void 0,(function*(){let r=this.renderRoot.querySelector(".file-upload-dialog-ok"),o=this.renderRoot.querySelector(".file-upload-dialog-cancel"),i=this.renderRoot.querySelector(".file-upload-dialog-close"),s=this.renderRoot.querySelector("#file-upload-dialog-check");function onOkDialogClick(){l.classList.remove("visible"),t([s.checked?1:0])}function onCancelDialogClick(){l.classList.remove("visible"),t([0])}s.checked=!1,s.classList.remove("hide"),r.removeEventListener("click",onOkDialogClick),o.removeEventListener("click",onCancelDialogClick),i.removeEventListener("click",onCancelDialogClick),r.addEventListener("click",onOkDialogClick),o.addEventListener("click",onCancelDialogClick),i.addEventListener("click",onCancelDialogClick)}))))}}))}getGrapQuery(t){let r="";return this.fileUploadList.itemPath&&this.fileUploadList.itemPath.length>0&&(r="/"===this.fileUploadList.itemPath.substring(0,1)?this.fileUploadList.itemPath:"/"+this.fileUploadList.itemPath),this.fileUploadList.userId&&this.fileUploadList.itemId?`/users/${this.fileUploadList.userId}/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.userId&&this.fileUploadList.itemPath?`/users/${this.fileUploadList.userId}/drive/root:${r}${t}`:this.fileUploadList.groupId&&this.fileUploadList.itemId?`/groups/${this.fileUploadList.groupId}/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.groupId&&this.fileUploadList.itemPath?`/groups/${this.fileUploadList.groupId}/drive/root:${r}${t}`:this.fileUploadList.driveId&&this.fileUploadList.itemId?`/drives/${this.fileUploadList.driveId}/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.driveId&&this.fileUploadList.itemPath?`/drives/${this.fileUploadList.driveId}/root:${r}${t}`:this.fileUploadList.siteId&&this.fileUploadList.itemId?`/sites/${this.fileUploadList.siteId}/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.siteId&&this.fileUploadList.itemPath?`/sites/${this.fileUploadList.siteId}/drive/root:${r}${t}`:this.fileUploadList.itemId?`/me/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.itemPath?`/me/drive/root:${r}${t}`:`/me/drive/root:${t}`}sendFileItemGraph(t){return __awaiter$o(this,void 0,void 0,(function*(){const r=this.fileUploadList.graph;let o="";if(t.file.size<this._maxChunckSize)try{t.completed||(null!==t.conflictBehavior&&1!==t.conflictBehavior||(o=`${this.getGrapQuery(t.fullPath)}:/content`),0===t.conflictBehavior&&(o=`${this.getGrapQuery(t.fullPath)}:/content?@microsoft.graph.conflictBehavior=rename`),t.driveItem=yield function sendFileContent(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){try{const i="files.readwrite";let s;try{s=yield t.client.api(r).middlewareOptions(prepScopes(i)).put(o)}catch(t){}return s||null}catch(t){return null}}))}(r,o,t.file),null!==t.driveItem?this.setUploadSuccess(t):(t.driveItem={name:t.file.name},this.setUploadFail(t,PR.failUploadFile)))}catch(r){this.setUploadFail(t,PR.failUploadFile)}else if(!t.completed&&void 0===t.uploadUrl){const o=yield function getUploadSession(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){try{const i="files.readwrite",s={item:{"@microsoft.graph.conflictBehavior":0===o||null===o?"rename":"replace"}};let l;try{l=yield t.api(r).middlewareOptions(prepScopes(i)).post(JSON.stringify(s))}catch(t){}return l||null}catch(t){return null}}))}(r,`${this.getGrapQuery(t.fullPath)}:/createUploadSession`,t.conflictBehavior);try{if(null!==o){t.uploadUrl=o.uploadUrl;const i=yield this.sendSessionUrlGraph(r,t);null!==i?(t.driveItem=i,this.setUploadSuccess(t)):this.setUploadFail(t,PR.failUploadFile)}else this.setUploadFail(t,PR.failUploadFile)}catch(t){}}}))}sendSessionUrlGraph(t,r){const o=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return __awaiter$o(this,void 0,void 0,(function*(){for(;r.file.size>r.minSize;){void 0===r.mimeStreamString&&(r.mimeStreamString=yield this.readFileContent(r.file));const i=new Blob([r.mimeStreamString.slice(r.minSize,r.maxSize)]);if(r.percent=Math.round(r.maxSize/r.file.size*100),o.requestStateUpdate.call(this,!0),void 0===r.uploadUrl)return null;{const o=yield sendFileChunck(t,r.uploadUrl,""+(r.maxSize-r.minSize),`bytes ${r.minSize}-${r.maxSize-1}/${r.file.size}`,i);if(null===o)return null;if(void 0!==o.id)return o;void 0!==o.nextExpectedRanges&&(r.minSize=parseInt(o.nextExpectedRanges[0].split("-")[0]),r.maxSize=r.minSize+this._maxChunckSize,r.maxSize>r.file.size&&(r.maxSize=r.file.size))}}}))}setUploadSuccess(t){t.percent=100,super.requestStateUpdate(!0),setTimeout((()=>{t.iconStatus=getSvg(dR.Success),t.view=exports.ViewType.twolines,t.fieldUploadResponse="lastModifiedDateTime",t.completed=!0,super.requestStateUpdate(!0),clearFilesCache()}),500)}setUploadFail(t,r){setTimeout((()=>{t.iconStatus=getSvg(dR.Fail),t.view=exports.ViewType.twolines,t.driveItem.description=r,t.fieldUploadResponse="description",t.completed=!0,super.requestStateUpdate(!0)}),500)}readFileContent(t){return new Promise(((r,o)=>{const i=new FileReader;i.onloadend=t=>{r(i.result)},i.onerror=t=>{o(t)},i.readAsArrayBuffer(t)}))}getFilesFromUploadArea(t){return __awaiter$o(this,void 0,void 0,(function*(){const r=[];let o;const i=[];for(let s=0;s<t.length;s++){const l=t[s];if("file"!==l.kind){const t=l;t&&(t.fullPath="",i.push(t))}else if(l.getAsEntry)if(o=l.getAsEntry(),o.isDirectory)r.push(o);else{const t=l.getAsFile();t&&(t.fullPath="",i.push(t))}else if(l.webkitGetAsEntry)if(o=l.webkitGetAsEntry(),o.isDirectory)r.push(o);else{const t=l.getAsFile();t&&(t.fullPath="",i.push(t))}else if("function"==typeof l.getAsFile){const t=l.getAsFile();t&&(t.fullPath="",i.push(t))}}if(r.length>0){const t=yield this.getFolderFiles(r);i.push(...t)}return i}))}getFolderFiles(t){return new Promise((r=>{let o=0;const i=[];function readEntry(t,s){t.isDirectory?function readReaderContent(t){o++,t.readEntries((t=>{o--;for(const r of t)readEntry(r,r.fullPath);0===o&&r(i)}))}(t.createReader()):(o++,t.file((t=>{o--,t.fullPath=s,i.push(t),0===o&&r(i)})))}t.forEach((t=>{readEntry(t,"")}))}))}},__decorate$n([property({type:Object}),__metadata$m("design:type",Array)],exports.MgtFileUpload.prototype,"filesToUpload",void 0),__decorate$n([property({type:Object}),__metadata$m("design:type",Object)],exports.MgtFileUpload.prototype,"fileUploadList",void 0),exports.MgtFileUpload=__decorate$n([customElement$1("mgt-file-upload"),__metadata$m("design:paramtypes",[])],exports.MgtFileUpload);const oF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--file-item-background-color--hover:rgba(0, 0, 0, 0.1);--file-item-background-color--active:rgba(0, 0, 0, 0.05);--file-list-background-color:#ffffff;--file-upload-button-background-color:#f3f2f1;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.1);--file-upload-dialog-content-background-color:white;--file-upload-dialog-content-color:#323130;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}.mgt-dark{--file-item-background-color--hover:#0078d4;--file-item-background-color--active:#238ada;--file-list-background-color:#424242;--file-upload-button-background-color:#006cbe;--file-upload-dialog-background-color:rgba(0, 0, 0, 0.3);--file-upload-dialog-content-background-color:#4a4a4a;--file-upload-dialog-content-color:white;--file-upload-dialog-primarybutton-color:white;--file-upload-dialog-primarybutton-background-color:#006cbe}:host{font-family:var(--default-font-family);font-size:var(--default-font-size)}:host .file-list-wrapper,mgt-file-item .file-list-wrapper{background-color:var(--file-list-background-color,#fff);box-shadow:var(--file-list-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--file-list-border-radius,4px);border:var(--file-list-border,none);position:relative;color:var(--color-sub1,#323130);display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .file-list,mgt-file-item .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,4px 0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item,mgt-file-item .file-list-wrapper .file-list .file-item{border-top:var(--file-item-border-top,none);border-left:var(--file-item-border-left,none);border-right:var(--file-item-border-right,none);border-bottom:var(--file-item-border-bottom,none);margin:var(--file-item-margin,0 4px);border-radius:var(--file-item-border-radius,2px);cursor:pointer}:host .file-list-wrapper .file-list .file-item mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item mgt-file{--file-background-color:$background-color}:host .file-list-wrapper .file-list .file-item.focused,:host .file-list-wrapper .file-list .file-item:hover,mgt-file-item .file-list-wrapper .file-list .file-item.focused,mgt-file-item .file-list-wrapper .file-list .file-item:hover{background-color:var(--file-item-background-color--hover,rgba(0,0,0,.1));border-radius:4px}:host .file-list-wrapper .file-list .file-item.focused mgt-file,:host .file-list-wrapper .file-list .file-item:hover mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.focused mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:hover mgt-file{--file-background-color:$file-item-background-color--hover}:host .file-list-wrapper .file-list .file-item.selected,:host .file-list-wrapper .file-list .file-item:active,mgt-file-item .file-list-wrapper .file-list .file-item.selected,mgt-file-item .file-list-wrapper .file-list .file-item:active{background-color:var(--file-item-background-color--active,rgba(0,0,0,.05))}:host .file-list-wrapper .file-list .file-item.selected mgt-file,:host .file-list-wrapper .file-list .file-item:active mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item.selected mgt-file,mgt-file-item .file-list-wrapper .file-list .file-item:active mgt-file{--file-background-color:$file-item-background-color--active}:host .file-list-wrapper .progress-ring,mgt-file-item .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more,mgt-file-item .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,6px);border-bottom-right-radius:var(--show-more-button-border-bottom-right-radius,8px);border-bottom-left-radius:var(--show-more-button-border-bottom-left-radius,8px);cursor:pointer;background-color:var(--show-more-button-background-color,var(--background-color-sub2,#f3f2f1))}:host .file-list-wrapper .show-more:hover,mgt-file-item .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color--hover,var(--file-item-background-color--hover,rgba(0,0,0,.1)))}
`],nF={showMoreSubtitle:"Show more items"};var __decorate$m=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$l=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$n=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.MgtFileList=class MgtFileList extends MgtTemplatedComponent{static get styles(){return oF}get strings(){return nF}get fileListQuery(){return this._fileListQuery}set fileListQuery(t){t!==this._fileListQuery&&(this._fileListQuery=t,this.requestStateUpdate(!0))}get fileQueries(){return this._fileQueries}set fileQueries(t){arraysAreEqual(this._fileQueries,t)||(this._fileQueries=t,this.requestStateUpdate(!0))}get siteId(){return this._siteId}set siteId(t){t!==this._siteId&&(this._siteId=t,this.requestStateUpdate(!0))}get driveId(){return this._driveId}set driveId(t){t!==this._driveId&&(this._driveId=t,this.requestStateUpdate(!0))}get groupId(){return this._groupId}set groupId(t){t!==this._groupId&&(this._groupId=t,this.requestStateUpdate(!0))}get itemId(){return this._itemId}set itemId(t){t!==this._itemId&&(this._itemId=t,this.requestStateUpdate(!0))}get itemPath(){return this._itemPath}set itemPath(t){t!==this._itemPath&&(this._itemPath=t,this.requestStateUpdate(!0))}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.requestStateUpdate(!0))}get insightType(){return this._insightType}set insightType(t){t!==this._insightType&&(this._insightType=t,this.requestStateUpdate(!0))}get fileExtensions(){return this._fileExtensions}set fileExtensions(t){arraysAreEqual(this._fileExtensions,t)||(this._fileExtensions=t,this.requestStateUpdate(!0))}get pageSize(){return this._pageSize}set pageSize(t){t!==this._pageSize&&(this._pageSize=t,this.requestStateUpdate(!0))}get maxFileSize(){return this._maxFileSize}set maxFileSize(t){t!==this._maxFileSize&&(this._maxFileSize=t,this.requestStateUpdate(!0))}get maxUploadFile(){return this._maxUploadFile}set maxUploadFile(t){t!==this._maxUploadFile&&(this._maxUploadFile=t,this.requestStateUpdate(!0))}get excludedFileExtensions(){return this._excludedFileExtensions}set excludedFileExtensions(t){arraysAreEqual(this._excludedFileExtensions,t)||(this._excludedFileExtensions=t,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set([...exports.MgtFile.requiredScopes])]}constructor(){super(),this._focusedItemIndex=-1,this.pageSize=10,this.itemView=exports.ViewType.twolines,this.maxUploadFile=10,this.enableFileUpload=!1,this._preloadedFiles=[]}requestStateUpdate(t){return this.clearState(),super.requestStateUpdate(t)}clearState(){super.clearState(),this.files=null}render(){return!this.files&&this.isLoadingState?this.renderLoading():this.files&&0!==this.files.length?this.renderTemplate("default",{files:this.files})||this.renderFiles():this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||html$1``}renderNoData(){return this.renderTemplate("no-data",null)||(!0===this.enableFileUpload&&void 0!==Providers.globalProvider?html$1`
      <fluent-design-system-provider use-defaults>
        <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
          ${this.renderFileUpload()}
        </div>
      </fluent-design-system-provider>
      `:html$1``)}renderFiles(){return html$1`
    <fluent-design-system-provider use-defaults>
      <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
        ${this.enableFileUpload?this.renderFileUpload():null}
        <ul
          id="file-list"
          class="file-list"
          tabindex="0"
          @keydown="${this.onFileListKeyDown}"
          @keyup="${this.onFileListKeyUp}"
          @blur="${this.onFileListOut}"
        >
          ${kR(this.files,(t=>t.id),(t=>html$1`
              <li class="file-item" @click=${r=>this.handleItemSelect(t,r)}>
                ${this.renderFile(t)}
              </li>
            `))}
        </ul>
        ${!this.hideMoreFilesButton&&this.pageIterator&&(this.pageIterator.hasNext||this._preloadedFiles.length)?this.renderMoreFileButton():null}
      </div>
    </fluent-design-system-provider>
    `}renderFile(t){const r=this.itemView;return this.renderTemplate("file",{file:t},t.id)||html$1`
        <mgt-file .fileDetails=${t} .view=${r}></mgt-file>
      `}renderMoreFileButton(){return this._isLoadingMore?html$1`
        <fluent-progress-ring role="progressbar" viewBox="0 0 8 8" class="progress-ring"></fluent-progress-ring>
      `:html$1`<a id="show-more" class="show-more" @click=${()=>this.renderNextPage()} tabindex="0" @keydown=${this.onShowMoreKeyDown}><span>${this.strings.showMoreSubtitle}<span></a>`}renderFileUpload(){const t={graph:Providers.globalProvider.graph.forComponent(this),driveId:this.driveId,excludedFileExtensions:this.excludedFileExtensions,groupId:this.groupId,itemId:this.itemId,itemPath:this.itemPath,userId:this.userId,siteId:this.siteId,maxFileSize:this.maxFileSize,maxUploadFile:this.maxUploadFile};return html$1`
        <mgt-file-upload .fileUploadList=${t} ></mgt-file-upload>
      `}onShowMoreKeyDown(t){t&&"Enter"===t.code&&(t.preventDefault(),this.renderNextPage())}onFileListKeyUp(t){const r=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];"Enter"!==t.code&&"Space"!==t.code||(t.preventDefault(),null==r||r.classList.remove("selected"),null==r||r.classList.add("focused"))}onFileListKeyDown(t){const r=this.renderRoot.querySelector(".file-list");let o;if(r&&r.children.length){if("ArrowUp"!==t.code&&"ArrowDown"!==t.code||("ArrowUp"===t.code&&(-1===this._focusedItemIndex&&(this._focusedItemIndex=r.children.length),this._focusedItemIndex=(this._focusedItemIndex-1+r.children.length)%r.children.length),"ArrowDown"===t.code&&(this._focusedItemIndex=(this._focusedItemIndex+1)%r.children.length),o=r.children[this._focusedItemIndex],this.updateItemBackgroundColor(r,o,"focused")),"Enter"===t.code||"Space"===t.code){o=r.children[this._focusedItemIndex];const i=o.children[0];t.preventDefault(),this.fireCustomEvent("itemClick",i.fileDetails),this.updateItemBackgroundColor(r,o,"selected")}"Tab"===t.code&&(o=r.children[this._focusedItemIndex],null==o||o.classList.remove("focused"))}}onFileListOut(){const t=this.renderRoot.querySelector(".file-list").children[this._focusedItemIndex];null==t||t.classList.remove("focused")}loadState(){return __awaiter$n(this,void 0,void 0,(function*(){const t=Providers.globalProvider;if(!t||t.state===exports.ProviderState.Loading)return;if(t.state===exports.ProviderState.SignedOut)return void(this.files=null);const r=t.graph.forComponent(this);let o,i;const s=!(this.driveId||this.siteId||this.groupId||this.userId);if((this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this.files=null),!this.files){let t;if(this.fileListQuery?i=yield function getFilesByListQueryIterator(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){let i,s;const l=sR.fileLists.stores.fileLists;s=CacheService.getCache(sR.fileLists,l);const u=yield getFileListFromCache(s,l,r);if(u)return i=yield getFilesPageIteratorFromCache(t,u.files,u.nextLink),i;const h=["files.read","sites.read.all"];let m;try{m=yield t.api(r).middlewareOptions(prepScopes(...h)),o&&m.top(o),i=yield getFilesPageIteratorFromRequest(t,m),getIsFileListsCacheEnabled()&&s.putValue(r,{files:i.value,nextLink:i._nextLink})}catch(t){}return i||null}))}(r,this.fileListQuery,this.pageSize):this.fileQueries?o=yield function getFilesByQueries(t,r){return __awaiter$q(this,void 0,void 0,(function*(){if(!r||0===r.length)return[];const o=t.createBatch(),i=[],s=["files.read"];let l,u;getIsFilesCacheEnabled()&&(l=CacheService.getCache(sR.files,sR.files.stores.fileQueries));for(const t of r)getIsFilesCacheEnabled()&&(u=yield l.getValue(t)),getIsFilesCacheEnabled()&&u&&getFileInvalidationTime()>Date.now()-u.timeCached?i.push(JSON.parse(u.file)):""!==t&&o.get(t,t,s);try{const t=yield o.executeAll();for(const o of r){const r=t.get(o);r&&r.content&&(i.push(r.content),getIsFilesCacheEnabled()&&l.putValue(o,{file:JSON.stringify(r.content)}))}return i}catch(o){try{return Promise.all(r.filter((t=>t&&""!==t)).map((r=>__awaiter$q(this,void 0,void 0,(function*(){const o=yield getDriveItemByQuery(t,r);if(o)return getIsFilesCacheEnabled()&&l.putValue(r,{file:JSON.stringify(o)}),o})))))}catch(t){return[]}}}))}(r,this.fileQueries):s?this.itemId?i=yield function getFilesByIdIterator(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/me/drive/items/${r}/children`;let s,l;const u=sR.fileLists.stores.fileLists;l=CacheService.getCache(sR.fileLists,u);const h=yield getFileListFromCache(l,u,i);if(h)return s=yield getFilesPageIteratorFromCache(t,h.files,h.nextLink),s;let m;try{m=t.api(i).middlewareOptions(prepScopes("files.read")),o&&m.top(o),s=yield getFilesPageIteratorFromRequest(t,m),getIsFileListsCacheEnabled()&&l.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(t){}return s||null}))}(r,this.itemId,this.pageSize):this.itemPath?i=yield function getFilesByPathIterator(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){const i=`/me/drive/root:/${r}:/children`;let s,l;const u=sR.fileLists.stores.fileLists;l=CacheService.getCache(sR.fileLists,u);const h=yield getFileListFromCache(l,u,i);if(h)return s=yield getFilesPageIteratorFromCache(t,h.files,h.nextLink),s;let m;try{m=t.api(i).middlewareOptions(prepScopes("files.read")),o&&m.top(o),s=yield getFilesPageIteratorFromRequest(t,m),getIsFileListsCacheEnabled()&&l.putValue(i,{files:s.value,nextLink:s._nextLink})}catch(t){}return s||null}))}(r,this.itemPath,this.pageSize):this.insightType?o=yield function getMyInsightsFiles(t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o=`/me/insights/${r}`;let i;const s=sR.fileLists.stores.insightfileLists;i=CacheService.getCache(sR.fileLists,s);const l=yield getFileListFromCache(i,s,o);if(l)return l.files;const u=["sites.read.all"];let h;try{h=yield t.api(o).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions(prepScopes(...u)).get()}catch(t){}const m=yield getDriveItemsByInsights(t,h,u);return getIsFileListsCacheEnabled()&&i.putValue(o,{files:m}),m||null}))}(r,this.insightType):i=yield function getFilesIterator(t,r){return __awaiter$q(this,void 0,void 0,(function*(){const o="/me/drive/root/children";let i,s;const l=sR.fileLists.stores.fileLists;s=CacheService.getCache(sR.fileLists,l);const u=yield getFileListFromCache(s,l,o);if(u)return i=yield getFilesPageIteratorFromCache(t,u.files,u.nextLink),i;let h;try{h=t.api(o).middlewareOptions(prepScopes("files.read")),r&&h.top(r),i=yield getFilesPageIteratorFromRequest(t,h),getIsFileListsCacheEnabled()&&s.putValue(o,{files:i.value,nextLink:i._nextLink})}catch(t){}return i||null}))}(r,this.pageSize):this.driveId?this.itemId?i=yield function getDriveFilesByIdIterator(t,r,o,i){return __awaiter$q(this,void 0,void 0,(function*(){const s=`/drives/${r}/items/${o}/children`;let l,u;const h=sR.fileLists.stores.fileLists;u=CacheService.getCache(sR.fileLists,h);const m=yield getFileListFromCache(u,h,s);if(m)return l=yield getFilesPageIteratorFromCache(t,m.files,m.nextLink),l;let v;try{v=t.api(s).middlewareOptions(prepScopes("files.read")),i&&v.top(i),l=yield getFilesPageIteratorFromRequest(t,v),getIsFileListsCacheEnabled()&&u.putValue(s,{files:l.value,nextLink:l._nextLink})}catch(t){}return l||null}))}(r,this.driveId,this.itemId,this.pageSize):this.itemPath&&(i=yield function getDriveFilesByPathIterator(t,r,o,i){return __awaiter$q(this,void 0,void 0,(function*(){const s=`/drives/${r}/root:/${o}:/children`;let l,u;const h=sR.fileLists.stores.fileLists;u=CacheService.getCache(sR.fileLists,h);const m=yield getFileListFromCache(u,h,s);if(m)return l=yield getFilesPageIteratorFromCache(t,m.files,m.nextLink),l;let v;try{v=t.api(s).middlewareOptions(prepScopes("files.read")),i&&v.top(i),l=yield getFilesPageIteratorFromRequest(t,v),getIsFileListsCacheEnabled()&&u.putValue(s,{files:l.value,nextLink:l._nextLink})}catch(t){}return l||null}))}(r,this.driveId,this.itemPath,this.pageSize)):this.groupId?this.itemId?i=yield function getGroupFilesByIdIterator(t,r,o,i){return __awaiter$q(this,void 0,void 0,(function*(){const s=`/groups/${r}/drive/items/${o}/children`;let l,u;const h=sR.fileLists.stores.fileLists;u=CacheService.getCache(sR.fileLists,h);const m=yield getFileListFromCache(u,h,s);if(m)return l=yield getFilesPageIteratorFromCache(t,m.files,m.nextLink),l;let v;try{v=t.api(s).middlewareOptions(prepScopes("files.read")),i&&v.top(i),l=yield getFilesPageIteratorFromRequest(t,v),getIsFileListsCacheEnabled()&&u.putValue(s,{files:l.value,nextLink:l._nextLink})}catch(t){}return l||null}))}(r,this.groupId,this.itemId,this.pageSize):this.itemPath&&(i=yield function getGroupFilesByPathIterator(t,r,o,i){return __awaiter$q(this,void 0,void 0,(function*(){const s=`/groups/${r}/drive/root:/${o}:/children`;let l,u;const h=sR.fileLists.stores.fileLists;u=CacheService.getCache(sR.fileLists,h);const m=yield getFileListFromCache(u,h,s);if(m)return l=yield getFilesPageIteratorFromCache(t,m.files,m.nextLink),l;let v;try{v=t.api(s).middlewareOptions(prepScopes("files.read")),i&&v.top(i),l=yield getFilesPageIteratorFromRequest(t,v),getIsFileListsCacheEnabled()&&u.putValue(s,{files:l.value,nextLink:l._nextLink})}catch(t){}return l||null}))}(r,this.groupId,this.itemPath,this.pageSize)):this.siteId?this.itemId?i=yield function getSiteFilesByIdIterator(t,r,o,i){return __awaiter$q(this,void 0,void 0,(function*(){const s=`/sites/${r}/drive/items/${o}/children`;let l,u;const h=sR.fileLists.stores.fileLists;u=CacheService.getCache(sR.fileLists,h);const m=yield getFileListFromCache(u,h,s);if(m)return l=yield getFilesPageIteratorFromCache(t,m.files,m.nextLink),l;let v;try{v=t.api(s).middlewareOptions(prepScopes("files.read")),i&&v.top(i),l=yield getFilesPageIteratorFromRequest(t,v),getIsFileListsCacheEnabled()&&u.putValue(s,{files:l.value,nextLink:l._nextLink})}catch(t){}return l||null}))}(r,this.siteId,this.itemId,this.pageSize):this.itemPath&&(i=yield function getSiteFilesByPathIterator(t,r,o,i){return __awaiter$q(this,void 0,void 0,(function*(){const s=`/sites/${r}/drive/root:/${o}:/children`;let l,u;const h=sR.fileLists.stores.fileLists;u=CacheService.getCache(sR.fileLists,h);const m=yield getFileListFromCache(u,h,s);if(m)return l=yield getFilesPageIteratorFromCache(t,m.files,m.nextLink),l;let v;try{v=t.api(s).middlewareOptions(prepScopes("files.read")),i&&v.top(i),l=yield getFilesPageIteratorFromRequest(t,v),getIsFileListsCacheEnabled()&&u.putValue(s,{files:l.value,nextLink:l._nextLink})}catch(t){}return l||null}))}(r,this.siteId,this.itemPath,this.pageSize)):this.userId&&(this.itemId?i=yield function getUserFilesByIdIterator(t,r,o,i){return __awaiter$q(this,void 0,void 0,(function*(){const s=`/users/${r}/drive/items/${o}/children`;let l,u;const h=sR.fileLists.stores.fileLists;u=CacheService.getCache(sR.fileLists,h);const m=yield getFileListFromCache(u,h,s);if(m)return l=yield getFilesPageIteratorFromCache(t,m.files,m.nextLink),l;let v;try{v=t.api(s).middlewareOptions(prepScopes("files.read")),i&&v.top(i),l=yield getFilesPageIteratorFromRequest(t,v),getIsFileListsCacheEnabled()&&u.putValue(s,{files:l.value,nextLink:l._nextLink})}catch(t){}return l||null}))}(r,this.userId,this.itemId,this.pageSize):this.itemPath?i=yield function getUserFilesByPathIterator(t,r,o,i){return __awaiter$q(this,void 0,void 0,(function*(){const s=`/users/${r}/drive/root:/${o}:/children`;let l,u;const h=sR.fileLists.stores.fileLists;u=CacheService.getCache(sR.fileLists,h);const m=yield getFileListFromCache(u,h,s);if(m)return l=yield getFilesPageIteratorFromCache(t,m.files,m.nextLink),l;let v;try{v=t.api(s).middlewareOptions(prepScopes("files.read")),i&&v.top(i),l=yield getFilesPageIteratorFromRequest(t,v),getIsFileListsCacheEnabled()&&u.putValue(s,{files:l.value,nextLink:l._nextLink})}catch(t){}return l||null}))}(r,this.userId,this.itemPath,this.pageSize):this.insightType&&(o=yield function getUserInsightsFiles(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){let i,s;"shared"===o?(i="/me/insights/shared",s=`((lastshared/sharedby/id eq '${r}') and (resourceReference/type eq 'microsoft.graph.driveItem'))`):(i=`/users/${r}/insights/${o}`,s="resourceReference/type eq 'microsoft.graph.driveItem'");const l=`${i}?$filter=${s}`;let u;const h=sR.fileLists.stores.insightfileLists;u=CacheService.getCache(sR.fileLists,h);const m=yield getFileListFromCache(u,h,l);if(m)return m.files;const v=["sites.read.all"];let C;try{C=yield t.api(i).filter(s).middlewareOptions(prepScopes(...v)).get()}catch(t){}const _=yield getDriveItemsByInsights(t,C,v);return getIsFileListsCacheEnabled()&&u.putValue(i,{files:_}),_||null}))}(r,this.userId,this.insightType))),i&&(this.pageIterator=i,this._preloadedFiles=[...this.pageIterator.value],o=this._preloadedFiles.length>=this.pageSize?this._preloadedFiles.splice(0,this.pageSize):this._preloadedFiles.splice(0,this._preloadedFiles.length)),this.fileExtensions&&null!==this.fileExtensions){if(this.pageIterator&&this.pageIterator.value){for(;this.pageIterator.hasNext;)yield fetchNextAndCacheForFilesPageIterator(this.pageIterator);o=this.pageIterator.value,this._preloadedFiles=[]}t=o.filter((t=>{for(const r of this.fileExtensions)if(r==this.getFileExtension(t.name))return t}))}t&&t.length>=0?(this.files=t,this.pageSize&&(o=this.files.splice(0,this.pageSize),this.files=o)):this.files=o}}))}handleItemSelect(t,r){if(this.fireCustomEvent("itemClick",t),r){const t=this.renderRoot.querySelector(".file-list"),o=Array.from(t.children),i=r.target.closest("li"),s=o.indexOf(i);this._focusedItemIndex=s;for(let r=0;r<t.children.length;r++)t.children[r].classList.remove("focused")}}renderNextPage(){return __awaiter$n(this,void 0,void 0,(function*(){if(this._preloadedFiles.length>0)this.files=[...this.files,...this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length))];else if(this.pageIterator.hasNext){this._isLoadingMore=!0;const t=this.renderRoot.querySelector("file-list-wrapper");t&&t.animate&&t.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),yield fetchNextAndCacheForFilesPageIterator(this.pageIterator),this._isLoadingMore=!1,this.files=this.pageIterator.value}this.requestUpdate()}))}getFileExtension(t){return/(?:\.([^.]+))?$/.exec(t)[1]||""}updateItemBackgroundColor(t,r,o){for(let r=0;r<t.children.length;r++)t.children[r].classList.remove(o);r&&(r.classList.add(o),r.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}reload(t=!1){t&&clearFilesCache(),this.requestStateUpdate(!0)}},__decorate$m([property({attribute:"file-list-query"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],exports.MgtFileList.prototype,"fileListQuery",null),__decorate$m([property({attribute:"file-queries",converter:(t,r)=>t?t.split(",").map((t=>t.trim())):null}),__metadata$l("design:type",Array),__metadata$l("design:paramtypes",[Array])],exports.MgtFileList.prototype,"fileQueries",null),__decorate$m([property({type:Object}),__metadata$l("design:type",Array)],exports.MgtFileList.prototype,"files",void 0),__decorate$m([property({attribute:"site-id"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],exports.MgtFileList.prototype,"siteId",null),__decorate$m([property({attribute:"drive-id"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],exports.MgtFileList.prototype,"driveId",null),__decorate$m([property({attribute:"group-id"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],exports.MgtFileList.prototype,"groupId",null),__decorate$m([property({attribute:"item-id"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],exports.MgtFileList.prototype,"itemId",null),__decorate$m([property({attribute:"item-path"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],exports.MgtFileList.prototype,"itemPath",null),__decorate$m([property({attribute:"user-id"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],exports.MgtFileList.prototype,"userId",null),__decorate$m([property({attribute:"insight-type"}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],exports.MgtFileList.prototype,"insightType",null),__decorate$m([property({attribute:"item-view",converter:t=>t&&0!==t.length?(t=t.toLowerCase(),void 0===exports.ViewType[t]?exports.ViewType.threelines:exports.ViewType[t]):exports.ViewType.threelines}),__metadata$l("design:type",Number)],exports.MgtFileList.prototype,"itemView",void 0),__decorate$m([property({attribute:"file-extensions",converter:(t,r)=>t.split(",").map((t=>t.trim()))}),__metadata$l("design:type",Array),__metadata$l("design:paramtypes",[Array])],exports.MgtFileList.prototype,"fileExtensions",null),__decorate$m([property({attribute:"page-size",type:Number}),__metadata$l("design:type",Number),__metadata$l("design:paramtypes",[Number])],exports.MgtFileList.prototype,"pageSize",null),__decorate$m([property({attribute:"hide-more-files-button",type:Boolean}),__metadata$l("design:type",Boolean)],exports.MgtFileList.prototype,"hideMoreFilesButton",void 0),__decorate$m([property({attribute:"max-file-size",type:Number}),__metadata$l("design:type",Number),__metadata$l("design:paramtypes",[Number])],exports.MgtFileList.prototype,"maxFileSize",null),__decorate$m([property({attribute:"enable-file-upload",type:Boolean}),__metadata$l("design:type",Boolean)],exports.MgtFileList.prototype,"enableFileUpload",void 0),__decorate$m([property({attribute:"max-upload-file",type:Number}),__metadata$l("design:type",Number),__metadata$l("design:paramtypes",[Number])],exports.MgtFileList.prototype,"maxUploadFile",null),__decorate$m([property({attribute:"excluded-file-extensions",converter:(t,r)=>t.split(",").map((t=>t.trim()))}),__metadata$l("design:type",Array),__metadata$l("design:paramtypes",[Array])],exports.MgtFileList.prototype,"excludedFileExtensions",null),__decorate$m([internalProperty(),__metadata$l("design:type",Boolean)],exports.MgtFileList.prototype,"_isLoadingMore",void 0),exports.MgtFileList=__decorate$m([customElement$1("mgt-file-list"),__metadata$l("design:paramtypes",[])],exports.MgtFileList);var __decorate$l=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$k=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$m=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.ResponseType=void 0,function(t){t.json="json",t.image="image"}(exports.ResponseType||(exports.ResponseType={}));const getIsResponseCacheEnabled=()=>CacheService.config.response.isEnabled&&CacheService.config.isEnabled;exports.MgtGet=class MgtGet extends MgtTemplatedComponent{constructor(){super(...arguments),this.scopes=[],this.version="v1.0",this.type=exports.ResponseType.json,this.maxPages=3,this.pollingRate=0,this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.isPolling=!1,this.isRefreshing=!1}attributeChangedCallback(t,r,o){super.attributeChangedCallback(t,r,o),this.requestStateUpdate()}refresh(t=!1){this.isRefreshing=!0,t&&this.clearState(),this.requestStateUpdate(t)}clearState(){this.response=null}render(){if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.error)return this.renderTemplate("error",this.error);if(this.hasTemplate("value")&&this.response&&this.response.value){let t;if(Array.isArray(this.response.value)){let r=null;this.isLoadingState&&!this.isPolling&&(r=this.renderTemplate("loading",null)),t=html$1`
          ${this.response.value.map((t=>this.renderTemplate("value",t,t.id)))} ${r}
        `}else t=this.renderTemplate("value",this.response);if(this.hasTemplate("default")){const r=this.renderTemplate("default",this.response);return this.templates.value.templateOrder>this.templates.default.templateOrder?html$1`
            ${r}${t}
          `:html$1`
            ${t}${r}
          `}return t}return this.response?this.renderTemplate("default",this.response)||html$1``:this.hasTemplate("no-data")?this.renderTemplate("no-data",null):html$1``}loadState(){return __awaiter$m(this,void 0,void 0,(function*(){const t=Providers.globalProvider;if(this.error=null,t&&t.state===exports.ProviderState.SignedIn){if(this.resource){try{let r;const o=`${this.version}${this.resource}`;let i=null;if(this.shouldRetrieveCache()){r=CacheService.getCache(sR.get,sR.get.stores.responses);const t=getIsResponseCacheEnabled()?yield r.getValue(o):null;t&&(this.cacheInvalidationPeriod||CacheService.config.response.invalidationPeriod||CacheService.config.defaultInvalidationPeriod)>Date.now()-t.timeCached&&(i=JSON.parse(t.response))}if(!i){let s=this.resource,l=!1;this.response&&this.response["@odata.deltaLink"]?(s=this.response["@odata.deltaLink"],l=!0):l=new URL(s,"https://graph.microsoft.com").pathname.endsWith("delta");const u=t.graph.forComponent(this);let h=u.api(s).version(this.version);if(this.scopes&&this.scopes.length&&(h=h.middlewareOptions(prepScopes(...this.scopes))),this.type===exports.ResponseType.json){if(i=yield h.get(),l&&this.response&&Array.isArray(this.response.value)&&Array.isArray(i.value)&&(i.value=this.response.value.concat(i.value)),this.isPolling||equals(this.response,i)||(this.response=i),i&&Array.isArray(i.value)&&i["@odata.nextLink"]){let t=1,r=i;for(;(t<this.maxPages||this.maxPages<=0||l&&this.pollingRate)&&r&&r["@odata.nextLink"];){t++;const o=r["@odata.nextLink"].split(this.version)[1];r=yield u.client.api(o).version(this.version).get(),r&&r.value&&r.value.length&&(r.value=i.value.concat(r.value),i=r,this.isPolling||(this.response=i))}}}else{if(-1===this.resource.indexOf("/photo/$value")&&-1===this.resource.indexOf("/thumbnails/"))throw new Error("Only /photo/$value and /thumbnails/ endpoints support the image type");let t;if(this.resource.indexOf("/photo/$value")>-1){const r=this.resource.replace("/photo/$value",""),o=yield getPhotoForResource(u,r,this.scopes);o&&(t=o.photo)}else if(this.resource.indexOf("/thumbnails/")>-1){const r=yield function getDocumentThumbnail(t,r,o){return __awaiter$q(this,void 0,void 0,(function*(){try{const i=yield t.api(r).responseType(Ox.RAW).middlewareOptions(prepScopes(...o)).get();if(404===i.status)return{eTag:null,thumbnail:null};if(!i.ok)return null;return{eTag:i.headers.get("eTag"),thumbnail:yield blobToBase64(yield i.blob())}}catch(t){return null}}))}(u,this.resource,this.scopes);r&&(t=r.thumbnail)}t&&(i={image:t})}this.shouldUpdateCache()&&i&&(r=CacheService.getCache(sR.get,sR.get.stores.responses),r.putValue(o,{response:JSON.stringify(i)}))}equals(this.response,i)||(this.response=i)}catch(t){this.error=t}this.response&&(this.error=null,this.pollingRate&&setTimeout((()=>__awaiter$m(this,void 0,void 0,(function*(){this.isPolling=!0,yield this.loadState(),this.isPolling=!1}))),this.pollingRate))}else this.response=null;this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}}))}shouldRetrieveCache(){return getIsResponseCacheEnabled()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}shouldUpdateCache(){return getIsResponseCacheEnabled()&&this.cacheEnabled}},__decorate$l([property({attribute:"resource",reflect:!0,type:String}),__metadata$k("design:type",String)],exports.MgtGet.prototype,"resource",void 0),__decorate$l([property({attribute:"scopes",converter:(t,r)=>t?t.toLowerCase().split(","):null,reflect:!0}),__metadata$k("design:type",Array)],exports.MgtGet.prototype,"scopes",void 0),__decorate$l([property({attribute:"version",reflect:!0,type:String}),__metadata$k("design:type",String)],exports.MgtGet.prototype,"version",void 0),__decorate$l([property({attribute:"type",reflect:!0,type:exports.ResponseType}),__metadata$k("design:type",String)],exports.MgtGet.prototype,"type",void 0),__decorate$l([property({attribute:"max-pages",reflect:!0,type:Number}),__metadata$k("design:type",Number)],exports.MgtGet.prototype,"maxPages",void 0),__decorate$l([property({attribute:"polling-rate",reflect:!0,type:Number}),__metadata$k("design:type",Number)],exports.MgtGet.prototype,"pollingRate",void 0),__decorate$l([property({attribute:"cache-enabled",reflect:!0,type:Boolean}),__metadata$k("design:type",Boolean)],exports.MgtGet.prototype,"cacheEnabled",void 0),__decorate$l([property({attribute:"cache-invalidation-period",reflect:!0,type:Number}),__metadata$k("design:type",Number)],exports.MgtGet.prototype,"cacheInvalidationPeriod",void 0),__decorate$l([property({attribute:!1}),__metadata$k("design:type",Object)],exports.MgtGet.prototype,"response",void 0),__decorate$l([property({attribute:!1}),__metadata$k("design:type",Object)],exports.MgtGet.prototype,"error",void 0),exports.MgtGet=__decorate$l([customElement$1("mgt-get")],exports.MgtGet);const iF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}:host,mgt-login{--font-size:14px;--font-weight:600;--width:'100%';--height:'100%';--margin:0;--padding:12px 20px;--popup-command-font-size:12px;--popup-command-margin:16px 0 0;--popup-padding:24px 48px 16px 24px}:host .root,mgt-login .root{position:relative;display:inline-block}:host .login-button,mgt-login .login-button{display:flex;align-items:center;font-family:var(--default-font-family);font-size:var(--font-size);font-weight:var(--font-weight);width:var(--width);height:var(--height);margin:var(--margin);padding:var(--padding);color:var(--button-color,#323130);background-color:var(--button-background-color,transparent);border:none;cursor:pointer;transition:color .3s,background-color .3s;word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-button mgt-person,mgt-login .login-button mgt-person{--color-sub1:set-var(button__color, $theme-default, $login)}:host .login-button:hover,mgt-login .login-button:hover{color:var(--button-color--hover,#0078d4);--color:var(--button-color--hover, #0078d4);background-color:var(--button-background-color--hover,var(--background-color--hover,#edebe9));--color-sub1:var(--button-color--hover, #0078d4);border-radius:4px}:host .login-button:focus,mgt-login .login-button:focus{outline:0}:host .login-button:disabled,mgt-login .login-button:disabled{opacity:.4;pointer-events:none}:host .login-button.no-click,mgt-login .login-button.no-click{pointer-events:none}:host .login-button:focus-visible,mgt-login .login-button:focus-visible{outline:auto}:host .login-icon+span,mgt-login .login-icon+span{margin-left:6px}:host .popup,mgt-login .popup{font-family:var(--default-font-family);background-color:var(--popup-background-color,var(--background-color,#fff));min-width:240px;z-index:1;color:var(--popup-color,#323130);border-radius:8px}:host .popup mgt-person,mgt-login .popup mgt-person{--color-sub1:set-var(popup__color, $theme-default, $login)}:host .popup-content,mgt-login .popup-content{display:flex;flex-direction:column;padding:var(--popup-padding);border-radius:8px}:host .popup-commands ul,mgt-login .popup-commands ul{list-style-type:none;margin:var(--popup-command-margin);padding:0}:host .popup-command,mgt-login .popup-command{font-family:var(--default-font-family);font-size:var(--popup-command-font-size);font-weight:var(--font-weight);color:#0078d4;background-color:var(--popup-background-color,var(--background-color,#fff));border:none;padding:0;cursor:pointer;transition:color .3s;word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .popup-command:hover,mgt-login .popup-command:hover{color:#005a9e}[dir=rtl]{--popup-padding:24px 24px 16px 48px}[dir=rtl] mgt-person .details{--details-spacing:0px 12px 0px 0px}[dir=rtl] mgt-person .details.small{--details-spacing:0px 6px 0px 0px}
`],sF={signInLinkSubtitle:"Sign In",signOutLinkSubtitle:"Sign Out"};var __decorate$k=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$j=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$l=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.MgtLogin=class MgtLogin extends MgtTemplatedComponent{static get styles(){return iF}get strings(){return sF}get flyout(){return this.renderRoot.querySelector(".flyout")}static get requiredScopes(){return[...new Set(["user.read",...exports.MgtPerson.requiredScopes])]}constructor(){super(),this._isFlyoutOpen=!1}connectedCallback(){super.connectedCallback(),this.addEventListener("click",(t=>t.stopPropagation()))}login(){return __awaiter$l(this,void 0,void 0,(function*(){if(this.userDetails||!this.fireCustomEvent("loginInitiated"))return;const t=Providers.globalProvider;t&&t.login&&(yield t.login(),t.state===exports.ProviderState.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"))}))}logout(){return __awaiter$l(this,void 0,void 0,(function*(){if(!this.fireCustomEvent("logoutInitiated"))return;const t=Providers.globalProvider;t&&t.logout&&(yield t.logout(),this.userDetails=null,this.hideFlyout(),this.fireCustomEvent("logoutCompleted"))}))}render(){return html$1`
      <div class="root" dir=${this.direction}>
        <div>
          ${this.renderButton()}
        </div>
        ${this.renderFlyout()}
      </div>
    `}loadState(){return __awaiter$l(this,void 0,void 0,(function*(){const t=Providers.globalProvider;t&&!this.userDetails&&(t.state===exports.ProviderState.SignedIn?(this.userDetails=yield getUserWithPhoto(t.graph.forComponent(this)),this.userDetails.personImage&&(this._image=this.userDetails.personImage),this.fireCustomEvent("loginCompleted")):this.userDetails=null)}))}renderButton(){const t=Providers.globalProvider,r=exports.ProviderState.SignedIn;let o=this.strings.signInLinkSubtitle;t&&t.state===r&&(o=this.userDetails?this.userDetails.displayName:this.strings.signInLinkSubtitle);const i={"login-button":!0,"no-click":this._isFlyoutOpen};return html$1`
      <button aria-label=${o} ?disabled="${this.isLoadingState}" @click=${this.onClick} class=${oR(i)} role="button">
        ${this.renderButtonContent()}
      </button>
    `}renderFlyout(){return html$1`
      <mgt-flyout
        class="flyout"
        light-dismiss
        @opened=${()=>this._isFlyoutOpen=!0}
        @closed=${()=>this._isFlyoutOpen=!1}
      >
        <div slot="flyout">
          ${this.renderFlyoutContent()}
        </div>
      </mgt-flyout>
    `}renderFlyoutContent(){if(this.userDetails)return html$1`
      <div class="popup">
        <div class="popup-content">
          <div>
            ${this.renderFlyoutPersonDetails(this.userDetails,this._image)}
          </div>
          <div class="popup-commands">
            ${this.renderFlyoutCommands()}
          </div>
        </div>
      </div>
    `}renderFlyoutPersonDetails(t,r){return this.renderTemplate("flyout-person-details",{personDetails:t,personImage:r})||html$1`
        <mgt-person .personDetails=${t} .personImage=${r} .view=${exports.ViewType.twolines} />
      `}renderFlyoutCommands(){return this.renderTemplate("flyout-commands",{handleSignOut:()=>this.logout()})||html$1`
        <ul>
          <li>
            <button class="popup-command" @click=${this.logout} aria-label=${this.strings.signOutLinkSubtitle}>
              ${this.strings.signOutLinkSubtitle}
            </button>
          </li>
        </ul>
      `}renderButtonContent(){return this.userDetails?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent()}renderSignedInButtonContent(t,r){return this.renderTemplate("signed-in-button-content",{personDetails:t,personImage:r})||html$1`
        <mgt-person .personDetails=${this.userDetails} .personImage=${this._image} .view=${exports.ViewType.oneline} />
      `}clearState(){this.userDetails=null,this._image=null}renderSignedOutButtonContent(){return this.renderTemplate("signed-out-button-content",null)||html$1`
        <i class="login-icon ms-Icon ms-Icon--Contact"></i>
        <span>${this.strings.signInLinkSubtitle}</span>
      `}showFlyout(){const t=this.flyout;t&&t.open()}hideFlyout(){const t=this.flyout;t&&t.close()}onClick(){this.userDetails?this.showFlyout():this.login()}},__decorate$k([property({attribute:"user-details",type:Object}),__metadata$j("design:type",Object)],exports.MgtLogin.prototype,"userDetails",void 0),__decorate$k([property({attribute:!1}),__metadata$j("design:type",Boolean)],exports.MgtLogin.prototype,"_isFlyoutOpen",void 0),exports.MgtLogin=__decorate$k([customElement$1("mgt-login"),__metadata$j("design:paramtypes",[])],exports.MgtLogin);var aF,__awaiter$k=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.GroupType=void 0,(aF=exports.GroupType||(exports.GroupType={}))[aF.any=0]="any",aF[aF.unified=1]="unified",aF[aF.security=2]="security",aF[aF.mailenabledsecurity=4]="mailenabledsecurity",aF[aF.distribution=8]="distribution";const getGroupsInvalidationTime=()=>CacheService.config.groups.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsGroupsCacheEnabled=()=>CacheService.config.groups.isEnabled&&CacheService.config.isEnabled;function findGroups(t,r,o=10,i=exports.GroupType.any,s=""){return __awaiter$k(this,void 0,void 0,(function*(){const l="Group.Read.All";let u;const h=`${r||"*"}*${i}*${s}`;if(getIsGroupsCacheEnabled()){u=CacheService.getCache(sR.groups,sR.groups.stores.groupsQuery);const t=yield u.getValue(h);if(t&&getGroupsInvalidationTime()>Date.now()-t.timeCached&&t.top>=o)return t.groups.map((t=>JSON.parse(t))).slice(0,o+1)}let m,v="",C=[];if(""!==r&&(v=`(startswith(displayName,'${r}') or startswith(mailNickname,'${r}') or startswith(mail,'${r}'))`),s&&(v+=`${r?" and ":""}${s}`),i!==exports.GroupType.any){const r=t.createBatch(),s=[];exports.GroupType.unified===(i&exports.GroupType.unified)&&s.push("groupTypes/any(c:c+eq+'Unified')"),exports.GroupType.security===(i&exports.GroupType.security)&&s.push("(mailEnabled eq false and securityEnabled eq true)"),exports.GroupType.mailenabledsecurity===(i&exports.GroupType.mailenabledsecurity)&&s.push("(mailEnabled eq true and securityEnabled eq true)"),exports.GroupType.distribution===(i&exports.GroupType.distribution)&&s.push("(mailEnabled eq true and securityEnabled eq false)"),v=v?`${v} and `:"";for(let t of s)r.get(t,`/groups?$filter=${v+t}`,["Group.Read.All"]);try{m=yield r.executeAll();for(let t=0;t<s.length;t++)if(m.get(s[t]).content.value)for(let r of m.get(s[t]).content.value){let t=C.filter((t=>t.id===r.id));0===t.length&&C.push(r),t=[]}}catch(r){try{let r=[];for(let i of s)r.push(yield t.api("groups").filter(`${v} and ${i}`).top(o).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes(l)).get());return Promise.all(r)}catch(t){return[]}}}else if(0===C.length){const r=yield t.api("groups").filter(v).top(o).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes(l)).get();return getIsGroupsCacheEnabled()&&r&&u.putValue(h,{groups:r.value.map((t=>JSON.stringify(t))),top:o}),r?r.value:null}return C}))}function getGroup(t,r,o){return __awaiter$k(this,void 0,void 0,(function*(){let i;if(getIsGroupsCacheEnabled()){i=CacheService.getCache(sR.groups,sR.groups.stores.groups);const t=yield i.getValue(r);if(t&&getGroupsInvalidationTime()>Date.now()-t.timeCached){const r=t.group?JSON.parse(t.group):null,i=o&&r?o.filter((t=>!Object.keys(r).includes(t))):null;if(!i||i.length<=1)return r}}let s=`/groups/${r}`;o&&(s=s+"?$select="+o.toString());const l=yield t.api(s).middlewareOptions(prepScopes("Group.Read.All")).get();return getIsGroupsCacheEnabled()&&i.putValue(r,{group:JSON.stringify(l)}),l}))}function getGroupsForGroupIds(t,r,o=""){return __awaiter$k(this,void 0,void 0,(function*(){if(!r||0===r.length)return[];const i=t.createBatch(),s={},l=[];let u;getIsGroupsCacheEnabled()&&(u=CacheService.getCache(sR.groups,sR.groups.stores.groups));for(const t of r){s[t]=null;let r=null;if(getIsGroupsCacheEnabled()&&(r=yield u.getValue(t)),r&&getGroupsInvalidationTime()>Date.now()-r.timeCached)s[t]=r.group?JSON.parse(r.group):null;else if(""!==t){let r=`/groups/${t}`;o&&(r=`${r}?$filters=${o}`),i.get(t,r,["Group.Read.All"]),l.push(t)}}try{const t=yield i.executeAll();for(const o of r){const r=t.get(o);r&&r.content&&(s[o]=r.content,getIsGroupsCacheEnabled()&&u.putValue(o,{group:JSON.stringify(r.content)}))}return Promise.all(Object.values(s))}catch(o){try{return r.filter((t=>l.includes(t))).forEach((r=>s[r]=getGroup(t,r))),getIsGroupsCacheEnabled()&&r.filter((t=>l.includes(t))).forEach((t=>__awaiter$k(this,void 0,void 0,(function*(){return u.putValue(t,{group:JSON.stringify(yield s[t])})})))),Promise.all(Object.values(s))}catch(t){return[]}}}))}const cF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .spinner{border:2px solid #c7e0f4;border-top:2px solid #0078d4;border-radius:50%;width:20px;height:20px;animation:spin 2s linear infinite}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
`];var __decorate$j=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u};let lF=class MgtSpinner extends MgtBaseComponent{static get styles(){return cF}render(){return html$1`
      <div class="spinner"></div>
    `}};lF=__decorate$j([customElement$1("mgt-spinner")],lF);const dF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--selected-person-background-color:#f3f2f1}.mgt-dark{--selected-person-background-color:#4f4f4f}:host{font-family:var(--default-font-family);font-size:14px;height:24px;display:contents;overflow:hidden;position:absolute;width:135px;left:0;top:0;border-radius:12px}:host .root,mgt-people-picker .root{display:block}.people-picker{background-color:var(--input-background-color,#fff);border-top:var(--input-border-top,var(--input-border,2px solid #605e5c));border-right:var(--input-border-right,var(--input-border,2px solid #605e5c));border-bottom:var(--input-border-bottom,var(--input-border,2px solid #605e5c));border-left:var(--input-border-left,var(--input-border,2px solid #605e5c));padding:6px 0 0}.people-picker:hover{border-color:var(--input-border-color--hover,#323130)}.people-picker.focused{border-color:var(--input-border-color--focus,#0078d4)}.people-picker.disabled{pointer-events:none}.people-picker .people-picker-inner{flex:1 1 auto;display:flex;flex-wrap:wrap;vertical-align:middle;list-style-type:none;font-style:normal;font-weight:400;overflow:hidden}.people-picker .flyout .search-box{margin:1px 2px 8px}.people-picker .flyout .search-box.search-box-start{line-height:normal;margin-inline-start:0;margin-inline-end:0}.people-picker .flyout .search-box__input{box-sizing:border-box;border-width:0;border-style:none;width:100%;display:flex;flex:1 0 auto;font-family:var(--default-font-family);position:relative;outline:0;font-style:normal;font-weight:400;font-size:14px;background-color:var(--input-background-color,#fff);color:var(--color-sub1,#323130);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}.people-picker .flyout .search-box__input::placeholder{color:var(--placeholder-color,#605e5c)}.people-picker .flyout .flyout-root{padding:0;border-radius:2px;min-width:260px;overflow-y:auto;text-align:left;list-style-type:none;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));max-height:var(--mgt-flyout-set-height,unset);border-radius:8px}.people-picker .flyout .flyout-root li{cursor:pointer}.people-picker .flyout .flyout-root .people-list{list-style:none;padding:0}.people-picker .flyout .flyout-root .people-list .list-person{display:flex;flex-direction:row;align-items:center;padding:12px;font-style:normal;font-weight:600;font-size:14px;margin:var(--file-item-margin,4px);border-radius:4px}.people-picker .flyout .flyout-root .people-list .list-person:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.people-picker .flyout .flyout-root .people-list .list-person:hover .people-person-text-area{color:var(--dropdown-item-text-hover-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person:focus,.people-picker .flyout .flyout-root .people-list .list-person:focus-within{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.people-picker .flyout .flyout-root .people-list .list-person:focus .people-person-text-area,.people-picker .flyout .flyout-root .people-list .list-person:focus-within .people-person-text-area{color:var(--dropdown-item-text-hover-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area{margin-left:13px;flex:1 1 0;min-height:40px;overflow:hidden;color:var(--dropdown-item-text-color,#000)}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text{font-size:var(--people-picker-flyout-line1-text-font-size,14px);font-weight:var(--people-picker-flyout-line1-text-font-weight,normal);margin:0;padding:0}.people-picker .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text.highlight-search-text{font-weight:700}.people-picker .selected-list{list-style:none;padding:0;display:contents}.people-picker .selected-list__person-wrapper,.people-picker .selected-list__person-wrapper-highlighted,.people-picker .selected-list__person-wrapper-highlighted:hover{display:flex;margin:0 5px 6px 0;align-items:center;border-radius:12px;height:24px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;position:relative;background-color:var(--selected-person-background-color,#f3f2f1)}.people-picker .selected-list__person-wrapper-highlighted__person,.people-picker .selected-list__person-wrapper__person{overflow:hidden;min-width:100%;--avatar-size-s:24px;margin-left:0;--color:var(--color-sub1, #323130);color:var(--color-sub1,#323130);padding-bottom:1px;padding-right:4px}.people-picker .selected-list__person-wrapper-highlighted__overflow,.people-picker .selected-list__person-wrapper__overflow{margin-left:25px}.people-picker .selected-list__person-wrapper-highlighted__overflow__gradient,.people-picker .selected-list__person-wrapper__overflow__gradient{content:'';position:absolute;margin-right:23px;width:10px;height:90%;top:0;right:0;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:none}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon,.people-picker .selected-list__person-wrapper__overflow__close-icon{font-family:FabricMDL2Icons;cursor:pointer;background-color:var(--selected-person-background-color,#f3f2f1);color:var(--color-sub1,#323130);display:flex;flex-direction:column;align-items:center;position:absolute;height:24px;width:24px;right:0;top:0;border-radius:12px;line-height:24px}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon:focus,.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon:focus-visible,.people-picker .selected-list__person-wrapper__overflow__close-icon:focus,.people-picker .selected-list__person-wrapper__overflow__close-icon:focus-visible{outline-offset:-4px;outline-width:1px;outline-style:solid}.people-picker .selected-list__person-wrapper-highlighted,.people-picker .selected-list__person-wrapper-highlighted:hover{background:#005393}.people-picker .selected-list__person-wrapper-highlighted__person{color:#fff;--color:white}.people-picker .selected-list__person-wrapper-highlighted__overflow__gradient{background-image:none}.people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon{background:#005393;color:#fff;line-height:24px}.people-picker .selected-list__person-wrapper-highlighted:hover{background-color:#006cbe}mgt-person{--avatar-size-s:32px;margin-left:12px;cursor:default}:host .loading-text,:host .search-error-text,mgt-people-picker .loading-text,mgt-people-picker .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;margin-left:50px;margin-right:50px;color:#0078d4}:host .message-parent,mgt-people-picker .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}:host .people-person-job-title,mgt-people-picker .people-person-job-title{flex:100%;order:3;font-size:var(--people-picker-flyout-line2-text-font-size,12px);font-weight:var(--people-picker-flyout-line1-text-font-weight,normal)}:host .people-person-job-title.uppercase,mgt-people-picker .people-person-job-title.uppercase{text-transform:uppercase}mgt-flyout{flex:1 0 auto}[dir=rtl] mgt-person{margin:0 12px 0 0}[dir=rtl] .selected-list{margin-right:8px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted,[dir=rtl] .selected-list__person-wrapper{margin-left:6px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__person,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__person,[dir=rtl] .selected-list__person-wrapper__person{margin-right:0!important;margin-left:4px!important}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__overflow__gradient,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__overflow__gradient,[dir=rtl] .selected-list__person-wrapper__overflow__gradient{right:auto!important;position:absolute!important;margin-right:0!important;width:10px!important;height:90%;top:0}.people-picker [dir=rtl] .selected-list__person-wrapper-highlighted__overflow__close-icon,[dir=rtl] .people-picker .selected-list__person-wrapper-highlighted__overflow__close-icon,[dir=rtl] .selected-list__person-wrapper__overflow__close-icon{right:auto!important;margin-left:5px!important;left:0!important}[dir=rtl] .people-person-text-area{margin-right:13px;margin-left:0!important}[dir=rtl] .flyout-root{text-align:right!important}@media (forced-colors:active) and (prefers-color-scheme:dark){svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#fff!important}.flyout-root{border:1px solid #fff}.people-list .list-person{border:solid 1px #fff}}@media (forced-colors:active) and (prefers-color-scheme:light){svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important;color:#000!important}.flyout-root{border:1px solid #000}.people-list .list-person{border:solid 1px #000}}
`],uF={inputPlaceholderText:"Start typing a name",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",suggestedContact:"suggested contact",suggestedContacts:"suggested contacts",selected:"selected",removeSelectedItem:"remove selected item"};var __decorate$i=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$i=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$j=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.MgtPeoplePicker=class MgtPeoplePicker extends MgtTemplatedComponent{static get styles(){return dF}get strings(){return uF}get flyout(){return this.renderRoot.querySelector(".flyout")}get input(){return this.renderRoot.querySelector(".search-box__input")}get groupId(){return this._groupId}set groupId(t){this._groupId!==t&&(this._groupId=t,this.requestStateUpdate(!0))}get groupIds(){return this._groupIds}set groupIds(t){arraysAreEqual(this._groupIds,t)||(this._groupIds=t,this.requestStateUpdate(!0))}get type(){return this._type}set type(t){this._type!==t&&(this._type=t,this.requestStateUpdate(!0))}get groupType(){return this._groupType}set groupType(t){this._groupType!==t&&(this._groupType=t,this.requestStateUpdate(!0))}get userType(){return this._userType}set userType(t){this._userType!==t&&(this._userType=t,this.requestStateUpdate(!0))}get transitiveSearch(){return this._transitiveSearch}set transitiveSearch(t){this.transitiveSearch!==t&&(this._transitiveSearch=t,this.requestStateUpdate(!0))}get people(){return this._people}set people(t){arraysAreEqual(this._people,t)||(this._people=t,this.requestStateUpdate(!0))}get showMax(){return this._showMax}set showMax(t){t!==this._showMax&&(this._showMax=t,this.requestStateUpdate(!0))}get selectedPeople(){return this._selectedPeople}set selectedPeople(t){t||(t=[]),arraysAreEqual(this._selectedPeople,t)||(this._selectedPeople=t,this.requestUpdate())}get defaultSelectedUserIds(){return this._defaultSelectedUserIds}set defaultSelectedUserIds(t){arraysAreEqual(this._defaultSelectedUserIds,t)||(this._defaultSelectedUserIds=t,this.requestStateUpdate(!0))}get defaultSelectedGroupIds(){return this._defaultSelectedGroupIds}set defaultSelectedGroupIds(t){arraysAreEqual(this._defaultSelectedGroupIds,t)||(this._defaultSelectedGroupIds=t,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(t){arraysAreEqual(this._userIds,t)||(this._userIds=t,this.requestStateUpdate(!0))}get userFilters(){return this._userFilters}set userFilters(t){this._userFilters=t,this.requestStateUpdate(!0)}get peopleFilters(){return this._peopleFilters}set peopleFilters(t){this._peopleFilters=t,this.requestStateUpdate(!0)}get groupFilters(){return this._groupFilters}set groupFilters(t){this._groupFilters=t,this.requestStateUpdate(!0)}static get requiredScopes(){return[...new Set(["user.read.all","people.read","group.read.all","user.readbasic.all",...exports.MgtPerson.requiredScopes])]}constructor(){super(),this._type=exports.PersonType.person,this._groupType=exports.GroupType.any,this._userType=exports.UserType.any,this._selectedPeople=[],this._arrowSelectionCount=-1,this._highlightedUsers=[],this._currentHighlightedUserPos=0,this._isFocused=!1,this._setAnyEmail=!1,this.clearState(),this._showLoading=!0,this.showMax=6,this.disableImages=!1,this.disabled=!1,this.allowAnyEmail=!1,this.addEventListener("copy",this.handleCopy),this.addEventListener("cut",this.handleCut),this.addEventListener("paste",this.handlePaste)}focus(t){this.input&&(this.input.focus(t),this.input.select())}selectUsersById(t){return __awaiter$j(this,void 0,void 0,(function*(){const r=Providers.globalProvider,o=Providers.globalProvider.graph;if(r&&r.state===exports.ProviderState.SignedIn)for(const r in t){const i=t[r];try{const t=yield getUser(o,i);this.addPerson(t)}catch(t){if(t.message&&t.message.includes("does not exist")&&this.allowAnyEmail&&isValidEmail(i)){const t={mail:i,displayName:i};this.addPerson(t)}}}}))}selectGroupsById(t){return __awaiter$j(this,void 0,void 0,(function*(){const r=Providers.globalProvider,o=Providers.globalProvider.graph;if(r&&r.state===exports.ProviderState.SignedIn)for(const r in t)try{const i=yield getGroup(o,t[r]);this.addPerson(i)}catch(t){}}))}render(){const t=this.renderTemplate("default",{people:this._foundPeople});if(t)return t;const r=this.renderSelectedPeople(this.selectedPeople),o=this.renderInput(),i=this.renderFlyout(o),s={focused:this._isFocused,"people-picker":!0,disabled:this.disabled};return html$1`
       <div dir=${this.direction} class=${oR(s)}>
          <div class="people-picker-inner">${r} ${i}</div>
       </div>
     `}clearState(){this.selectedPeople=[],this.userInput="",this._highlightedUsers=[],this._currentHighlightedUserPos=0}requestStateUpdate(t){return t&&(this._groupPeople=null,this._foundPeople=null,this.selectedPeople=[],this.defaultPeople=null),super.requestStateUpdate(t)}renderInput(){var t;const r=(null===(t=this.selectedPeople)||void 0===t?void 0:t.length)>0,o=this.disabled?this.placeholder||"":this.placeholder?this.placeholder:this.strings.inputPlaceholderText,i={"search-box":!0,"search-box-start":r};return"single"===(this.selectionMode?this.selectionMode:"multiple")&&this.selectedPeople.length>=1?(this.lostFocus(),html$1``):html$1`
       <div class="${oR(i)}">
         <input
           id="people-picker-input"
           class="search-box__input"
           type="text"
           role="combobox"
           placeholder=${o}
           autocomplete="off"
           aria-label=${this.ariaLabel||""}
           aria-controls="suggestions-list"
           aria-haspopup="listbox"
           aria-autocomplete="list"
           aria-expanded="false"
           @click="${this.handleInputClick}"
           @focus="${this.gainedFocus}"
           @keydown="${this.onUserKeyDown}"
           @keyup="${this.onUserKeyUp}"
           @input="${this.onUserInput}"
           @blur=${this.lostFocus}
           ?disabled=${this.disabled}
         />
       </div>
     `}renderSelectedPeople(t){return t&&t.length?html$1`
       <ul
        id="selected-list"
        aria-label="${this.strings.selected}"
        class="selected-list"
        >${t.slice(0,t.length).map((t=>html$1`
             <li
             class="selected-list__person-wrapper">
               ${this.renderTemplate("selected-person",{person:t},`selected-${t.id?t.id:t.displayName}`)||this.renderSelectedPerson(t)}

               <div class="selected-list__person-wrapper__overflow">
                 <div class="selected-list__person-wrapper__overflow__gradient"></div>
                 <div
                   tabindex="0"
                   role="button"
                   aria-label="${this.strings.removeSelectedItem} ${t.displayName}"
                   class="selected-list__person-wrapper__overflow__close-icon"
                   @click="${r=>this.removePerson(t,r)}"
                   @keydown="${r=>this.handleRemovePersonKeyDown(t,r)}"
                 >
                   \uE711
                 </div>
               </div>
              </li>
           `))}</ul>
     `:html$1``}renderFlyout(t){return html$1`
      <mgt-flyout light-dismiss class="flyout">
        ${t}
        <div
          slot="flyout"
          class="flyout-root"
          @wheel=${t=>this.handleSectionScroll(t)}
          @keydown=${t=>this.onUserKeyDown(t)}
        >
          ${this.renderFlyoutContent()}
        </div>
      </mgt-flyout>
    `}renderFlyoutContent(){if(this.isLoadingState||this._showLoading)return this.renderLoading();const t=this._foundPeople;return t&&0!==t.length&&0!==this.showMax?this.renderSearchResults(t):this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||html$1`
         <div class="message-parent">
           <mgt-spinner></mgt-spinner>
           <div label="loading-text" aria-label="loading" class="loading-text">
             ${this.strings.loadingMessage}
           </div>
         </div>
       `}renderNoData(){if(this._isFocused)return this.renderTemplate("error",null)||this.renderTemplate("no-data",null)||html$1`
         <div class="message-parent">
           <div label="search-error-text" aria-label=${this.strings.noResultsFound} class="search-error-text">
             ${this.strings.noResultsFound}
           </div>
         </div>
       `}renderSearchResults(t){const r=t.filter((t=>t.id));return html$1`
      <ul
        id="suggestions-list"
        aria-label="${this.strings.suggestedContacts}"
        class="people-list"
        role="listbox"
        aria-live="polite"
      >
         ${kR(r,(t=>t.id),(t=>{const r=t.jobTitle||t.mail,o=`${this.strings.suggestedContact} ${t.displayName} ${null!=r?r:""}`;return html$1`
               <li
                id="${t.id}"
                aria-label="${o}"
                class="list-person"
                role="option"
                @click="${r=>this.handleSuggestionClick(t)}">
                  ${this.renderPersonResult(t)}
               </li>
             `}))}
       </ul>
     `}renderPersonResult(t){const r=t,o=r.jobTitle||r.mail,i={"people-person-job-title":!0,uppercase:!!r.jobTitle};return this.renderTemplate("person",{person:t},t.id)||html$1`
         <mgt-person
          .personDetails=${t}
          .fetchImage=${!this.disableImages}
          .personCardInteraction=${exports.PersonCardInteraction.none}
         ></mgt-person>
         <div class="people-person-text-area" id="${t.displayName}">
           ${this.renderHighlightText(t)}
           <span class="${oR(i)}">${o}</span>
         </div>
       `}renderSelectedPerson(t){return html$1`
       <mgt-person
         tabindex="-1"
         class="selected-list__person-wrapper__person"
         .personDetails=${t}
         .fetchImage=${!this.disableImages}
         .view=${exports.ViewType.oneline}
         .personCardInteraction=${exports.PersonCardInteraction.click}
       ></mgt-person>
     `}loadState(){var t,r;return __awaiter$j(this,void 0,void 0,(function*(){let o=this.people;const i=this.userInput.toLowerCase(),s=Providers.globalProvider;if(o){if(i){const t=o.filter((t=>null==t?void 0:t.displayName.toLowerCase().includes(i)));o=t}this._showLoading=!1}else if(!o&&s&&s.state===exports.ProviderState.SignedIn){const l=s.graph.forComponent(this);if(!i.length&&this._isFocused)if(this.defaultPeople)o=this.defaultPeople;else{if(this.groupId||this.groupIds){if(null===this._groupPeople)if(this.groupId)try{this.type===exports.PersonType.group?this._groupPeople=yield findGroupMembers(l,null,this.groupId,this.showMax,this.type,this.transitiveSearch):this._groupPeople=yield findGroupMembers(l,null,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters)}catch(t){this._groupPeople=[]}else if(this.groupIds)if(this.type===exports.PersonType.group)try{this._groupPeople=yield getGroupsForGroupIds(l,this.groupIds,this.groupFilters)}catch(t){this._groupPeople=[]}else try{const t=yield findUsersFromGroupIds(l,"",this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters);this._groupPeople=t}catch(t){this._groupPeople=[]}o=this._groupPeople||[]}else if(this.type===exports.PersonType.person||this.type===exports.PersonType.any)if(this.userIds)o=yield getUsersForUserIds(l,this.userIds,"",this.userFilters);else{const t=this.userType===exports.UserType.user||this.userType===exports.UserType.contact;o=this._userFilters&&t?yield function getUsers(t,r="",o=10){return __awaiter$y(this,void 0,void 0,(function*(){let i;const s=""===r?"*":r,l={maxResults:o,results:null};if(getIsUsersCacheEnabled()){i=CacheService.getCache(sR.users,sR.users.stores.userFilters);const t=yield i.getValue(s);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}const u=t.api("/users").top(o);r&&u.filter(r);try{const t=yield u.middlewareOptions(prepScopes("user.read")).get();return getIsUsersCacheEnabled()&&t&&(l.results=t.value.map((t=>JSON.stringify(t))),i.putValue(r,l)),t.value}catch(t){}}))}(l,this._userFilters,this.showMax):yield getPeople(l,this.userType,this._peopleFilters)}else if(this.type===exports.PersonType.group)if(this.groupIds)try{o=yield this.getGroupsForGroupIds(l,o)}catch(t){}else{let t=(yield findGroups(l,"",this.showMax,this.groupType,this._groupFilters))||[];t.length>0&&t[0].value&&(t=t[0].value),o=t}this.defaultPeople=o}if(this._showLoading=!1,!((null===(t=this.defaultSelectedUserIds)||void 0===t?void 0:t.length)>0||(null===(r=this.defaultSelectedGroupIds)||void 0===r?void 0:r.length)>0)||this.selectedPeople.length||this.defaultSelectedUsers||(this.defaultSelectedUsers=yield getUsersForUserIds(l,this.defaultSelectedUserIds,"",this.userFilters),this.defaultSelectedGroups=yield getGroupsForGroupIds(l,this.defaultSelectedGroupIds,this.peopleFilters),this.defaultSelectedGroups=this.defaultSelectedGroups.filter((t=>null!==t)),this.defaultSelectedUsers=this.defaultSelectedUsers.filter((t=>null!==t)),this.selectedPeople=[...this.defaultSelectedUsers,...this.defaultSelectedGroups],this.requestUpdate(),this.fireCustomEvent("selectionChanged",this.selectedPeople)),i)if(o=[],this.groupId)o=(yield findGroupMembers(l,i,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters))||[];else{if(this.type===exports.PersonType.person||this.type===exports.PersonType.any){try{if(this.userType===exports.UserType.contact||this.userType===exports.UserType.user)o=this.userIds&&this.userIds.length?yield getUsersForUserIds(l,this.userIds,i,this._userFilters):yield findUsers(l,i,this.showMax,this._userFilters);else if(this.groupIds)try{o=yield findUsersFromGroupIds(l,i,this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters)}catch(t){}else o=this.userIds&&this.userIds.length?yield getUsersForUserIds(l,this.userIds,i,this._userFilters):(yield findPeople(l,i,this.showMax,this.userType,this._peopleFilters))||[]}catch(t){}if(o&&o.length<this.showMax&&this.userType!==exports.UserType.contact&&this.type!==exports.PersonType.person)try{const t=(yield findUsers(l,i,this.showMax,this._userFilters))||[],r=new Set(o.map((t=>t.id)));for(const i of t)r.has(i.id)||o.push(i)}catch(t){}}if((this.type===exports.PersonType.group||this.type===exports.PersonType.any)&&o.length<this.showMax)if(this.groupIds)try{o=yield function findGroupsFromGroupIds(t,r,o,i=10,s=exports.GroupType.any,l=""){return __awaiter$k(this,void 0,void 0,(function*(){const u=[],h=yield findGroups(t,r,i,s,l);if(h)for(let t=0;t<h.length;t++){const r=h[t];r.id&&o.includes(r.id)&&u.push(r)}return u}))}(l,i,this.groupIds,this.showMax,this.groupType,this.userFilters)}catch(t){}else{let t=[];try{t=(yield findGroups(l,i,this.showMax,this.groupType,this._groupFilters))||[],o=o.concat(t)}catch(t){}}}}this._foundPeople=this.filterPeople(o)}))}getGroupsForGroupIds(t,r){return __awaiter$j(this,void 0,void 0,(function*(){const o=yield getGroupsForGroupIds(t,this.groupIds,this.groupFilters);for(const t of o)r=r.concat(t);return r=r.filter((t=>t))}))}hideFlyout(){const t=this.flyout;t&&t.close(),this.input&&(this.input.setAttribute("aria-expanded","false"),this.input.setAttribute("aria-activedescendant","")),this._arrowSelectionCount=-1}showFlyout(){const t=this.flyout;t&&t.open(),this.input&&this.input.setAttribute("aria-expanded","true"),this._arrowSelectionCount=-1}removePerson(t,r){var o;r.stopPropagation();const i=this.selectedPeople.filter((r=>!t.id&&r.displayName?r.displayName!==t.displayName:r.id!==t.id));this.selectedPeople=i,this.loadState(),this.fireCustomEvent("selectionChanged",this.selectedPeople),null===(o=this.input)||void 0===o||o.focus()}handleRemovePersonKeyDown(t,r){"Enter"===r.key&&this.removePerson(t,r)}addPerson(t){if(t){setTimeout((()=>{this.clearInput()}),50);0===this.selectedPeople.filter((r=>!t.id&&r.displayName?r.displayName===t.displayName:r.id===t.id)).length&&(this.selectedPeople=[...this.selectedPeople,t],this.fireCustomEvent("selectionChanged",this.selectedPeople),this.loadState(),this._foundPeople=[],this._arrowSelectionCount=-1)}}clearInput(){this.clearHighlighted(),"single"!==this.selectionMode&&(this.input.value=""),this.userInput=""}handleInputClick(){this.flyout.isOpen||this.handleUserSearch()}gainedFocus(){this.clearHighlighted(),this._isFocused=!0,this.loadState(),this.showFlyout()}lostFocus(){this._isFocused=!1,this.input&&(this.input.setAttribute("aria-expanded","false"),this.input.setAttribute("aria-activedescendant",""));const t=this.renderRoot.querySelector(".people-list");if(t)for(const r of t.children)r.classList.remove("focused"),r.setAttribute("aria-selected","false");this.requestUpdate()}renderHighlightText(t){let r="",o="",i="";const s=t.displayName,l=s.toLowerCase().indexOf(this.userInput.toLowerCase());if(-1!==l){const t=this.userInput.length;0===l?(r="",i=s.slice(0,t),o=s.slice(t,s.length)):l===s.length?(r=s.slice(0,l),i=s.slice(l,s.length),o=""):(r=s.slice(0,l),i=s.slice(l,l+t),o=s.slice(l+t,s.length))}else r=t.displayName;return html$1`
       <div>
         <span class="people-person-text">${r}</span
         ><span class="people-person-text highlight-search-text">${i}</span
         ><span class="people-person-text">${o}</span>
       </div>
     `}onUserKeyUp(t){const r=(t.ctrlKey||t.metaKey)&&"v"===t.key,o=["ControlLeft","ControlRight"].includes(t.code)||t.ctrlKey||t.metaKey,i=["ArrowDown","ArrowRight","ArrowUp","ArrowLeft"].includes(t.code);return!r&&o||i?((o||["ArrowLeft","ArrowRight"].includes(t.code))&&this.hideFlyout(),void(["ArrowDown"].includes(t.code)&&!this.flyout.isOpen&&this._isFocused&&this.handleUserSearch())):t.shiftKey||"ShiftLeft"===t.code||"Tab"===t.code||"Enter"===t.code?void 0:"Escape"===t.code?(this.clearInput(),this._foundPeople=[],void(this._arrowSelectionCount=-1)):"Backspace"===t.code&&0===this.userInput.length&&this.selectedPeople.length>0?(this.clearHighlighted(),this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-1),this.loadState(),this.hideFlyout(),void this.fireCustomEvent("selectionChanged",this.selectedPeople)):void("Comma"!==t.code&&"Semicolon"!==t.code||this.allowAnyEmail&&(this._setAnyEmail=!0,t.preventDefault(),t.stopPropagation()))}onUserInput(t){const r=t.target;if(this.userInput=r.value,this.userInput){isValidEmail(this.userInput)&&this.allowAnyEmail?this._setAnyEmail&&this.handleAnyEmail():this.handleUserSearch(),this._setAnyEmail=!1}}handleAnyEmail(){if(this._showLoading=!1,this._arrowSelectionCount=-1,isValidEmail(this.userInput)){const t={mail:this.userInput,displayName:this.userInput};this.addPerson(t)}this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0)}handleSuggestionClick(t){this.addPerson(t),this.hideFlyout(),this.input.focus()}handleUserSearch(){this._debouncedSearch||(this._debouncedSearch=debounce((()=>__awaiter$j(this,void 0,void 0,(function*(){const t=setTimeout((()=>{this._showLoading=!0}),50);yield this.loadState(),clearTimeout(t),this._showLoading=!1,this._arrowSelectionCount=-1,this.showFlyout()}))),400)),this._debouncedSearch()}onUserKeyDown(t){const r=this.renderRoot.querySelector(".selected-list"),o=t.ctrlKey||t.metaKey;if(o&&r){const i=r.querySelectorAll("mgt-person.selected-list__person-wrapper__person");if(this.hideFlyout(),o&&"ArrowLeft"===t.code)this._currentHighlightedUserPos=(this._currentHighlightedUserPos-1+i.length)%i.length,this._currentHighlightedUserPos>=0&&!Number.isNaN(this._currentHighlightedUserPos)?this._highlightedUsers.push(i[this._currentHighlightedUserPos]):this._currentHighlightedUserPos=0;else if(o&&"ArrowRight"===t.code){const t=this._highlightedUsers.pop();if(t){const r=t.parentElement;r&&(this.clearHighlighted(r),this._currentHighlightedUserPos++)}}else o&&"KeyA"===t.code&&(this._highlightedUsers=[],i.forEach((t=>this._highlightedUsers.push(t))));return void(this._highlightedUsers&&this.highlightSelectedPeople(this._highlightedUsers))}if(this.clearHighlighted(),!this.flyout.isOpen)return;const i=t.target;if("ArrowUp"!==t.key&&"ArrowDown"!==t.key||(this.handleArrowSelection(t),t.preventDefault()),"Enter"===t.code)if(!t.shiftKey&&this._foundPeople){t.preventDefault(),t.stopPropagation();const r=this._foundPeople[this._arrowSelectionCount];r&&(this.addPerson(r),this.hideFlyout(),this.input.value="")}else this.allowAnyEmail&&this.handleAnyEmail();"Escape"==t.code&&t.stopPropagation(),"Tab"===t.code&&this.hideFlyout(),"Comma"!==t.code&&"Semicolon"!==t.code||this.allowAnyEmail&&(t.preventDefault(),t.stopPropagation(),this.userInput=i.value,this.handleAnyEmail())}writeHighlightedText(){return __awaiter$j(this,void 0,void 0,(function*(){const t=[];for(let r=0;r<this._highlightedUsers.length;r++){const o=this._highlightedUsers[r]._personDetails,{id:i,displayName:s,email:l,userPrincipalName:u,scoredEmailAddresses:h}=o;let m;m=h&&h.length>0?h.pop().address:u||l,t.push({id:i,displayName:s,email:m})}let r="";t.length>0&&(r=JSON.stringify(t)),yield navigator.clipboard.writeText(r)}))}handleCut(){return __awaiter$j(this,void 0,void 0,(function*(){yield this.writeHighlightedText(),this.removeHighlightedOnCut()}))}handleCopy(){return __awaiter$j(this,void 0,void 0,(function*(){yield this.writeHighlightedText()}))}handlePaste(){return __awaiter$j(this,void 0,void 0,(function*(){try{const t=yield navigator.clipboard.readText();if(t)try{const r=JSON.parse(t);if(r&&r.length>0)for(const t of r)this.addPerson(t)}catch(r){if(r instanceof SyntaxError){const r=[",",";"];let o;try{for(let i=0;i<r.length;i++)if(o=t.split(r[i]),o.length>1){this.hideFlyout(),this.selectUsersById(o);break}}catch(t){}}}}catch(t){}}))}removeHighlightedOnCut(){this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-this._highlightedUsers.length),this._highlightedUsers=[],this._currentHighlightedUserPos=0,this.loadState(),this.hideFlyout(),this.fireCustomEvent("selectionChanged",this.selectedPeople)}highlightSelectedPeople(t){for(let r=0;r<t.length;r++){const o=t[r].parentElement;o.setAttribute("class","selected-list__person-wrapper-highlighted");const i=Array.from(o.getElementsByClassName("selected-list__person-wrapper__person"));if(i&&i.length>0){i.pop().setAttribute("class","selected-list__person-wrapper-highlighted__person")}const s=Array.from(o.getElementsByClassName("selected-list__person-wrapper__overflow__gradient"));if(s&&s.length>0){s.pop().setAttribute("class","selected-list__person-wrapper-highlighted__overflow__gradient")}const l=Array.from(o.getElementsByClassName("selected-list__person-wrapper__overflow__close-icon"));if(l&&l.length>0){l.pop().setAttribute("class","selected-list__person-wrapper-highlighted__overflow__close-icon")}}}clearHighlighted(t){if(t)this.clearNodeHighlights(t);else{for(let t=0;t<this._highlightedUsers.length;t++){const r=this._highlightedUsers[t].parentElement;r&&this.clearNodeHighlights(r)}this._highlightedUsers=[],this._currentHighlightedUserPos=0}}clearNodeHighlights(t){t.setAttribute("class","selected-list__person-wrapper");const r=Array.from(t.getElementsByClassName("selected-list__person-wrapper-highlighted__person"));if(r&&r.length>0){r.pop().setAttribute("class","selected-list__person-wrapper__person")}const o=Array.from(t.getElementsByClassName("selected-list__person-wrapper-highlighted__overflow__gradient"));if(o&&o.length>0){o.pop().setAttribute("class","selected-list__person-wrapper__overflow__gradient")}const i=Array.from(t.getElementsByClassName("selected-list__person-wrapper-highlighted__overflow__close-icon"));if(i&&i.length>0){i.pop().setAttribute("class","selected-list__person-wrapper__overflow__close-icon")}}handleArrowSelection(t){const r=this.renderRoot.querySelector(".people-list");if(r&&r.children.length){t&&("ArrowUp"===t.key&&(-1===this._arrowSelectionCount?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount-1+r.children.length)%r.children.length),"ArrowDown"===t.key&&(-1===this._arrowSelectionCount?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount+1+r.children.length)%r.children.length));for(const t of null==r?void 0:r.children){const r=t;r.setAttribute("aria-selected","false"),r.removeAttribute("tabindex"),r.blur()}const o=r.children[this._arrowSelectionCount];o&&(o.setAttribute("tabindex","0"),o.focus(),o.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}),o.setAttribute("aria-selected","true"),this.input.setAttribute("aria-activedescendant",o.id))}}filterPeople(t){if(t&&t.length>0){t=t.filter((t=>t));const r=this.selectedPeople.map((t=>t.id?t.id:t.displayName)),o=t.filter((t=>(null==t?void 0:t.id)?-1===r.indexOf(t.id):-1===r.indexOf(null==t?void 0:t.displayName))),i=new Set;for(let t=0;t<o.length;t++){const r=JSON.stringify(o[t]);i.add(r)}const s=[];return i.forEach((t=>{const r=JSON.parse(t);s.push(r)})),s}}handleSectionScroll(t){const r=this.renderRoot.querySelector(".flyout-root");r&&(t.deltaY<0&&0===r.scrollTop||t.deltaY>0&&r.clientHeight+r.scrollTop>=r.scrollHeight-1||t.stopPropagation())}},__decorate$i([property({attribute:"group-id",converter:t=>t.trim()}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"groupId",null),__decorate$i([property({attribute:"group-ids",converter:t=>t.split(",").map((t=>t.trim()))}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"groupIds",null),__decorate$i([property({attribute:"type",converter:(t,r)=>(t=t.toLowerCase())&&0!==t.length?void 0===exports.PersonType[t]?exports.PersonType.any:exports.PersonType[t]:exports.PersonType.any}),__metadata$i("design:type",Object),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"type",null),__decorate$i([property({attribute:"group-type",converter:(t,r)=>{if(!t||0===t.length)return exports.GroupType.any;const o=t.split(","),i=[];for(let t of o)t=t.trim(),void 0!==exports.GroupType[t]&&i.push(exports.GroupType[t]);if(0===i.length)return exports.GroupType.any;return i.reduce(((t,r)=>t|r))}}),__metadata$i("design:type",Number),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"groupType",null),__decorate$i([property({attribute:"user-type",converter:(t,r)=>(t=t.toLowerCase())&&0!==t.length?void 0===exports.UserType[t]?exports.UserType.any:exports.UserType[t]:exports.UserType.any}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"userType",null),__decorate$i([property({attribute:"transitive-search",type:Boolean}),__metadata$i("design:type",Boolean),__metadata$i("design:paramtypes",[Boolean])],exports.MgtPeoplePicker.prototype,"transitiveSearch",null),__decorate$i([property({attribute:"people",type:Object}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Array])],exports.MgtPeoplePicker.prototype,"people",null),__decorate$i([property({attribute:"show-max",type:Number}),__metadata$i("design:type",Number),__metadata$i("design:paramtypes",[Number])],exports.MgtPeoplePicker.prototype,"showMax",null),__decorate$i([property({attribute:"disable-images",type:Boolean}),__metadata$i("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"disableImages",void 0),__decorate$i([property({attribute:"selected-people",type:Array}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Array])],exports.MgtPeoplePicker.prototype,"selectedPeople",null),__decorate$i([property({attribute:"default-selected-user-ids",converter:t=>t.split(",").map((t=>t.trim())),type:String}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"defaultSelectedUserIds",null),__decorate$i([property({attribute:"default-selected-group-ids",converter:t=>t.split(",").map((t=>t.trim())),type:String}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"defaultSelectedGroupIds",null),__decorate$i([property({attribute:"placeholder",type:String}),__metadata$i("design:type",String)],exports.MgtPeoplePicker.prototype,"placeholder",void 0),__decorate$i([property({attribute:"disabled",type:Boolean}),__metadata$i("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"disabled",void 0),__decorate$i([property({attribute:"allow-any-email",type:Boolean}),__metadata$i("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"allowAnyEmail",void 0),__decorate$i([property({attribute:"selection-mode",type:String}),__metadata$i("design:type",String)],exports.MgtPeoplePicker.prototype,"selectionMode",void 0),__decorate$i([property({attribute:"user-ids",converter:t=>t.split(",").map((t=>t.trim())),type:String}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Array])],exports.MgtPeoplePicker.prototype,"userIds",null),__decorate$i([property({attribute:"user-filters"}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[String])],exports.MgtPeoplePicker.prototype,"userFilters",null),__decorate$i([property({attribute:"people-filters"}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[String])],exports.MgtPeoplePicker.prototype,"peopleFilters",null),__decorate$i([property({attribute:"group-filters"}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[String])],exports.MgtPeoplePicker.prototype,"groupFilters",null),__decorate$i([property({attribute:"aria-label",type:String}),__metadata$i("design:type",String)],exports.MgtPeoplePicker.prototype,"ariaLabel",void 0),__decorate$i([YP(),__metadata$i("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"_showLoading",void 0),__decorate$i([YP(),__metadata$i("design:type",Object)],exports.MgtPeoplePicker.prototype,"_arrowSelectionCount",void 0),__decorate$i([YP(),__metadata$i("design:type",Object)],exports.MgtPeoplePicker.prototype,"_isFocused",void 0),__decorate$i([YP(),__metadata$i("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"_setAnyEmail",void 0),__decorate$i([YP(),__metadata$i("design:type",Array)],exports.MgtPeoplePicker.prototype,"_foundPeople",void 0),exports.MgtPeoplePicker=__decorate$i([customElement$1("mgt-people-picker"),__metadata$i("design:paramtypes",[])],exports.MgtPeoplePicker);var __awaiter$i=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};const hF="businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id,accountEnabled",pF={directReports:"directReports",files:"files",messages:"messages",people:"people",person:"person"};function getPersonCardGraphData(t,r,o,i){return __awaiter$i(this,void 0,void 0,(function*(){const s=r.id,l=getEmailFromGraphEntity(r),u="classification"in r||"personType"in r&&("PersonalContact"===r.personType.subclass||"Group"===r.personType.class),h=t.createBatch();let m;u||i.sections.organization&&(!function buildOrgStructureRequest(t,r){const o=`manager($levels=max;$select=${hF})`;t.get(pF.person,`users/${r}?$expand=${o}&$select=${hF}&$count=true`,["user.read.all"],{ConsistencyLevel:"eventual"}),t.get(pF.directReports,`users/${r}/directReports?$select=${hF}`)}(h,s),"boolean"!=typeof i.sections.organization&&i.sections.organization.showWorksWith&&function buildWorksWithRequest(t,r){t.get(pF.people,`users/${r}/people?$filter=personType/class eq 'Person'`,["People.Read.All"])}(h,s)),i.sections.mailMessages&&l&&function buildMessagesWithUserRequest(t,r){t.get(pF.messages,`me/messages?$search="from:${r}"`,["Mail.ReadBasic"])}(h,l),i.sections.files&&function buildFilesRequest(t,r){let o;o=r?`me/insights/shared?$filter=lastshared/sharedby/address eq '${r}'`:"me/insights/used";t.get(pF.files,o,["Sites.Read.All"])}(h,o?null:l);const v={};try{m=yield h.executeAll()}catch(t){}if(m)for(const[t,r]of m)v[t]=r.content.value||r.content;if(!u&&i.sections.profile)try{const r=yield function getProfile(t,r){return __awaiter$i(this,void 0,void 0,(function*(){return yield t.api(`/users/${r}/profile`).version("beta").get()}))}(t,s);r&&(v.profile=r)}catch(t){}return v.directReports&&v.directReports.length>0&&(v.directReports=v.directReports.filter((t=>t.accountEnabled))),v}))}const fF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}:host{background:var(--person-card-background-color,var(--background-color,#fff));width:var(--mgt-flyout-set-width,340px);font-family:var(--default-font-family);overflow:hidden;user-select:none;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));border-radius:8px}:host .small{max-height:100vh;overflow-y:auto;overflow-x:hidden}:host .nav{height:0;position:relative;z-index:100}:host .nav__back{padding:8px;height:32px;width:32px;align-items:center;justify-content:center}:host .nav__back svg{fill:var(--person-card-nav-back-arrow-color,#0078d4)}:host .nav__back:hover{cursor:pointer}:host .nav__back:hover svg{fill:var(--person-card-nav-back-arrow-hover-color,#000)}:host .person-details-container{display:flex;flex-direction:column;width:calc(var(--mgt-flyout-set-width,340px) - 40px);padding:20px}:host .person-details-container .person-image{--presence-background-color:var(--person-card-background-color, var(--background-color, #ffffff));--presence-icon-color:var(--person-card-background-color, var(--background-color, #ffffff));--avatar-size:75px;--font-size:var(--person-card-display-name-font-size, 20px);--color:var(--person-card-display-name-color, var(--color-sub1, #323130));--line2-font-size:var(--person-card-title-font-size, 14px);--line2-color:var(--person-card-title-color);--line3-font-size:var(--person-card-subtitle-font-size, 12px);--line3-color:var(--person-card-subtitle-color)}:host .person-details-container .base-icons{display:flex;-webkit-align-items:center;align-items:center;max-width:120px;margin-top:16px}:host .person-details-container .base-icons .icon{display:flex;align-items:center;cursor:pointer;font-size:12px;white-space:nowrap;margin:-11px -13px;padding:11px 13px}:host .person-details-container .base-icons .icon:not(:last-child){margin-right:20px}:host .person-details-container .base-icons .icon svg{fill:var(--icon-color,#605e5c)}:host .person-details-container .base-icons .icon span{margin-left:8px;color:var(--person-card-base-links-color,#023b8f)}:host .person-details-container .base-icons .icon:hover{color:var(--person-card-base-links-hover-color,#012e7f)}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;align-items:center;height:28px;background:var(--person-card-background-color,var(--background-color,#fff));border-top:1px solid var(--line-seperator-color,#edebe9)}:host .expanded-details-container .expanded-details-button svg path{stroke:#1a1a1a}:host .expanded-details-container .expanded-details-button:hover{background-color:var(--background-color--hover,#edebe9)}:host .section-nav{display:flex;padding:0 14px;border-bottom:1px solid var(--tab-line-color,#edebe9)}:host .section-nav__icon{all:initial;box-sizing:border-box;width:48px;padding:12px;display:flex;align-items:center;justify-content:center;border:2px solid transparent;margin-bottom:-1px;cursor:pointer}:host .section-nav__icon svg{width:20px;height:20px;fill:var(--icon-color,#605e5c)}:host .section-nav__icon:hover{background:var(--tab-background-color--hover,#edebe9)}:host .section-nav__icon:focus{border-color:#000}:host .section-nav__icon.active{border-bottom-color:var(--person-card-tab-nav-color,#0078d4);border-bottom-style:solid;border-left-color:none;border-right-color:none;border-top-color:none;border-top-style:none;border-left-style:none;border-right-style:none}:host .section-nav__icon.active svg{fill:var(--person-card-tab-nav-color,#0078d4)}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .section-host{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden}:host .section-host.small{overflow-y:hidden}:host .quick-message{display:flex;flex-direction:row;border-bottom:1px solid var(--tab-line-color,#edebe9);padding:12px 10px 8px 10px}:host .quick-message__input{flex-grow:1;padding-left:8px;border:none;border-radius:2px;color:var(--color-sub1,#323130);background-color:var(--background-color-sub2,#f3f2f1)}:host .quick-message__send{all:initial;height:32px;width:32px;display:flex;align-items:center;justify-content:center}:host .quick-message__send svg{fill:var(--color-sub2,#717171);height:18px;width:18px}:host .quick-message__send:hover svg{fill:var(--color-sub1,#323130)}:host .sections .section{padding:14px 0;display:flex;flex-direction:column;position:relative}:host .sections .section:not(:last-child):after{position:absolute;content:'';width:90%;transform:translateX(-50%);border-bottom:1px solid var(--tab-line-color,#edebe9);left:50%;bottom:0}:host .sections .section__header{display:flex;flex-direction:row;padding:0 20px}:host .sections .section__title{flex-grow:1;color:var(--title-color-subtitle,#323130);font-size:14px;font-weight:600}:host .sections .section__show-more{color:var(--person-card-show-more-color,#0078d4);font-size:12px;font-weight:600;align-self:center}:host .sections .section__show-more:hover{cursor:pointer;color:var(--person-card-show-more-hover-color,#005a9e)}:host .sections .section__content{margin-top:14px}:host .sections .section .additional-details{padding:0 20px}[dir=rtl] .base-icons span{margin-right:8px}[dir=rtl] .nav__back{width:20px!important;-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){.root{border:1px solid #fff;border-radius:inherit}.root svg,.root svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root{border:1px solid #000;border-radius:inherit}.root svg,.root svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`];var __decorate$h=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$h=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};class BasePersonCardSection extends MgtTemplatedComponent{get personDetails(){return this._personDetails}set personDetails(t){this._personDetails!==t&&(this._personDetails=t,this.requestStateUpdate())}get isCompact(){return this._isCompact}constructor(){super(),this._isCompact=!1,this._personDetails=null}asCompactView(){return this._isCompact=!0,this.requestUpdate(),this}asFullView(){return this._isCompact=!1,this.requestUpdate(),this}clearState(){this._isCompact=!1,this._personDetails=null}render(){return this.isCompact?this.renderCompactView():this.renderFullView()}renderLoading(){return html$1`
      <div class="loading">
        <mgt-spinner></mgt-spinner>
      </div>
    `}renderNoData(){return html$1`
      <div class="no-data">No data</div>
    `}navigateCard(t){let r=this.parentNode;for(;r;)if(r=r.parentNode,r&&r.host&&"MGT-PERSON-CARD"===r.host.tagName){r=r.host;break}r.navigate(t)}}__decorate$h([property({attribute:"person-details",type:Object}),__metadata$h("design:type",Object),__metadata$h("design:paramtypes",[Object])],BasePersonCardSection.prototype,"personDetails",null);const gF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--title-color-sub2,#717171);line-height:20px}:host .root .part .part__details .part__value{grid-column:2;color:var(--color-sub1,#323130);font-size:14px;font-weight:400}:host .root .part .part__details .part__value .part__link{color:var(--person-card-contact-link-color,#0078d4);font-family:var(--default-font-family);font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:var(--person-card-contact-link-hover-color,#004578)}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--background-color-sub2,#f3f2f1);visibility:hidden;display:flex;align-items:center;justify-content:center}:host .root .part .part__copy svg{fill:var(--color-sub1,#323130);cursor:pointer}:host .root .part:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`],mF={contactSectionTitle:"Contact",emailTitle:"Email",chatTitle:"Teams",businessPhoneTitle:"Business Phone",cellPhoneTitle:"Mobile Phone",departmentTitle:"Department",titleTitle:"Title",officeLocationTitle:"Office Location",copyToClipboardButton:"Copy to clipboard"};var __decorate$g=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$g=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};let vF=class MgtPersonCardContact extends BasePersonCardSection{static get styles(){return gF}get strings(){return mF}get hasData(){if(!this._contactParts)return!1;return!!Object.values(this._contactParts).filter((t=>!!t.value)).length}constructor(t){super(),this._contactParts={email:{icon:getSvg(dR.Email,"#929292"),onClick:()=>this.sendEmail(getEmailFromGraphEntity(this._person)),showCompact:!0,title:this.strings.emailTitle},chat:{icon:getSvg(dR.Chat,"#929292"),onClick:()=>{var t;return this.sendChat(null===(t=this._person)||void 0===t?void 0:t.userPrincipalName)},showCompact:!1,title:this.strings.chatTitle},businessPhone:{icon:getSvg(dR.Phone,"#929292"),onClick:()=>{var t,r;return this.sendCall((null===(r=null===(t=this._person)||void 0===t?void 0:t.businessPhones)||void 0===r?void 0:r.length)>0?this._person.businessPhones[0]:null)},showCompact:!0,title:this.strings.businessPhoneTitle},cellPhone:{icon:getSvg(dR.CellPhone,"#929292"),onClick:()=>{var t;return this.sendCall(null===(t=this._person)||void 0===t?void 0:t.mobilePhone)},showCompact:!0,title:this.strings.cellPhoneTitle},department:{icon:getSvg(dR.Department,"#929292"),showCompact:!1,title:this.strings.departmentTitle},title:{icon:getSvg(dR.Person,"#929292"),showCompact:!1,title:this.strings.titleTitle},officeLocation:{icon:getSvg(dR.OfficeLocation,"#929292"),showCompact:!0,title:this.strings.officeLocationTitle}},this.sendCall=t=>{this.sendLink("tel:",t)},this._person=t,this._contactParts.email.value=getEmailFromGraphEntity(this._person),this._contactParts.chat.value=this._person.userPrincipalName,this._contactParts.cellPhone.value=this._person.mobilePhone,this._contactParts.department.value=this._person.department,this._contactParts.title.value=this._person.jobTitle,this._contactParts.officeLocation.value=this._person.officeLocation,this._person.businessPhones&&this._person.businessPhones.length&&(this._contactParts.businessPhone.value=this._person.businessPhones[0])}get displayName(){return this.strings.contactSectionTitle}renderIcon(){return getSvg(dR.Contact)}clearState(){super.clearState();for(const t of Object.keys(this._contactParts))this._contactParts[t].value=null}renderCompactView(){let t;if(!this.hasData)return null;const r=Object.values(this._contactParts).filter((t=>!!t.value));let o=Object.values(r).filter((t=>!!t.value&&t.showCompact));return o&&o.length||(o=Object.values(r).slice(0,2)),t=html$1`
      ${o.map((t=>this.renderContactPart(t)))}
    `,html$1`
      <div class="root compact" dir=${this.direction}>
        ${t}
      </div>
    `}renderFullView(){let t;if(this.hasData){const r=Object.values(this._contactParts).filter((t=>!!t.value));t=html$1`
        ${r.map((t=>this.renderContactPart(t)))}
      `}return html$1`
      <div class="root" dir=${this.direction}>
        <div class="title" tabindex="0">${this.displayName}</div>
        ${t}
      </div>
    `}renderContactPart(t){let r=!1;"Mobile Phone"!==t.title&&"Business Phone"!==t.title||(r=!0);const o={part__link:!0,phone:r},i=t.onClick?html$1`
          <span class=${oR(o)} @click=${r=>t.onClick(r)}>${t.value}</span>
        `:html$1`
          ${t.value}
        `;return html$1`
      <div class="part" @click=${r=>this.handlePartClick(r,t.value)} tabindex="0">
        <div class="part__icon" aria-label=${t.title} title=${t.title}>${t.icon}</div>
        <div class="part__details">
          <div class="part__title">${t.title}</div>
          <div class="part__value" title=${t.title}>${i}</div>
        </div>
        <div class="part__copy" aria-role="button" aria-label=${this.strings.copyToClipboardButton} title=${this.strings.copyToClipboardButton}>
          ${getSvg(dR.Copy)}
        </div>
      </div>
    `}handlePartClick(t,r){r&&navigator.clipboard.writeText(r)}sendLink(t,r){r?window.open(`${t}${r}`,"_blank","noreferrer"):console.error(`Target resource for ${t} link was not provided: resource: ${r}`)}sendChat(t){if(!t)return void console.error("Can't send chat when upn is not provided");const r=`https://teams.microsoft.com/l/chat/0/0?users=${t}`,openWindow=()=>window.open(r,"_blank","noreferrer");TeamsHelper.isAvailable?TeamsHelper.executeDeepLink(r,(t=>{t||openWindow()})):openWindow()}sendEmail(t){this.sendLink("mailto:",t)}};vF=__decorate$g([customElement$1("mgt-person-card-contact"),__metadata$g("design:paramtypes",[Object])],vF);const yF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .file{display:flex;align-items:center;padding:11px 20px}:host .root .file:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .file:last-child{margin-bottom:unset}:host .root .file .file__icon{width:28px;min-width:28px;height:28px;margin-right:12px;display:flex;align-items:center;justify-content:center}:host .root .file .file__icon img{height:28px;width:28px}:host .root .file .file__details{min-width:0;margin-right:40px}:host .root .file .file__details .file__name{font-size:14px;color:var(--color-sub1,#323130)}:host .root .file .file__details .file__last-modified{font-size:12px;color:var(--color-sub2,#717171)}:host .root .file .file__details>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[dir=rtl] .file__icon{margin-right:0!important}[dir=rtl] .file__details{margin-right:12px!important}
`],bF={filesSectionTitle:"Files",sharedTextSubtitle:"Shared"};var __decorate$f=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$f=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};let wF=class MgtPersonCardFiles extends BasePersonCardSection{static get styles(){return yF}get strings(){return bF}constructor(t){super(),this._files=t}get displayName(){return this.strings.filesSectionTitle}clearState(){super.clearState(),this._files=null}renderIcon(){return getSvg(dR.Files)}renderCompactView(){let t;return t=this.isLoadingState?this.renderLoading():this._files&&this._files.length?html$1`
        ${this._files.slice(0,3).map((t=>this.renderFile(t)))}
      `:this.renderNoData(),html$1`
      <div class="root compact" dir=${this.direction}>
        ${t}
      </div>
    `}renderFullView(){let t;return t=this.isLoadingState?this.renderLoading():this._files&&this._files.length?html$1`
        ${this._files.map((t=>this.renderFile(t)))}
      `:this.renderNoData(),html$1`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.filesSectionTitle}</div>
        ${t}
      </div>
    `}renderFile(t){const r=t.lastShared?html$1`
          <div class="file__last-modified">
            ${this.strings.sharedTextSubtitle} ${getRelativeDisplayDate(new Date(t.lastShared.sharedDateTime))}
          </div>
        `:null;return html$1`
      <div class="file" @click=${r=>this.handleFileClick(t)} tabindex="0">
        <div class="file__icon">
          <img alt="${t.resourceVisualization.title}" src=${function getFileTypeIconUri(t,r,o){const i=ER[t]||"genericfile";return`${xR}/${r.toString()}/${i}.${o}`}(t.resourceVisualization.type,48,"svg")} />
        </div>
        <div class="file__details">
          <div class="file__name">${t.resourceVisualization.title}</div>
          ${r}
        </div>
      </div>
    `}handleFileClick(t){t.resourceReference&&t.resourceReference.webUrl&&window.open(t.resourceReference.webUrl,"_blank","noreferrer")}};wF=__decorate$f([customElement$1("mgt-person-card-files"),__metadata$f("design:paramtypes",[Array])],wF);const CF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--color,#000);font-size:16px}:host .root .message .message__detail .message__from{font-size:12px;color:var(--color-sub1,#323130)}:host .root .message .message__detail .message__message{font-size:12px;color:var(--color-sub2,#717171)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{font-size:12px;color:var(--color-sub2,#717171);margin-left:10px;white-space:nowrap}
`],_F={emailsSectionTitle:"Emails"};var __decorate$e=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$e=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};let kF=class MgtPersonCardMessages extends BasePersonCardSection{static get styles(){return CF}get strings(){return _F}constructor(t){super(),this._messages=t}get displayName(){return this.strings.emailsSectionTitle}clearState(){super.clearState(),this._messages=[]}renderIcon(){return getSvg(dR.Messages)}renderCompactView(){let t;if(this.isLoadingState)t=this.renderLoading();else if(this._messages&&this._messages.length){const r=this._messages?this._messages.slice(0,3).map((t=>this.renderMessage(t))):[];t=html$1`
        ${r}
      `}else t=this.renderNoData();return html$1`
      <div class="root compact">
        ${t}
      </div>
    `}renderFullView(){let t;return t=this.isLoadingState?this.renderLoading():this._messages&&this._messages.length?html$1`
        ${this._messages.slice(0,5).map((t=>this.renderMessage(t)))}
      `:this.renderNoData(),html$1`
      <div class="root">
        <div class="title" tabindex="0">${this.strings.emailsSectionTitle}</div>
        ${t}
      </div>
    `}renderMessage(t){return html$1`
      <div class="message" @click=${()=>this.handleMessageClick(t)}>
        <div class="message__detail">
          <div class="message__subject">${t.subject}</div>
          <div class="message__from">${t.from.emailAddress.name}</div>
          <div class="message__message">${t.bodyPreview}</div>
        </div>
        <div class="message__date">${getRelativeDisplayDate(new Date(t.receivedDateTime))}</div>
      </div>
    `}handleMessageClick(t){window.open(t.webLink,"_blank","noreferrer")}};kF=__decorate$e([customElement$1("mgt-person-card-messages"),__metadata$e("design:paramtypes",[Array])],kF);const SF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 20px 20px}:host .root .subtitle{color:var(--title-color-sub2,#717171);font-size:14px;margin:0 20px 8px 20px}:host .root .divider{display:flex;background:var(--line-seperator-color,#edebe9);height:1px;margin-top:26px;margin-bottom:18px;margin-left:20px;margin-right:20px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:var(--background-color-sub2,#f3f2f1);border:1px solid var(--person-card-active-org-member-color,#0078d4)}:host .root .org-member.org-member--direct-report:not(:last-child){border-bottom:none}:host .root .org-member:not(.org-member--target){background-color:var(--background-color-sub1,#faf9f8);border:1px solid var(--line-seperator-color,#edebe9)}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__person mgt-person{--avatar-size:48px;--avatar-size-s:48px;--font-size:16px;--color:#323130;--line2-font-size:14px;--line3-font-size:14px;--line2-text-transform:uppercase;--line2-color:#797775;--line3-color:#797775;--line3-text-transform:uppercase;margin-right:8px;max-width:230px}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--color-sub1,#323130);font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--color-sub2,#717171)}:host .root .org-member__separator{border:1px solid var(--line-seperator-color,#edebe9);box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .coworker .coworker__person{height:46px;width:46px;border-radius:46px;margin-right:8px}:host .root .coworker .coworker__person mgt-person{--font-size:16px;--line2-text-transform:uppercase;--line2-font-size:14px;--line2-color:set-var(color__sub2, $theme-default, $common);--avatar-size:46px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`],TF={reportsToSectionTitle:"Reports to",directReportsSectionTitle:"Direct reports",organizationSectionTitle:"Organization",youWorkWithSubSectionTitle:"You work with",userWorksWithSubSectionTitle:"works with"};var __decorate$d=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$d=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};let EF=class MgtPersonCardOrganization extends BasePersonCardSection{static get styles(){return SF}get strings(){return TF}constructor(t,r){super(),this._state=t,this._me=r}clearState(){super.clearState(),this._state=null,this._me=null}get displayName(){const{person:t,directReports:r}=this._state;return!t.manager&&r&&r.length?`${this.strings.directReportsSectionTitle} (${r.length})`:this.strings.reportsToSectionTitle}renderIcon(){return getSvg(dR.Organization)}renderCompactView(){let t;if(!this._state||!this._state.person)return null;const{person:r,directReports:o}=this._state;return r?(r.manager?t=this.renderCoworker(r.manager):o&&o.length&&(t=this.renderCompactDirectReports()),html$1`
      <div class="root compact">
        ${t}
      </div>
    `):null}renderFullView(){let t;if(!this._state||!this._state.person)return null;const{person:r,directReports:o,people:i}=this._state;if(!(r||o||i))return null;{const r=this.renderManagers(),o=this.renderCurrentUser(),i=this.renderDirectReports(),s=this.renderCoworkers();t=html$1`
        ${r} ${o} ${i} ${s}
      `}return html$1`
      <div class="root" dir=${this.direction}>
        <div class="title" tabindex="0">${this.strings.organizationSectionTitle}</div>
        ${t}
      </div>
    `}renderManager(t){return html$1`
      <div class="org-member" @keydown=${r=>{"Enter"===r.code&&this.navigateCard(t)}} @click=${()=>this.navigateCard(t)}>
        <div class="org-member__person">
          <mgt-person
            .personDetails=${t}
            .line2Property=${"jobTitle"}
            .line3Property=${"department"}
            .fetchImage=${!0}
            .view=${exports.ViewType.threelines}
          ></mgt-person>
        </div>
        <div tabindex="0" class="org-member__more">
          ${getSvg(dR.ExpandRight)}
        </div>
      </div>
      <div class="org-member__separator"></div>
    `}renderManagers(){const{person:t}=this._state;if(!t||!t.manager)return null;const r=[];let o=t;for(;o.manager;)r.push(o.manager),o=o.manager;return r.length?r.reverse().map((t=>this.renderManager(t))):null}renderDirectReports(){const{directReports:t}=this._state;return t&&t.length?html$1`
      <div class="org-member__separator"></div>
      <div>
        ${t.map((t=>html$1`
            <div class="org-member org-member--direct-report" @keydown=${r=>{"Enter"===r.code&&this.navigateCard(t)}} @click=${()=>this.navigateCard(t)}>
              <div class="org-member__person">
                <mgt-person
                  .personDetails=${t}
                  .line2Property=${"jobTitle"}
                  .line3Property=${"department"}
                  .fetchImage=${!0}
                  .view=${exports.ViewType.twolines}
                ></mgt-person>
              </div>
              <div tabindex="0" class="org-member__more">
                ${getSvg(dR.ExpandRight)}
              </div>
            </div>
          `))}
      </div>
    `:null}renderCompactDirectReports(){const{directReports:t}=this._state;return html$1`
      <div class="direct-report__compact">
        ${t.slice(0,6).map((t=>html$1`
            <div class="direct-report" @keydown=${r=>{"Enter"===r.code&&this.navigateCard(t)}} @click=${()=>this.navigateCard(t)} @keydown=${r=>{"Enter"===r.code&&this.navigateCard(t)}}>
              <mgt-person .personDetails=${t} .fetchImage=${!0}></mgt-person>
            </div>
          `))}
      </div>
    `}renderCurrentUser(){const{person:t}=this._state;return html$1`
      <div class="org-member org-member--target">
        <div class="org-member__person">
          <mgt-person
            .personDetails=${t}
            .line2Property=${"jobTitle"}
            .line3Property=${"department"}
            .fetchImage=${!0}
            .view=${exports.ViewType.threelines}
          ></mgt-person>
        </div>
      </div>
    `}renderCoworker(t){return html$1`
      <div class="coworker" @keydown=${r=>{"Enter"===r.code&&this.navigateCard(t)}} @click=${()=>this.navigateCard(t)}>
        <div class="coworker__person">
          <mgt-person
            .personDetails=${t}
            .line2Property=${"jobTitle"}
            .fetchImage=${!0}
            .view=${exports.ViewType.twolines}
          ></mgt-person>
        </div>
      </div>
    `}renderCoworkers(){const{people:t}=this._state;if(!t||!t.length)return null;const r=this._me.id===this._state.person.id?this.strings.youWorkWithSubSectionTitle:`${this._state.person.givenName} ${this.strings.userWorksWithSubSectionTitle}`;return html$1`
      <div class="divider"></div>
      <div class="subtitle" tabindex="0">${r}</div>
      <div>
        ${t.slice(0,6).map((t=>this.renderCoworker(t)))}
      </div>
    `}};EF=__decorate$d([customElement$1("mgt-person-card-organization"),__metadata$d("design:paramtypes",[Object,Object])],EF);const xF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:14px;color:var(--title-color-sub2,#717171)}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-direction:row;flex-wrap:wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--background-color-sub2,#f3f2f1);border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item:hover{color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--color-sub2,#717171);margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--title-color-subtitle,#323130)}:host .root .data-list__item .data-list__item__date-range{color:var(--color-sub2,#717171);font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#0078d4}:host .root .work-position .work-position__location{font-size:10px;color:var(--color-sub2,#717171);line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--color-sub3,#727170)}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--color-sub1,#323130)}[dir=rtl] .token-list__item{margin-right:0!important}
`],IF={SkillsAndExperienceSectionTitle:"Skills & Experience",AboutCompactSectionTitle:"About",SkillsSubSectionTitle:"Skills",LanguagesSubSectionTitle:"Languages",WorkExperienceSubSectionTitle:"Work Experience",EducationSubSectionTitle:"Education",professionalInterestsSubSectionTitle:"Professional Interests",personalInterestsSubSectionTitle:"Personal Interests",birthdaySubSectionTitle:"Birthday",currentYearSubtitle:"Current"};var __decorate$c=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$c=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};let AF=class MgtPersonCardProfile extends BasePersonCardSection{static get styles(){return xF}get strings(){return IF}get displayName(){return this.strings.SkillsAndExperienceSectionTitle}get hasData(){if(!this.profile)return!1;const{languages:t,skills:r,positions:o,educationalActivities:i}=this.profile;return[this._birthdayAnniversary,this._personalInterests&&this._personalInterests.length,this._professionalInterests&&this._professionalInterests.length,t&&t.length,r&&r.length,o&&o.length,i&&i.length].filter((t=>!!t)).length>0}get profile(){return this._profile}set profile(t){t!==this._profile&&(this._profile=t,this._birthdayAnniversary=t&&t.anniversaries?t.anniversaries.find(this.isBirthdayAnniversary):null,this._personalInterests=t&&t.interests?t.interests.filter(this.isPersonalInterest):null,this._professionalInterests=t&&t.interests?t.interests.filter(this.isProfessionalInterest):null)}constructor(t){super(),this.profile=t}renderIcon(){return getSvg(dR.Profile)}clearState(){super.clearState(),this.profile=null}renderCompactView(){return html$1`
      <div class="root compact" dir=${this.direction}>
        ${this.renderSubSections().slice(0,2)}
      </div>
    `}renderFullView(){return this.initPostRenderOperations(),html$1`
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.AboutCompactSectionTitle}</div>
        ${this.renderSubSections()}
      </div>
    `}renderSubSections(){return[this.renderSkills(),this.renderBirthday(),this.renderLanguages(),this.renderWorkExperience(),this.renderEducation(),this.renderProfessionalInterests(),this.renderPersonalInterests()].filter((t=>!!t))}renderLanguages(){const{languages:t}=this._profile;if(!t||!t.length)return null;const r=[];for(const o of t){let t=null;o.proficiency&&o.proficiency.length&&(t=html$1`
          <span class="language__proficiency" tabindex="0">
            &nbsp;(${o.proficiency})
          </span>
        `),r.push(html$1`
        <div class="token-list__item language">
          <span class="language__title" tabindex="0">${o.displayName}</span>
          ${t}
        </div>
      `)}const o=r.length?this.strings.LanguagesSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title" tabindex="0">${o}</div>
        <div class="section__content">
          <div class="token-list">
            ${r}
          </div>
        </div>
      </section>
    `}renderSkills(){const{skills:t}=this._profile;if(!t||!t.length)return null;const r=[];for(const o of t)r.push(html$1`
        <div class="token-list__item skill" tabindex="0">
          ${o.displayName}
        </div>
      `);const o=r.length?this.strings.SkillsSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title" tabindex="0">${o}</div>
        <div class="section__content">
          <div class="token-list">
            ${r}
          </div>
        </div>
      </section>
    `}renderWorkExperience(){var t,r,o,i,s,l,u,h,m;const{positions:v}=this._profile;if(!v||!v.length)return null;const C=[];for(const v of this._profile.positions)(v.detail.description||""!==v.detail.jobTitle)&&C.push(html$1`
          <div class="data-list__item work-position">
            <div class="data-list__item__header">
              <div class="data-list__item__title" tabindex="0">${null===(t=v.detail)||void 0===t?void 0:t.jobTitle}</div>
              <div class="data-list__item__date-range" tabindex="0">
                ${this.getDisplayDateRange(v.detail)}
              </div>
            </div>
            <div class="data-list__item__content">
              <div class="work-position__company" tabindex="0">
                ${null===(o=null===(r=null==v?void 0:v.detail)||void 0===r?void 0:r.company)||void 0===o?void 0:o.displayName}
              </div>
              <div class="work-position__location" tabindex="0">
                ${null===(l=null===(s=null===(i=null==v?void 0:v.detail)||void 0===i?void 0:i.company)||void 0===s?void 0:s.address)||void 0===l?void 0:l.city}, ${null===(m=null===(h=null===(u=null==v?void 0:v.detail)||void 0===u?void 0:u.company)||void 0===h?void 0:h.address)||void 0===m?void 0:m.state}
              </div>
            </div>
          </div>
        `);const _=C.length?this.strings.WorkExperienceSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title" tabindex="0">${_}</div>
        <div class="section__content">
          <div class="data-list">
            ${C}
          </div>
        </div>
      </section>
    `}renderEducation(){const{educationalActivities:t}=this._profile;if(!t||!t.length)return null;const r=[];for(const o of t)r.push(html$1`
        <div class="data-list__item educational-activity">
          <div class="data-list__item__header">
            <div class="data-list__item__title" tabindex="0">${o.institution.displayName}</div>
            <div class="data-list__item__date-range" tabindex="0">
              ${this.getDisplayDateRange(o)}
            </div>
          </div>
          <div class="data-list__item__content">
            <div class="educational-activity__degree" tabindex="0">
              ${o.program.displayName||"Bachelors Degree"}
            </div>
          </div>
        </div>
      `);const o=r.length?this.strings.EducationSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title" tabindex="0">${o}</div>
        <div class="section__content">
          <div class="data-list">
            ${r}
          </div>
        </div>
      </section>
    `}renderProfessionalInterests(){if(!this._professionalInterests||!this._professionalInterests.length)return null;const t=[];for(const r of this._professionalInterests)t.push(html$1`
        <div class="token-list__item interest interest--professional" tabindex="0">
          ${r.displayName}
        </div>
      `);const r=t.length?this.strings.professionalInterestsSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title" tabindex="0">${r}</div>
        <div class="section__content">
          <div class="token-list">
            ${t}
          </div>
        </div>
      </section>
    `}renderPersonalInterests(){if(!this._personalInterests||!this._personalInterests.length)return null;const t=[];for(const r of this._personalInterests)t.push(html$1`
        <div class="token-list__item interest interest--personal" tabindex="0">
          ${r.displayName}
        </div>
      `);const r=t.length?this.strings.personalInterestsSubSectionTitle:"";return html$1`
      <section>
        <div class="section__title" tabindex="0">${r}</div>
        <div class="section__content">
          <div class="token-list">
            ${t}
          </div>
        </div>
      </section>
    `}renderBirthday(){return this._birthdayAnniversary&&this._birthdayAnniversary.date?html$1`
      <section>
        <div class="section__title" tabindex="0">Birthday</div>
        <div class="section__content">
          <div class="birthday">
            <div class="birthday__icon">
              ${getSvg(dR.Birthday)}
            </div>
            <div class="birthday__date" tabindex="0">
              ${this.getDisplayDate(new Date(this._birthdayAnniversary.date))}
            </div>
          </div>
        </div>
      </section>
    `:null}isPersonalInterest(t){return t.categories&&t.categories.includes("personal")}isProfessionalInterest(t){return t.categories&&t.categories.includes("professional")}isBirthdayAnniversary(t){return"birthday"===t.type}getDisplayDate(t){return t.toLocaleString("default",{day:"numeric",month:"long"})}getDisplayDateRange(t){const r=new Date(t.startMonthYear).getFullYear();if(0===r)return null;return`${r} â ${t.endMonthYear?new Date(t.endMonthYear).getFullYear():this.strings.currentYearSubtitle}`}initPostRenderOperations(){setTimeout((()=>{try{this.shadowRoot.querySelectorAll("section").forEach((t=>{this.handleTokenOverflow(t)}))}catch(t){}}),0)}handleTokenOverflow(t){const r=t.querySelectorAll(".token-list");if(r&&r.length)for(const t of Array.from(r)){const r=t.querySelectorAll(".token-list__item");if(!r||!r.length)continue;let o=null,i=r[0].getBoundingClientRect();const s=t.getBoundingClientRect(),l=2*i.height+s.top;for(let t=0;t<r.length-1;t++)if(i=r[t].getBoundingClientRect(),i.top>l){o=Array.from(r).slice(t,r.length);break}if(o){o.forEach((t=>t.classList.add("overflow")));const r=document.createElement("div");r.classList.add("token-list__item"),r.classList.add("token-list__item--show-overflow"),r.tabIndex=0,r.innerText=`+ ${o.length} more`;const revealOverflow=()=>{r.remove(),o.forEach((t=>t.classList.remove("overflow")))};r.addEventListener("click",(t=>{revealOverflow()})),r.addEventListener("keydown",(t=>{"Enter"===t.code&&revealOverflow()})),t.appendChild(r)}}}};AF=__decorate$c([customElement$1("mgt-person-card-profile"),__metadata$c("design:paramtypes",[Object])],AF);const PF={sendEmailLinkSubtitle:"Send email",startChatLinkSubtitle:"Start chat",showMoreSectionButton:"Show more",endOfCard:"End of the card"};var RF,__decorate$b=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$b=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$h=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.MgtPersonCard=RF=class MgtPersonCard extends MgtTemplatedComponent{static get styles(){return fF}get strings(){return PF}static get requiredScopes(){return RF.getScopes()}static getScopes(){const t=[];return this.config.sections.files&&t.push("Sites.Read.All"),this.config.sections.mailMessages&&t.push("Mail.ReadBasic"),this.config.sections.organization&&(t.push("User.Read.All"),"boolean"!=typeof this.config.sections.organization&&this.config.sections.organization.showWorksWith&&t.push("People.Read.All")),this.config.sections.profile&&t.push("User.Read.All"),this.config.useContactApis&&t.push("Contacts.Read"),t.indexOf("User.Read.All")<0&&(t.push("User.ReadBasic.All"),t.push("User.Read")),t.indexOf("People.Read.All")<0&&t.push("People.Read"),[...new Set(t)]}static get config(){return this._config}get personDetails(){return this._personDetails}set personDetails(t){this._personDetails!==t&&(this._personDetails=t,this.personImage=this.getImage(),this.requestStateUpdate())}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.personDetails=null,this.state=null,this.requestStateUpdate())}get internalPersonDetails(){return this.state&&this.state.person||this.personDetails}constructor(){super(),this._chatInput="",this._currentSection=null,this._history=[],this.sections=[]}attributeChangedCallback(t,r,o){if(super.attributeChangedCallback(t,r,o),r!==o&&"person-query"===t)this.personDetails=null,this.state=null,this.requestStateUpdate()}navigate(t){this._history.push({personDetails:this.personDetails,personImage:this.getImage(),state:this.state}),this._personDetails=t,this.state=null,this.personImage=null,this._currentSection=null,this.sections=[],this.requestStateUpdate()}goBack(){if(!this._history||!this._history.length)return;const t=this._history.pop();this._currentSection=null,this.state=t.state,this._personDetails=t.state,this.personImage=t.personImage,this.loadSections()}clearHistory(){if(this._currentSection=null,!this._history||!this._history.length)return;const t=this._history[0];this._history=[],this.state=t.state,this._personDetails=t.state,this.personImage=t.personImage,this.loadSections()}render(){if(!this.internalPersonDetails)return this.renderNoData();const t=this.internalPersonDetails,r=this.getImage();if(this.hasTemplate("default"))return this.renderTemplate("default",{person:this.internalPersonDetails,personImage:r});const o=this._history&&this._history.length?html$1`
            <div class="nav">
              <div class="nav__back" tabindex="0" @keydown=${t=>{"Enter"===t.code&&this.goBack()}} @click=${()=>this.goBack()}>${getSvg(dR.Back)}</div>
            </div>
          `:null;let i=this.renderTemplate("person-details",{person:this.internalPersonDetails,personImage:r});if(!i){const r=this.renderPerson(),o=this.renderContactIcons(t);i=html$1`
        ${r} ${o}
      `}const s=this.isExpanded?this.renderExpandedDetails():this.renderExpandedDetailsButton();this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0);const l=this.lockTabNavigation?html$1`<div @keydown=${this.handleEndOfCard} aria-label=${this.strings.endOfCard} tabindex="0" id="end-of-container"></div>`:html$1``;return html$1`
      <div class="root" dir=${this.direction}>
      <div class=${this._smallView?"small":""}>
          ${o}
          <div class="person-details-container">${i}</div>
          <div class="expanded-details-container">${s}</div>
          ${l}
        </div>
      </div>
    `}handleEndOfCard(t){if(t&&"Tab"===t.code){const t=this.renderRoot.querySelector("#end-of-container");if(t){t.blur();const r=this.renderRoot.querySelector("mgt-person");r&&r.focus()}}}renderNoData(){return this.renderTemplate("no-data",null)||html$1``}renderPerson(){return html$1`
      <mgt-person
        tabindex="0"
        class="person-image"
        .personDetails=${this.internalPersonDetails}
        .personImage=${this.getImage()}
        .personPresence=${this.personPresence}
        .showPresence=${this.showPresence}
        .avatarSize=${"large"}
        .view=${exports.ViewType.threelines}
        .line2Property=${"jobTitle"}
        .line3Property=${"department"}
      ></mgt-person>
    `}renderPersonSubtitle(t){if((t=t||this.internalPersonDetails).department)return html$1`
      <div class="department">${t.department}</div>
    `}renderContactIcons(t){if(this.isExpanded)return;const r=t=t||this.internalPersonDetails;let o,i;return getEmailFromGraphEntity(t)&&(o=html$1`
        <div class="icon" @click=${()=>this.emailUser()} tabindex=0>
          ${getSvg(dR.SmallEmail)}
          <span>${this.strings.sendEmailLinkSubtitle}</span>
        </div>
      `),r.userPrincipalName&&(i=html$1`
        <div class="icon" @click=${()=>this.chatUser()} tabindex=0>
          ${getSvg(dR.SmallChat)}
          <span>${this.strings.startChatLinkSubtitle}</span>
        </div>
      `),html$1`
      <div class="base-icons">
        ${o} ${i}
      </div>
    `}renderExpandedDetailsButton(){return html$1`
      <div 
        class="expanded-details-button" 
        @click=${()=>this.showExpandedDetails()} 
        @keydown=${this.handleKeyDown}
        tabindex=0>
          ${getSvg(dR.ExpandDown)}
      </div>
    `}renderExpandedDetails(t){if(!this.state&&this.isStateLoading)return html$1`
        <div class="loading">
          <mgt-spinner></mgt-spinner>
        </div>
      `;Providers.globalProvider.state===exports.ProviderState.SignedOut&&this.loadSections(),t=t||this.internalPersonDetails;const r=this.renderSectionNavigation(),o=this.renderCurrentSection();return html$1`
      <div class="section-nav">
        ${r}
      </div>
      <div class="section-host ${this._smallView?"small":""}" @wheel=${t=>this.handleSectionScroll(t)} tabindex=0>
        ${o}
      </div>
    `}renderSectionNavigation(){if(!this.sections||this.sections.length<2&&!this.hasTemplate("additional-details"))return;const t=this._currentSection?this.sections.indexOf(this._currentSection):-1,r=this.sections.map(((r,o)=>{const i=oR({active:o===t,"section-nav__icon":!0}),s=r.tagName,l=s.substring(16,s.length).toLowerCase();return html$1`
        <button
          aria-label=${l}
          tabindex=0
          class=${i}
          @click=${()=>this.updateCurrentSection(r)}>
            ${r.renderIcon()}</button>
      `})),o=oR({active:-1===t,"section-nav__icon":!0});return html$1`
      <button 
        aria-label="overview"
        tabindex=0 
        class=${o}
        @click=${()=>this.updateCurrentSection(null)}>
          ${getSvg(dR.Overview)}
      </button>
      ${r}
    `}renderOverviewSection(){const t=this.sections.map((t=>html$1`
        <div class="section">
          <div class="section__header">
            <div class="section__title" tabindex="0">${t.displayName}</div>
            <a 
              class="section__show-more"
              tabindex=0
              @keydown=${r=>function handleKeyDown(t,r){"Enter"===t.code&&this.updateCurrentSection(r)}(r,t)}
              @click=${()=>this.updateCurrentSection(t)}>
                ${this.strings.showMoreSectionButton}</a>
          </div>
          <div class="section__content">${t.asCompactView()}</div>
        </div>
      `)),r=this.renderTemplate("additional-details",{person:this.internalPersonDetails,personImage:this.getImage(),state:this.state});return r&&t.splice(1,0,html$1`
          <div class="section">
            <div class="additional-details">${r}</div>
          </div>
        `),html$1`
      <div class="sections">
        ${t}
      </div>
    `}renderCurrentSection(){if(this.sections&&this.sections.length||this.hasTemplate("additional-details"))return 1!==this.sections.length||this.hasTemplate("additional-details")?this._currentSection?html$1`
      ${this._currentSection.asFullView()}
    `:this.renderOverviewSection():html$1`
        ${this.sections[0].asFullView()}
      `}loadState(){var t;return __awaiter$h(this,void 0,void 0,(function*(){if(this.state)return;if(!this.personDetails&&this.inheritDetails){let t=this.parentElement;for(;t&&"MGT-PERSON"!==t.tagName;)t=t.parentElement;let r=t.personDetails||t.personDetailsInternal;t&&r&&(this.personDetails=r,this.personImage=t.personImage)}const r=Providers.globalProvider;if(!r||r.state!==exports.ProviderState.SignedIn)return;const o=r.graph.forComponent(this);if(this.isStateLoading=!0,this._me||(this._me=yield Providers.me()),this.personDetails){const t=this.personDetails,r=t.userPrincipalName||t.id;if(r&&!getEmailFromGraphEntity(t)){const t=yield getUserWithPhoto(o,r);this.personDetails=t,this.personImage=this.getImage()}}else if(this.userId||"me"===this.personQuery){const t=yield getUserWithPhoto(o,this.userId);this.personDetails=t,this.personImage=this.getImage()}else if(this.personQuery){const t=yield findPeople(o,this.personQuery,1);t&&t.length&&(this.personDetails=t[0],getPersonImage(o,this.personDetails,RF.config.useContactApis).then((t=>{t&&(this.personDetails.personImage=t,this.personImage=t)})))}const i={activity:"Offline",availability:"Offline",id:null};if(!this.personPresence&&this.showPresence)try{this.personDetails&&this.personDetails.id?getUserPresence(o,this.personDetails.id).then((t=>{this.personPresence=t})):this.personPresence=i}catch(t){this.personPresence=i}(null===(t=this.personDetails)||void 0===t?void 0:t.id)&&(this.state=yield getPersonCardGraphData(o,this.personDetails,this._me===this.personDetails.id,RF.config)),this.loadSections(),this.isStateLoading=!1}))}sendQuickMessage(){const t=this._chatInput.trim();t&&t.length&&this.chatUser(t)}emailUser(){const t=this.internalPersonDetails;if(t){const r=getEmailFromGraphEntity(t);r&&window.open("mailto:"+r,"_blank","noreferrer")}}callUser(){const t=this.personDetails,r=this.personDetails;if(t&&t.businessPhones&&t.businessPhones.length){const r=t.businessPhones[0];r&&window.open("tel:"+r,"_blank","noreferrer")}else if(r&&r.phones&&r.phones.length){const t=this.getPersonBusinessPhones(r)[0];t&&window.open("tel:"+t,"_blank","noreferrer")}}chatUser(t=null){const r=this.personDetails;if(r&&r.userPrincipalName){let o=`https://teams.microsoft.com/l/chat/0/0?users=${r.userPrincipalName}`;t&&t.length&&(o+=`&message=${t}`);const openWindow=()=>window.open(o,"_blank","noreferrer");TeamsHelper.isAvailable?TeamsHelper.executeDeepLink(o,(t=>{t||openWindow()})):openWindow()}}showExpandedDetails(){const t=this.renderRoot.querySelector(".root");t&&t.animate&&t.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this.isExpanded=!0,this.fireCustomEvent("expanded",null,!0)}loadSections(){if(this.sections=[],!this.internalPersonDetails)return;const t=new vF(this.internalPersonDetails);if(t.hasData&&this.sections.push(t),!this.state)return;const{person:r,directReports:o,messages:i,files:s,profile:l}=this.state;if(RF.config.sections.organization&&(r&&r.manager||o&&o.length)&&this.sections.push(new EF(this.state,this._me)),RF.config.sections.mailMessages&&i&&i.length&&this.sections.push(new kF(i)),RF.config.sections.files&&s&&s.length&&this.sections.push(new wF(s)),RF.config.sections.profile&&l){const t=new AF(l);t.hasData&&this.sections.push(t)}}getImage(){if(this.personImage)return this.personImage;const t=this.personDetails;return t&&t.personImage?t.personImage:null}getPersonBusinessPhones(t){const r=t.phones,o=[];for(const t of r)"business"===t.type&&o.push(t.number);return o}updateCurrentSection(t){this.renderRoot.querySelector(".section-host").scrollTop=0,this._currentSection=t,this.requestUpdate()}handleSectionScroll(t){const r=this.renderRoot.querySelector(".section-host");r&&(t.deltaY<0&&0===r.scrollTop||t.deltaY>0&&r.clientHeight+r.scrollTop>=r.scrollHeight-1||t.stopPropagation())}handleKeyDown(t){t&&13===t.keyCode&&this.showExpandedDetails()}},exports.MgtPersonCard._config={sections:{files:!0,mailMessages:!0,organization:{showWorksWith:!0},profile:!0},useContactApis:!0},__decorate$b([property({attribute:"person-details",type:Object}),__metadata$b("design:type",Object),__metadata$b("design:paramtypes",[Object])],exports.MgtPersonCard.prototype,"personDetails",null),__decorate$b([property({attribute:"person-query"}),__metadata$b("design:type",String)],exports.MgtPersonCard.prototype,"personQuery",void 0),__decorate$b([property({attribute:"lock-tab-navigation",type:Boolean}),__metadata$b("design:type",Boolean)],exports.MgtPersonCard.prototype,"lockTabNavigation",void 0),__decorate$b([property({attribute:"user-id"}),__metadata$b("design:type",String),__metadata$b("design:paramtypes",[String])],exports.MgtPersonCard.prototype,"userId",null),__decorate$b([property({attribute:"person-image",type:String}),__metadata$b("design:type",String)],exports.MgtPersonCard.prototype,"personImage",void 0),__decorate$b([property({attribute:"fetch-image",type:Boolean}),__metadata$b("design:type",Boolean)],exports.MgtPersonCard.prototype,"fetchImage",void 0),__decorate$b([property({attribute:"is-expanded",type:Boolean}),__metadata$b("design:type",Boolean)],exports.MgtPersonCard.prototype,"isExpanded",void 0),__decorate$b([property({attribute:"inherit-details",type:Boolean}),__metadata$b("design:type",Boolean)],exports.MgtPersonCard.prototype,"inheritDetails",void 0),__decorate$b([property({attribute:"show-presence",type:Boolean}),__metadata$b("design:type",Boolean)],exports.MgtPersonCard.prototype,"showPresence",void 0),__decorate$b([property({attribute:"person-presence",type:Object}),__metadata$b("design:type",Object)],exports.MgtPersonCard.prototype,"personPresence",void 0),__decorate$b([internalProperty(),__metadata$b("design:type",Object)],exports.MgtPersonCard.prototype,"state",void 0),__decorate$b([internalProperty(),__metadata$b("design:type",Boolean)],exports.MgtPersonCard.prototype,"isStateLoading",void 0),exports.MgtPersonCard=RF=__decorate$b([customElement$1("mgt-person-card"),__metadata$b("design:paramtypes",[])],exports.MgtPersonCard);const OF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;-webkit-appearance:none}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,1px solid #e1dfdd);border-radius:8px}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#717171));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle;color:var(--color-sub2,#717171)}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\uE739'}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\uE73A'}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex;height:32px;padding:2px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{margin-right:28px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-family:var(--default-font-family, "Segoe UI");font-size:14px;line-height:20px}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130))}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`];var __awaiter$g=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};function assignPeopleToPlannerTask(t,r,o,i){return setPlannerTaskDetails(t,r,{assignments:o},i)}function setPlannerTaskDetails(t,r,o,i){return __awaiter$g(this,void 0,void 0,(function*(){return yield t.api(`/planner/tasks/${r}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.ReadWrite.All")).header("If-Match",i).patch(JSON.stringify(o))}))}var __awaiter$f=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};function setTodoTaskDetails(t,r,o,i){return __awaiter$f(this,void 0,void 0,(function*(){return yield t.api(`/me/outlook/tasks/${r}`).header("Cache-Control","no-store").header("If-Match",i).middlewareOptions(prepScopes("Tasks.ReadWrite")).patch(o)}))}var __awaiter$e=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class TaskSourceBase{constructor(t){this.graph=BetaGraph.fromGraph(t)}}class PlannerTaskSource extends TaskSourceBase{getTaskGroups(){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getAllMyPlannerPlans(t){return __awaiter$g(this,void 0,void 0,(function*(){const r=yield t.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return r&&r.value}))}(this.graph)).map((t=>{var r;return{id:t.id,title:t.title,containerId:null===(r=null==t?void 0:t.container)||void 0===r?void 0:r.containerId}}))}))}getTaskGroupsForGroup(t){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getPlansForGroup(t,r){return __awaiter$g(this,void 0,void 0,(function*(){const o=`/groups/${r}/planner/plans`,i=yield t.api(o).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return i?i.value:null}))}(this.graph,t)).map((t=>({id:t.id,title:t.title})))}))}getTaskGroup(t){return __awaiter$e(this,void 0,void 0,(function*(){const r=yield function getSinglePlannerPlan(t,r){return __awaiter$g(this,void 0,void 0,(function*(){return yield t.api(`/planner/plans/${r}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get()}))}(this.graph,t);return{id:r.id,title:r.title,_raw:r}}))}getTaskFoldersForTaskGroup(t){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getBucketsForPlannerPlan(t,r){return __awaiter$g(this,void 0,void 0,(function*(){const o=yield t.api(`/planner/plans/${r}/buckets`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return o&&o.value}))}(this.graph,t)).map((t=>({_raw:t,id:t.id,name:t.name,parentId:t.planId})))}))}getTasksForTaskFolder(t){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getTasksForPlannerBucket(t,r){return __awaiter$g(this,void 0,void 0,(function*(){const o=yield t.api(`/planner/buckets/${r}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return o&&o.value}))}(this.graph,t)).map((t=>({_raw:t,assignments:t.assignments,completed:100===t.percentComplete,dueDate:t.dueDateTime&&new Date(t.dueDateTime),eTag:t["@odata.etag"],id:t.id,immediateParentId:t.bucketId,name:t.title,topParentId:t.planId})))}))}setTaskComplete(t,r){return __awaiter$e(this,void 0,void 0,(function*(){return yield function setPlannerTaskComplete(t,r,o){return setPlannerTaskDetails(t,r,{percentComplete:100},o)}(this.graph,t,r)}))}setTaskIncomplete(t,r){return __awaiter$e(this,void 0,void 0,(function*(){return yield function setPlannerTaskIncomplete(t,r,o){return setPlannerTaskDetails(t,r,{percentComplete:0},o)}(this.graph,t,r)}))}addTask(t){return __awaiter$e(this,void 0,void 0,(function*(){return yield function addPlannerTask(t,r){return t.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.ReadWrite.All")).post(r)}(this.graph,{assignments:t.assignments,bucketId:t.immediateParentId,dueDateTime:t.dueDate&&t.dueDate.toISOString(),planId:t.topParentId,title:t.name})}))}assignPeopleToTask(t,r,o){return __awaiter$e(this,void 0,void 0,(function*(){return yield assignPeopleToPlannerTask(this.graph,t,r,o)}))}removeTask(t,r){return __awaiter$e(this,void 0,void 0,(function*(){return yield function removePlannerTask(t,r,o){return t.api(`/planner/tasks/${r}`).header("Cache-Control","no-store").header("If-Match",o).middlewareOptions(prepScopes("Group.ReadWrite.All")).delete()}(this.graph,t,r)}))}isAssignedToMe(t,r){return Object.keys(t.assignments).includes(r)}}class TodoTaskSource extends TaskSourceBase{getTaskGroups(){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getAllMyTodoGroups(t){return __awaiter$f(this,void 0,void 0,(function*(){const r=yield t.api("/me/outlook/taskGroups").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return r&&r.value}))}(this.graph)).map((t=>({_raw:t,id:t.id,secondaryId:t.groupKey,title:t.name})))}))}getTaskGroup(t){return __awaiter$e(this,void 0,void 0,(function*(){const r=yield function getSingleTodoGroup(t,r){return __awaiter$f(this,void 0,void 0,(function*(){return yield t.api(`/me/outlook/taskGroups/${r}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get()}))}(this.graph,t);return{id:r.id,secondaryId:r.groupKey,title:r.name,_raw:r}}))}getTaskFoldersForTaskGroup(t){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getFoldersForTodoGroup(t,r){return __awaiter$f(this,void 0,void 0,(function*(){const o=yield t.api(`/me/outlook/taskGroups/${r}/taskFolders`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return o&&o.value}))}(this.graph,t)).map((r=>({_raw:r,id:r.id,name:r.name,parentId:t})))}))}getTasksForTaskFolder(t,r){return __awaiter$e(this,void 0,void 0,(function*(){return(yield function getAllTodoTasksForFolder(t,r){return __awaiter$f(this,void 0,void 0,(function*(){const o=yield t.api(`/me/outlook/taskFolders/${r}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return o&&o.value}))}(this.graph,t)).map((o=>({_raw:o,assignments:{},completed:!!o.completedDateTime,dueDate:o.dueDateTime&&new Date(o.dueDateTime.dateTime+"Z"),eTag:o["@odata.etag"],id:o.id,immediateParentId:t,name:o.subject,topParentId:r})))}))}setTaskComplete(t,r){return __awaiter$e(this,void 0,void 0,(function*(){return yield function setTodoTaskComplete(t,r,o){return __awaiter$f(this,void 0,void 0,(function*(){return yield setTodoTaskDetails(t,r,{isReminderOn:!1,status:"completed"},o)}))}(this.graph,t,r)}))}assignPeopleToTask(t,r,o){return __awaiter$e(this,void 0,void 0,(function*(){return yield assignPeopleToPlannerTask(this.graph,t,r,o)}))}setTaskIncomplete(t,r){return __awaiter$e(this,void 0,void 0,(function*(){return yield function setTodoTaskIncomplete(t,r,o){return __awaiter$f(this,void 0,void 0,(function*(){return yield setTodoTaskDetails(t,r,{isReminderOn:!0,status:"notStarted"},o)}))}(this.graph,t,r)}))}addTask(t){return __awaiter$e(this,void 0,void 0,(function*(){const r={parentFolderId:t.immediateParentId,subject:t.name};return t.dueDate&&(r.dueDateTime={dateTime:t.dueDate.toISOString(),timeZone:"UTC"}),yield function addTodoTask(t,r){return __awaiter$f(this,void 0,void 0,(function*(){const{parentFolderId:o=null}=r;return o?yield t.api(`/me/outlook/taskFolders/${o}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(r):yield t.api("/me/outlook/tasks").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(r)}))}(this.graph,r)}))}removeTask(t,r){return __awaiter$e(this,void 0,void 0,(function*(){return yield function removeTodoTask(t,r,o){return __awaiter$f(this,void 0,void 0,(function*(){return yield t.api(`/me/outlook/tasks/${r}`).header("Cache-Control","no-store").header("If-Match",o).middlewareOptions(prepScopes("Tasks.ReadWrite")).delete()}))}(this.graph,t,r)}))}isAssignedToMe(t,r){return!0}getTaskGroupsForGroup(t){return __awaiter$e(this,void 0,void 0,(function*(){}))}}const NF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host,mgt-arrow-options{position:relative;font-family:var(--default-font-family)}:host .ArrowIcon,mgt-arrow-options .ArrowIcon{font-family:FabricMDL2Icons;margin:0 0 0 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Header,mgt-arrow-options .Header{cursor:pointer}:host .Header:hover,mgt-arrow-options .Header:hover{color:var(--theme-primary-color)}:host .Menu,mgt-arrow-options .Menu{position:absolute;left:var(--arrow-options-left,0);box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap}:host .Menu.Open,mgt-arrow-options .Menu.Open{display:block}:host .MenuOption,mgt-arrow-options .MenuOption{padding:20px;cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;display:flex;align-items:center;justify-content:stretch;justify-items:stretch}:host .MenuOption:first,mgt-arrow-options .MenuOption:first{padding:12px 20px 20px 20px}:host .MenuOption:hover,mgt-arrow-options .MenuOption:hover{background-color:var(--background-color--hover,#edebe9)}:host .MenuOption:active,mgt-arrow-options .MenuOption:active{background-color:var(--background-color--active,#e1dfdd)}:host .MenuOptionCheck,mgt-arrow-options .MenuOptionCheck{font-family:FabricMDL2Icons;color:transparent;margin-right:10px}:host .MenuOptionCheck.CurrentValue,mgt-arrow-options .MenuOptionCheck.CurrentValue{color:#0078d4}
`];var __decorate$a=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$a=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};let MF=class MgtArrowOptions extends MgtBaseComponent{static get styles(){return NF}constructor(){super(),this.value="",this.options={},this._clickHandler=t=>this.open=!1}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}onHeaderClick(t){Object.keys(this.options).length>1&&(t.preventDefault(),t.stopPropagation(),this.open=!this.open)}render(){return html$1`
      <span class="Header" @click=${t=>this.onHeaderClick(t)}>
        <span class="CurrentValue">${this.value}</span>
      </span>
      <div class=${oR({Menu:!0,Open:this.open,Closed:!this.open})}>
        ${this.getMenuOptions()}
      </div>
    `}getMenuOptions(){const t=Object.keys(this.options),r=this.options;return t.map((t=>html$1`
        <div
          class="MenuOption"
          @click="${o=>{this.open=!1,r[t](o)}}"
        >
          <span class=${oR({MenuOptionCheck:!0,CurrentValue:this.value===t})}>
            \uE73E
          </span>
          <span class="MenuOptionName">${t}</span>
        </div>
      `))}};__decorate$a([property({type:Boolean}),__metadata$a("design:type",Boolean)],MF.prototype,"open",void 0),__decorate$a([property({type:String}),__metadata$a("design:type",String)],MF.prototype,"value",void 0),__decorate$a([property({type:Object}),__metadata$a("design:type",Object)],MF.prototype,"options",void 0),MF=__decorate$a([customElement$1("mgt-arrow-options"),__metadata$a("design:paramtypes",[])],MF);const DF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}:host,mgt-dot-options{font-family:var(--default-font-family)}:host .DotIcon,mgt-dot-options .DotIcon{display:inline-block;font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .Menu,mgt-dot-options .Menu{position:absolute;box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap;transform:var(--dot-options-translateX,translateX(-50px))}:host .DotMenu.Open .Menu,mgt-dot-options .DotMenu.Open .Menu{display:block}:host .DotMenu .DotItem,mgt-dot-options .DotMenu .DotItem{direction:ltr;text-align:left;padding:10px 10px 8px 10px}:host .DotMenu .DotItem:hover,mgt-dot-options .DotMenu .DotItem:hover{background:var(--background-color--hover,#edebe9)}:host .DotMenu .DotItem:active,mgt-dot-options .DotMenu .DotItem:active{background:var(--background-color--active,#e1dfdd)}:host .DotMenu .DotItemName,mgt-dot-options .DotMenu .DotItemName{direction:rtl}
`];var __decorate$9=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$9=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};let FF=class MgtDotOptions extends MgtBaseComponent{static get styles(){return DF}constructor(){super(),this._clickHandler=null,this._clickHandler=t=>this.open=!1}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}render(){return html$1`
      <div tabindex="0" class=${oR({DotMenu:!0,Open:this.open})}
        @click=${t=>this.onDotClick(t)}
        @keydown=${t=>this.onDotKeydown(t)}>
        <span class="DotIcon">\uE712</span>
        <div tabindex="0" class="Menu">
          ${Object.keys(this.options).map((t=>this.getMenuOption(t,this.options[t])))}
        </div>
      </div>
    `}getMenuOption(t,r){return html$1`
      <div
        class="DotItem"
        @click="${t=>{t.preventDefault(),t.stopPropagation(),r(t),this.open=!1}}"
        @keydown="${t=>{this.handleKeydownMenuOption,r(t),this.open=!1}}"
      >
        <span class="DotItemName">
          ${t}
        </span>
      </div>
    `}onDotClick(t){t.preventDefault(),t.stopPropagation(),this.open=!this.open}onDotKeydown(t){"Enter"===t.code&&(t.preventDefault(),t.stopPropagation(),this.open=!this.open)}handleKeydownMenuOption(t){"Enter"===t.code&&(t.preventDefault(),t.stopPropagation())}};__decorate$9([property({type:Boolean}),__metadata$9("design:type",Boolean)],FF.prototype,"open",void 0),__decorate$9([property({type:Object}),__metadata$9("design:type",Object)],FF.prototype,"options",void 0),FF=__decorate$9([customElement$1("mgt-dot-options"),__metadata$9("design:paramtypes",[])],FF);const LF={removeTaskSubtitle:"Delete Task",cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add"};var UF,__decorate$8=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$8=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$d=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.TasksSource=void 0,(UF=exports.TasksSource||(exports.TasksSource={}))[UF.planner=0]="planner",UF[UF.todo=1]="todo";const BF={BASE_SELF_ASSIGNED:"All Tasks",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Folder not found",PLANS_SELF_ASSIGNED:"All groups",PLAN_NOT_FOUND:"Group not found"},HF={BASE_SELF_ASSIGNED:"Assigned to Me",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Bucket not found",PLANS_SELF_ASSIGNED:"All Plans",PLAN_NOT_FOUND:"Plan not found"},$F={"@odata.type":"microsoft.graph.plannerAssignment",orderHint:"string !"};exports.MgtTasks=class MgtTasks extends MgtTemplatedComponent{get res(){switch(this.dataSource){case exports.TasksSource.todo:return BF;case exports.TasksSource.planner:default:return HF}}static get styles(){return OF}get strings(){return LF}get isNewTaskVisible(){return this._isNewTaskVisible}set isNewTaskVisible(t){this._isNewTaskVisible=t,t||(this._newTaskDueDate=null,this._newTaskName="",this._newTaskGroupId="",this._newTaskContainerId="")}static get requiredScopes(){return[...new Set(["group.read.all","group.readwrite.all","tasks.read","tasks.readwrite",...exports.MgtPeople.requiredScopes,...exports.MgtPeoplePicker.requiredScopes])]}constructor(){super(),this.dataSource=exports.TasksSource.planner,this._me=null,this.clearState(),this.previousMediaQuery=this.mediaQuery,this.onResize=this.onResize.bind(this)}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}attributeChangedCallback(t,r,o){super.attributeChangedCallback(t,r,o),"data-source"===t&&(this.dataSource===exports.TasksSource.planner?(this._currentGroup=this.initialId,this._currentFolder=this.initialBucketId):this.dataSource===exports.TasksSource.todo&&(this._currentGroup=null,this._currentFolder=this.initialId),this.clearState(),this.requestStateUpdate())}clearState(){this._newTaskFolderId="",this._newTaskGroupId="",this._newTaskDueDate=null,this._newTaskName="",this._newTaskBeingAdded=!1,this._tasks=[],this._folders=[],this._groups=[],this._hiddenTasks=[],this._loadingTasks=[],this._hasDoneInitialLoad=!1,this._inTaskLoad=!1,this._todoDefaultSet=!1}firstUpdated(t){super.firstUpdated(t),this.initialId&&!this._currentGroup&&(this.dataSource===exports.TasksSource.planner?this._currentGroup=this.initialId:this.dataSource===exports.TasksSource.todo&&(this._currentFolder=this.initialId)),this.dataSource===exports.TasksSource.planner&&this.initialBucketId&&!this._currentFolder&&(this._currentFolder=this.initialBucketId)}render(){const t=this._inTaskLoad&&!this._hasDoneInitialLoad?this.renderLoadingTask():null;let r;return this.hideHeader||(r=html$1`
        <div class="Header" dir=${this.direction}>
          ${this.renderPlanOptions()}
        </div>
      `),html$1`
      ${r}
      <div class="Tasks" dir=${this.direction}>
        ${this._isNewTaskVisible?this.renderNewTask():null} ${t}
        ${kR(this._tasks,(t=>t.id),(t=>this.renderTask(t)))}
      </div>
    `}loadState(){return __awaiter$d(this,void 0,void 0,(function*(){const t=this.getTaskSource();if(!t)return;const r=Providers.globalProvider;if(r&&r.state===exports.ProviderState.SignedIn){if(this._inTaskLoad=!0,!this._me){const t=r.graph.forComponent(this);this._me=yield getMe(t)}this.groupId&&this.dataSource===exports.TasksSource.planner?yield this._loadTasksForGroup(t):this.targetId?this.dataSource===exports.TasksSource.todo?yield this._loadTargetTodoTasks(t):yield this._loadTargetPlannerTasks(t):yield this._loadAllTasks(t),this._tasks=this._tasks.filter((t=>this.isTaskInSelectedGroupFilter(t))).filter((t=>this.isTaskInSelectedFolderFilter(t))).filter((t=>!this._hiddenTasks.includes(t.id))),this.taskFilter&&(this._tasks=this._tasks.filter((t=>this.taskFilter(t._raw)))),this._inTaskLoad=!1,this._hasDoneInitialLoad=!0}}))}onResize(){this.mediaQuery!==this.previousMediaQuery&&(this.previousMediaQuery=this.mediaQuery,this.requestUpdate())}_loadTargetTodoTasks(t){return __awaiter$d(this,void 0,void 0,(function*(){const r=yield t.getTaskGroups(),o=(yield Promise.all(r.map((r=>t.getTaskFoldersForTaskGroup(r.id))))).reduce(((t,r)=>[...t,...r]),[]),i=(yield Promise.all(o.map((r=>t.getTasksForTaskFolder(r.id,r.parentId))))).reduce(((t,r)=>[...t,...r]),[]);this._tasks=i,this._folders=o,this._groups=r,this._currentGroup=null}))}_loadTargetPlannerTasks(t){return __awaiter$d(this,void 0,void 0,(function*(){const r=yield t.getTaskGroup(this.targetId);let o=yield t.getTaskFoldersForTaskGroup(r.id);this.targetBucketId&&(o=o.filter((t=>t.id===this.targetBucketId)));const i=(yield Promise.all(o.map((r=>t.getTasksForTaskFolder(r.id,r.parentId))))).reduce(((t,r)=>[...t,...r]),[]);this._tasks=i,this._folders=o,this._groups=[r]}))}_loadAllTasks(t){return __awaiter$d(this,void 0,void 0,(function*(){const r=yield t.getTaskGroups(),o=(yield Promise.all(r.map((r=>t.getTaskFoldersForTaskGroup(r.id))))).reduce(((t,r)=>[...t,...r]),[]);if(!this.initialId&&this.dataSource===exports.TasksSource.todo&&!this._todoDefaultSet){this._todoDefaultSet=!0;const t=o.find((t=>t._raw.isDefaultFolder));t&&(this._currentFolder=t.id)}const i=(yield Promise.all(o.map((r=>t.getTasksForTaskFolder(r.id,r.parentId))))).reduce(((t,r)=>[...t,...r]),[]);this._tasks=i,this._folders=o,this._groups=r}))}_loadTasksForGroup(t){return __awaiter$d(this,void 0,void 0,(function*(){const r=yield t.getTaskGroupsForGroup(this.groupId),o=(yield Promise.all(r.map((r=>t.getTaskFoldersForTaskGroup(r.id))))).reduce(((t,r)=>[...t,...r]),[]),i=(yield Promise.all(o.map((r=>t.getTasksForTaskFolder(r.id,r.parentId))))).reduce(((t,r)=>[...t,...r]),[]);this._tasks=i,this._folders=o,this._groups=r}))}addTask(t,r,o,i,s={}){return __awaiter$d(this,void 0,void 0,(function*(){const l=this.getTaskSource();if(!l)return;const u={assignments:s,dueDate:r,immediateParentId:i,name:t,topParentId:o};this._newTaskBeingAdded=!0;const h=yield l.addTask(u);this.fireCustomEvent("taskAdded",h),yield this.requestStateUpdate(),this._newTaskBeingAdded=!1,this.isNewTaskVisible=!1}))}completeTask(t){return __awaiter$d(this,void 0,void 0,(function*(){const r=this.getTaskSource();r&&(this._loadingTasks=[...this._loadingTasks,t.id],yield r.setTaskComplete(t.id,t.eTag),this.fireCustomEvent("taskChanged",t),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((r=>r!==t.id)))}))}uncompleteTask(t){return __awaiter$d(this,void 0,void 0,(function*(){const r=this.getTaskSource();r&&(this._loadingTasks=[...this._loadingTasks,t.id],yield r.setTaskIncomplete(t.id,t.eTag),this.fireCustomEvent("taskChanged",t),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((r=>r!==t.id)))}))}removeTask(t){return __awaiter$d(this,void 0,void 0,(function*(){const r=this.getTaskSource();r&&(this._hiddenTasks=[...this._hiddenTasks,t.id],yield r.removeTask(t.id,t.eTag),this.fireCustomEvent("taskRemoved",t),yield this.requestStateUpdate(),this._hiddenTasks=this._hiddenTasks.filter((r=>r!==t.id)))}))}assignPeople(t,r){return __awaiter$d(this,void 0,void 0,(function*(){const o=this.getTaskSource();if(!o)return;let i=[];t&&t.assignments&&(i=Object.keys(t.assignments).sort());const s=r.map((t=>t.id)),l=s.length===i.length&&s.sort().every(((t,r)=>t===i[r]));if(l)return;const u={};if(0===r.length)for(let t=0;t<i.length;t++)u[i[t]]=null;if(r){for(let t=0;t<i.length;t++)for(let o=0;o<r.length;o++){if(i[t]!==r[o].id){u[i[t]]=null;break}u[i[t]]=$F}for(let t=0;t<r.length;t++)u[r[t].id]=$F}t&&(this._loadingTasks=[...this._loadingTasks,t.id],yield o.assignPeopleToTask(t.id,u,t.eTag),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((r=>r!==t.id)))}))}onAddTaskClick(t){const r=this.getPeoplePicker(null),o={};if(r)for(const t of r.selectedPeople)r.selectedPeople.length&&(o[t.id]=$F);!this._newTaskBeingAdded&&this._newTaskName&&(this._currentGroup||this._newTaskGroupId)&&this.addTask(this._newTaskName,this._newTaskDueDate,this._currentGroup?this._currentGroup:this._newTaskGroupId,this._currentFolder?this._currentFolder:this._newTaskFolderId,o)}onAddTaskKeyDown(t){"Enter"===t.code&&this.onAddTaskClick}newTaskButtonKeydown(t){"Enter"===t.code&&(this.isNewTaskVisible=!this.isNewTaskVisible)}addNewTaskButtonClick(t){this.isNewTaskVisible=!this.isNewTaskVisible}handleNewTaskDateChange(t){const r=t.target.value;this._newTaskDueDate=r?new Date(r+"T17:00"):null}handleSelectedPlan(t){var r,o;if(this._newTaskGroupId=t.target.value,this.dataSource===exports.TasksSource.planner){const t=this._groups.filter((t=>t.id===this._newTaskGroupId));this._newTaskContainerId=null!==(o=null===(r=t.pop())||void 0===r?void 0:r.containerId)&&void 0!==o?o:this._newTaskContainerId}}newTaskVisible(t){"Enter"===t.code&&(this.isNewTaskVisible=!1)}renderPlanOptions(){const t=Providers.globalProvider;if(!t||t.state!==exports.ProviderState.SignedIn)return null;if(this._inTaskLoad&&!this._hasDoneInitialLoad)return html$1`
        <span class="LoadingHeader"></span>
      `;const r=this.readOnly||this._isNewTaskVisible?null:html$1`
            <div
              tabindex="0"
              class="AddBarItem NewTaskButton"
              @click="${this.addNewTaskButtonClick}"
              @keydown="${this.newTaskButtonKeydown}"
            >
              <span class="TaskIcon">î</span>
              <span>${this.strings.addTaskButtonSubtitle}</span>
            </div>
          `;if(this.dataSource===exports.TasksSource.planner){const t=this._groups.find((t=>t.id===this._currentGroup))||{title:this.res.BASE_SELF_ASSIGNED},o={[this.res.BASE_SELF_ASSIGNED]:t=>{this._currentGroup=null,this._currentFolder=null}};for(const t of this._groups)o[t.title]=r=>{this._currentGroup=t.id,this._currentFolder=null};const i=html$1`
        <mgt-arrow-options .options="${o}" .value="${t.title}"></mgt-arrow-options>
      `,s=this._currentGroup?html$1`
            <span class="TaskIcon Divider">/</span>
          `:null,l=this._folders.find((t=>t.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},u={[this.res.BUCKETS_SELF_ASSIGNED]:t=>{this._currentFolder=null}};for(const t of this._folders.filter((t=>t.parentId===this._currentGroup)))u[t.name]=r=>{this._currentFolder=t.id};const h=this.targetBucketId?html$1`
            <span class="PlanTitle">
              ${this._folders[0]&&this._folders[0].name}
            </span>
          `:html$1`
            <mgt-arrow-options .options="${u}" .value="${l.name}"></mgt-arrow-options>
          `;return html$1`
        <div class="TitleCont">
          ${i} ${s} ${this._currentGroup?h:null}
        </div>
        ${r}
      `}{const t=this._folders.find((t=>t.id===this.targetId))||{name:this.res.BUCKETS_SELF_ASSIGNED},o=this._folders.find((t=>t.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},i={};for(const t of this._folders)i[t.name]=()=>{this._currentFolder=t.id};i[this.res.BUCKETS_SELF_ASSIGNED]=t=>{this._currentFolder=null};const s=this.targetId?html$1`
            <span class="PlanTitle">
              ${t.name}
            </span>
          `:html$1`
            <mgt-arrow-options .value="${o.name}" .options="${i}"></mgt-arrow-options>
          `;return html$1`
        <span class="TitleCont">
          ${s}
        </span>
        ${r}
      `}}renderNewTask(){const t=html$1`
      <input
        type="text"
        placeholder=${this.strings.newTaskPlaceholder}
        .value="${this._newTaskName}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="textbox"
        @input="${t=>{this._newTaskName=t.target.value}}"
      />
    `,r=this._groups;r.length>0&&!this._newTaskGroupId&&(this._newTaskGroupId=r[0].id,this.dataSource===exports.TasksSource.planner&&(this._newTaskContainerId=r[0].containerId));const o=this.dataSource===exports.TasksSource.todo?null:this._currentGroup?html$1`
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <span>${this.getPlanTitle(this._currentGroup)}</span>
            </span>
          `:html$1`
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <select aria-label="new task group"
                .value="${this._newTaskGroupId}"
                @change="${this.handleSelectedPlan}"
              >
                ${this._groups.map((t=>html$1`
                    <option value="${t.id}">${t.title}</option>
                  `))}
              </select>
            </span>
          `,i=this._folders.filter((t=>this._currentGroup&&t.parentId===this._currentGroup||!this._currentGroup&&t.parentId===this._newTaskGroupId));i.length>0&&!this._newTaskFolderId&&(this._newTaskFolderId=i[0].id);const s=this._currentFolder?html$1`
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <span>${this.getFolderName(this._currentFolder)}</span>
          </span>
        `:html$1`
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <select aria-label="new task bucket"
              .value="${this._newTaskFolderId}"
              @change="${t=>{this._newTaskFolderId=t.target.value}}"
            >
              ${i.map((t=>html$1`
                  <option value="${t.id}">${t.name}</option>
                `))}
            </select>
          </span>
        `,l=html$1`
      <span class="NewTaskDue">
      ${this.renderCalendarIcon()}
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="textbox"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${this.handleNewTaskDateChange}"
        />
      </span>
    `,u=this.dataSource===exports.TasksSource.todo?null:this.renderAssignedPeople(null),h=this._newTaskBeingAdded?html$1`
          <div class="TaskAddButtonContainer"></div>
        `:html$1`
          <div class="TaskAddButtonContainer ${""===this._newTaskName?"Disabled":""}">
            <div tabindex="0" class="TaskIcon TaskAdd"
              @click="${this.onAddTaskClick}"
              @keydown="${this.onAddTaskKeyDown}">
              <span>${this.strings.addTaskButtonSubtitle}</span>
            </div>
            <div tabindex="0" class="TaskIcon TaskCancel"
              @click="${()=>this.isNewTaskVisible=!1}"
              @keydown="${this.newTaskVisible}">
              <span>${this.strings.cancelNewTaskSubtitle}</span>
            </div>
          </div>
        `;return html$1`
      <div class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${t}
            </div>
            <div class="TaskDetails">
              ${o} ${s} ${l} ${u}
            </div>
          </div>
        </div>
        ${h}
      </div>
    `}togglePeoplePicker(t){const r=this.getPeoplePicker(t),o=this.getMgtPeople(t),i=this.getFlyout(t);r&&o&&i&&(i.isOpen?i.close():(r.selectedPeople=o.people,i.open(),window.requestAnimationFrame((()=>{r.focus()}))))}updateAssignedPeople(t){const r=this.getPeoplePicker(t),o=this.getMgtPeople(t);r&&r.selectedPeople!==o.people&&(o.people=r.selectedPeople,this.assignPeople(t,r.selectedPeople))}getPeoplePicker(t){const r=t?t.id:"newTask";return this.renderRoot.querySelector(`.picker-${r}`)}getMgtPeople(t){const r=t?t.id:"newTask";return this.renderRoot.querySelector(`.people-${r}`)}getFlyout(t){const r=t?t.id:"newTask";return this.renderRoot.querySelector(`.flyout-${r}`)}renderTask(t){const{name:r="Task",completed:o=!1,dueDate:i}=t,s=this._loadingTasks.includes(t.id),l=s?html$1`
          ïª
        `:o?html$1`
          î¾
        `:null,u=html$1`
      <span tabindex="0" class=${oR({Complete:!s&&o,Loading:s,TaskCheck:!0,TaskIcon:!0})}><span class="TaskCheckContent">${l}</span></span>
    `,h=this._currentGroup?null:this.getPlanTitle(t.topParentId),m=this._currentFolder?null:this.getFolderName(t.immediateParentId),v={task:Object.assign(Object.assign({},t._raw),{groupTitle:h,folderTitle:m})},C=this.renderTemplate("task",v,t.id);if(C)return C;let _=this.renderTemplate("task-details",v,`task-details-${t.id}`);if(!_){const o=this.dataSource===exports.TasksSource.todo||this._currentGroup?null:html$1`
              <div class="TaskDetail TaskGroup">
                ${this.renderPlannerIcon()}
                <span>${this.getPlanTitle(t.topParentId)}</span>
              </div>
            `,s=this._currentFolder?null:html$1`
            <div class="TaskDetail TaskBucket">
              ${this.renderBucketIcon()}
              <span>${this.getFolderName(t.immediateParentId)}</span>
            </div>
          `,l=i?html$1`
            <div class="TaskDetail TaskDue">
              <span>Due ${getShortDateString(i)}</span>
            </div>
          `:null,u=this.dataSource!==exports.TasksSource.todo?this.renderAssignedPeople(t):null;_=html$1`
        <div class="TaskTitle">
          ${r}
        </div>
        ${o} ${s} ${u} ${l}
      `}const k=this.readOnly||this.hideOptions?null:html$1`
            <div class="TaskOptions">
              <mgt-dot-options
                .options="${{[this.strings.removeTaskSubtitle]:()=>this.removeTask(t)}}"
              ></mgt-dot-options>
            </div>
          `;return html$1`
      <div
        class=${oR({Complete:o,Incomplete:!o,ReadOnly:this.readOnly,Task:!0})}
      >
        <div
          class="TaskContent"
          @click=${()=>{this.handleTaskClick(t)}}
        >
          <span
            class=${oR({Complete:o,Incomplete:!o,TaskCheckContainer:!0})}
            @click="${r=>{this.readOnly||(t.completed?this.uncompleteTask(t):this.completeTask(t),r.stopPropagation(),r.preventDefault())}}"
            @keydown="${r=>{"Enter"===r.code&&(this.readOnly||(t.completed?this.uncompleteTask(t):this.completeTask(t),r.stopPropagation(),r.preventDefault()))}}"
          >
            ${u}
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery} ${this._currentGroup?"NoPlan":""}">
            ${_}
          </div>
          ${k}

        </div>
      </div>
    `}renderAssignedPeople(t){var r,o;let i,s=null;const l={NewTaskAssignee:null===t,TaskAssignee:null!==t,TaskDetail:null!==t},u=t?Object.keys(t.assignments).map((t=>t)):[],h=html$1`
      <template data-type="no-data">
        <i class="login-icon ms-Icon ms-Icon--Contact"></i>
      </template>
    `,m=t?t.id:"newTask";if(l[`flyout-${m}`]=!0,!this.newTaskVisible){const s=null===(r=null==t?void 0:t._raw)||void 0===r?void 0:r.planId;if(s){i=null===(o=this._groups.filter((t=>t.id===s)).pop())||void 0===o?void 0:o.containerId}}const v=this.isNewTaskVisible?this._newTaskContainerId:i;return s=html$1`
      <mgt-people
        class="people-${m}"
        .userIds="${u}"
        .personCardInteraction=${exports.PersonCardInteraction.none}
        @click=${r=>{this.togglePeoplePicker(t),r.stopPropagation()}}
        @keydown=${r=>{"Enter"===r.code&&(this.togglePeoplePicker(t),r.stopPropagation())}}
        >${h}
      </mgt-people>
    `,html$1`
      <mgt-flyout light-dismiss class=${oR(l)} @closed=${r=>this.updateAssignedPeople(t)}>
        ${s}
        <div slot="flyout" class=${oR({Picker:!0})}>
          <mgt-people-picker
            class="picker-${m}"
            .groupId=${iR(v)}
            @click=${t=>t.stopPropagation()}
            @keydown=${t=>{"Enter"===t.code&&t.stopPropagation()}}
          ></mgt-people-picker>
        </div>
      </mgt-flyout>
    `}handleTaskClick(t){t&&this.fireCustomEvent("taskClick",{task:t._raw})}renderLoadingTask(){return html$1`
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `}renderPlannerIcon(){return html$1`
      <svg width="16" height="18" viewBox="0 0 16 18" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.223 1.156C6.98 1.26 6.769 1.404 6.586 1.586C6.403 1.768 6.261 1.98 6.157 2.223C6.052 2.465 6 2.724 6 3H2V17H14V3H10C10 2.724 9.948 2.465 9.844 2.223C9.74 1.98 9.596 1.768 9.414 1.586C9.231 1.404 9.02 1.26 8.777 1.156C8.535 1.053 8.276 1 8 1C7.723 1 7.465 1.053 7.223 1.156ZM5 4H7V3C7 2.86 7.026 2.729 7.078 2.609C7.13 2.49 7.202 2.385 7.293 2.293C7.384 2.202 7.49 2.131 7.609 2.079C7.73 2.026 7.859 2 8 2C8.14 2 8.271 2.026 8.39 2.079C8.511 2.131 8.616 2.202 8.707 2.293C8.798 2.385 8.87 2.49 8.922 2.609C8.974 2.729 9 2.86 9 3V4H11V5H5V4ZM12 6V4H13V16H3V4H4V6H12Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 12.3517L5.49956 14.2037L4.14856 12.8517L4.85156 12.1487L5.49956 12.7967L6.64856 11.6487L7.35156 12.3517Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 8.35168L5.49956 10.2037L4.14856 8.85168L4.85156 8.14868L5.49956 8.79668L6.64856 7.64868L7.35156 8.35168Z"
          fill="#3C3C3C"
        />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 14H12.001V13H8V14Z" fill="#3C3C3C" />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 10H12.001V9H8V10Z" fill="#3C3C3C" />
      </svg>
    `}renderBucketIcon(){return html$1`
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `}renderCalendarIcon(){return html$1`
          <svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 11C5.55228 11 6 10.5523 6 10C6 9.44771 5.55228 9 5 9C4.44772 9 4 9.44771 4 10C4 10.5523 4.44772 11 5 11ZM6 13C6 13.5523 5.55228 14 5 14C4.44772 14 4 13.5523 4 13C4 12.4477 4.44772 12 5 12C5.55228 12 6 12.4477 6 13ZM8 11C8.55229 11 9 10.5523 9 10C9 9.44771 8.55229 9 8 9C7.44771 9 7 9.44771 7 10C7 10.5523 7.44771 11 8 11ZM9 13C9 13.5523 8.55229 14 8 14C7.44771 14 7 13.5523 7 13C7 12.4477 7.44771 12 8 12C8.55229 12 9 12.4477 9 13ZM11 11C11.5523 11 12 10.5523 12 10C12 9.44771 11.5523 9 11 9C10.4477 9 10 9.44771 10 10C10 10.5523 10.4477 11 11 11ZM15 5.5C15 4.11929 13.8807 3 12.5 3H3.5C2.11929 3 1 4.11929 1 5.5V14.5C1 15.8807 2.11929 17 3.5 17H12.5C13.8807 17 15 15.8807 15 14.5V5.5ZM2 7H14V14.5C14 15.3284 13.3284 16 12.5 16H3.5C2.67157 16 2 15.3284 2 14.5V7ZM3.5 4H12.5C13.3284 4 14 4.67157 14 5.5V6H2V5.5C2 4.67157 2.67157 4 3.5 4Z" fill="#717171"/>
          </svg>
        `}getTaskSource(){const t=Providers.globalProvider;if(!t||t.state!==exports.ProviderState.SignedIn)return null;const r=t.graph.forComponent(this);return this.dataSource===exports.TasksSource.planner?new PlannerTaskSource(r):this.dataSource===exports.TasksSource.todo?new TodoTaskSource(r):null}getPlanTitle(t){return t?t===this.res.PLANS_SELF_ASSIGNED?this.res.PLANS_SELF_ASSIGNED:(this._groups.find((r=>r.id===t))||{title:this.res.PLAN_NOT_FOUND}).title:this.res.BASE_SELF_ASSIGNED}getFolderName(t){return t?(this._folders.find((r=>r.id===t))||{name:this.res.BUCKET_NOT_FOUND}).name:this.res.BUCKETS_SELF_ASSIGNED}isTaskInSelectedGroupFilter(t){return t.topParentId===this._currentGroup||!this._currentGroup&&this.getTaskSource().isAssignedToMe(t,this._me.id)}isTaskInSelectedFolderFilter(t){return t.immediateParentId===this._currentFolder||!this._currentFolder}dateToInputValue(t){return t?new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().split("T")[0]:null}},__decorate$8([property({attribute:"read-only",type:Boolean}),__metadata$8("design:type",Boolean)],exports.MgtTasks.prototype,"readOnly",void 0),__decorate$8([property({attribute:"data-source",converter:(t,r)=>(t=t.toLowerCase(),exports.TasksSource[t]||exports.TasksSource.planner)}),__metadata$8("design:type",Number)],exports.MgtTasks.prototype,"dataSource",void 0),__decorate$8([property({attribute:"target-id",type:String}),__metadata$8("design:type",String)],exports.MgtTasks.prototype,"targetId",void 0),__decorate$8([property({attribute:"target-bucket-id",type:String}),__metadata$8("design:type",String)],exports.MgtTasks.prototype,"targetBucketId",void 0),__decorate$8([property({attribute:"initial-id",type:String}),__metadata$8("design:type",String)],exports.MgtTasks.prototype,"initialId",void 0),__decorate$8([property({attribute:"initial-bucket-id",type:String}),__metadata$8("design:type",String)],exports.MgtTasks.prototype,"initialBucketId",void 0),__decorate$8([property({attribute:"hide-header",type:Boolean}),__metadata$8("design:type",Boolean)],exports.MgtTasks.prototype,"hideHeader",void 0),__decorate$8([property({attribute:"hide-options",type:Boolean}),__metadata$8("design:type",Boolean)],exports.MgtTasks.prototype,"hideOptions",void 0),__decorate$8([property({attribute:"group-id",type:String}),__metadata$8("design:type",String)],exports.MgtTasks.prototype,"groupId",void 0),__decorate$8([property(),__metadata$8("design:type",Boolean)],exports.MgtTasks.prototype,"_isNewTaskVisible",void 0),__decorate$8([property(),__metadata$8("design:type",Boolean)],exports.MgtTasks.prototype,"_newTaskBeingAdded",void 0),__decorate$8([property(),__metadata$8("design:type",String)],exports.MgtTasks.prototype,"_newTaskName",void 0),__decorate$8([property(),__metadata$8("design:type",Date)],exports.MgtTasks.prototype,"_newTaskDueDate",void 0),__decorate$8([property(),__metadata$8("design:type",String)],exports.MgtTasks.prototype,"_newTaskGroupId",void 0),__decorate$8([property(),__metadata$8("design:type",String)],exports.MgtTasks.prototype,"_newTaskFolderId",void 0),__decorate$8([property(),__metadata$8("design:type",String)],exports.MgtTasks.prototype,"_newTaskContainerId",void 0),__decorate$8([property(),__metadata$8("design:type",Array)],exports.MgtTasks.prototype,"_groups",void 0),__decorate$8([property(),__metadata$8("design:type",Array)],exports.MgtTasks.prototype,"_folders",void 0),__decorate$8([property(),__metadata$8("design:type",Array)],exports.MgtTasks.prototype,"_tasks",void 0),__decorate$8([property(),__metadata$8("design:type",Array)],exports.MgtTasks.prototype,"_hiddenTasks",void 0),__decorate$8([property(),__metadata$8("design:type",Array)],exports.MgtTasks.prototype,"_loadingTasks",void 0),__decorate$8([property(),__metadata$8("design:type",Boolean)],exports.MgtTasks.prototype,"_inTaskLoad",void 0),__decorate$8([property(),__metadata$8("design:type",Boolean)],exports.MgtTasks.prototype,"_hasDoneInitialLoad",void 0),__decorate$8([property(),__metadata$8("design:type",Boolean)],exports.MgtTasks.prototype,"_todoDefaultSet",void 0),__decorate$8([property(),__metadata$8("design:type",String)],exports.MgtTasks.prototype,"_currentGroup",void 0),__decorate$8([property(),__metadata$8("design:type",String)],exports.MgtTasks.prototype,"_currentFolder",void 0),__decorate$8([YP(),__metadata$8("design:type",Object)],exports.MgtTasks.prototype,"_me",void 0),exports.MgtTasks=__decorate$8([customElement$1("mgt-tasks"),__metadata$8("design:paramtypes",[])],exports.MgtTasks);const qF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}:host{font-family:var(--default-font-family)}.root{position:relative}.root .input-wrapper{font-family:var(--default-font-family);display:flex;flex-wrap:wrap;align-items:center;padding:4px 10px;position:relative;background-color:var(--input-background-color,#fff);font-size:14px;color:var(--color-sub1,#323130);height:29px;line-height:19px;cursor:text;border-top:var(--input-border-top,var(--input-border,2px solid #605e5c));border-right:var(--input-border-right,var(--input-border,2px solid #605e5c));border-bottom:var(--input-border-bottom,var(--input-border,2px solid #605e5c));border-left:var(--input-border-left,var(--input-border,2px solid #605e5c))}.root .input-wrapper:hover{border-color:var(--input-border-color--hover,#323130)}.root .input-wrapper.focused{border-color:var(--input-border-color--focus,#0078d4)}.root .input-wrapper .selected-team{padding-right:10px;border:none;display:flex;position:relative;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;align-items:center;height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.root .input-wrapper .selected-team .arrow{margin-left:8px;margin-right:8px}.root .input-wrapper .selected-team .selected-team-name{font-weight:700}.root .input-wrapper .selected-team .search-wrapper{margin-left:12px;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .search-wrapper{overflow:hidden;height:18px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .hide-icon{display:none}.root .input-wrapper .team-chosen-input{display:inline-block;border:none;line-height:normal;outline:0;font-family:var(--default-font-family);font-style:normal;font-weight:400;font-size:14px;line-height:19px;background-color:transparent;color:var(--color-sub1,#323130);padding-left:5px}.root .input-wrapper .team-chosen-input::placeholder{color:var(--placeholder-color,#605e5c)}.root .input-wrapper .team-chosen-input[contenteditable]:empty::after{content:attr(data-placeholder);color:var(--placeholder-color,#605e5c)}.root .input-wrapper .search-icon{margin-top:1px;align-self:flex-start;font-family:FabricMDL2Icons;color:var(--accent-color,#0078d4);line-height:normal}.root .input-wrapper .input-search{height:19px}.root .input-wrapper .input-search-start{white-space:nowrap;line-height:normal;margin-inline-start:0;margin-inline-end:0}.root .input-wrapper::after{content:'';position:absolute;width:100%;height:90%;top:2px;right:2px;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}.root .close-icon{display:inline-block;position:absolute;right:10px;top:12px;line-height:normal;font-family:FabricMDL2Icons;cursor:pointer;color:var(--placeholder-color,#605e5c);background-color:var(--input-background-color,#fff)}.root .close-icon:hover{color:var(--color-sub1,#323130)}.root .dropdown{padding-top:5px;padding-bottom:11px;position:absolute;box-shadow:0 1.3289px 2.65781px rgba(180,180,180,.182),0 1.3289px 2.65781px rgba(68,68,68,.3);border-radius:8px;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));z-index:1;width:100%;text-align:left;list-style-type:none;font-family:var(--default-font-family);font-style:normal;font-weight:400;color:var(--color-sub1,#323130);display:none;max-height:346px;overflow-y:auto}.root .dropdown.visible{display:block}.root .dropdown .item .arrow svg{fill:var(--arrow-fill,#000)}.root .dropdown .item.list-team{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;display:flex;flex-direction:row;align-items:center;padding:5px 12px 6px 14px;margin:6px 4px 4px 4px;border-radius:4px;font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:16px;color:var(--color-sub1,#323130);flex-flow:nowrap;position:relative;overflow:hidden;white-space:nowrap;background-color:transparent}.root .dropdown .item.list-team:after{content:'';position:absolute;width:36px;height:100%;top:0;right:0;background-image:-webkit-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-moz-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-ms-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-o-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:linear-gradient(to left,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0))}.root .dropdown .item.list-team:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .item.list-team .arrow{margin-right:5px;margin-bottom:1px}.root .dropdown .item.selected{background-color:var(--dropdown-item-selected-background,#deecf9)}.root .dropdown .item.focused{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .channel-display{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;cursor:pointer;padding-left:21px;padding-right:10px}.root .dropdown .channel-display .showing{padding-left:10px;padding-top:4px;padding-bottom:4px}.root .dropdown .channel-display .showing .channel-name-text{font-size:14px;font-weight:400;color:var(--color-sub1,#323130);margin:0;padding:0}.root .dropdown .channel-display .showing .channel-name-text.highlight-search-text{font-weight:700}.root .dropdown .channel-display:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .loading-text,.root .dropdown .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;color:var(--color-sub1,#323130);line-height:19px;text-align:center}.root .dropdown .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}.root .dropdown .message-parent .loading-text{margin-top:3px;margin-left:9px;color:#0078d4}[dir=rtl] .input-wrapper::after{content:'';position:absolute;width:99%;height:90%;top:2px;left:0;background-image:linear-gradient(to left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}[dir=rtl] .search-wrapper{margin-right:0!important}[dir=rtl] .search-icon{margin-left:8px!important}[dir=rtl] .channel-display{padding:0 34px 0 10px!important}[dir=rtl] .close-icon{right:auto;left:10px}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`];var __awaiter$c=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};const jF={inputPlaceholderText:"Select a channel",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading..."};var zF,__decorate$7=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$7=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$b=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.MgtTeamsChannelPicker=zF=class MgtTeamsChannelPicker extends MgtTemplatedComponent{static get styles(){return qF}get strings(){return jF}static get config(){return this._config}get selectedItem(){return this._selectedItemState?{channel:this._selectedItemState.item,team:this._selectedItemState.parent.item}:null}static get requiredScopes(){return this.config.useTeamsBasedScopes?["team.readbasic.all","channel.readbasic.all"]:["user.read.all","group.read.all"]}set items(t){this._items!==t&&(this._items=t,this._treeViewState=t?this.generateTreeViewState(t):[],this.resetFocusState())}get items(){return this._items}get _input(){return this.renderRoot.querySelector(".team-chosen-input")}constructor(){super(),this._inputValue="",this._isFocused=!1,this._treeViewState=[],this._focusList=[],this._focusedIndex=-1,this.handleWindowClick=this.handleWindowClick.bind(this),this.addEventListener("keydown",(t=>this.onUserKeyDown(t))),this.addEventListener("focus",(t=>this.loadTeamsIfNotLoaded())),this.addEventListener("mouseover",(t=>this.loadTeamsIfNotLoaded()))}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this.handleWindowClick)}disconnectedCallback(){window.removeEventListener("click",this.handleWindowClick),super.disconnectedCallback()}selectChannelById(t){return __awaiter$b(this,void 0,void 0,(function*(){const r=Providers.globalProvider;if(r&&r.state===exports.ProviderState.SignedIn){this.items||(yield this.requestStateUpdate());for(const r of this._treeViewState)for(const o of r.channels)if(o.item.id===t)return this.selectChannel(o),!0}return!1}))}render(){const t={focused:this._isFocused,"input-wrapper":!0};this._isFocused&&this._selectedItemState;const r={dropdown:!0,visible:this._isDropdownVisible},o={"hide-icon":!!this._selectedItemState,"search-wrapper":!0};return this.renderTemplate("default",{teams:this.items})||html$1`
        <div class="root" @blur=${this.lostFocus} dir=${this.direction}>
          <div class=${oR(t)} @click=${this.gainedFocus}>
            ${this.renderSelected()}
            <div class=${oR(o)}>${this.renderSearchIcon()} ${this.renderInput()}</div>
          </div>
          ${this.renderCloseButton()}
          <div class=${oR(r)}>${this.renderDropdown()}</div>
        </div>
      `}renderSelected(){return this._selectedItemState?html$1`
      <li class="selected-team" title=${this._selectedItemState.item.displayName}>
        <div class="selected-team-name">${this._selectedItemState.parent.item.displayName}</div>
        <div class="arrow">${getSvg(dR.TeamSeparator,"#B3B0AD")}</div>
        ${this._selectedItemState.item.displayName}
        <div class="search-wrapper">${this.renderSearchIcon()} ${this.renderInput()}</div>
      </li>
    `:html$1``}clearState(){this._items=[],this._inputValue="",this._treeViewState=[],this._focusList=[]}renderSearchIcon(){return html$1`
      <div class="search-icon">
        ${getSvg(dR.Search,"#252424")}
      </div>
    `}renderInput(){const t={"input-search":!!this._selectedItemState,"input-search-start":!this._selectedItemState};return html$1`
      <div class="${oR(t)}">
        <span
          id="teams-channel-picker-input"
          class="team-chosen-input"
          type="text"
          label="teams-channel-picker-input"
          aria-label="Select a channel"
          data-placeholder="${this._selectedItemState?"":this.strings.inputPlaceholderText} "
          role="searchbox"
          @keyup=${t=>this.handleInputChanged(t)}
          contenteditable
        ></span>
      </div>
    `}renderCloseButton(){return html$1`
      <div tabindex="0" class="close-icon"
        @keydown="${()=>this.selectChannel(null)}"
        @click="${()=>this.selectChannel(null)}"> î
      </div>
    `}renderDropdown(){return this.isLoadingState||!this._treeViewState?this.renderLoading():this._treeViewState?!this.isLoadingState&&0===this._treeViewState.length&&this._inputValue.length>0?this.renderError():this.renderDropdownList(this._treeViewState):html$1``}renderDropdownList(t,r=0){return t&&t.length?t.map(((t,o)=>{const i=!!t.channels&&t.isExpanded;return html$1`
          ${this.renderItem(t)}
          ${i?this.renderDropdownList(t.channels,r+1):html$1``}
        `})):null}renderItem(t){let r=null;t.channels&&(r=t.isExpanded?getSvg(dR.ArrowDown,"#252424"):getSvg(dR.ArrowRight,"#252424"));let o=!1;this.selectedItem&&this.selectedItem.channel===t.item&&(o=!0);const i={focused:this._focusList[this._focusedIndex]===t,item:!0,"list-team":!!t.channels,selected:o},s=this.renderRoot.querySelector(".dropdown");return s.children[this._focusedIndex]&&s.children[this._focusedIndex].scrollIntoView(!1),html$1`
      <div @click=${()=>this.handleItemClick(t)} class="${oR(i)}">
        <div class="arrow">
          ${r}
        </div>
        ${t.channels?t.item.displayName:this.renderHighlightedText(t.item)}
      </div>
    `}renderHighlightedText(t){let r={};const o=t.displayName.toLowerCase().indexOf(this._inputValue.toLowerCase());return-1!==o?0===o?(r.first="",r.highlight=t.displayName.slice(0,this._inputValue.length),r.last=t.displayName.slice(this._inputValue.length,t.displayName.length)):o===t.displayName.length?(r.first=t.displayName.slice(0,o),r.highlight=t.displayName.slice(o,t.displayName.length),r.last=""):(r.first=t.displayName.slice(0,o),r.highlight=t.displayName.slice(o,o+this._inputValue.length),r.last=t.displayName.slice(o+this._inputValue.length,t.displayName.length)):r.last=t.displayName,html$1`
      <div class="channel-display">
        <div class="showing">
          <span class="channel-name-text">${r.first}</span
          ><span class="channel-name-text highlight-search-text">${r.highlight}</span
          ><span class="channel-name-text">${r.last}</span>
        </div>
      </div>
    `}renderError(){return this.renderTemplate("error",null,"error")||html$1`
        <div class="message-parent">
          <div label="search-error-text" aria-label="We didn't find any matches." class="search-error-text">
            ${this.strings.noResultsFound}
          </div>
        </div>
      `}renderLoading(){return this.renderTemplate("loading",null,"loading")||html$1`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `}loadState(){return __awaiter$b(this,void 0,void 0,(function*(){const t=Providers.globalProvider;let r;if(t&&t.state===exports.ProviderState.SignedIn){const o=t.graph.forComponent(this);if(!(yield t.getAccessTokenForScopes(...zF.requiredScopes)))return;r=yield function getAllMyTeams(t){return __awaiter$c(this,void 0,void 0,(function*(){const r=yield t.api("/me/joinedTeams").select(["displayName","id","isArchived"]).middlewareOptions(prepScopes("team.readbasic.all")).get();return r?r.value:null}))}(o),r=r.filter((t=>!t.isArchived));const i=o.createBatch(),s=["team.readbasic.all"];for(const t of r)i.get(t.id,`teams/${t.id}/channels`,s);const l=yield i.executeAll();for(const t of r){const r=l.get(t.id);r&&r.content&&r.content.value&&(t.channels=r.content.value.map((t=>({item:t}))))}this.items=r.map((t=>({channels:t.channels,item:t})))}this.filterList(),this.resetFocusState()}))}handleItemClick(t){t.channels?t.isExpanded=!t.isExpanded:this.selectChannel(t),this._focusedIndex=-1,this.resetFocusState()}handleInputChanged(t){this._inputValue!==t.target.textContent&&(this._inputValue=t.target.textContent,this.gainedFocus(),this.debouncedSearch||(this.debouncedSearch=debounce((()=>{this.filterList()}),400)),this.debouncedSearch())}filterList(){this.items&&(this._treeViewState=this.generateTreeViewState(this.items,this._inputValue),this._focusedIndex=-1,this.resetFocusState())}generateTreeViewState(t,r="",o=null){const i=[];if(r=r.toLowerCase(),t)for(const s of t){let t;if(0===r.length||s.item.displayName.toLowerCase().includes(r))t={item:s.item,parent:o},s.channels&&(t.channels=this.generateTreeViewState(s.channels,"",t),t.isExpanded=r.length>0);else if(s.channels){const i={item:s.item,parent:o},l=this.generateTreeViewState(s.channels,r,i);l.length>0&&(t=i,t.channels=l,t.isExpanded=!0)}t&&i.push(t)}return i}generateFocusList(t){if(!t||0===t.length)return[];let r=[];for(const o of t)r.push(o),o.channels&&o.isExpanded&&(r=[...r,...this.generateFocusList(o.channels)]);return r}resetFocusState(){this._focusList=this.generateFocusList(this._treeViewState),this.requestUpdate()}loadTeamsIfNotLoaded(){this.items||this.isLoadingState||this.requestStateUpdate()}handleWindowClick(t){t.target!==this&&this.lostFocus()}onUserKeyDown(t){if(13===t.keyCode&&t.preventDefault(),0===this._treeViewState.length)return;const r=this._focusList[this._focusedIndex];switch(t.keyCode){case 40:this._focusedIndex=(this._focusedIndex+1)%this._focusList.length,this.requestUpdate(),t.preventDefault();break;case 38:-1===this._focusedIndex&&(this._focusedIndex=this._focusList.length),this._focusedIndex=(this._focusedIndex-1+this._focusList.length)%this._focusList.length,this.requestUpdate(),t.preventDefault();break;case 39:r&&r.channels&&!r.isExpanded&&(r.isExpanded=!0,this.resetFocusState(),t.preventDefault());break;case 37:r&&r.channels&&r.isExpanded&&(r.isExpanded=!1,this.resetFocusState(),t.preventDefault());break;case 9:if(!r){this.lostFocus();break}case 13:r&&r.channels?(r.isExpanded=!r.isExpanded,this.resetFocusState(),t.preventDefault()):r&&!r.channels&&(this.selectChannel(r),this.resetFocusState(),this._focusedIndex=-1,t.preventDefault());break;case 8:0===this._inputValue.length&&this._selectedItemState&&(this.selectChannel(null),t.preventDefault());break;case 27:this.selectChannel(this._selectedItemState),this._focusedIndex=-1,this.resetFocusState(),t.preventDefault()}}gainedFocus(){this._isFocused=!0;const t=this._input;t&&t.focus(),this._isDropdownVisible=!0}lostFocus(){this._isFocused=!1;const t=this._input;t&&(t.textContent=this._inputValue=""),this._isDropdownVisible=!1,this.filterList()}selectChannel(t){this._selectedItemState!==t&&(this._selectedItemState=t,this.fireCustomEvent("selectionChanged",t?[this.selectedItem]:[]));const r=this._input;r&&(r.textContent=this._inputValue=""),this.requestUpdate(),this.lostFocus()}},exports.MgtTeamsChannelPicker._config={useTeamsBasedScopes:!1},__decorate$7([property({attribute:!1}),__metadata$7("design:type",Object)],exports.MgtTeamsChannelPicker.prototype,"_isDropdownVisible",void 0),exports.MgtTeamsChannelPicker=zF=__decorate$7([customElement$1("mgt-teams-channel-picker"),__metadata$7("design:paramtypes",[])],exports.MgtTeamsChannelPicker);const GF={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var __decorate$6=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$6=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$a=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class MgtTasksBase extends MgtTemplatedComponent{get newTaskName(){return this._newTaskName}get strings(){return GF}constructor(){super(),this.clearState(),this._previousMediaQuery=this.mediaQuery,this.onResize=this.onResize.bind(this)}attributeChangedCallback(t,r,o){switch(super.attributeChangedCallback(t,r,o),t){case"target-id":case"initial-id":this.clearState(),this.requestStateUpdate()}}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){const t=Providers.globalProvider;if(!t||t.state!==exports.ProviderState.SignedIn)return html$1``;if(this.isLoadingState)return this.renderLoadingTask();const r=this.hideHeader?null:this.renderHeader(),o=this._isNewTaskVisible?this.renderNewTaskPanel():null,i=this.isLoadingState?this.renderLoadingTask():this.renderTasks();return html$1`
      ${r} ${o}
      <div class="Tasks" dir=${this.direction}>
        ${i}
      </div>
    `}renderHeader(){const t=this.renderHeaderContent(),r=oR({AddBarItem:!0,NewTaskButton:!0,hidden:this.readOnly||this._isNewTaskVisible});return html$1`
      <div class="Header" dir=${this.direction}>
        ${t}
        <button class="${r}" @click="${()=>this.showNewTaskPanel()}">
          <span class="TaskIcon">î</span>
          <span>${this.strings.addTaskButtonSubtitle}</span>
        </button>
      </div>
    `}renderLoadingTask(){return html$1`
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `}renderNewTaskPanel(){const t=this._newTaskName,r=html$1`
      <input
        type="text"
        placeholder="${this.strings.newTaskPlaceholder}"
        .value="${t}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="textbox"
        @input="${t=>{this._newTaskName=t.target.value,this.requestUpdate()}}"
      />
    `,o=oR({Disabled:!(this._isNewTaskBeingAdded||t&&t.length),TaskAddButtonContainer:!0}),i=this._isNewTaskBeingAdded?null:html$1`
          <div
            tabindex='0'
            class="TaskIcon TaskAdd"
            @click="${()=>this.addTask()}"
            @keypress="${t=>{"Enter"!==t.key&&" "!==t.key||this.addTask()}}"
          >
          <span>${this.strings.addTaskButtonSubtitle}</span>
          </div>
          <div
            role='button'
            tabindex='0'
            class="TaskIcon TaskCancel"
            @click="${()=>this.hideNewTaskPanel()}"
            @keypress="${t=>{"Enter"!==t.key&&" "!==t.key||this.hideNewTaskPanel()}}">
            <span>${this.strings.cancelNewTaskSubtitle}</span>
          </div>
        `,s=this.renderNewTaskDetails();return html$1`
      <div dir=${this.direction} class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${r}
            </div>
            <div class="TaskDetails">
              ${s}
            </div>
          </div>
        </div>
        <div class="${o}">
          ${i}
        </div>
      </div>
    `}renderBucketIcon(){return html$1`
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `}renderCalendarIcon(){return html$1`
        <svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 11C5.55228 11 6 10.5523 6 10C6 9.44771 5.55228 9 5 9C4.44772 9 4 9.44771 4 10C4 10.5523 4.44772 11 5 11ZM6 13C6 13.5523 5.55228 14 5 14C4.44772 14 4 13.5523 4 13C4 12.4477 4.44772 12 5 12C5.55228 12 6 12.4477 6 13ZM8 11C8.55229 11 9 10.5523 9 10C9 9.44771 8.55229 9 8 9C7.44771 9 7 9.44771 7 10C7 10.5523 7.44771 11 8 11ZM9 13C9 13.5523 8.55229 14 8 14C7.44771 14 7 13.5523 7 13C7 12.4477 7.44771 12 8 12C8.55229 12 9 12.4477 9 13ZM11 11C11.5523 11 12 10.5523 12 10C12 9.44771 11.5523 9 11 9C10.4477 9 10 9.44771 10 10C10 10.5523 10.4477 11 11 11ZM15 5.5C15 4.11929 13.8807 3 12.5 3H3.5C2.11929 3 1 4.11929 1 5.5V14.5C1 15.8807 2.11929 17 3.5 17H12.5C13.8807 17 15 15.8807 15 14.5V5.5ZM2 7H14V14.5C14 15.3284 13.3284 16 12.5 16H3.5C2.67157 16 2 15.3284 2 14.5V7ZM3.5 4H12.5C13.3284 4 14 4.67157 14 5.5V6H2V5.5C2 4.67157 2.67157 4 3.5 4Z" fill="#717171"/>
        </svg>
      `}addTask(){return __awaiter$a(this,void 0,void 0,(function*(){if(!this._isNewTaskBeingAdded&&this.newTaskName){this._isNewTaskBeingAdded=!0,yield this.requestUpdate();try{yield this.createNewTask()}finally{this._isNewTaskBeingAdded=!1,this._isNewTaskVisible=!1,this.requestUpdate()}}}))}clearNewTaskData(){this._newTaskName=""}clearState(){this.clearNewTaskData(),this._isNewTaskVisible=!1,this.requestUpdate()}handleTaskClick(t,r){this.fireCustomEvent("taskClick",{task:r})}dateToInputValue(t){return t?new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().split("T")[0]:null}showNewTaskPanel(){this._isNewTaskVisible=!0,this.requestUpdate()}hideNewTaskPanel(){this._isNewTaskVisible=!1,this.clearNewTaskData(),this.requestUpdate()}onResize(){this.mediaQuery!==this._previousMediaQuery&&(this._previousMediaQuery=this.mediaQuery,this.requestUpdate())}}__decorate$6([property({attribute:"read-only",type:Boolean}),__metadata$6("design:type",Boolean)],MgtTasksBase.prototype,"readOnly",void 0),__decorate$6([property({attribute:"hide-header",type:Boolean}),__metadata$6("design:type",Boolean)],MgtTasksBase.prototype,"hideHeader",void 0),__decorate$6([property({attribute:"hide-options",type:Boolean}),__metadata$6("design:type",Boolean)],MgtTasksBase.prototype,"hideOptions",void 0),__decorate$6([property({attribute:"target-id",type:String}),__metadata$6("design:type",String)],MgtTasksBase.prototype,"targetId",void 0),__decorate$6([property({attribute:"initial-id",type:String}),__metadata$6("design:type",String)],MgtTasksBase.prototype,"initialId",void 0);var VF,KF,WF,__awaiter$9=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};!function(t){t[t.notStarted=0]="notStarted",t[t.inProgress=1]="inProgress",t[t.completed=2]="completed",t[t.deferred=3]="deferred",t[t.waitingOnOthers=4]="waitingOnOthers"}(VF||(VF={})),function(t){t[t.low=0]="low",t[t.normal=1]="normal",t[t.high=2]="high"}(KF||(KF={})),function(t){t[t.none=0]="none",t[t.default=1]="default",t[t.flaggedEmails=2]="flaggedEmails",t[t.unknownFutureValue=3]="unknownFutureValue"}(WF||(WF={}));const QF=[css$1`
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--default-font-size:14px;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#717171;--color-sub3:#727170;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#727170;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#717171;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:var(--input-border, 2px solid #605e5c);--input-border-right:var(--input-border, 2px solid #605e5c);--input-border-bottom:var(--input-border, 2px solid #605e5c);--input-border-left:var(--input-border, 2px solid #605e5c);--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff;--list-item-background-color--hover:#edebe9;--dropdown-item-text-color:#000000;--dropdown-item-text-hover-color:#000000}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#727170;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#717171;--tab-line-color:#3b3a39;--tab-line-color--hover:#727170;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#717171;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:var(--input-border, 2px solid #8a8886);--input-border-right:var(--input-border, 2px solid #8a8886);--input-border-bottom:var(--input-border, 2px solid #8a8886);--input-border-left:var(--input-border, 2px solid #8a8886);--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514;--list-item-background-color--hover:#323130;--dropdown-item-text-color:#ffffff;--dropdown-item-text-hover-color:#ffffff}.mgt-light{--task-border:1px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:1px solid #717171;--task-complete-border:2px dotted #717171;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;-webkit-appearance:none}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,1px solid #e1dfdd);border-radius:8px}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#717171));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle;color:var(--color-sub2,#717171)}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#717171))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#717171));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .ReadOnly.Task .TaskCheckContainer{cursor:default}:host .Complete.Task{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Complete.Task .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#727170)}:host .NewTask.Task{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .NewTask.Task .SelfAssign{display:none}:host .NewTask.Task .AssignTo{border:0;background:0 0}:host .NewTask.Task .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .NewTask.Task .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\uE739'}:host .NewTask.Task .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\uE73A'}:host .NewTask.Task .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .NewTask.Task .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle{display:flex;height:32px;padding:2px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .NewTask.Task .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .NewTask.Task .TaskAddButtonContainer{margin-right:28px}:host .NewTask.Task .TaskAddButtonContainer .TaskAdd,:host .NewTask.Task .TaskAddButtonContainer .TaskCancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-family:var(--default-font-family, "Segoe UI");font-size:14px;line-height:20px}:host .NewTask.Task .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .NewTask.Task .TaskAddButtonContainer .TaskCancel{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130))}:host .NewTask.Task .TaskAddButtonContainer.Disabled .TaskAdd{color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}:host .LoadingTask.Task .TaskCheckContainer{cursor:default}:host .LoadingTask.Task .TaskDetails{display:flex}:host .LoadingTask.Task .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .LoadingTask.Task .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .LoadingTask.Task .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .LoadingTask.Task .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .LoadingTask.Task .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px}:host .Task{border:none}
`],YF={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding task...",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var __decorate$5=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$5=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)},__awaiter$8=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.MgtTodo=class MgtTodo extends MgtTasksBase{static get styles(){return QF}get strings(){return YF}static get requiredScopes(){return["tasks.read","tasks.readwrite"]}constructor(){super(),this._graph=null,this._newTaskDueDate=null,this._newTaskListId="",this._currentList=null,this._lists=[],this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1}renderTasks(){if(this._isLoadingTasks)return this.renderLoadingTask();let t=this._tasks;t&&this.taskFilter&&(t=t.filter((t=>this.taskFilter(t))));const r=kR(t,(t=>t.id),(t=>this.renderTask(t)));return html$1`
      ${r}
    `}renderNewTaskDetails(){const t=this._lists.filter((t=>this._currentList&&t.id===this._currentList.id||!this._currentList&&t.id===this._newTaskListId));t.length>0&&!this._newTaskListId&&(this._newTaskListId=t[0].id);const r=this._currentList?html$1`
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <span>${this._currentList.displayName}</span>
          </span>
        `:html$1`
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <select
              .value="${this._newTaskListId}"
              @change="${t=>{this._newTaskListId=t.target.value}}"
            >
              ${t.map((t=>html$1`
                  <option value="${t.id}">${t.displayName}</option>
                `))}
            </select>
          </span>
        `,o=html$1`
      <span class="NewTaskDue">
        ${this.renderCalendarIcon()}
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="textbox"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${t=>{const r=t.target.value;this._newTaskDueDate=r?new Date(r+"T17:00"):null}}"
        />
      </span>
    `;return html$1`
      ${r} ${o}
    `}renderHeaderContent(){if(this.isLoadingState)return html$1`
        <div class="header__loading"></div>
      `;const t=this._lists||[],r=this._currentList,o=this.targetId;let i;if(o&&t.length){const r=t.find((t=>t.id===o));r&&(i=html$1`
          <span class="PlanTitle">
            ${r.displayName}
          </span>
        `)}else if(r){const o={};for(const r of t)o[r.displayName]=()=>this.loadTaskList(r);i=html$1`
        <mgt-arrow-options .value="${r.displayName}" .options="${o}"></mgt-arrow-options>
      `}return html$1`
      <span class="TitleCont">
        ${i}
      </span>
    `}renderTask(t){const r={task:t,list:this._currentList};if(this.hasTemplate("task"))return this.renderTemplate("task",r,t.id);const o=VF[t.status]===VF.completed,i=this._loadingTasks.includes(t.id),s={Complete:!i&&o,Loading:i,TaskCheck:!0,TaskIcon:!0},l=i?html$1`
          ïª
        `:o?html$1`
          î¾
        `:null;let u=null;if(this.hasTemplate("task-details"))u=this.renderTemplate("task-details",r,`task-details-${t.id}`);else{const r=t.dueDateTime?html$1`
            <div class="TaskDetail TaskDue">
              <span>Due ${getShortDateString(new Date(t.dueDateTime.dateTime))}</span>
            </div>
          `:null;u=html$1`
        <div class="TaskTitle">
          ${t.title}
        </div>
        <div class="TaskDetail TaskBucket">
          ${this.renderBucketIcon()}
          <span>${this._currentList.displayName}</span>
        </div>
        ${r}
      `}const h=this.readOnly||this.hideOptions?null:html$1`
            <div class="TaskOptions">
              <mgt-dot-options
                .options="${{[this.strings.removeTaskSubtitle]:r=>this.removeTask(r,t.id)}}"
              ></mgt-dot-options>
            </div>
          `,m=oR({Complete:o,Incomplete:!o,ReadOnly:this.readOnly,Task:!0}),v=oR({Complete:o,Incomplete:!o,TaskCheckContainer:!0});return html$1`
      <div class=${m}>
        <div class="TaskContent" @click="${r=>this.handleTaskClick(r,t)}}">
          <span class=${v} @click="${r=>this.handleTaskCheckClick(r,t)}">
            <span class=${oR(s)}>
              <span class="TaskCheckContent">${l}</span>
            </span>
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery}">
            ${u}
          </div>
          ${h}
          <div class="Divider"></div>
        </div>
      </div>
    `}loadState(){return __awaiter$8(this,void 0,void 0,(function*(){const t=Providers.globalProvider;if(!t||t.state!==exports.ProviderState.SignedIn)return;if(!this._graph){const r=t.graph.forComponent(this);this._graph=r}let r=this._lists;if(!r||!r.length){if(this.targetId){const t=yield function getTodoTaskList(t,r){return __awaiter$9(this,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${r}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get()}))}(this._graph,this.targetId);r=t?[t]:[]}else r=yield function getTodoTaskLists(t){return __awaiter$9(this,void 0,void 0,(function*(){const r=yield t.api("/me/todo/lists").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return r&&r.value}))}(this._graph);this._tasks=[],this._currentList=null,this._lists=r}let o=this._currentList;!o&&r&&r.length&&(this.initialId&&(o=r.find((t=>t.id===this.initialId))),o||(o=r[0]),this._tasks=[],this._currentList=o),o&&(yield this.loadTaskList(o))}))}createNewTask(){return __awaiter$8(this,void 0,void 0,(function*(){const t=this._currentList.id,r={title:this.newTaskName};this._newTaskDueDate&&(r.dueDateTime={dateTime:this._newTaskDueDate.toLocaleDateString(),timeZone:"UTC"});const o=yield function createTodoTask(t,r,o){return __awaiter$9(this,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${r}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(o)}))}(this._graph,t,r);this._tasks.unshift(o)}))}clearNewTaskData(){super.clearNewTaskData(),this._newTaskDueDate=null,this._newTaskListId=null}clearState(){super.clearState(),this._currentList=null,this._lists=[],this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1}loadTaskList(t){return __awaiter$8(this,void 0,void 0,(function*(){this._isLoadingTasks=!0,this._currentList=t,this.requestUpdate(),this._tasks=yield function getTodoTasks(t,r){return __awaiter$9(this,void 0,void 0,(function*(){const o=yield t.api(`/me/todo/lists/${r}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return o&&o.value}))}(this._graph,t.id),this._isLoadingTasks=!1,this.requestUpdate()}))}updateTaskStatus(t,r){return __awaiter$8(this,void 0,void 0,(function*(){this._loadingTasks=[...this._loadingTasks,t.id],this.requestUpdate(),t.status=r;const o=this._currentList.id;t=yield function updateTodoTask(t,r,o,i){return __awaiter$9(this,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${r}/tasks/${o}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).patch(i)}))}(this._graph,o,t.id,t);const i=this._tasks.findIndex((r=>r.id===t.id));this._tasks[i]=t,this._loadingTasks=this._loadingTasks.filter((r=>r!==t.id)),this.requestUpdate()}))}removeTask(t,r){return __awaiter$8(this,void 0,void 0,(function*(){this._tasks=this._tasks.filter((t=>t.id!==r)),this.requestUpdate();const t=this._currentList.id;yield function deleteTodoTask(t,r,o){return __awaiter$9(this,void 0,void 0,(function*(){yield t.api(`/me/todo/lists/${r}/tasks/${o}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).delete()}))}(this._graph,t,r),this._tasks=this._tasks.filter((t=>t.id!==r))}))}handleTaskCheckClick(t,r){this.readOnly||(VF[r.status]===VF.completed?this.updateTaskStatus(r,VF.notStarted):this.updateTaskStatus(r,VF.completed),t.stopPropagation(),t.preventDefault())}},exports.MgtTodo=__decorate$5([customElement$1("mgt-todo"),__metadata$5("design:paramtypes",[])],exports.MgtTodo);var __awaiter$7=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class MsalProvider extends IProvider{get userAgentApplication(){return this._userAgentApplication}get name(){return"MgtMsalProvider"}constructor(t){super(),this.sessionStorageRequestedScopesKey="mgt-requested-scopes",this.sessionStorageDeniedScopesKey="mgt-denied-scopes",this.initProvider(t)}trySilentSignIn(){return __awaiter$7(this,void 0,void 0,(function*(){try{if(this._userAgentApplication.isCallback(window.location.hash))return;this._userAgentApplication.getAccount()&&(yield this.getAccessToken(null))?this.setState(exports.ProviderState.SignedIn):this.setState(exports.ProviderState.SignedOut)}catch(t){this.setState(exports.ProviderState.SignedOut)}}))}login(t){return __awaiter$7(this,void 0,void 0,(function*(){let r=t||{loginHint:this._loginHint,scopes:this.scopes};if(this._prompt&&(r.prompt=this._prompt),this._domainHint&&(r.extraQueryParameters={domain_hint:this._domainHint}),this._loginType===exports.LoginType.Popup){const t=yield this._userAgentApplication.loginPopup(r);this.setState(t.account?exports.ProviderState.SignedIn:exports.ProviderState.SignedOut)}else this._userAgentApplication.loginRedirect(r)}))}logout(){return __awaiter$7(this,void 0,void 0,(function*(){this._userAgentApplication.logout(),this.setState(exports.ProviderState.SignedOut)}))}getAccessToken(t){return __awaiter$7(this,void 0,void 0,(function*(){const r=t&&t.scopes||this.scopes,o={loginHint:this._loginHint,scopes:r};this._domainHint&&(o.extraQueryParameters={domain_hint:this._domainHint});try{return(yield this._userAgentApplication.acquireTokenSilent(o)).accessToken}catch(t){if(!this.requiresInteraction(t))throw this.setState(exports.ProviderState.SignedOut),t;if(this._loginType===exports.LoginType.Redirect){if(this.areScopesDenied(r))throw t;this.setRequestedScopes(r),this._userAgentApplication.acquireTokenRedirect(o)}else try{return(yield this._userAgentApplication.acquireTokenPopup(o)).accessToken}catch(t){throw t}}throw null}))}updateScopes(t){this.scopes=t}requiresInteraction(t){return!(!t||!t.errorCode)&&(-1!==t.errorCode.indexOf("consent_required")||-1!==t.errorCode.indexOf("interaction_required")||-1!==t.errorCode.indexOf("login_required"))}setRequestedScopes(t){t&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(t))}getRequestedScopes(){const t=sessionStorage.getItem(this.sessionStorageRequestedScopesKey);return t?JSON.parse(t):null}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}addDeniedScopes(t){if(t){let r=this.getDeniedScopes()||[];r=r.concat(t);let o=r.indexOf("openid");-1!==o&&r.splice(o,1),o=r.indexOf("profile"),-1!==o&&r.splice(o,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(r))}}getDeniedScopes(){const t=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return t?JSON.parse(t):null}areScopesDenied(t){if(t){const r=this.getDeniedScopes();if(r&&r.filter((r=>-1!==t.indexOf(r))).length>0)return!0}return!1}initProvider(t){let r,o;if(this.scopes=void 0!==t.scopes?t.scopes:["user.read"],this._loginType=void 0!==t.loginType?t.loginType:exports.LoginType.Redirect,this._loginHint=t.loginHint,this._domainHint=t.domainHint,this._prompt=void 0!==t.prompt?t.prompt:"select_account","clientId"in t){if(!t.clientId)throw new Error("clientId must be provided");{const i=t.options||{auth:{clientId:t.clientId}};i.auth.clientId=t.clientId,i.cache=i.cache||{},i.cache.cacheLocation=i.cache.cacheLocation||"localStorage",void 0!==i.cache.storeAuthStateInCookie&&null!==i.cache.storeAuthStateInCookie||(i.cache.storeAuthStateInCookie=!0),t.authority&&(i.auth.authority=t.authority),t.redirectUri&&(i.auth.redirectUri=t.redirectUri),o=t.clientId,r=new dP(i)}}else{if(!("userAgentApplication"in t))throw new Error("either clientId or userAgentApplication must be provided");if(!t.userAgentApplication)throw new Error("userAgentApplication must be provided");r=t.userAgentApplication;o=r.getCurrentConfiguration().auth.clientId}this.clientId=o,this._userAgentApplication=r,this._userAgentApplication.handleRedirectCallback((t=>this.tokenReceivedCallback(t)),((t,r)=>this.errorReceivedCallback(t,r))),this.graph=createFromProvider(this),this.trySilentSignIn()}tokenReceivedCallback(t){"id_token"===t.tokenType&&this.setState(exports.ProviderState.SignedIn),this.clearRequestedScopes()}errorReceivedCallback(t,r){const o=this.getRequestedScopes();o&&this.addDeniedScopes(o),this.clearRequestedScopes()}}var __decorate$4=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$4=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};exports.MgtMsalProvider=class MgtMsalProvider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const t={clientId:this.clientId,domainHint:this.domainHint,prompt:this.prompt};if(this.loginType&&this.loginType.length>1){let r=this.loginType.toLowerCase();r=r[0].toUpperCase()+r.slice(1);const o=exports.LoginType[r];t.loginType=o}if(this.authority&&(t.authority=this.authority),this.scopes){const r=this.scopes.split(",");r&&r.length>0&&(t.scopes=r)}this.redirectUri&&(t.redirectUri=this.redirectUri),this.provider=new MsalProvider(t),Providers.globalProvider=this.provider}}},__decorate$4([property({attribute:"client-id",type:String}),__metadata$4("design:type",Object)],exports.MgtMsalProvider.prototype,"clientId",void 0),__decorate$4([property({attribute:"login-type",type:String}),__metadata$4("design:type",Object)],exports.MgtMsalProvider.prototype,"loginType",void 0),__decorate$4([property(),__metadata$4("design:type",Object)],exports.MgtMsalProvider.prototype,"authority",void 0),__decorate$4([property({attribute:"scopes",type:String}),__metadata$4("design:type",Object)],exports.MgtMsalProvider.prototype,"scopes",void 0),__decorate$4([property({attribute:"redirect-uri",type:String}),__metadata$4("design:type",Object)],exports.MgtMsalProvider.prototype,"redirectUri",void 0),__decorate$4([property({attribute:"domain-hint",type:String}),__metadata$4("design:type",Object)],exports.MgtMsalProvider.prototype,"domainHint",void 0),__decorate$4([property({attribute:"prompt",type:String}),__metadata$4("design:type",Object)],exports.MgtMsalProvider.prototype,"prompt",void 0),exports.MgtMsalProvider=__decorate$4([customElement$1("mgt-msal-provider")],exports.MgtMsalProvider);var __awaiter$6=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class TeamsProvider extends MsalProvider{static get isAvailable(){return TeamsHelper.isAvailable}static get microsoftTeamsLib(){return TeamsHelper.microsoftTeamsLib}static set microsoftTeamsLib(t){TeamsHelper.microsoftTeamsLib=t}get name(){return"MgtTeamsProvider"}static handleAuth(){return __awaiter$6(this,void 0,void 0,(function*(){const t=TeamsHelper.microsoftTeamsLib;if(!t)return void console.error("Make sure you have referenced the Microsoft Teams sdk before using the TeamsProvider");t.initialize(),sessionStorage.getItem(this._sessionStorageLogoutInProgress)&&t.authentication.notifySuccess();const r=new URL(window.location.href).searchParams.get("signout"),o=localStorage.getItem(this._localStorageParametersKey);let i;if(i=o?JSON.parse(o):{},!i.clientId)return void t.authentication.notifyFailure("no clientId provided");const s=i.scopes?i.scopes.split(","):null,l=i.options||{auth:{clientId:i.clientId}};l.system=l.system||{},l.system.loadFrameTimeout=1e4;const u=new MsalProvider({clientId:i.clientId,options:l,scopes:s});if(u.userAgentApplication.urlContainsHash(window.location.hash))return;const handleProviderState=()=>__awaiter$6(this,void 0,void 0,(function*(){if(u.state===exports.ProviderState.SignedOut){if(r)return void t.authentication.notifySuccess();sessionStorage.getItem(this._sessionStorageLoginInProgress)||(sessionStorage.setItem(this._sessionStorageLoginInProgress,"true"),u.login({loginHint:i.loginHint,scopes:s||u.scopes}))}else if(u.state===exports.ProviderState.SignedIn){if(r)return sessionStorage.setItem(this._sessionStorageLogoutInProgress,"true"),void(yield u.logout());try{const r=yield u.getAccessTokenForScopes(...u.scopes);t.authentication.notifySuccess(r)}catch(r){t.authentication.notifyFailure(r)}}}));u.onStateChanged(handleProviderState),handleProviderState()}))}constructor(t){super({clientId:t.clientId,loginType:exports.LoginType.Redirect,options:t.msalOptions,scopes:t.scopes}),this._msalOptions=t.msalOptions,this._authPopupUrl=t.authPopupUrl;TeamsHelper.microsoftTeamsLib.initialize()}login(){return __awaiter$6(this,void 0,void 0,(function*(){this.setState(exports.ProviderState.Loading);const t=TeamsHelper.microsoftTeamsLib;return new Promise(((r,o)=>{t.getContext((i=>{this.teamsContext=i;const s={clientId:this.clientId,loginHint:i.loginHint,options:this._msalOptions,scopes:this.scopes.join(",")};localStorage.setItem(TeamsProvider._localStorageParametersKey,JSON.stringify(s));const l=new URL(this._authPopupUrl,new URL(window.location.href));t.authentication.authenticate({failureCallback:t=>{this.setState(exports.ProviderState.SignedOut),o()},successCallback:t=>{this.trySilentSignIn(),r()},url:l.href})}))}))}))}logout(){return __awaiter$6(this,void 0,void 0,(function*(){const t=TeamsHelper.microsoftTeamsLib;return new Promise(((r,o)=>{t.getContext((i=>{this.teamsContext=i;const s=new URL(this._authPopupUrl,new URL(window.location.href));s.searchParams.append("signout","true"),t.authentication.authenticate({failureCallback:t=>{this.trySilentSignIn(),o()},successCallback:t=>{this.trySilentSignIn(),r()},url:s.href})}))}))}))}getAccessToken(t){return __awaiter$6(this,void 0,void 0,(function*(){if(!this.teamsContext&&TeamsHelper.microsoftTeamsLib){const t=TeamsHelper.microsoftTeamsLib;t.initialize(),this.teamsContext=yield t.getContext()}const r={scopes:t&&t.scopes||this.scopes};this.teamsContext&&this.teamsContext.loginHint&&(r.loginHint=this.teamsContext.loginHint);try{return(yield this.userAgentApplication.acquireTokenSilent(r)).accessToken}catch(t){if(this.requiresInteraction(t))return null;throw t}}))}}TeamsProvider._localStorageParametersKey="msg-teamsprovider-auth-parameters",TeamsProvider._sessionStorageLoginInProgress="msg-teamsprovider-login-in-progress",TeamsProvider._sessionStorageLogoutInProgress="msg-teamsprovider-logout-in-progress";var __decorate$3=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$3=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};exports.MgtTeamsProvider=class MgtTeamsProvider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId="",this.authPopupUrl=""}get isAvailable(){return TeamsProvider.isAvailable}initializeProvider(){if(this.clientId&&this.authPopupUrl){const t={authPopupUrl:this.authPopupUrl,clientId:this.clientId};if(this.scopes){const r=this.scopes.split(",");r&&r.length>0&&(t.scopes=r)}if(this.authority){const r={auth:{authority:this.authority,clientId:this.clientId}};t.msalOptions=r}this.provider=new TeamsProvider(t),Providers.globalProvider=this.provider}}},__decorate$3([property({attribute:"client-id",type:String}),__metadata$3("design:type",Object)],exports.MgtTeamsProvider.prototype,"clientId",void 0),__decorate$3([property({attribute:"auth-popup-url",type:String}),__metadata$3("design:type",Object)],exports.MgtTeamsProvider.prototype,"authPopupUrl",void 0),__decorate$3([property(),__metadata$3("design:type",Object)],exports.MgtTeamsProvider.prototype,"authority",void 0),__decorate$3([property({attribute:"scopes",type:String}),__metadata$3("design:type",Object)],exports.MgtTeamsProvider.prototype,"scopes",void 0),exports.MgtTeamsProvider=__decorate$3([customElement$1("mgt-teams-provider")],exports.MgtTeamsProvider);var __awaiter$5=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};class CustomHeaderMiddleware{constructor(t){this._getCustomHeaders=t}execute(t){return __awaiter$5(this,void 0,void 0,(function*(){if(this._getCustomHeaders){const r=yield this._getCustomHeaders();for(const o in r)r.hasOwnProperty(o)&&setRequestHeader(t.request,t.options,o,r[o])}return yield this.nextMiddleware.execute(t)}))}setNext(t){this.nextMiddleware=t}}class ProxyGraph extends Graph{constructor(t,r){const o=[new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new SdkVersionMiddleware(hP),new CustomHeaderMiddleware(r),new HTTPMessageHandler];super(Client.initWithMiddleware({baseUrl:t,middleware:chainMiddleware(...o)}))}}class ProxyProvider extends IProvider{get name(){return"MgtProxyProvider"}constructor(t,r=null){super(),this.graph=new ProxyGraph(t,r),this.graph.api("me").get().then((t=>{null!=t?this.setState(exports.ProviderState.SignedIn):this.setState(exports.ProviderState.SignedOut)}),(t=>{this.setState(exports.ProviderState.SignedOut)}))}getAccessToken(){return null}}var __decorate$2=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$2=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};exports.MgtProxyProvider=class MgtProxyProvider extends MgtBaseProvider{get isAvailable(){return!0}initializeProvider(){void 0!==this.graphProxyUrl&&(this.provider=new ProxyProvider(this.graphProxyUrl),Providers.globalProvider=this.provider)}},__decorate$2([property({attribute:"graph-proxy-url"}),__metadata$2("design:type",String)],exports.MgtProxyProvider.prototype,"graphProxyUrl",void 0),exports.MgtProxyProvider=__decorate$2([customElement$1("mgt-proxy-provider")],exports.MgtProxyProvider);var __awaiter$4=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};
/*! @azure/msal-browser v2.36.0 2023-04-18 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var extendStatics$1=function(t,r){return extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},extendStatics$1(t,r)};function __extends$1(t,r){function __(){this.constructor=t}extendStatics$1(t,r),t.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}var __assign$1=function(){return __assign$1=Object.assign||function __assign(t){for(var r,o=1,i=arguments.length;o<i;o++)for(var s in r=arguments[o])Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s]);return t},__assign$1.apply(this,arguments)};function __rest(t,r){var o={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&r.indexOf(i)<0&&(o[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)r.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(o[i[s]]=t[i[s]])}return o}function __awaiter$3(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))}function __generator$1(t,r){var o,i,s,l,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(l){return function(h){return function step(l){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=2&l[0]?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return u.label++,{value:l[1],done:!1};case 5:u.label++,i=l[1],l=[0];continue;case 7:l=u.ops.pop(),u.trys.pop();continue;default:if(!(s=u.trys,(s=s.length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){u=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){u.label=l[1];break}if(6===l[0]&&u.label<s[1]){u.label=s[1],s=l;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(l);break}s[2]&&u.ops.pop(),u.trys.pop();continue}l=r.call(t,u)}catch(t){l=[6,t],i=0}finally{o=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,h])}}}function __read(t,r){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var i,s,l=o.call(t),u=[];try{for(;(void 0===r||r-- >0)&&!(i=l.next()).done;)u.push(i.value)}catch(t){s={error:t}}finally{try{i&&!i.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}return u}function __spread(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(__read(arguments[r]));return t}
/*! @azure/msal-common v12.1.0 2023-04-18 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(t,r){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},extendStatics(t,r)};function __extends(t,r){function __(){this.constructor=t}extendStatics(t,r),t.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}var __assign=function(){return __assign=Object.assign||function __assign(t){for(var r,o=1,i=arguments.length;o<i;o++)for(var s in r=arguments[o])Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s]);return t},__assign.apply(this,arguments)};function __awaiter$2(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))}function __generator(t,r){var o,i,s,l,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return l={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function verb(l){return function(h){return function step(l){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=2&l[0]?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return u.label++,{value:l[1],done:!1};case 5:u.label++,i=l[1],l=[0];continue;case 7:l=u.ops.pop(),u.trys.pop();continue;default:if(!(s=u.trys,(s=s.length>0&&s[s.length-1])||6!==l[0]&&2!==l[0])){u=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){u.label=l[1];break}if(6===l[0]&&u.label<s[1]){u.label=s[1],s=l;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(l);break}s[2]&&u.ops.pop(),u.trys.pop();continue}l=r.call(t,u)}catch(t){l=[6,t],i=0}finally{o=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,h])}}}function __spreadArrays(){for(var t=0,r=0,o=arguments.length;r<o;r++)t+=arguments[r].length;var i=Array(t),s=0;for(r=0;r<o;r++)for(var l=arguments[r],u=0,h=l.length;u<h;u++,s++)i[s]=l[u];return i}
/*! @azure/msal-common v12.1.0 2023-04-18 */var JF,XF,ZF,eL,tL,rL={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},oL=[rL.OPENID_SCOPE,rL.PROFILE_SCOPE,rL.OFFLINE_ACCESS_SCOPE],nL=__spreadArrays(oL,[rL.EMAIL_SCOPE]);!function(t){t.CONTENT_TYPE="Content-Type",t.RETRY_AFTER="Retry-After",t.CCS_HEADER="X-AnchorMailbox",t.WWWAuthenticate="WWW-Authenticate",t.AuthenticationInfo="Authentication-Info",t.X_MS_REQUEST_ID="x-ms-request-id",t.X_MS_HTTP_VERSION="x-ms-httpver"}(JF||(JF={})),function(t){t.ID_TOKEN="idtoken",t.CLIENT_INFO="client.info",t.ADAL_ID_TOKEN="adal.idtoken",t.ERROR="error",t.ERROR_DESC="error.description",t.ACTIVE_ACCOUNT="active-account",t.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(XF||(XF={})),function(t){t.COMMON="common",t.ORGANIZATIONS="organizations",t.CONSUMERS="consumers"}(ZF||(ZF={})),function(t){t.CLIENT_ID="client_id",t.REDIRECT_URI="redirect_uri",t.RESPONSE_TYPE="response_type",t.RESPONSE_MODE="response_mode",t.GRANT_TYPE="grant_type",t.CLAIMS="claims",t.SCOPE="scope",t.ERROR="error",t.ERROR_DESCRIPTION="error_description",t.ACCESS_TOKEN="access_token",t.ID_TOKEN="id_token",t.REFRESH_TOKEN="refresh_token",t.EXPIRES_IN="expires_in",t.STATE="state",t.NONCE="nonce",t.PROMPT="prompt",t.SESSION_STATE="session_state",t.CLIENT_INFO="client_info",t.CODE="code",t.CODE_CHALLENGE="code_challenge",t.CODE_CHALLENGE_METHOD="code_challenge_method",t.CODE_VERIFIER="code_verifier",t.CLIENT_REQUEST_ID="client-request-id",t.X_CLIENT_SKU="x-client-SKU",t.X_CLIENT_VER="x-client-VER",t.X_CLIENT_OS="x-client-OS",t.X_CLIENT_CPU="x-client-CPU",t.X_CLIENT_CURR_TELEM="x-client-current-telemetry",t.X_CLIENT_LAST_TELEM="x-client-last-telemetry",t.X_MS_LIB_CAPABILITY="x-ms-lib-capability",t.X_APP_NAME="x-app-name",t.X_APP_VER="x-app-ver",t.POST_LOGOUT_URI="post_logout_redirect_uri",t.ID_TOKEN_HINT="id_token_hint",t.DEVICE_CODE="device_code",t.CLIENT_SECRET="client_secret",t.CLIENT_ASSERTION="client_assertion",t.CLIENT_ASSERTION_TYPE="client_assertion_type",t.TOKEN_TYPE="token_type",t.REQ_CNF="req_cnf",t.OBO_ASSERTION="assertion",t.REQUESTED_TOKEN_USE="requested_token_use",t.ON_BEHALF_OF="on_behalf_of",t.FOCI="foci",t.CCS_HEADER="X-AnchorMailbox",t.RETURN_SPA_CODE="return_spa_code",t.NATIVE_BROKER="nativebroker",t.LOGOUT_HINT="logout_hint"}(eL||(eL={})),function(t){t.ACCESS_TOKEN="access_token",t.XMS_CC="xms_cc"}(tL||(tL={}));var iL,sL={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"};!function(t){t.ACCOUNT="account",t.SID="sid",t.LOGIN_HINT="login_hint",t.ID_TOKEN="id_token",t.DOMAIN_HINT="domain_hint",t.ORGANIZATIONS="organizations",t.CONSUMERS="consumers",t.ACCOUNT_ID="accountIdentifier",t.HOMEACCOUNT_ID="homeAccountIdentifier"}(iL||(iL={}));var aL,cL,lL,dL,uL,hL,pL={PLAIN:"plain",S256:"S256"};!function(t){t.QUERY="query",t.FRAGMENT="fragment",t.FORM_POST="form_post"}(aL||(aL={})),function(t){t.IMPLICIT_GRANT="implicit",t.AUTHORIZATION_CODE_GRANT="authorization_code",t.CLIENT_CREDENTIALS_GRANT="client_credentials",t.RESOURCE_OWNER_PASSWORD_GRANT="password",t.REFRESH_TOKEN_GRANT="refresh_token",t.DEVICE_CODE_GRANT="device_code",t.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(cL||(cL={})),function(t){t.MSSTS_ACCOUNT_TYPE="MSSTS",t.ADFS_ACCOUNT_TYPE="ADFS",t.MSAV1_ACCOUNT_TYPE="MSA",t.GENERIC_ACCOUNT_TYPE="Generic"}(lL||(lL={})),function(t){t.CACHE_KEY_SEPARATOR="-",t.CLIENT_INFO_SEPARATOR="."}(dL||(dL={})),function(t){t.ID_TOKEN="IdToken",t.ACCESS_TOKEN="AccessToken",t.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",t.REFRESH_TOKEN="RefreshToken"}(uL||(uL={})),function(t){t[t.ADFS=1001]="ADFS",t[t.MSA=1002]="MSA",t[t.MSSTS=1003]="MSSTS",t[t.GENERIC=1004]="GENERIC",t[t.ACCESS_TOKEN=2001]="ACCESS_TOKEN",t[t.REFRESH_TOKEN=2002]="REFRESH_TOKEN",t[t.ID_TOKEN=2003]="ID_TOKEN",t[t.APP_METADATA=3001]="APP_METADATA",t[t.UNDEFINED=9999]="UNDEFINED"}(hL||(hL={}));var fL,gL="appmetadata",mL="1",vL="authority-metadata",yL=86400;!function(t){t.CONFIG="config",t.CACHE="cache",t.NETWORK="network",t.HARDCODED_VALUES="hardcoded_values"}(fL||(fL={}));var bL,wL={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(t){t.BEARER="Bearer",t.POP="pop",t.SSH="ssh-cert"}(bL||(bL={}));var CL,_L,kL,SL,TL,EL,xL=60,IL=3600,AL="throttling",PL="retry-after, h429",RL="invalid_grant",OL="client_mismatch";!function(t){t.username="username",t.password="password"}(CL||(CL={})),function(t){t[t.httpSuccess=200]="httpSuccess",t[t.httpBadRequest=400]="httpBadRequest"}(_L||(_L={})),function(t){t.FAILED_AUTO_DETECTION="1",t.INTERNAL_CACHE="2",t.ENVIRONMENT_VARIABLE="3",t.IMDS="4"}(kL||(kL={})),function(t){t.CONFIGURED_MATCHES_DETECTED="1",t.CONFIGURED_NO_AUTO_DETECTION="2",t.CONFIGURED_NOT_DETECTED="3",t.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",t.AUTO_DETECTION_REQUESTED_FAILED="5"}(SL||(SL={})),function(t){t.NO_CACHE_HIT="0",t.FORCE_REFRESH="1",t.NO_CACHED_ACCESS_TOKEN="2",t.CACHED_ACCESS_TOKEN_EXPIRED="3",t.REFRESH_CACHED_ACCESS_TOKEN="4"}(TL||(TL={})),function(t){t.Jwt="JWT",t.Jwk="JWK",t.Pop="pop"}(EL||(EL={}));
/*! @azure/msal-common v12.1.0 2023-04-18 */
var NL,ML={code:"unexpected_error",desc:"Unexpected error in authentication."},DL={code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},FL=function(t){function AuthError(r,o,i){var s=this,l=o?r+": "+o:r;return s=t.call(this,l)||this,Object.setPrototypeOf(s,AuthError.prototype),s.errorCode=r||rL.EMPTY_STRING,s.errorMessage=o||rL.EMPTY_STRING,s.subError=i||rL.EMPTY_STRING,s.name="AuthError",s}return __extends(AuthError,t),AuthError.prototype.setCorrelationId=function(t){this.correlationId=t},AuthError.createUnexpectedError=function(t){return new AuthError(ML.code,ML.desc+": "+t)},AuthError.createPostRequestFailed=function(t){return new AuthError(DL.code,DL.desc+": "+t)},AuthError}(Error),LL={createNewGuid:function(){throw FL.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw FL.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw FL.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - generatePkceCodes() has not been implemented",FL.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",FL.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - removeTokenBindingKey() has not been implemented",FL.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - clearKeystore() has not been implemented",FL.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - signJwt() has not been implemented",FL.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - hashString() has not been implemented",FL.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},UL={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},BL={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},HL={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},$L={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},qL={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},jL={code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},zL={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},GL={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},VL={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},KL={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},WL={code:"state_not_found",desc:"State not found"},QL={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},YL={code:"nonce_not_found",desc:"nonce not found"},JL={code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},XL={code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},ZL={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},eU={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},tU={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},rU={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},oU={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},nU={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},iU={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},sU={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},aU={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},cU={code:"device_code_expired",desc:"Device code is expired."},lU={code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},dU={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},uU={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},hU={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},pU={code:"no_account_found",desc:"No account found in cache for given key."},fU={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},gU={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},mU={code:"invalid_cache_type",desc:"Invalid cache type"},vU={code:"unexpected_account_type",desc:"Unexpected account type."},yU={code:"unexpected_credential_type",desc:"Unexpected credential type."},bU={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},wU={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},CU={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},_U={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},kU={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},SU={code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},TU={code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},EU={code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},xU={code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},IU={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},AU={code:"user_canceled",desc:"User canceled the flow."},PU=function(t){function ClientAuthError(r,o){var i=t.call(this,r,o)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,ClientAuthError.prototype),i}return __extends(ClientAuthError,t),ClientAuthError.createClientInfoDecodingError=function(t){return new ClientAuthError(UL.code,UL.desc+" Failed with error: "+t)},ClientAuthError.createClientInfoEmptyError=function(){return new ClientAuthError(BL.code,""+BL.desc)},ClientAuthError.createTokenParsingError=function(t){return new ClientAuthError(HL.code,HL.desc+" Failed with error: "+t)},ClientAuthError.createTokenNullOrEmptyError=function(t){return new ClientAuthError($L.code,$L.desc+" Raw Token Value: "+t)},ClientAuthError.createEndpointDiscoveryIncompleteError=function(t){return new ClientAuthError(qL.code,qL.desc+" Detail: "+t)},ClientAuthError.createNetworkError=function(t,r){return new ClientAuthError(jL.code,jL.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+t.split("?")[0])},ClientAuthError.createUnableToGetOpenidConfigError=function(t){return new ClientAuthError(zL.code,zL.desc+" Attempted to retrieve endpoints from: "+t)},ClientAuthError.createHashNotDeserializedError=function(t){return new ClientAuthError(GL.code,GL.desc+" Given Object: "+t)},ClientAuthError.createInvalidStateError=function(t,r){return new ClientAuthError(VL.code,VL.desc+" Invalid State: "+t+", Root Err: "+r)},ClientAuthError.createStateMismatchError=function(){return new ClientAuthError(KL.code,KL.desc)},ClientAuthError.createStateNotFoundError=function(t){return new ClientAuthError(WL.code,WL.desc+":  "+t)},ClientAuthError.createNonceMismatchError=function(){return new ClientAuthError(QL.code,QL.desc)},ClientAuthError.createAuthTimeNotFoundError=function(){return new ClientAuthError(JL.code,JL.desc)},ClientAuthError.createMaxAgeTranspiredError=function(){return new ClientAuthError(XL.code,XL.desc)},ClientAuthError.createNonceNotFoundError=function(t){return new ClientAuthError(YL.code,YL.desc+":  "+t)},ClientAuthError.createMultipleMatchingTokensInCacheError=function(){return new ClientAuthError(ZL.code,ZL.desc+".")},ClientAuthError.createMultipleMatchingAccountsInCacheError=function(){return new ClientAuthError(eU.code,eU.desc)},ClientAuthError.createMultipleMatchingAppMetadataInCacheError=function(){return new ClientAuthError(tU.code,tU.desc)},ClientAuthError.createTokenRequestCannotBeMadeError=function(){return new ClientAuthError(rU.code,rU.desc)},ClientAuthError.createAppendEmptyScopeToSetError=function(t){return new ClientAuthError(oU.code,oU.desc+" Given Scope: "+t)},ClientAuthError.createRemoveEmptyScopeFromSetError=function(t){return new ClientAuthError(nU.code,nU.desc+" Given Scope: "+t)},ClientAuthError.createAppendScopeSetError=function(t){return new ClientAuthError(iU.code,iU.desc+" Detail Error: "+t)},ClientAuthError.createEmptyInputScopeSetError=function(){return new ClientAuthError(sU.code,""+sU.desc)},ClientAuthError.createDeviceCodeCancelledError=function(){return new ClientAuthError(aU.code,""+aU.desc)},ClientAuthError.createDeviceCodeExpiredError=function(){return new ClientAuthError(cU.code,""+cU.desc)},ClientAuthError.createDeviceCodeUnknownError=function(){return new ClientAuthError(lU.code,""+lU.desc)},ClientAuthError.createNoAccountInSilentRequestError=function(){return new ClientAuthError(dU.code,""+dU.desc)},ClientAuthError.createNullOrUndefinedCacheRecord=function(){return new ClientAuthError(uU.code,uU.desc)},ClientAuthError.createInvalidCacheEnvironmentError=function(){return new ClientAuthError(hU.code,hU.desc)},ClientAuthError.createNoAccountFoundError=function(){return new ClientAuthError(pU.code,pU.desc)},ClientAuthError.createCachePluginError=function(){return new ClientAuthError(fU.code,""+fU.desc)},ClientAuthError.createNoCryptoObjectError=function(t){return new ClientAuthError(gU.code,""+gU.desc+t)},ClientAuthError.createInvalidCacheTypeError=function(){return new ClientAuthError(mU.code,""+mU.desc)},ClientAuthError.createUnexpectedAccountTypeError=function(){return new ClientAuthError(vU.code,""+vU.desc)},ClientAuthError.createUnexpectedCredentialTypeError=function(){return new ClientAuthError(yU.code,""+yU.desc)},ClientAuthError.createInvalidAssertionError=function(){return new ClientAuthError(bU.code,""+bU.desc)},ClientAuthError.createInvalidCredentialError=function(){return new ClientAuthError(wU.code,""+wU.desc)},ClientAuthError.createRefreshRequiredError=function(){return new ClientAuthError(CU.code,CU.desc)},ClientAuthError.createUserTimeoutReachedError=function(){return new ClientAuthError(_U.code,_U.desc)},ClientAuthError.createTokenClaimsRequiredError=function(){return new ClientAuthError(kU.code,kU.desc)},ClientAuthError.createNoAuthCodeInServerResponseError=function(){return new ClientAuthError(SU.code,SU.desc)},ClientAuthError.createBindingKeyNotRemovedError=function(){return new ClientAuthError(TU.code,TU.desc)},ClientAuthError.createLogoutNotSupportedError=function(){return new ClientAuthError(EU.code,EU.desc)},ClientAuthError.createKeyIdMissingError=function(){return new ClientAuthError(xU.code,xU.desc)},ClientAuthError.createNoNetworkConnectivityError=function(){return new ClientAuthError(IU.code,IU.desc)},ClientAuthError.createUserCanceledError=function(){return new ClientAuthError(AU.code,AU.desc)},ClientAuthError}(FL),RU=function(){function StringUtils(){}return StringUtils.decodeAuthToken=function(t){if(StringUtils.isEmpty(t))throw PU.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw PU.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},StringUtils.isEmpty=function(t){return void 0===t||!t||0===t.length},StringUtils.isEmptyObj=function(t){if(t&&!StringUtils.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(t){}return!0},StringUtils.startsWith=function(t,r){return 0===t.indexOf(r)},StringUtils.endsWith=function(t,r){return t.length>=r.length&&t.lastIndexOf(r)===t.length-r.length},StringUtils.queryStringToObject=function(t){var r={},o=t.split("&"),decode=function(t){return decodeURIComponent(t.replace(/\+/g," "))};return o.forEach((function(t){if(t.trim()){var o=t.split(/=(.+)/g,2),i=o[0],s=o[1];i&&s&&(r[decode(i)]=decode(s))}})),r},StringUtils.trimArrayEntries=function(t){return t.map((function(t){return t.trim()}))},StringUtils.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!StringUtils.isEmpty(t)}))},StringUtils.jsonParseHelper=function(t){try{return JSON.parse(t)}catch(t){return null}},StringUtils.matchPattern=function(t,r){return new RegExp(t.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(r)},StringUtils}();!function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace"}(NL||(NL={}));var OU,NU=function(){function Logger(t,r,o){this.level=NL.Info;var i=t||Logger.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||function(){},this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level="number"==typeof i.logLevel?i.logLevel:NL.Info,this.correlationId=i.correlationId||rL.EMPTY_STRING,this.packageName=r||rL.EMPTY_STRING,this.packageVersion=o||rL.EMPTY_STRING}return Logger.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:NL.Info}},Logger.prototype.clone=function(t,r,o){return new Logger({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:o||this.correlationId},t,r)},Logger.prototype.logMessage=function(t,r){if(!(r.logLevel>this.level||!this.piiLoggingEnabled&&r.containsPii)){var o=(new Date).toUTCString(),i=(RU.isEmpty(r.correlationId)?RU.isEmpty(this.correlationId)?"["+o+"]":"["+o+"] : ["+this.correlationId+"]":"["+o+"] : ["+r.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+NL[r.logLevel]+" - "+t;this.executeCallback(r.logLevel,i,r.containsPii||!1)}},Logger.prototype.executeCallback=function(t,r,o){this.localCallback&&this.localCallback(t,r,o)},Logger.prototype.error=function(t,r){this.logMessage(t,{logLevel:NL.Error,containsPii:!1,correlationId:r||rL.EMPTY_STRING})},Logger.prototype.errorPii=function(t,r){this.logMessage(t,{logLevel:NL.Error,containsPii:!0,correlationId:r||rL.EMPTY_STRING})},Logger.prototype.warning=function(t,r){this.logMessage(t,{logLevel:NL.Warning,containsPii:!1,correlationId:r||rL.EMPTY_STRING})},Logger.prototype.warningPii=function(t,r){this.logMessage(t,{logLevel:NL.Warning,containsPii:!0,correlationId:r||rL.EMPTY_STRING})},Logger.prototype.info=function(t,r){this.logMessage(t,{logLevel:NL.Info,containsPii:!1,correlationId:r||rL.EMPTY_STRING})},Logger.prototype.infoPii=function(t,r){this.logMessage(t,{logLevel:NL.Info,containsPii:!0,correlationId:r||rL.EMPTY_STRING})},Logger.prototype.verbose=function(t,r){this.logMessage(t,{logLevel:NL.Verbose,containsPii:!1,correlationId:r||rL.EMPTY_STRING})},Logger.prototype.verbosePii=function(t,r){this.logMessage(t,{logLevel:NL.Verbose,containsPii:!0,correlationId:r||rL.EMPTY_STRING})},Logger.prototype.trace=function(t,r){this.logMessage(t,{logLevel:NL.Trace,containsPii:!1,correlationId:r||rL.EMPTY_STRING})},Logger.prototype.tracePii=function(t,r){this.logMessage(t,{logLevel:NL.Trace,containsPii:!0,correlationId:r||rL.EMPTY_STRING})},Logger.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},Logger}(),MU="@azure/msal-common",DU="12.1.0";
/*! @azure/msal-common v12.1.0 2023-04-18 */!function(t){t[t.None=0]="None",t.AzurePublic="https://login.microsoftonline.com",t.AzurePpe="https://login.windows-ppe.net",t.AzureChina="https://login.chinacloudapi.cn",t.AzureGermany="https://login.microsoftonline.de",t.AzureUsGovernment="https://login.microsoftonline.us"}(OU||(OU={}));
/*! @azure/msal-common v12.1.0 2023-04-18 */
var FU,LU={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},UU={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},BU={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},HU={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},$U={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},qU={code:"empty_url_error",desc:"URL was empty or null."},jU={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},zU={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},GU={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},VU={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},KU={code:"token_request_empty",desc:"Token request was empty and not found in cache."},WU={code:"logout_request_empty",desc:"The logout request was null or undefined."},QU={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},YU={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},JU={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},XU={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},ZU={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},eB={code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},tB={code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},rB={code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},oB={code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},nB={code:"invalid_authentication_header",desc:"Invalid authentication header provided"},iB=function(t){function ClientConfigurationError(r,o){var i=t.call(this,r,o)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,ClientConfigurationError.prototype),i}return __extends(ClientConfigurationError,t),ClientConfigurationError.createRedirectUriEmptyError=function(){return new ClientConfigurationError(LU.code,LU.desc)},ClientConfigurationError.createPostLogoutRedirectUriEmptyError=function(){return new ClientConfigurationError(UU.code,UU.desc)},ClientConfigurationError.createClaimsRequestParsingError=function(t){return new ClientConfigurationError(BU.code,BU.desc+" Given value: "+t)},ClientConfigurationError.createInsecureAuthorityUriError=function(t){return new ClientConfigurationError(HU.code,HU.desc+" Given URI: "+t)},ClientConfigurationError.createUrlParseError=function(t){return new ClientConfigurationError($U.code,$U.desc+" Given Error: "+t)},ClientConfigurationError.createUrlEmptyError=function(){return new ClientConfigurationError(qU.code,qU.desc)},ClientConfigurationError.createEmptyScopesArrayError=function(){return new ClientConfigurationError(jU.code,""+jU.desc)},ClientConfigurationError.createClientIdSingleScopeError=function(t){return new ClientConfigurationError(zU.code,zU.desc+" Given Scopes: "+t)},ClientConfigurationError.createInvalidPromptError=function(t){return new ClientConfigurationError(GU.code,GU.desc+" Given value: "+t)},ClientConfigurationError.createInvalidClaimsRequestError=function(){return new ClientConfigurationError(VU.code,VU.desc)},ClientConfigurationError.createEmptyLogoutRequestError=function(){return new ClientConfigurationError(WU.code,WU.desc)},ClientConfigurationError.createEmptyTokenRequestError=function(){return new ClientConfigurationError(KU.code,KU.desc)},ClientConfigurationError.createInvalidCodeChallengeMethodError=function(){return new ClientConfigurationError(QU.code,QU.desc)},ClientConfigurationError.createInvalidCodeChallengeParamsError=function(){return new ClientConfigurationError(YU.code,YU.desc)},ClientConfigurationError.createInvalidCloudDiscoveryMetadataError=function(){return new ClientConfigurationError(JU.code,JU.desc)},ClientConfigurationError.createInvalidAuthorityMetadataError=function(){return new ClientConfigurationError(XU.code,XU.desc)},ClientConfigurationError.createUntrustedAuthorityError=function(){return new ClientConfigurationError(ZU.code,ZU.desc)},ClientConfigurationError.createInvalidAzureCloudInstanceError=function(){return new ClientConfigurationError(eB.code,eB.desc)},ClientConfigurationError.createMissingSshJwkError=function(){return new ClientConfigurationError(tB.code,tB.desc)},ClientConfigurationError.createMissingSshKidError=function(){return new ClientConfigurationError(rB.code,rB.desc)},ClientConfigurationError.createMissingNonceAuthenticationHeadersError=function(){return new ClientConfigurationError(oB.code,oB.desc)},ClientConfigurationError.createInvalidAuthenticationHeaderError=function(t,r){return new ClientConfigurationError(nB.code,nB.desc+". Invalid header: "+t+". Details: "+r)},ClientConfigurationError}(PU),sB=function(){function ScopeSet(t){var r=this,o=t?RU.trimArrayEntries(__spreadArrays(t)):[],i=o?RU.removeEmptyStringsFromArray(o):[];this.validateInputScopes(i),this.scopes=new Set,i.forEach((function(t){return r.scopes.add(t)}))}return ScopeSet.fromString=function(t){return new ScopeSet((t||rL.EMPTY_STRING).split(" "))},ScopeSet.createSearchScopes=function(t){var r=new ScopeSet(t);return r.containsOnlyOIDCScopes()?r.removeScope(rL.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r},ScopeSet.prototype.validateInputScopes=function(t){if(!t||t.length<1)throw iB.createEmptyScopesArrayError()},ScopeSet.prototype.containsScope=function(t){var r=new ScopeSet(this.printScopesLowerCase().split(" "));return!RU.isEmpty(t)&&r.scopes.has(t.toLowerCase())},ScopeSet.prototype.containsScopeSet=function(t){var r=this;return!(!t||t.scopes.size<=0)&&(this.scopes.size>=t.scopes.size&&t.asArray().every((function(t){return r.containsScope(t)})))},ScopeSet.prototype.containsOnlyOIDCScopes=function(){var t=this,r=0;return nL.forEach((function(o){t.containsScope(o)&&(r+=1)})),this.scopes.size===r},ScopeSet.prototype.appendScope=function(t){RU.isEmpty(t)||this.scopes.add(t.trim())},ScopeSet.prototype.appendScopes=function(t){var r=this;try{t.forEach((function(t){return r.appendScope(t)}))}catch(t){throw PU.createAppendScopeSetError(t)}},ScopeSet.prototype.removeScope=function(t){if(RU.isEmpty(t))throw PU.createRemoveEmptyScopeFromSetError(t);this.scopes.delete(t.trim())},ScopeSet.prototype.removeOIDCScopes=function(){var t=this;nL.forEach((function(r){t.scopes.delete(r)}))},ScopeSet.prototype.unionScopeSets=function(t){if(!t)throw PU.createEmptyInputScopeSetError();var r=new Set;return t.scopes.forEach((function(t){return r.add(t.toLowerCase())})),this.scopes.forEach((function(t){return r.add(t.toLowerCase())})),r},ScopeSet.prototype.intersectingScopeSets=function(t){if(!t)throw PU.createEmptyInputScopeSetError();t.containsOnlyOIDCScopes()||t.removeOIDCScopes();var r=this.unionScopeSets(t),o=t.getScopeCount(),i=this.getScopeCount();return r.size<i+o},ScopeSet.prototype.getScopeCount=function(){return this.scopes.size},ScopeSet.prototype.asArray=function(){var t=[];return this.scopes.forEach((function(r){return t.push(r)})),t},ScopeSet.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):rL.EMPTY_STRING},ScopeSet.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},ScopeSet}();
/*! @azure/msal-common v12.1.0 2023-04-18 */
function buildClientInfo(t,r){if(RU.isEmpty(t))throw PU.createClientInfoEmptyError();try{var o=r.base64Decode(t);return JSON.parse(o)}catch(t){throw PU.createClientInfoDecodingError(t.message)}}function buildClientInfoFromHomeAccountId(t){if(RU.isEmpty(t))throw PU.createClientInfoDecodingError("Home account ID was empty.");var r=t.split(dL.CLIENT_INFO_SEPARATOR,2);return{uid:r[0],utid:r.length<2?rL.EMPTY_STRING:r[1]}}
/*! @azure/msal-common v12.1.0 2023-04-18 */!function(t){t[t.Default=0]="Default",t[t.Adfs=1]="Adfs",t[t.Dsts=2]="Dsts",t[t.Ciam=3]="Ciam"}(FU||(FU={}));
/*! @azure/msal-common v12.1.0 2023-04-18 */
var aB=function(){function AccountEntity(){}return AccountEntity.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(dL.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.prototype.generateAccountKey=function(){return AccountEntity.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},AccountEntity.prototype.generateType=function(){switch(this.authorityType){case lL.ADFS_ACCOUNT_TYPE:return hL.ADFS;case lL.MSAV1_ACCOUNT_TYPE:return hL.MSA;case lL.MSSTS_ACCOUNT_TYPE:return hL.MSSTS;case lL.GENERIC_ACCOUNT_TYPE:return hL.GENERIC;default:throw PU.createUnexpectedAccountTypeError()}},AccountEntity.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},AccountEntity.generateAccountCacheKey=function(t){return[t.homeAccountId,t.environment||rL.EMPTY_STRING,t.tenantId||rL.EMPTY_STRING].join(dL.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.createAccount=function(t,r,o,i,s,l,u,h){var m,v,C,_,k,E,R=new AccountEntity;R.authorityType=lL.MSSTS_ACCOUNT_TYPE,R.clientInfo=t,R.homeAccountId=r,R.nativeAccountId=h;var N=u||i&&i.getPreferredCache();if(!N)throw PU.createInvalidCacheEnvironmentError();if(R.environment=N,R.realm=(null===(m=null==o?void 0:o.claims)||void 0===m?void 0:m.tid)||rL.EMPTY_STRING,o){R.idTokenClaims=o.claims,R.localAccountId=(null===(v=null==o?void 0:o.claims)||void 0===v?void 0:v.oid)||(null===(C=null==o?void 0:o.claims)||void 0===C?void 0:C.sub)||rL.EMPTY_STRING;var M=null===(_=null==o?void 0:o.claims)||void 0===_?void 0:_.preferred_username,B=(null===(k=null==o?void 0:o.claims)||void 0===k?void 0:k.emails)?o.claims.emails[0]:null;R.username=M||B||rL.EMPTY_STRING,R.name=null===(E=null==o?void 0:o.claims)||void 0===E?void 0:E.name}return R.cloudGraphHostName=s,R.msGraphHost=l,R},AccountEntity.createGenericAccount=function(t,r,o,i,s,l){var u,h,m,v,C=new AccountEntity;C.authorityType=o&&o.authorityType===FU.Adfs?lL.ADFS_ACCOUNT_TYPE:lL.GENERIC_ACCOUNT_TYPE,C.homeAccountId=t,C.realm=rL.EMPTY_STRING;var _=l||o&&o.getPreferredCache();if(!_)throw PU.createInvalidCacheEnvironmentError();return r&&(C.localAccountId=(null===(u=null==r?void 0:r.claims)||void 0===u?void 0:u.oid)||(null===(h=null==r?void 0:r.claims)||void 0===h?void 0:h.sub)||rL.EMPTY_STRING,C.username=(null===(m=null==r?void 0:r.claims)||void 0===m?void 0:m.upn)||rL.EMPTY_STRING,C.name=(null===(v=null==r?void 0:r.claims)||void 0===v?void 0:v.name)||rL.EMPTY_STRING,C.idTokenClaims=null==r?void 0:r.claims),C.environment=_,C.cloudGraphHostName=i,C.msGraphHost=s,C},AccountEntity.generateHomeAccountId=function(t,r,o,i,s){var l,u=(null===(l=null==s?void 0:s.claims)||void 0===l?void 0:l.sub)?s.claims.sub:rL.EMPTY_STRING;if(r===FU.Adfs||r===FU.Dsts)return u;if(t)try{var h=buildClientInfo(t,i);if(!RU.isEmpty(h.uid)&&!RU.isEmpty(h.utid))return""+h.uid+dL.CLIENT_INFO_SEPARATOR+h.utid}catch(t){}return o.verbose("No client info in response"),u},AccountEntity.isAccountEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("localAccountId")&&t.hasOwnProperty("username")&&t.hasOwnProperty("authorityType"))},AccountEntity.accountInfoIsEqual=function(t,r,o){if(!t||!r)return!1;var i=!0;if(o){var s=t.idTokenClaims||{},l=r.idTokenClaims||{};i=s.iat===l.iat&&s.nonce===l.nonce}return t.homeAccountId===r.homeAccountId&&t.localAccountId===r.localAccountId&&t.username===r.username&&t.tenantId===r.tenantId&&t.environment===r.environment&&t.nativeAccountId===r.nativeAccountId&&i},AccountEntity}(),cB=function(){function AuthToken(t,r){if(RU.isEmpty(t))throw PU.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=AuthToken.extractTokenClaims(t,r)}return AuthToken.extractTokenClaims=function(t,r){var o=RU.decodeAuthToken(t);try{var i=o.JWSPayload,s=r.base64Decode(i);return JSON.parse(s)}catch(t){throw PU.createTokenParsingError(t)}},AuthToken.checkMaxAge=function(t,r){if(0===r||Date.now()-3e5>t+r)throw PU.createMaxAgeTranspiredError()},AuthToken}(),lB=function(){function CacheManager(t,r,o){this.clientId=t,this.cryptoImpl=r,this.commonLogger=o.clone(MU,DU)}return CacheManager.prototype.getAllAccounts=function(){var t=this,r=this.getAccountKeys();if(r.length<1)return[];var o=r.reduce((function(r,o){var i=t.getAccount(o);return i?(r.push(i),r):r}),[]);return o.length<1?[]:o.map((function(r){return t.getAccountInfoFromEntity(r)}))},CacheManager.prototype.getAccountInfoFilteredBy=function(t){var r=this.getAccountsFilteredBy(t);return r.length>0?this.getAccountInfoFromEntity(r[0]):null},CacheManager.prototype.getAccountInfoFromEntity=function(t){var r=t.getAccountInfo(),o=this.getIdToken(r);return o&&(r.idToken=o.secret,r.idTokenClaims=new cB(o.secret,this.cryptoImpl).claims),r},CacheManager.prototype.saveCacheRecord=function(t){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(r){switch(r.label){case 0:if(!t)throw PU.createNullOrUndefinedCacheRecord();return t.account&&this.setAccount(t.account),t.idToken&&this.setIdTokenCredential(t.idToken),t.accessToken?[4,this.saveAccessToken(t.accessToken)]:[3,2];case 1:r.sent(),r.label=2;case 2:return t.refreshToken&&this.setRefreshTokenCredential(t.refreshToken),t.appMetadata&&this.setAppMetadata(t.appMetadata),[2]}}))}))},CacheManager.prototype.saveAccessToken=function(t){return __awaiter$2(this,void 0,void 0,(function(){var r,o,i,s,l=this;return __generator(this,(function(u){switch(u.label){case 0:return r={clientId:t.clientId,credentialType:t.credentialType,environment:t.environment,homeAccountId:t.homeAccountId,realm:t.realm,tokenType:t.tokenType,requestedClaimsHash:t.requestedClaimsHash},o=this.getTokenKeys(),i=sB.fromString(t.target),s=[],o.accessToken.forEach((function(t){if(l.accessTokenKeyMatchesFilter(t,r,!1)){var o=l.getAccessTokenCredential(t);if(o&&l.credentialMatchesFilter(o,r))sB.fromString(o.target).intersectingScopeSets(i)&&s.push(l.removeAccessToken(t))}})),[4,Promise.all(s)];case 1:return u.sent(),this.setAccessTokenCredential(t),[2]}}))}))},CacheManager.prototype.getAccountsFilteredBy=function(t){var r=this,o=this.getAccountKeys(),i=[];return o.forEach((function(o){if(r.isAccountKey(o,t.homeAccountId,t.realm)){var s=r.getAccount(o);s&&(t.homeAccountId&&!r.matchHomeAccountId(s,t.homeAccountId)||t.localAccountId&&!r.matchLocalAccountId(s,t.localAccountId)||t.username&&!r.matchUsername(s,t.username)||t.environment&&!r.matchEnvironment(s,t.environment)||t.realm&&!r.matchRealm(s,t.realm)||t.nativeAccountId&&!r.matchNativeAccountId(s,t.nativeAccountId)||i.push(s))}})),i},CacheManager.prototype.isAccountKey=function(t,r,o){return!(t.split(dL.CACHE_KEY_SEPARATOR).length<3)&&(!(r&&!t.toLowerCase().includes(r.toLowerCase()))&&!(o&&!t.toLowerCase().includes(o.toLowerCase())))},CacheManager.prototype.isCredentialKey=function(t){if(t.split(dL.CACHE_KEY_SEPARATOR).length<6)return!1;var r=t.toLowerCase();if(-1===r.indexOf(uL.ID_TOKEN.toLowerCase())&&-1===r.indexOf(uL.ACCESS_TOKEN.toLowerCase())&&-1===r.indexOf(uL.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===r.indexOf(uL.REFRESH_TOKEN.toLowerCase()))return!1;if(r.indexOf(uL.REFRESH_TOKEN.toLowerCase())>-1){var o=""+uL.REFRESH_TOKEN+dL.CACHE_KEY_SEPARATOR+this.clientId+dL.CACHE_KEY_SEPARATOR,i=""+uL.REFRESH_TOKEN+dL.CACHE_KEY_SEPARATOR+mL+dL.CACHE_KEY_SEPARATOR;if(-1===r.indexOf(o.toLowerCase())&&-1===r.indexOf(i.toLowerCase()))return!1}else if(-1===r.indexOf(this.clientId.toLowerCase()))return!1;return!0},CacheManager.prototype.credentialMatchesFilter=function(t,r){if(r.clientId&&!this.matchClientId(t,r.clientId))return!1;if(r.userAssertionHash&&!this.matchUserAssertionHash(t,r.userAssertionHash))return!1;if("string"==typeof r.homeAccountId&&!this.matchHomeAccountId(t,r.homeAccountId))return!1;if(r.environment&&!this.matchEnvironment(t,r.environment))return!1;if(r.realm&&!this.matchRealm(t,r.realm))return!1;if(r.credentialType&&!this.matchCredentialType(t,r.credentialType))return!1;if(r.familyId&&!this.matchFamilyId(t,r.familyId))return!1;if(r.target&&!this.matchTarget(t,r.target))return!1;if((r.requestedClaimsHash||t.requestedClaimsHash)&&t.requestedClaimsHash!==r.requestedClaimsHash)return!1;if(t.credentialType===uL.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(r.tokenType&&!this.matchTokenType(t,r.tokenType))return!1;if(r.tokenType===bL.SSH&&r.keyId&&!this.matchKeyId(t,r.keyId))return!1}return!0},CacheManager.prototype.getAppMetadataFilteredBy=function(t){return this.getAppMetadataFilteredByInternal(t.environment,t.clientId)},CacheManager.prototype.getAppMetadataFilteredByInternal=function(t,r){var o=this,i=this.getKeys(),s={};return i.forEach((function(i){if(o.isAppMetadata(i)){var l=o.getAppMetadata(i);l&&(t&&!o.matchEnvironment(l,t)||r&&!o.matchClientId(l,r)||(s[i]=l))}})),s},CacheManager.prototype.getAuthorityMetadataByAlias=function(t){var r=this,o=this.getAuthorityMetadataKeys(),i=null;return o.forEach((function(o){if(r.isAuthorityMetadata(o)&&-1!==o.indexOf(r.clientId)){var s=r.getAuthorityMetadata(o);s&&-1!==s.aliases.indexOf(t)&&(i=s)}})),i},CacheManager.prototype.removeAllAccounts=function(){return __awaiter$2(this,void 0,void 0,(function(){var t,r,o=this;return __generator(this,(function(i){switch(i.label){case 0:return t=this.getAccountKeys(),r=[],t.forEach((function(t){r.push(o.removeAccount(t))})),[4,Promise.all(r)];case 1:return i.sent(),[2]}}))}))},CacheManager.prototype.removeAccount=function(t){return __awaiter$2(this,void 0,void 0,(function(){var r;return __generator(this,(function(o){switch(o.label){case 0:if(!(r=this.getAccount(t)))throw PU.createNoAccountFoundError();return[4,this.removeAccountContext(r)];case 1:return o.sent(),this.removeItem(t),[2]}}))}))},CacheManager.prototype.removeAccountContext=function(t){return __awaiter$2(this,void 0,void 0,(function(){var r,o,i,s=this;return __generator(this,(function(l){switch(l.label){case 0:return r=this.getTokenKeys(),o=t.generateAccountId(),i=[],r.idToken.forEach((function(t){0===t.indexOf(o)&&s.removeIdToken(t)})),r.accessToken.forEach((function(t){0===t.indexOf(o)&&i.push(s.removeAccessToken(t))})),r.refreshToken.forEach((function(t){0===t.indexOf(o)&&s.removeRefreshToken(t)})),[4,Promise.all(i)];case 1:return l.sent(),[2]}}))}))},CacheManager.prototype.removeAccessToken=function(t){return __awaiter$2(this,void 0,void 0,(function(){var r,o;return __generator(this,(function(i){switch(i.label){case 0:if(!(r=this.getAccessTokenCredential(t)))return[2];if(r.credentialType.toLowerCase()!==uL.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(r.tokenType!==bL.POP)return[3,4];if(!(o=r.keyId))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(o)];case 2:return i.sent(),[3,4];case 3:throw i.sent(),PU.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t)]}}))}))},CacheManager.prototype.removeAppMetadata=function(){var t=this;return this.getKeys().forEach((function(r){t.isAppMetadata(r)&&t.removeItem(r)})),!0},CacheManager.prototype.readCacheRecord=function(t,r,o){var i=this.getTokenKeys(),s=this.readAccountFromCache(t),l=this.getIdToken(t,i),u=this.getAccessToken(t,r,i),h=this.getRefreshToken(t,!1,i),m=this.readAppMetadataFromCache(o);return s&&l&&(s.idTokenClaims=new cB(l.secret,this.cryptoImpl).claims),{account:s,idToken:l,accessToken:u,refreshToken:h,appMetadata:m}},CacheManager.prototype.readAccountFromCache=function(t){var r=aB.generateAccountCacheKey(t);return this.getAccount(r)},CacheManager.prototype.getIdToken=function(t,r){this.commonLogger.trace("CacheManager - getIdToken called");var o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:uL.ID_TOKEN,clientId:this.clientId,realm:t.tenantId},i=this.getIdTokensByFilter(o,r),s=i.length;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1)throw PU.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getIdToken - Returning id token"),i[0]},CacheManager.prototype.getIdTokensByFilter=function(t,r){var o=this,i=r&&r.idToken||this.getTokenKeys().idToken,s=[];return i.forEach((function(r){if(o.idTokenKeyMatchesFilter(r,__assign({clientId:o.clientId},t))){var i=o.getIdTokenCredential(r);i&&o.credentialMatchesFilter(i,t)&&s.push(i)}})),s},CacheManager.prototype.idTokenKeyMatchesFilter=function(t,r){var o=t.toLowerCase();return(!r.clientId||-1!==o.indexOf(r.clientId.toLowerCase()))&&(!r.homeAccountId||-1!==o.indexOf(r.homeAccountId.toLowerCase()))},CacheManager.prototype.removeIdToken=function(t){this.removeItem(t)},CacheManager.prototype.removeRefreshToken=function(t){this.removeItem(t)},CacheManager.prototype.getAccessToken=function(t,r,o){var i=this;this.commonLogger.trace("CacheManager - getAccessToken called");var s=sB.createSearchScopes(r.scopes),l=r.authenticationScheme||bL.BEARER,u=l&&l.toLowerCase()!==bL.BEARER.toLowerCase()?uL.ACCESS_TOKEN_WITH_AUTH_SCHEME:uL.ACCESS_TOKEN,h={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:u,clientId:this.clientId,realm:t.tenantId,target:s,tokenType:l,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash},m=o&&o.accessToken||this.getTokenKeys().accessToken,v=[];m.forEach((function(t){if(i.accessTokenKeyMatchesFilter(t,h,!0)){var r=i.getAccessTokenCredential(t);r&&i.credentialMatchesFilter(r,h)&&v.push(r)}}));var C=v.length;if(C<1)return this.commonLogger.info("CacheManager:getAccessToken - No token found"),null;if(C>1)throw PU.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),v[0]},CacheManager.prototype.accessTokenKeyMatchesFilter=function(t,r,o){var i=t.toLowerCase();if(r.clientId&&-1===i.indexOf(r.clientId.toLowerCase()))return!1;if(r.homeAccountId&&-1===i.indexOf(r.homeAccountId.toLowerCase()))return!1;if(r.realm&&-1===i.indexOf(r.realm.toLowerCase()))return!1;if(r.requestedClaimsHash&&-1===i.indexOf(r.requestedClaimsHash.toLowerCase()))return!1;if(r.target)for(var s=r.target.asArray(),l=0;l<s.length;l++){if(o&&!i.includes(s[l].toLowerCase()))return!1;if(!o&&i.includes(s[l].toLowerCase()))return!0}return!0},CacheManager.prototype.getAccessTokensByFilter=function(t){var r=this,o=this.getTokenKeys(),i=[];return o.accessToken.forEach((function(o){if(r.accessTokenKeyMatchesFilter(o,t,!0)){var s=r.getAccessTokenCredential(o);s&&r.credentialMatchesFilter(s,t)&&i.push(s)}})),i},CacheManager.prototype.getRefreshToken=function(t,r,o){var i=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var s=r?mL:void 0,l={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:uL.REFRESH_TOKEN,clientId:this.clientId,familyId:s},u=o&&o.refreshToken||this.getTokenKeys().refreshToken,h=[];return u.forEach((function(t){if(i.refreshTokenKeyMatchesFilter(t,l)){var r=i.getRefreshTokenCredential(t);r&&i.credentialMatchesFilter(r,l)&&h.push(r)}})),h.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),h[0])},CacheManager.prototype.refreshTokenKeyMatchesFilter=function(t,r){var o=t.toLowerCase();return(!r.familyId||-1!==o.indexOf(r.familyId.toLowerCase()))&&(!(!r.familyId&&r.clientId&&-1===o.indexOf(r.clientId.toLowerCase()))&&(!r.homeAccountId||-1!==o.indexOf(r.homeAccountId.toLowerCase())))},CacheManager.prototype.readAppMetadataFromCache=function(t){var r={environment:t,clientId:this.clientId},o=this.getAppMetadataFilteredBy(r),i=Object.keys(o).map((function(t){return o[t]})),s=i.length;if(s<1)return null;if(s>1)throw PU.createMultipleMatchingAppMetadataInCacheError();return i[0]},CacheManager.prototype.isAppMetadataFOCI=function(t){var r=this.readAppMetadataFromCache(t);return!(!r||r.familyId!==mL)},CacheManager.prototype.matchHomeAccountId=function(t,r){return!("string"!=typeof t.homeAccountId||r!==t.homeAccountId)},CacheManager.prototype.matchLocalAccountId=function(t,r){return!("string"!=typeof t.localAccountId||r!==t.localAccountId)},CacheManager.prototype.matchUsername=function(t,r){return!("string"!=typeof t.username||r.toLowerCase()!==t.username.toLowerCase())},CacheManager.prototype.matchUserAssertionHash=function(t,r){return!(!t.userAssertionHash||r!==t.userAssertionHash)},CacheManager.prototype.matchEnvironment=function(t,r){var o=this.getAuthorityMetadataByAlias(r);return!!(o&&o.aliases.indexOf(t.environment)>-1)},CacheManager.prototype.matchCredentialType=function(t,r){return t.credentialType&&r.toLowerCase()===t.credentialType.toLowerCase()},CacheManager.prototype.matchClientId=function(t,r){return!(!t.clientId||r!==t.clientId)},CacheManager.prototype.matchFamilyId=function(t,r){return!(!t.familyId||r!==t.familyId)},CacheManager.prototype.matchRealm=function(t,r){return!(!t.realm||r!==t.realm)},CacheManager.prototype.matchNativeAccountId=function(t,r){return!(!t.nativeAccountId||r!==t.nativeAccountId)},CacheManager.prototype.matchTarget=function(t,r){return!(t.credentialType!==uL.ACCESS_TOKEN&&t.credentialType!==uL.ACCESS_TOKEN_WITH_AUTH_SCHEME||!t.target)&&sB.fromString(t.target).containsScopeSet(r)},CacheManager.prototype.matchTokenType=function(t,r){return!(!t.tokenType||t.tokenType!==r)},CacheManager.prototype.matchKeyId=function(t,r){return!(!t.keyId||t.keyId!==r)},CacheManager.prototype.isAppMetadata=function(t){return-1!==t.indexOf(gL)},CacheManager.prototype.isAuthorityMetadata=function(t){return-1!==t.indexOf(vL)},CacheManager.prototype.generateAuthorityMetadataCacheKey=function(t){return vL+"-"+this.clientId+"-"+t},CacheManager.toObject=function(t,r){for(var o in r)t[o]=r[o];return t},CacheManager}(),dB=function(t){function DefaultStorageClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(DefaultStorageClass,t),DefaultStorageClass.prototype.setAccount=function(){throw FL.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccount=function(){throw FL.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setIdTokenCredential=function(){throw FL.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getIdTokenCredential=function(){throw FL.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAccessTokenCredential=function(){throw FL.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccessTokenCredential=function(){throw FL.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setRefreshTokenCredential=function(){throw FL.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getRefreshTokenCredential=function(){throw FL.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAppMetadata=function(){throw FL.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAppMetadata=function(){throw FL.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setServerTelemetry=function(){throw FL.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getServerTelemetry=function(){throw FL.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAuthorityMetadata=function(){throw FL.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAuthorityMetadata=function(){throw FL.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAuthorityMetadataKeys=function(){throw FL.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setThrottlingCache=function(){throw FL.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getThrottlingCache=function(){throw FL.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.removeItem=function(){throw FL.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.containsKey=function(){throw FL.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getKeys=function(){throw FL.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccountKeys=function(){throw FL.createUnexpectedError("Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getTokenKeys=function(){throw FL.createUnexpectedError("Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.clear=function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",FL.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},DefaultStorageClass.prototype.updateCredentialCacheKey=function(){throw FL.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass}(lB),uB={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},hB={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:NL.Info,correlationId:rL.EMPTY_STRING},pB={sendGetRequestAsync:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Network interface - sendGetRequestAsync() has not been implemented",FL.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Network interface - sendPostRequestAsync() has not been implemented",FL.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},fB={sku:rL.SKU,version:DU,cpu:rL.EMPTY_STRING,os:rL.EMPTY_STRING},gB={clientSecret:rL.EMPTY_STRING,clientAssertion:void 0},mB={azureCloudInstance:OU.None,tenant:""+rL.DEFAULT_COMMON_TENANT},vB={application:{appName:"",appVersion:""}};
/*! @azure/msal-common v12.1.0 2023-04-18 */
/*! @azure/msal-common v12.1.0 2023-04-18 */
var yB,bB=function(t){function ServerError(r,o,i){var s=t.call(this,r,o,i)||this;return s.name="ServerError",Object.setPrototypeOf(s,ServerError.prototype),s}return __extends(ServerError,t),ServerError}(FL),wB=function(){function ThrottlingUtils(){}return ThrottlingUtils.generateThrottlingStorageKey=function(t){return AL+"."+JSON.stringify(t)},ThrottlingUtils.preProcess=function(t,r){var o,i=ThrottlingUtils.generateThrottlingStorageKey(r),s=t.getThrottlingCache(i);if(s){if(s.throttleTime<Date.now())return void t.removeItem(i);throw new bB((null===(o=s.errorCodes)||void 0===o?void 0:o.join(" "))||rL.EMPTY_STRING,s.errorMessage,s.subError)}},ThrottlingUtils.postProcess=function(t,r,o){if(ThrottlingUtils.checkResponseStatus(o)||ThrottlingUtils.checkResponseForRetryAfter(o)){var i={throttleTime:ThrottlingUtils.calculateThrottleTime(parseInt(o.headers[JF.RETRY_AFTER])),error:o.body.error,errorCodes:o.body.error_codes,errorMessage:o.body.error_description,subError:o.body.suberror};t.setThrottlingCache(ThrottlingUtils.generateThrottlingStorageKey(r),i)}},ThrottlingUtils.checkResponseStatus=function(t){return 429===t.status||t.status>=500&&t.status<600},ThrottlingUtils.checkResponseForRetryAfter=function(t){return!!t.headers&&(t.headers.hasOwnProperty(JF.RETRY_AFTER)&&(t.status<200||t.status>=300))},ThrottlingUtils.calculateThrottleTime=function(t){var r=t<=0?0:t,o=Date.now()/1e3;return Math.floor(1e3*Math.min(o+(r||xL),o+IL))},ThrottlingUtils.removeThrottle=function(t,r,o,i){var s={clientId:r,authority:o.authority,scopes:o.scopes,homeAccountIdentifier:i,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},l=this.generateThrottlingStorageKey(s);t.removeItem(l)},ThrottlingUtils}(),CB=function(){function NetworkManager(t,r){this.networkClient=t,this.cacheManager=r}return NetworkManager.prototype.sendPostRequest=function(t,r,o){return __awaiter$2(this,void 0,void 0,(function(){var i,s;return __generator(this,(function(l){switch(l.label){case 0:wB.preProcess(this.cacheManager,t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(r,o)];case 2:return i=l.sent(),[3,4];case 3:throw(s=l.sent())instanceof FL?s:PU.createNetworkError(r,s);case 4:return wB.postProcess(this.cacheManager,t,i),[2,i]}}))}))},NetworkManager}();
/*! @azure/msal-common v12.1.0 2023-04-18 */!function(t){t.HOME_ACCOUNT_ID="home_account_id",t.UPN="UPN"}(yB||(yB={}));
/*! @azure/msal-common v12.1.0 2023-04-18 */
var _B,kB,SB=function(){function RequestValidator(){}return RequestValidator.validateRedirectUri=function(t){if(RU.isEmpty(t))throw iB.createRedirectUriEmptyError()},RequestValidator.validatePrompt=function(t){var r=[];for(var o in sL)r.push(sL[o]);if(r.indexOf(t)<0)throw iB.createInvalidPromptError(t)},RequestValidator.validateClaims=function(t){try{JSON.parse(t)}catch(t){throw iB.createInvalidClaimsRequestError()}},RequestValidator.validateCodeChallengeParams=function(t,r){if(RU.isEmpty(t)||RU.isEmpty(r))throw iB.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(r)},RequestValidator.validateCodeChallengeMethod=function(t){if([pL.PLAIN,pL.S256].indexOf(t)<0)throw iB.createInvalidCodeChallengeMethodError()},RequestValidator.sanitizeEQParams=function(t,r){return t?(r.forEach((function(r,o){t[o]&&delete t[o]})),Object.fromEntries(Object.entries(t).filter((function(t){return""!==t[1]})))):{}},RequestValidator}(),TB=function(){function RequestParameterBuilder(){this.parameters=new Map}return RequestParameterBuilder.prototype.addResponseTypeCode=function(){this.parameters.set(eL.RESPONSE_TYPE,encodeURIComponent(rL.CODE_RESPONSE_TYPE))},RequestParameterBuilder.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(eL.RESPONSE_TYPE,encodeURIComponent(rL.TOKEN_RESPONSE_TYPE+" "+rL.ID_TOKEN_RESPONSE_TYPE))},RequestParameterBuilder.prototype.addResponseMode=function(t){this.parameters.set(eL.RESPONSE_MODE,encodeURIComponent(t||aL.QUERY))},RequestParameterBuilder.prototype.addNativeBroker=function(){this.parameters.set(eL.NATIVE_BROKER,encodeURIComponent("1"))},RequestParameterBuilder.prototype.addScopes=function(t,r){void 0===r&&(r=!0);var o=r?__spreadArrays(t||[],oL):t||[],i=new sB(o);this.parameters.set(eL.SCOPE,encodeURIComponent(i.printScopes()))},RequestParameterBuilder.prototype.addClientId=function(t){this.parameters.set(eL.CLIENT_ID,encodeURIComponent(t))},RequestParameterBuilder.prototype.addRedirectUri=function(t){SB.validateRedirectUri(t),this.parameters.set(eL.REDIRECT_URI,encodeURIComponent(t))},RequestParameterBuilder.prototype.addPostLogoutRedirectUri=function(t){SB.validateRedirectUri(t),this.parameters.set(eL.POST_LOGOUT_URI,encodeURIComponent(t))},RequestParameterBuilder.prototype.addIdTokenHint=function(t){this.parameters.set(eL.ID_TOKEN_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addDomainHint=function(t){this.parameters.set(iL.DOMAIN_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addLoginHint=function(t){this.parameters.set(iL.LOGIN_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addCcsUpn=function(t){this.parameters.set(JF.CCS_HEADER,encodeURIComponent("UPN:"+t))},RequestParameterBuilder.prototype.addCcsOid=function(t){this.parameters.set(JF.CCS_HEADER,encodeURIComponent("Oid:"+t.uid+"@"+t.utid))},RequestParameterBuilder.prototype.addSid=function(t){this.parameters.set(iL.SID,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClaims=function(t,r){var o=this.addClientCapabilitiesToClaims(t,r);SB.validateClaims(o),this.parameters.set(eL.CLAIMS,encodeURIComponent(o))},RequestParameterBuilder.prototype.addCorrelationId=function(t){this.parameters.set(eL.CLIENT_REQUEST_ID,encodeURIComponent(t))},RequestParameterBuilder.prototype.addLibraryInfo=function(t){this.parameters.set(eL.X_CLIENT_SKU,t.sku),this.parameters.set(eL.X_CLIENT_VER,t.version),t.os&&this.parameters.set(eL.X_CLIENT_OS,t.os),t.cpu&&this.parameters.set(eL.X_CLIENT_CPU,t.cpu)},RequestParameterBuilder.prototype.addApplicationTelemetry=function(t){(null==t?void 0:t.appName)&&this.parameters.set(eL.X_APP_NAME,t.appName),(null==t?void 0:t.appVersion)&&this.parameters.set(eL.X_APP_VER,t.appVersion)},RequestParameterBuilder.prototype.addPrompt=function(t){SB.validatePrompt(t),this.parameters.set(""+eL.PROMPT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addState=function(t){RU.isEmpty(t)||this.parameters.set(eL.STATE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addNonce=function(t){this.parameters.set(eL.NONCE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addCodeChallengeParams=function(t,r){if(SB.validateCodeChallengeParams(t,r),!t||!r)throw iB.createInvalidCodeChallengeParamsError();this.parameters.set(eL.CODE_CHALLENGE,encodeURIComponent(t)),this.parameters.set(eL.CODE_CHALLENGE_METHOD,encodeURIComponent(r))},RequestParameterBuilder.prototype.addAuthorizationCode=function(t){this.parameters.set(eL.CODE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addDeviceCode=function(t){this.parameters.set(eL.DEVICE_CODE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addRefreshToken=function(t){this.parameters.set(eL.REFRESH_TOKEN,encodeURIComponent(t))},RequestParameterBuilder.prototype.addCodeVerifier=function(t){this.parameters.set(eL.CODE_VERIFIER,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientSecret=function(t){this.parameters.set(eL.CLIENT_SECRET,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientAssertion=function(t){RU.isEmpty(t)||this.parameters.set(eL.CLIENT_ASSERTION,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientAssertionType=function(t){RU.isEmpty(t)||this.parameters.set(eL.CLIENT_ASSERTION_TYPE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addOboAssertion=function(t){this.parameters.set(eL.OBO_ASSERTION,encodeURIComponent(t))},RequestParameterBuilder.prototype.addRequestTokenUse=function(t){this.parameters.set(eL.REQUESTED_TOKEN_USE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addGrantType=function(t){this.parameters.set(eL.GRANT_TYPE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},RequestParameterBuilder.prototype.addExtraQueryParameters=function(t){var r=this,o=SB.sanitizeEQParams(t,this.parameters);Object.keys(o).forEach((function(o){r.parameters.set(o,t[o])}))},RequestParameterBuilder.prototype.addClientCapabilitiesToClaims=function(t,r){var o;if(t)try{o=JSON.parse(t)}catch(t){throw iB.createInvalidClaimsRequestError()}else o={};return r&&r.length>0&&(o.hasOwnProperty(tL.ACCESS_TOKEN)||(o[tL.ACCESS_TOKEN]={}),o[tL.ACCESS_TOKEN][tL.XMS_CC]={values:r}),JSON.stringify(o)},RequestParameterBuilder.prototype.addUsername=function(t){this.parameters.set(CL.username,encodeURIComponent(t))},RequestParameterBuilder.prototype.addPassword=function(t){this.parameters.set(CL.password,encodeURIComponent(t))},RequestParameterBuilder.prototype.addPopToken=function(t){RU.isEmpty(t)||(this.parameters.set(eL.TOKEN_TYPE,bL.POP),this.parameters.set(eL.REQ_CNF,encodeURIComponent(t)))},RequestParameterBuilder.prototype.addSshJwk=function(t){RU.isEmpty(t)||(this.parameters.set(eL.TOKEN_TYPE,bL.SSH),this.parameters.set(eL.REQ_CNF,encodeURIComponent(t)))},RequestParameterBuilder.prototype.addServerTelemetry=function(t){this.parameters.set(eL.X_CLIENT_CURR_TELEM,t.generateCurrentRequestHeaderValue()),this.parameters.set(eL.X_CLIENT_LAST_TELEM,t.generateLastRequestHeaderValue())},RequestParameterBuilder.prototype.addThrottling=function(){this.parameters.set(eL.X_MS_LIB_CAPABILITY,PL)},RequestParameterBuilder.prototype.addLogoutHint=function(t){this.parameters.set(eL.LOGOUT_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.createQueryString=function(){var t=new Array;return this.parameters.forEach((function(r,o){t.push(o+"="+r)})),t.join("&")},RequestParameterBuilder}(),EB=function(){function BaseClient(t,r){this.config=function buildClientConfiguration(t){var r,o=t.authOptions,i=t.systemOptions,s=t.loggerOptions,l=t.storageInterface,u=t.networkInterface,h=t.cryptoInterface,m=t.clientCredentials,v=t.libraryInfo,C=t.telemetry,_=t.serverTelemetryManager,k=t.persistencePlugin,E=t.serializableCache,R=__assign(__assign({},hB),s);return{authOptions:(r=o,__assign({clientCapabilities:[],azureCloudOptions:mB,skipAuthorityMetadataCache:!1},r)),systemOptions:__assign(__assign({},uB),i),loggerOptions:R,storageInterface:l||new dB(o.clientId,LL,new NU(R)),networkInterface:u||pB,cryptoInterface:h||LL,clientCredentials:m||gB,libraryInfo:__assign(__assign({},fB),v),telemetry:__assign(__assign({},vB),C),serverTelemetryManager:_||null,persistencePlugin:k||null,serializableCache:E||null}}(t),this.logger=new NU(this.config.loggerOptions,MU,DU),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new CB(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=r}return BaseClient.prototype.createTokenRequestHeaders=function(t){var r={};if(r[JF.CONTENT_TYPE]=rL.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&t)switch(t.type){case yB.HOME_ACCOUNT_ID:try{var o=buildClientInfoFromHomeAccountId(t.credential);r[JF.CCS_HEADER]="Oid:"+o.uid+"@"+o.utid}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case yB.UPN:r[JF.CCS_HEADER]="UPN: "+t.credential}return r},BaseClient.prototype.executePostToTokenEndpoint=function(t,r,o,i){return __awaiter$2(this,void 0,void 0,(function(){var s;return __generator(this,(function(l){switch(l.label){case 0:return[4,this.networkManager.sendPostRequest(i,t,{body:r,headers:o})];case 1:return s=l.sent(),this.config.serverTelemetryManager&&s.status<500&&429!==s.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,s]}}))}))},BaseClient.prototype.updateAuthority=function(t){if(!t.discoveryComplete())throw PU.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=t},BaseClient.prototype.createTokenQueryParameters=function(t){var r=new TB;return t.tokenQueryParameters&&r.addExtraQueryParameters(t.tokenQueryParameters),r.createQueryString()},BaseClient}(),xB=function(){function CredentialEntity(){}return CredentialEntity.prototype.generateAccountId=function(){return CredentialEntity.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},CredentialEntity.prototype.generateCredentialId=function(){return CredentialEntity.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},CredentialEntity.prototype.generateTarget=function(){return CredentialEntity.generateTargetForCacheKey(this.target)},CredentialEntity.prototype.generateCredentialKey=function(){return CredentialEntity.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},CredentialEntity.prototype.generateType=function(){switch(this.credentialType){case uL.ID_TOKEN:return hL.ID_TOKEN;case uL.ACCESS_TOKEN:case uL.ACCESS_TOKEN_WITH_AUTH_SCHEME:return hL.ACCESS_TOKEN;case uL.REFRESH_TOKEN:return hL.REFRESH_TOKEN;default:throw PU.createUnexpectedCredentialTypeError()}},CredentialEntity.generateCredentialCacheKey=function(t,r,o,i,s,l,u,h,m){return[this.generateAccountIdForCacheKey(t,r),this.generateCredentialIdForCacheKey(o,i,s,u),this.generateTargetForCacheKey(l),this.generateClaimsHashForCacheKey(m),this.generateSchemeForCacheKey(h)].join(dL.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateAccountIdForCacheKey=function(t,r){return[t,r].join(dL.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateCredentialIdForCacheKey=function(t,r,o,i){return[t,t===uL.REFRESH_TOKEN&&i||r,o||rL.EMPTY_STRING].join(dL.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateTargetForCacheKey=function(t){return(t||rL.EMPTY_STRING).toLowerCase()},CredentialEntity.generateClaimsHashForCacheKey=function(t){return(t||rL.EMPTY_STRING).toLowerCase()},CredentialEntity.generateSchemeForCacheKey=function(t){return t&&t.toLowerCase()!==bL.BEARER.toLowerCase()?t.toLowerCase():rL.EMPTY_STRING},CredentialEntity}(),IB=function(t){function IdTokenEntity(){return null!==t&&t.apply(this,arguments)||this}return __extends(IdTokenEntity,t),IdTokenEntity.createIdTokenEntity=function(t,r,o,i,s){var l=new IdTokenEntity;return l.credentialType=uL.ID_TOKEN,l.homeAccountId=t,l.environment=r,l.clientId=i,l.secret=o,l.realm=s,l},IdTokenEntity.isIdTokenEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===uL.ID_TOKEN)},IdTokenEntity}(xB),AB=function(){function TimeUtils(){}return TimeUtils.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},TimeUtils.isTokenExpired=function(t,r){var o=Number(t)||0;return TimeUtils.nowSeconds()+r>o},TimeUtils.wasClockTurnedBack=function(t){return Number(t)>TimeUtils.nowSeconds()},TimeUtils.delay=function(t,r){return new Promise((function(o){return setTimeout((function(){return o(r)}),t)}))},TimeUtils}(),PB=function(t){function AccessTokenEntity(){return null!==t&&t.apply(this,arguments)||this}return __extends(AccessTokenEntity,t),AccessTokenEntity.createAccessTokenEntity=function(t,r,o,i,s,l,u,h,m,v,C,_,k,E,R){var N,M,B=new AccessTokenEntity;B.homeAccountId=t,B.credentialType=uL.ACCESS_TOKEN,B.secret=o;var H=AB.nowSeconds();if(B.cachedAt=H.toString(),B.expiresOn=u.toString(),B.extendedExpiresOn=h.toString(),v&&(B.refreshOn=v.toString()),B.environment=r,B.clientId=i,B.realm=s,B.target=l,B.userAssertionHash=_,B.tokenType=RU.isEmpty(C)?bL.BEARER:C,E&&(B.requestedClaims=E,B.requestedClaimsHash=R),(null===(N=B.tokenType)||void 0===N?void 0:N.toLowerCase())!==bL.BEARER.toLowerCase())switch(B.credentialType=uL.ACCESS_TOKEN_WITH_AUTH_SCHEME,B.tokenType){case bL.POP:var $=cB.extractTokenClaims(o,m);if(!(null===(M=null==$?void 0:$.cnf)||void 0===M?void 0:M.kid))throw PU.createTokenClaimsRequiredError();B.keyId=$.cnf.kid;break;case bL.SSH:B.keyId=k}return B},AccessTokenEntity.isAccessTokenEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.hasOwnProperty("target")&&(t.credentialType===uL.ACCESS_TOKEN||t.credentialType===uL.ACCESS_TOKEN_WITH_AUTH_SCHEME))},AccessTokenEntity}(xB),RB=function(t){function RefreshTokenEntity(){return null!==t&&t.apply(this,arguments)||this}return __extends(RefreshTokenEntity,t),RefreshTokenEntity.createRefreshTokenEntity=function(t,r,o,i,s,l){var u=new RefreshTokenEntity;return u.clientId=i,u.credentialType=uL.REFRESH_TOKEN,u.environment=r,u.homeAccountId=t,u.secret=o,u.userAssertionHash=l,s&&(u.familyId=s),u},RefreshTokenEntity.isRefreshTokenEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===uL.REFRESH_TOKEN)},RefreshTokenEntity}(xB),OB=["interaction_required","consent_required","login_required"],NB=["message_only","additional_action","basic_action","user_password_expired","consent_required"],MB={code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},DB={code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."},FB=function(t){function InteractionRequiredAuthError(r,o,i,s,l,u,h){var m=t.call(this,r,o,i)||this;return Object.setPrototypeOf(m,InteractionRequiredAuthError.prototype),m.timestamp=s||rL.EMPTY_STRING,m.traceId=l||rL.EMPTY_STRING,m.correlationId=u||rL.EMPTY_STRING,m.claims=h||rL.EMPTY_STRING,m.name="InteractionRequiredAuthError",m}return __extends(InteractionRequiredAuthError,t),InteractionRequiredAuthError.isInteractionRequiredError=function(t,r,o){var i=!!t&&OB.indexOf(t)>-1,s=!!o&&NB.indexOf(o)>-1,l=!!r&&OB.some((function(t){return r.indexOf(t)>-1}));return i||l||s},InteractionRequiredAuthError.createNoTokensFoundError=function(){return new InteractionRequiredAuthError(MB.code,MB.desc)},InteractionRequiredAuthError.createNativeAccountUnavailableError=function(){return new InteractionRequiredAuthError(DB.code,DB.desc)},InteractionRequiredAuthError}(FL),LB=function LB(t,r,o,i,s){this.account=t||null,this.idToken=r||null,this.accessToken=o||null,this.refreshToken=i||null,this.appMetadata=s||null},UB=function(){function ProtocolUtils(){}return ProtocolUtils.setRequestState=function(t,r,o){var i=ProtocolUtils.generateLibraryState(t,o);return RU.isEmpty(r)?i:""+i+rL.RESOURCE_DELIM+r},ProtocolUtils.generateLibraryState=function(t,r){if(!t)throw PU.createNoCryptoObjectError("generateLibraryState");var o={id:t.createNewGuid()};r&&(o.meta=r);var i=JSON.stringify(o);return t.base64Encode(i)},ProtocolUtils.parseRequestState=function(t,r){if(!t)throw PU.createNoCryptoObjectError("parseRequestState");if(RU.isEmpty(r))throw PU.createInvalidStateError(r,"Null, undefined or empty state");try{var o=r.split(rL.RESOURCE_DELIM),i=o[0],s=o.length>1?o.slice(1).join(rL.RESOURCE_DELIM):rL.EMPTY_STRING,l=t.base64Decode(i),u=JSON.parse(l);return{userRequestState:RU.isEmpty(s)?rL.EMPTY_STRING:s,libraryState:u}}catch(t){throw PU.createInvalidStateError(r,t)}},ProtocolUtils}(),BB=function(){function UrlString(t){if(this._urlString=t,RU.isEmpty(this._urlString))throw iB.createUrlEmptyError();RU.isEmpty(this.getHash())&&(this._urlString=UrlString.canonicalizeUri(t))}return Object.defineProperty(UrlString.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),UrlString.canonicalizeUri=function(t){if(t){var r=t.toLowerCase();return RU.endsWith(r,"?")?r=r.slice(0,-1):RU.endsWith(r,"?/")&&(r=r.slice(0,-2)),RU.endsWith(r,"/")||(r+="/"),r}return t},UrlString.prototype.validateAsUri=function(){var t;try{t=this.getUrlComponents()}catch(t){throw iB.createUrlParseError(t)}if(!t.HostNameAndPort||!t.PathSegments)throw iB.createUrlParseError("Given url string: "+this.urlString);if(!t.Protocol||"https:"!==t.Protocol.toLowerCase())throw iB.createInsecureAuthorityUriError(this.urlString)},UrlString.appendQueryString=function(t,r){return RU.isEmpty(r)?t:t.indexOf("?")<0?t+"?"+r:t+"&"+r},UrlString.removeHashFromUrl=function(t){return UrlString.canonicalizeUri(t.split("#")[0])},UrlString.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),o=r.PathSegments;return!t||0===o.length||o[0]!==ZF.COMMON&&o[0]!==ZF.ORGANIZATIONS||(o[0]=t),UrlString.constructAuthorityUriFromObject(r)},UrlString.prototype.getHash=function(){return UrlString.parseHash(this.urlString)},UrlString.prototype.getUrlComponents=function(){var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=this.urlString.match(t);if(!r)throw iB.createUrlParseError("Given url string: "+this.urlString);var o={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5],QueryString:r[7]},i=o.AbsolutePath.split("/");return i=i.filter((function(t){return t&&t.length>0})),o.PathSegments=i,!RU.isEmpty(o.QueryString)&&o.QueryString.endsWith("/")&&(o.QueryString=o.QueryString.substring(0,o.QueryString.length-1)),o},UrlString.getDomainFromUrl=function(t){var r=RegExp("^([^:/?#]+://)?([^/?#]*)"),o=t.match(r);if(!o)throw iB.createUrlParseError("Given url string: "+t);return o[2]},UrlString.getAbsoluteUrl=function(t,r){if(t[0]===rL.FORWARD_SLASH){var o=new UrlString(r).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+t}return t},UrlString.parseHash=function(t){var r=t.indexOf("#"),o=t.indexOf("#/");return o>-1?t.substring(o+2):r>-1?t.substring(r+1):rL.EMPTY_STRING},UrlString.parseQueryString=function(t){var r=t.indexOf("?"),o=t.indexOf("/?");return o>-1?t.substring(o+2):r>-1?t.substring(r+1):rL.EMPTY_STRING},UrlString.constructAuthorityUriFromObject=function(t){return new UrlString(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},UrlString.getDeserializedHash=function(t){if(RU.isEmpty(t))return{};var r=UrlString.parseHash(t),o=RU.queryStringToObject(RU.isEmpty(r)?t:r);if(!o)throw PU.createHashNotDeserializedError(JSON.stringify(o));return o},UrlString.getDeserializedQueryString=function(t){if(RU.isEmpty(t))return{};var r=UrlString.parseQueryString(t),o=RU.queryStringToObject(RU.isEmpty(r)?t:r);if(!o)throw PU.createHashNotDeserializedError(JSON.stringify(o));return o},UrlString.hashContainsKnownProperties=function(t){if(RU.isEmpty(t)||t.indexOf("=")<0)return!1;var r=UrlString.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},UrlString}();
/*! @azure/msal-common v12.1.0 2023-04-18 */!function(t){t.AcquireTokenByCode="acquireTokenByCode",t.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",t.AcquireTokenSilent="acquireTokenSilent",t.AcquireTokenSilentAsync="acquireTokenSilentAsync",t.AcquireTokenPopup="acquireTokenPopup",t.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",t.CryptoOptsSignJwt="cryptoOptsSignJwt",t.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",t.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",t.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",t.SsoSilent="ssoSilent",t.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",t.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",t.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",t.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",t.BrokerHandhshake="brokerHandshake",t.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",t.AcquireTokenByBroker="acquireTokenByBroker",t.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",t.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",t.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",t.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",t.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",t.AcquireTokenFromCache="acquireTokenFromCache",t.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",t.InitializeBaseRequest="initializeBaseRequest",t.InitializeSilentRequest="initializeSilentRequest",t.InitializeClientApplication="initializeClientApplication",t.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",t.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",t.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",t.SilentHandlerLoadFrame="silentHandlerLoadFrame",t.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",t.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",t.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",t.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",t.GetAuthCodeUrl="getAuthCodeUrl",t.HandleCodeResponseFromServer="handleCodeResponseFromServer",t.HandleCodeResponseFromHash="handleCodeResponseFromHash",t.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",t.AuthClientAcquireToken="authClientAcquireToken",t.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",t.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",t.AuthClientCreateQueryString="authClientCreateQueryString",t.PopTokenGenerateCnf="popTokenGenerateCnf",t.PopTokenGenerateKid="popTokenGenerateKid",t.HandleServerTokenResponse="handleServerTokenResponse",t.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",t.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",t.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",t.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",t.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",t.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",t.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",t.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",t.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",t.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",t.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",t.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",t.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",t.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",t.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",t.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",t.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake"}(_B||(_B={})),function(t){t[t.NotStarted=0]="NotStarted",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed"}(kB||(kB={}));var HB,$B=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]);
/*! @azure/msal-common v12.1.0 2023-04-18 */!function(t){t.SW="sw",t.UHW="uhw"}(HB||(HB={}));var qB=function(){function PopTokenGenerator(t,r){this.cryptoUtils=t,this.performanceClient=r}return PopTokenGenerator.prototype.generateCnf=function(t){var r,o;return __awaiter$2(this,void 0,void 0,(function(){var i,s,l;return __generator(this,(function(u){switch(u.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.PopTokenGenerateCnf,t.correlationId),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(_B.PopTokenGenerateKid,t.correlationId),[4,this.generateKid(t)];case 1:return i=u.sent(),s=this.cryptoUtils.base64Encode(JSON.stringify(i)),l={kid:i.kid,reqCnfString:s},[4,this.cryptoUtils.hashString(s)];case 2:return[2,(l.reqCnfHash=u.sent(),l)]}}))}))},PopTokenGenerator.prototype.generateKid=function(t){var r;return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(o){switch(o.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.PopTokenGenerateKid,t.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(t)];case 1:return[2,{kid:o.sent(),xms_ksl:HB.SW}]}}))}))},PopTokenGenerator.prototype.signPopToken=function(t,r,o){return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(i){return[2,this.signPayload(t,r,o)]}))}))},PopTokenGenerator.prototype.signPayload=function(t,r,o,i){return __awaiter$2(this,void 0,void 0,(function(){var s,l,u,h,m,v;return __generator(this,(function(C){switch(C.label){case 0:return s=o.resourceRequestMethod,l=o.resourceRequestUri,u=o.shrClaims,h=o.shrNonce,m=l?new BB(l):void 0,v=null==m?void 0:m.getUrlComponents(),[4,this.cryptoUtils.signJwt(__assign({at:t,ts:AB.nowSeconds(),m:null==s?void 0:s.toUpperCase(),u:null==v?void 0:v.HostNameAndPort,nonce:h||this.cryptoUtils.createNewGuid(),p:null==v?void 0:v.AbsolutePath,q:(null==v?void 0:v.QueryString)?[[],v.QueryString]:void 0,client_claims:u||void 0},i),r,o.correlationId)];case 1:return[2,C.sent()]}}))}))},PopTokenGenerator}(),jB=function(){function AppMetadataEntity(){}return AppMetadataEntity.prototype.generateAppMetadataKey=function(){return AppMetadataEntity.generateAppMetadataCacheKey(this.environment,this.clientId)},AppMetadataEntity.generateAppMetadataCacheKey=function(t,r){return[gL,t,r].join(dL.CACHE_KEY_SEPARATOR).toLowerCase()},AppMetadataEntity.createAppMetadataEntity=function(t,r,o){var i=new AppMetadataEntity;return i.clientId=t,i.environment=r,o&&(i.familyId=o),i},AppMetadataEntity.isAppMetadataEntity=function(t,r){return!!r&&(0===t.indexOf(gL)&&r.hasOwnProperty("clientId")&&r.hasOwnProperty("environment"))},AppMetadataEntity}(),zB=function(){function TokenCacheContext(t,r){this.cache=t,this.hasChanged=r}return Object.defineProperty(TokenCacheContext.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(TokenCacheContext.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),TokenCacheContext}(),GB=function(){function ResponseHandler(t,r,o,i,s,l,u){this.clientId=t,this.cacheStorage=r,this.cryptoObj=o,this.logger=i,this.serializableCache=s,this.persistencePlugin=l,this.performanceClient=u}return ResponseHandler.prototype.validateServerAuthorizationCodeResponse=function(t,r,o){if(!t.state||!r)throw t.state?PU.createStateNotFoundError("Cached State"):PU.createStateNotFoundError("Server State");if(decodeURIComponent(t.state)!==decodeURIComponent(r))throw PU.createStateMismatchError();if(t.error||t.error_description||t.suberror){if(FB.isInteractionRequiredError(t.error,t.error_description,t.suberror))throw new FB(t.error||rL.EMPTY_STRING,t.error_description,t.suberror,t.timestamp||rL.EMPTY_STRING,t.trace_id||rL.EMPTY_STRING,t.correlation_id||rL.EMPTY_STRING,t.claims||rL.EMPTY_STRING);throw new bB(t.error||rL.EMPTY_STRING,t.error_description,t.suberror)}t.client_info&&buildClientInfo(t.client_info,o)},ResponseHandler.prototype.validateTokenResponse=function(t){if(t.error||t.error_description||t.suberror){if(FB.isInteractionRequiredError(t.error,t.error_description,t.suberror))throw new FB(t.error,t.error_description,t.suberror,t.timestamp||rL.EMPTY_STRING,t.trace_id||rL.EMPTY_STRING,t.correlation_id||rL.EMPTY_STRING,t.claims||rL.EMPTY_STRING);var r=t.error_codes+" - ["+t.timestamp+"]: "+t.error_description+" - Correlation ID: "+t.correlation_id+" - Trace ID: "+t.trace_id;throw new bB(t.error,r,t.suberror)}},ResponseHandler.prototype.handleServerTokenResponse=function(t,r,o,i,s,l,u,h,m){var v;return __awaiter$2(this,void 0,void 0,(function(){var C,_,k,E,R,N;return __generator(this,(function(M){switch(M.label){case 0:if(null===(v=this.performanceClient)||void 0===v||v.addQueueMeasurement(_B.HandleServerTokenResponse,t.correlation_id),t.id_token){if(C=new cB(t.id_token||rL.EMPTY_STRING,this.cryptoObj),s&&!RU.isEmpty(s.nonce)&&C.claims.nonce!==s.nonce)throw PU.createNonceMismatchError();if(i.maxAge||0===i.maxAge){if(!(_=C.claims.auth_time))throw PU.createAuthTimeNotFoundError();cB.checkMaxAge(_,i.maxAge)}}this.homeAccountIdentifier=aB.generateHomeAccountId(t.client_info||rL.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,C),s&&s.state&&(k=UB.parseRequestState(this.cryptoObj,s.state)),t.key_id=t.key_id||i.sshKid||void 0,E=this.generateCacheRecord(t,r,o,i,C,l,s),M.label=1;case 1:return M.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),R=new zB(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(R)]):[3,3];case 2:M.sent(),M.label=3;case 3:return!u||h||!E.account||(N=E.account.generateAccountKey(),this.cacheStorage.getAccount(N))?[4,this.cacheStorage.saveCacheRecord(E)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,ResponseHandler.generateAuthenticationResult(this.cryptoObj,r,E,!1,i,C,k,void 0,m)]);case 4:return M.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&R?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(R)]):[3,7];case 6:M.sent(),M.label=7;case 7:return[7];case 8:return[2,ResponseHandler.generateAuthenticationResult(this.cryptoObj,r,E,!1,i,C,k,t,m)]}}))}))},ResponseHandler.prototype.generateCacheRecord=function(t,r,o,i,s,l,u){var h,m,v=r.getPreferredCache();if(RU.isEmpty(v))throw PU.createInvalidCacheEnvironmentError();!RU.isEmpty(t.id_token)&&s&&(h=IB.createIdTokenEntity(this.homeAccountIdentifier,v,t.id_token||rL.EMPTY_STRING,this.clientId,s.claims.tid||rL.EMPTY_STRING),m=this.generateAccountEntity(t,s,r,u));var C=null;if(!RU.isEmpty(t.access_token)){var _=t.scope?sB.fromString(t.scope):new sB(i.scopes||[]),k=("string"==typeof t.expires_in?parseInt(t.expires_in,10):t.expires_in)||0,E=("string"==typeof t.ext_expires_in?parseInt(t.ext_expires_in,10):t.ext_expires_in)||0,R=("string"==typeof t.refresh_in?parseInt(t.refresh_in,10):t.refresh_in)||void 0,N=o+k,M=N+E,B=R&&R>0?o+R:void 0;C=PB.createAccessTokenEntity(this.homeAccountIdentifier,v,t.access_token||rL.EMPTY_STRING,this.clientId,s?s.claims.tid||rL.EMPTY_STRING:r.tenant,_.printScopes(),N,M,this.cryptoObj,B,t.token_type,l,t.key_id,i.claims,i.requestedClaimsHash)}var H=null;RU.isEmpty(t.refresh_token)||(H=RB.createRefreshTokenEntity(this.homeAccountIdentifier,v,t.refresh_token||rL.EMPTY_STRING,this.clientId,t.foci,l));var $=null;return RU.isEmpty(t.foci)||($=jB.createAppMetadataEntity(this.clientId,v,t.foci)),new LB(m,h,C,H,$)},ResponseHandler.prototype.generateAccountEntity=function(t,r,o,i){var s=o.authorityType,l=i?i.cloud_graph_host_name:rL.EMPTY_STRING,u=i?i.msgraph_host:rL.EMPTY_STRING;if(s===FU.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),aB.createGenericAccount(this.homeAccountIdentifier,r,o,l,u);if(RU.isEmpty(t.client_info)&&"AAD"===o.protocolMode)throw PU.createClientInfoEmptyError();return t.client_info?aB.createAccount(t.client_info,this.homeAccountIdentifier,r,o,l,u):aB.createGenericAccount(this.homeAccountIdentifier,r,o,l,u)},ResponseHandler.generateAuthenticationResult=function(t,r,o,i,s,l,u,h,m){var v,C,_;return __awaiter$2(this,void 0,void 0,(function(){var k,E,R,N,M,B,H,$,q,j,z;return __generator(this,(function(V){switch(V.label){case 0:if(k=rL.EMPTY_STRING,E=[],R=null,M=rL.EMPTY_STRING,!o.accessToken)return[3,4];if(o.accessToken.tokenType!==bL.POP)return[3,2];if(B=new qB(t),H=o.accessToken,$=H.secret,!(q=H.keyId))throw PU.createKeyIdMissingError();return[4,B.signPopToken($,q,s)];case 1:return k=V.sent(),[3,3];case 2:k=o.accessToken.secret,V.label=3;case 3:E=sB.fromString(o.accessToken.target).asArray(),R=new Date(1e3*Number(o.accessToken.expiresOn)),N=new Date(1e3*Number(o.accessToken.extendedExpiresOn)),V.label=4;case 4:return o.appMetadata&&(M=o.appMetadata.familyId===mL?mL:rL.EMPTY_STRING),j=(null==l?void 0:l.claims.oid)||(null==l?void 0:l.claims.sub)||rL.EMPTY_STRING,z=(null==l?void 0:l.claims.tid)||rL.EMPTY_STRING,(null==h?void 0:h.spa_accountid)&&o.account&&(o.account.nativeAccountId=null==h?void 0:h.spa_accountid),[2,{authority:r.canonicalAuthority,uniqueId:j,tenantId:z,scopes:E,account:o.account?o.account.getAccountInfo():null,idToken:l?l.rawToken:rL.EMPTY_STRING,idTokenClaims:l?l.claims:{},accessToken:k,fromCache:i,expiresOn:R,correlationId:s.correlationId,requestId:m||rL.EMPTY_STRING,extExpiresOn:N,familyId:M,tokenType:(null===(v=o.accessToken)||void 0===v?void 0:v.tokenType)||rL.EMPTY_STRING,state:u?u.userRequestState:rL.EMPTY_STRING,cloudGraphHostName:(null===(C=o.account)||void 0===C?void 0:C.cloudGraphHostName)||rL.EMPTY_STRING,msGraphHost:(null===(_=o.account)||void 0===_?void 0:_.msGraphHost)||rL.EMPTY_STRING,code:null==h?void 0:h.spa_code,fromNativeBroker:!1}]}}))}))},ResponseHandler}(),VB=function(t){function AuthorizationCodeClient(r,o){var i=t.call(this,r,o)||this;return i.includeRedirectUri=!0,i}return __extends(AuthorizationCodeClient,t),AuthorizationCodeClient.prototype.getAuthCodeUrl=function(t){var r,o;return __awaiter$2(this,void 0,void 0,(function(){var i;return __generator(this,(function(s){switch(s.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.GetAuthCodeUrl,t.correlationId),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(_B.AuthClientCreateQueryString,t.correlationId),[4,this.createAuthCodeUrlQueryString(t)];case 1:return i=s.sent(),[2,BB.appendQueryString(this.authority.authorizationEndpoint,i)]}}))}))},AuthorizationCodeClient.prototype.acquireToken=function(t,r){var o,i,s,l,u,h;return __awaiter$2(this,void 0,void 0,(function(){var m,v,C,_,k,E,R=this;return __generator(this,(function(N){switch(N.label){case 0:if(!t||!t.code)throw PU.createTokenRequestCannotBeMadeError();return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(_B.AuthClientAcquireToken,t.correlationId),m=null===(i=this.performanceClient)||void 0===i?void 0:i.startMeasurement("AuthCodeClientAcquireToken",t.correlationId),this.logger.info("in acquireToken call in auth-code client"),v=AB.nowSeconds(),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(_B.AuthClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(this.authority,t)];case 1:return C=N.sent(),_=null===(l=C.headers)||void 0===l?void 0:l[JF.X_MS_REQUEST_ID],(k=null===(u=C.headers)||void 0===u?void 0:u[JF.X_MS_HTTP_VERSION])&&(null==m||m.addStaticFields({httpVerAuthority:k})),(E=new GB(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(C.body),null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(_B.HandleServerTokenResponse,t.correlationId),[2,E.handleServerTokenResponse(C.body,this.authority,v,t,r,void 0,void 0,void 0,_).then((function(t){return null==m||m.endMeasurement({success:!0}),t})).catch((function(r){throw R.logger.verbose("Error in fetching token in ACC",t.correlationId),null==m||m.endMeasurement({errorCode:r.errorCode,subErrorCode:r.subError,success:!1}),r}))]}}))}))},AuthorizationCodeClient.prototype.handleFragmentResponse=function(t,r){var o=new GB(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),i=new BB(t),s=BB.getDeserializedHash(i.getHash());if(o.validateServerAuthorizationCodeResponse(s,r,this.cryptoUtils),!s.code)throw PU.createNoAuthCodeInServerResponseError();return __assign(__assign({},s),{code:s.code})},AuthorizationCodeClient.prototype.getLogoutUri=function(t){if(!t)throw iB.createEmptyLogoutRequestError();var r=this.createLogoutUrlQueryString(t);return BB.appendQueryString(this.authority.endSessionEndpoint,r)},AuthorizationCodeClient.prototype.executeTokenRequest=function(t,r){var o,i;return __awaiter$2(this,void 0,void 0,(function(){var s,l,u,h,m,v,C;return __generator(this,(function(_){switch(_.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(_B.AuthClientExecuteTokenRequest,r.correlationId),null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(_B.AuthClientCreateTokenRequestBody,r.correlationId),s=this.createTokenQueryParameters(r),l=BB.appendQueryString(t.tokenEndpoint,s),[4,this.createTokenRequestBody(r)];case 1:if(u=_.sent(),h=void 0,r.clientInfo)try{m=buildClientInfo(r.clientInfo,this.cryptoUtils),h={credential:""+m.uid+dL.CLIENT_INFO_SEPARATOR+m.utid,type:yB.HOME_ACCOUNT_ID}}catch(t){this.logger.verbose("Could not parse client info for CCS Header: "+t)}return v=this.createTokenRequestHeaders(h||r.ccsCredential),C={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:r.scopes,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},[2,this.executePostToTokenEndpoint(l,u,v,C)]}}))}))},AuthorizationCodeClient.prototype.createTokenRequestBody=function(t){var r,o;return __awaiter$2(this,void 0,void 0,(function(){var i,s,l,u,h,m,v,C;return __generator(this,(function(_){switch(_.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.AuthClientCreateTokenRequestBody,t.correlationId),(i=new TB).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?i.addRedirectUri(t.redirectUri):SB.validateRedirectUri(t.redirectUri),i.addScopes(t.scopes),i.addAuthorizationCode(t.code),i.addLibraryInfo(this.config.libraryInfo),i.addApplicationTelemetry(this.config.telemetry.application),i.addThrottling(),this.serverTelemetryManager&&i.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&i.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&i.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(s=this.config.clientCredentials.clientAssertion,i.addClientAssertion(s.assertion),i.addClientAssertionType(s.assertionType)),i.addGrantType(cL.AUTHORIZATION_CODE_GRANT),i.addClientInfo(),t.authenticationScheme!==bL.POP?[3,2]:(l=new qB(this.cryptoUtils,this.performanceClient),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(_B.PopTokenGenerateCnf,t.correlationId),[4,l.generateCnf(t)]);case 1:return u=_.sent(),i.addPopToken(u.reqCnfString),[3,3];case 2:if(t.authenticationScheme===bL.SSH){if(!t.sshJwk)throw iB.createMissingSshJwkError();i.addSshJwk(t.sshJwk)}_.label=3;case 3:if(h=t.correlationId||this.config.cryptoInterface.createNewGuid(),i.addCorrelationId(h),(!RU.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(t.claims,this.config.authOptions.clientCapabilities),m=void 0,t.clientInfo)try{v=buildClientInfo(t.clientInfo,this.cryptoUtils),m={credential:""+v.uid+dL.CLIENT_INFO_SEPARATOR+v.utid,type:yB.HOME_ACCOUNT_ID}}catch(t){this.logger.verbose("Could not parse client info for CCS Header: "+t)}else m=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&m)switch(m.type){case yB.HOME_ACCOUNT_ID:try{v=buildClientInfoFromHomeAccountId(m.credential),i.addCcsOid(v)}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case yB.UPN:i.addCcsUpn(m.credential)}return t.tokenBodyParameters&&i.addExtraQueryParameters(t.tokenBodyParameters),!t.enableSpaAuthorizationCode||t.tokenBodyParameters&&t.tokenBodyParameters[eL.RETURN_SPA_CODE]||i.addExtraQueryParameters(((C={})[eL.RETURN_SPA_CODE]="1",C)),[2,i.createQueryString()]}}))}))},AuthorizationCodeClient.prototype.createAuthCodeUrlQueryString=function(t){var r;return __awaiter$2(this,void 0,void 0,(function(){var o,i,s,l,u,h,m;return __generator(this,(function(v){switch(v.label){case 0:if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.AuthClientCreateQueryString,t.correlationId),(o=new TB).addClientId(this.config.authOptions.clientId),i=__spreadArrays(t.scopes||[],t.extraScopesToConsent||[]),o.addScopes(i),o.addRedirectUri(t.redirectUri),s=t.correlationId||this.config.cryptoInterface.createNewGuid(),o.addCorrelationId(s),o.addResponseMode(t.responseMode),o.addResponseTypeCode(),o.addLibraryInfo(this.config.libraryInfo),o.addApplicationTelemetry(this.config.telemetry.application),o.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&o.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&o.addPrompt(t.prompt),t.domainHint&&o.addDomainHint(t.domainHint),t.prompt!==sL.SELECT_ACCOUNT)if(t.sid&&t.prompt===sL.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),o.addSid(t.sid);else if(t.account){if(l=this.extractAccountSid(t.account),u=this.extractLoginHint(t.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),o.addLoginHint(u);try{h=buildClientInfoFromHomeAccountId(t.account.homeAccountId),o.addCcsOid(h)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(l&&t.prompt===sL.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),o.addSid(l);try{h=buildClientInfoFromHomeAccountId(t.account.homeAccountId),o.addCcsOid(h)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),o.addLoginHint(t.loginHint),o.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),o.addLoginHint(t.account.username);try{h=buildClientInfoFromHomeAccountId(t.account.homeAccountId),o.addCcsOid(h)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),o.addLoginHint(t.loginHint),o.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&o.addNonce(t.nonce),t.state&&o.addState(t.state),(!RU.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&o.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),t.nativeBroker?(o.addNativeBroker(),t.authenticationScheme!==bL.POP?[3,2]:[4,new qB(this.cryptoUtils).generateCnf(t)]):[3,2];case 1:m=v.sent(),o.addPopToken(m.reqCnfHash),v.label=2;case 2:return[2,o.createQueryString()]}}))}))},AuthorizationCodeClient.prototype.createLogoutUrlQueryString=function(t){var r=new TB;return t.postLogoutRedirectUri&&r.addPostLogoutRedirectUri(t.postLogoutRedirectUri),t.correlationId&&r.addCorrelationId(t.correlationId),t.idTokenHint&&r.addIdTokenHint(t.idTokenHint),t.state&&r.addState(t.state),t.logoutHint&&r.addLogoutHint(t.logoutHint),t.extraQueryParameters&&r.addExtraQueryParameters(t.extraQueryParameters),r.createQueryString()},AuthorizationCodeClient.prototype.extractAccountSid=function(t){var r;return(null===(r=t.idTokenClaims)||void 0===r?void 0:r.sid)||null},AuthorizationCodeClient.prototype.extractLoginHint=function(t){var r;return(null===(r=t.idTokenClaims)||void 0===r?void 0:r.login_hint)||null},AuthorizationCodeClient}(EB),KB=function(t){function RefreshTokenClient(r,o){return t.call(this,r,o)||this}return __extends(RefreshTokenClient,t),RefreshTokenClient.prototype.acquireToken=function(t){var r,o,i,s,l,u,h;return __awaiter$2(this,void 0,void 0,(function(){var m,v,C,_,k,E,R=this;return __generator(this,(function(N){switch(N.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.RefreshTokenClientAcquireToken,t.correlationId),m=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(_B.RefreshTokenClientAcquireToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",t.correlationId),v=AB.nowSeconds(),null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(_B.RefreshTokenClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(t,this.authority)];case 1:return C=N.sent(),_=null===(s=C.headers)||void 0===s?void 0:s[JF.X_MS_HTTP_VERSION],null==m||m.addStaticFields({refreshTokenSize:(null===(l=C.body.refresh_token)||void 0===l?void 0:l.length)||0}),_&&(null==m||m.addStaticFields({httpVerToken:_})),k=null===(u=C.headers)||void 0===u?void 0:u[JF.X_MS_REQUEST_ID],(E=new GB(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(C.body),null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(_B.HandleServerTokenResponse,t.correlationId),[2,E.handleServerTokenResponse(C.body,this.authority,v,t,void 0,void 0,!0,t.forceCache,k).then((function(t){return null==m||m.endMeasurement({success:!0}),t})).catch((function(r){throw R.logger.verbose("Error in fetching refresh token",t.correlationId),null==m||m.endMeasurement({errorCode:r.errorCode,subErrorCode:r.subError,success:!1}),r}))]}}))}))},RefreshTokenClient.prototype.acquireTokenByRefreshToken=function(t){var r,o,i,s;return __awaiter$2(this,void 0,void 0,(function(){var l,u;return __generator(this,(function(h){if(!t)throw iB.createEmptyTokenRequestError();if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),!t.account)throw PU.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(t.account.environment))try{return null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(_B.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!0)]}catch(r){if(l=r instanceof FB&&r.errorCode===MB.code,u=r instanceof bB&&r.errorCode===RL&&r.subError===OL,l||u)return null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(_B.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)];throw r}return null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(_B.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)]}))}))},RefreshTokenClient.prototype.acquireTokenWithCachedRefreshToken=function(t,r){var o,i,s;return __awaiter$2(this,void 0,void 0,(function(){var l,u,h;return __generator(this,(function(m){if(null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(_B.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),l=null===(i=this.performanceClient)||void 0===i?void 0:i.startMeasurement(_B.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",t.correlationId),!(u=this.cacheManager.getRefreshToken(t.account,r)))throw null==l||l.discardMeasurement(),FB.createNoTokensFoundError();return null==l||l.endMeasurement({success:!0}),h=__assign(__assign({},t),{refreshToken:u.secret,authenticationScheme:t.authenticationScheme||bL.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:yB.HOME_ACCOUNT_ID}}),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(_B.RefreshTokenClientAcquireToken,t.correlationId),[2,this.acquireToken(h)]}))}))},RefreshTokenClient.prototype.executeTokenRequest=function(t,r){var o,i,s;return __awaiter$2(this,void 0,void 0,(function(){var l,u,h,m,v,C;return __generator(this,(function(_){switch(_.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(_B.RefreshTokenClientExecuteTokenRequest,t.correlationId),l=null===(i=this.performanceClient)||void 0===i?void 0:i.startMeasurement(_B.RefreshTokenClientExecuteTokenRequest,t.correlationId),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(_B.RefreshTokenClientCreateTokenRequestBody,t.correlationId),u=this.createTokenQueryParameters(t),h=BB.appendQueryString(r.tokenEndpoint,u),[4,this.createTokenRequestBody(t)];case 1:return m=_.sent(),v=this.createTokenRequestHeaders(t.ccsCredential),C={clientId:this.config.authOptions.clientId,authority:r.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(h,m,v,C).then((function(t){return null==l||l.endMeasurement({success:!0}),t})).catch((function(t){throw null==l||l.endMeasurement({success:!1}),t}))]}}))}))},RefreshTokenClient.prototype.createTokenRequestBody=function(t){var r,o,i;return __awaiter$2(this,void 0,void 0,(function(){var s,l,u,h,m,v,C;return __generator(this,(function(_){switch(_.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.RefreshTokenClientCreateTokenRequestBody,t.correlationId),s=t.correlationId,l=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(_B.BaseClientCreateTokenRequestHeaders,s),(u=new TB).addClientId(this.config.authOptions.clientId),u.addScopes(t.scopes),u.addGrantType(cL.REFRESH_TOKEN_GRANT),u.addClientInfo(),u.addLibraryInfo(this.config.libraryInfo),u.addApplicationTelemetry(this.config.telemetry.application),u.addThrottling(),this.serverTelemetryManager&&u.addServerTelemetry(this.serverTelemetryManager),u.addCorrelationId(s),u.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&u.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(h=this.config.clientCredentials.clientAssertion,u.addClientAssertion(h.assertion),u.addClientAssertionType(h.assertionType)),t.authenticationScheme!==bL.POP?[3,2]:(m=new qB(this.cryptoUtils,this.performanceClient),null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(_B.PopTokenGenerateCnf,t.correlationId),[4,m.generateCnf(t)]);case 1:return v=_.sent(),u.addPopToken(v.reqCnfString),[3,3];case 2:if(t.authenticationScheme===bL.SSH){if(!t.sshJwk)throw null==l||l.endMeasurement({success:!1}),iB.createMissingSshJwkError();u.addSshJwk(t.sshJwk)}_.label=3;case 3:if((!RU.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&u.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case yB.HOME_ACCOUNT_ID:try{C=buildClientInfoFromHomeAccountId(t.ccsCredential.credential),u.addCcsOid(C)}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case yB.UPN:u.addCcsUpn(t.ccsCredential.credential)}return null==l||l.endMeasurement({success:!0}),[2,u.createQueryString()]}}))}))},RefreshTokenClient}(EB),WB=function(t){function SilentFlowClient(r,o){return t.call(this,r,o)||this}return __extends(SilentFlowClient,t),SilentFlowClient.prototype.acquireToken=function(t){return __awaiter$2(this,void 0,void 0,(function(){var r;return __generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.acquireCachedToken(t)];case 1:return[2,o.sent()];case 2:if((r=o.sent())instanceof PU&&r.errorCode===CU.code)return[2,new KB(this.config,this.performanceClient).acquireTokenByRefreshToken(t)];throw r;case 3:return[2]}}))}))},SilentFlowClient.prototype.acquireCachedToken=function(t){var r,o,i,s;return __awaiter$2(this,void 0,void 0,(function(){var l,u;return __generator(this,(function(h){switch(h.label){case 0:if(!t)throw iB.createEmptyTokenRequestError();if(t.forceRefresh)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(TL.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),PU.createRefreshRequiredError();if(!t.account)throw PU.createNoAccountInSilentRequestError();if(l=t.authority||this.authority.getPreferredCache(),!(u=this.cacheManager.readCacheRecord(t.account,t,l)).accessToken)throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(TL.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),PU.createRefreshRequiredError();if(AB.wasClockTurnedBack(u.accessToken.cachedAt)||AB.isTokenExpired(u.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(i=this.serverTelemetryManager)||void 0===i||i.setCacheOutcome(TL.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),PU.createRefreshRequiredError();if(u.accessToken.refreshOn&&AB.isTokenExpired(u.accessToken.refreshOn,0))throw null===(s=this.serverTelemetryManager)||void 0===s||s.setCacheOutcome(TL.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),PU.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(u,t)];case 1:return[2,h.sent()]}}))}))},SilentFlowClient.prototype.generateResultFromCacheRecord=function(t,r){return __awaiter$2(this,void 0,void 0,(function(){var o,i;return __generator(this,(function(s){switch(s.label){case 0:if(t.idToken&&(o=new cB(t.idToken.secret,this.config.cryptoInterface)),r.maxAge||0===r.maxAge){if(!(i=null==o?void 0:o.claims.auth_time))throw PU.createAuthTimeNotFoundError();cB.checkMaxAge(i,r.maxAge)}return[4,GB.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,r,o)];case 1:return[2,s.sent()]}}))}))},SilentFlowClient}(EB);
/*! @azure/msal-common v12.1.0 2023-04-18 */
/*! @azure/msal-common v12.1.0 2023-04-18 */
function isOpenIdConfigResponse(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}
/*! @azure/msal-common v12.1.0 2023-04-18 */var QB,YB={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},JB={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}};!function(t){t.AAD="AAD",t.OIDC="OIDC"}(QB||(QB={}));
/*! @azure/msal-common v12.1.0 2023-04-18 */
var XB=function(){function AuthorityMetadataEntity(){this.expiresAt=AB.nowSeconds()+yL}return AuthorityMetadataEntity.prototype.updateCloudDiscoveryMetadata=function(t,r){this.aliases=t.aliases,this.preferred_cache=t.preferred_cache,this.preferred_network=t.preferred_network,this.aliasesFromNetwork=r},AuthorityMetadataEntity.prototype.updateEndpointMetadata=function(t,r){this.authorization_endpoint=t.authorization_endpoint,this.token_endpoint=t.token_endpoint,this.end_session_endpoint=t.end_session_endpoint,this.issuer=t.issuer,this.endpointsFromNetwork=r,this.jwks_uri=t.jwks_uri},AuthorityMetadataEntity.prototype.updateCanonicalAuthority=function(t){this.canonical_authority=t},AuthorityMetadataEntity.prototype.resetExpiresAt=function(){this.expiresAt=AB.nowSeconds()+yL},AuthorityMetadataEntity.prototype.isExpired=function(){return this.expiresAt<=AB.nowSeconds()},AuthorityMetadataEntity.isAuthorityMetadataEntity=function(t,r){return!!r&&(0===t.indexOf(vL)&&r.hasOwnProperty("aliases")&&r.hasOwnProperty("preferred_cache")&&r.hasOwnProperty("preferred_network")&&r.hasOwnProperty("canonical_authority")&&r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("aliasesFromNetwork")&&r.hasOwnProperty("endpointsFromNetwork")&&r.hasOwnProperty("expiresAt")&&r.hasOwnProperty("jwks_uri"))},AuthorityMetadataEntity}();
/*! @azure/msal-common v12.1.0 2023-04-18 */
/*! @azure/msal-common v12.1.0 2023-04-18 */
var ZB,eH,tH,rH,oH,nH,iH,sH,aH,cH=function(){function RegionDiscovery(t,r,o){this.networkInterface=t,this.performanceClient=r,this.correlationId=o}return RegionDiscovery.prototype.detectRegion=function(t,r){var o,i,s,l;return __awaiter$2(this,void 0,void 0,(function(){var u,h,m,v,C;return __generator(this,(function(_){switch(_.label){case 0:if(null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(_B.RegionDiscoveryDetectRegion,this.correlationId),u=t)return[3,8];h=RegionDiscovery.IMDS_OPTIONS,_.label=1;case 1:return _.trys.push([1,6,,7]),null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(_B.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(rL.IMDS_VERSION,h)];case 2:return(m=_.sent()).status===_L.httpSuccess&&(u=m.body,r.region_source=kL.IMDS),m.status!==_L.httpBadRequest?[3,5]:(null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(_B.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(h)]);case 3:return(v=_.sent())?(null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(_B.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(v,h)]):(r.region_source=kL.FAILED_AUTO_DETECTION,[2,null]);case 4:(C=_.sent()).status===_L.httpSuccess&&(u=C.body,r.region_source=kL.IMDS),_.label=5;case 5:return[3,7];case 6:return _.sent(),r.region_source=kL.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:r.region_source=kL.ENVIRONMENT_VARIABLE,_.label=9;case 9:return u||(r.region_source=kL.FAILED_AUTO_DETECTION),[2,u||null]}}))}))},RegionDiscovery.prototype.getRegionFromIMDS=function(t,r){var o;return __awaiter$2(this,void 0,void 0,(function(){return __generator(this,(function(i){return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(_B.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(rL.IMDS_ENDPOINT+"?api-version="+t+"&format=text",r,rL.IMDS_TIMEOUT)]}))}))},RegionDiscovery.prototype.getCurrentVersion=function(t){var r;return __awaiter$2(this,void 0,void 0,(function(){var o;return __generator(this,(function(i){switch(i.label){case 0:null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.RegionDiscoveryGetCurrentVersion,this.correlationId),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(rL.IMDS_ENDPOINT+"?format=json",t)];case 2:return(o=i.sent()).status===_L.httpBadRequest&&o.body&&o.body["newest-versions"]&&o.body["newest-versions"].length>0?[2,o.body["newest-versions"][0]]:[2,null];case 3:return i.sent(),[2,null];case 4:return[2]}}))}))},RegionDiscovery.IMDS_OPTIONS={headers:{Metadata:"true"}},RegionDiscovery}(),lH=function(){function Authority(t,r,o,i,s,l,u){this.canonicalAuthority=t,this._canonicalAuthority.validateAsUri(),this.networkInterface=r,this.cacheManager=o,this.authorityOptions=i,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=s,this.performanceClient=l,this.correlationId=u,this.regionDiscovery=new cH(r,this.performanceClient,this.correlationId)}return Object.defineProperty(Authority.prototype,"authorityType",{get:function(){if(this.canonicalAuthorityUrlComponents.HostNameAndPort.endsWith(rL.CIAM_AUTH_URL))return FU.Ciam;var t=this.canonicalAuthorityUrlComponents.PathSegments;if(t.length)switch(t[0].toLowerCase()){case rL.ADFS:return FU.Adfs;case rL.DSTS:return FU.Dsts}return FU.Default},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(t){this._canonicalAuthority=new BB(t),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(t)}throw PU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(t)}throw PU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(t)}throw PU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw PU.createLogoutNotSupportedError();var t=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(t)}throw PU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.issuer);return this.replaceTenant(t)}throw PU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"jwksUri",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.jwks_uri);return this.replaceTenant(t)}throw PU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Authority.prototype.replaceTenant=function(t){return t.replace(/{tenant}|{tenantid}/g,this.tenant)},Authority.prototype.replacePath=function(t){var r=t,o=new BB(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(t,i){var s=o[i];t!==s&&(r=r.replace("/"+s+"/","/"+t+"/"))})),r},Object.defineProperty(Authority.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===FU.Adfs||this.authorityType===FU.Dsts||this.protocolMode===QB.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),Authority.prototype.discoveryComplete=function(){return!!this.metadata},Authority.prototype.resolveEndpointsAsync=function(){var t,r,o;return __awaiter$2(this,void 0,void 0,(function(){var i,s,l,u;return __generator(this,(function(h){switch(h.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(_B.AuthorityResolveEndpointsAsync,this.correlationId),(i=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(i=new XB).updateCanonicalAuthority(this.canonicalAuthority),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(_B.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(i)];case 1:return s=h.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,i.preferred_network),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(_B.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(i)];case 2:return l=h.sent(),s!==fL.CACHE&&l!==fL.CACHE&&(i.resetExpiresAt(),i.updateCanonicalAuthority(this.canonicalAuthority)),u=this.cacheManager.generateAuthorityMetadataCacheKey(i.preferred_cache),this.cacheManager.setAuthorityMetadata(u,i),this.metadata=i,[2]}}))}))},Authority.prototype.updateEndpointMetadata=function(t){var r,o,i,s,l,u;return __awaiter$2(this,void 0,void 0,(function(){var h,m;return __generator(this,(function(v){switch(v.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.AuthorityUpdateEndpointMetadata,this.correlationId),(h=this.getEndpointMetadataFromConfig())?(t.updateEndpointMetadata(h,!1),[2,fL.CONFIG]):this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!t.isExpired()?[2,fL.CACHE]:(null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(_B.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(h=v.sent())?(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.azureRegion)?(null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(_B.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(h)]):[3,3]:[3,4];case 2:h=v.sent(),v.label=3;case 3:return t.updateEndpointMetadata(h,!0),[2,fL.NETWORK];case 4:return!(m=this.getEndpointMetadataFromHardcodedValues())||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:(null===(l=this.authorityOptions.azureRegionConfiguration)||void 0===l?void 0:l.azureRegion)?(null===(u=this.performanceClient)||void 0===u||u.setPreQueueTime(_B.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(m)]):[3,6];case 5:m=v.sent(),v.label=6;case 6:return t.updateEndpointMetadata(m,!1),[2,fL.HARDCODED_VALUES];case 7:throw PU.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},Authority.prototype.isAuthoritySameType=function(t){return new BB(t.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},Authority.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(t){throw iB.createInvalidAuthorityMetadataError()}return null},Authority.prototype.getEndpointMetadataFromNetwork=function(){var t;return __awaiter$2(this,void 0,void 0,(function(){var r,o;return __generator(this,(function(i){switch(i.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(_B.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),r={},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,r)];case 2:return[2,isOpenIdConfigResponse((o=i.sent()).body)?o.body:null];case 3:return i.sent(),[2,null];case 4:return[2]}}))}))},Authority.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in YB?YB[this.canonicalAuthority]:null},Authority.prototype.updateMetadataWithRegionalInformation=function(t){var r,o,i,s,l,u,h;return __awaiter$2(this,void 0,void 0,(function(){var m,v;return __generator(this,(function(C){switch(C.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(_B.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.environmentRegion,this.regionDiscoveryMetadata)];case 1:return m=C.sent(),v=(null===(s=this.authorityOptions.azureRegionConfiguration)||void 0===s?void 0:s.azureRegion)===rL.AZURE_REGION_AUTO_DISCOVER_FLAG?m:null===(l=this.authorityOptions.azureRegionConfiguration)||void 0===l?void 0:l.azureRegion,(null===(u=this.authorityOptions.azureRegionConfiguration)||void 0===u?void 0:u.azureRegion)===rL.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=m?SL.AUTO_DETECTION_REQUESTED_SUCCESSFUL:SL.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=m?(null===(h=this.authorityOptions.azureRegionConfiguration)||void 0===h?void 0:h.azureRegion)===m?SL.CONFIGURED_MATCHES_DETECTED:SL.CONFIGURED_NOT_DETECTED:SL.CONFIGURED_NO_AUTO_DETECTION,v?(this.regionDiscoveryMetadata.region_used=v,[2,Authority.replaceWithRegionalInformation(t,v)]):[2,t]}}))}))},Authority.prototype.updateCloudDiscoveryMetadata=function(t){var r,o;return __awaiter$2(this,void 0,void 0,(function(){var i,s,l;return __generator(this,(function(u){switch(u.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(_B.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||rL.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||rL.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(t.canonical_authority||rL.NOT_APPLICABLE)),(i=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),t.updateCloudDiscoveryMetadata(i,!1),[2,fL.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),s=t.isExpired(),this.isAuthoritySameType(t)&&t.aliasesFromNetwork&&!s?(this.logger.verbose("Found metadata in the cache."),[2,fL.CACHE]):(s&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(_B.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(i=u.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),t.updateCloudDiscoveryMetadata(i,!0),[2,fL.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(l=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),t.updateCloudDiscoveryMetadata(l,!1),[2,fL.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),iB.createUntrustedAuthorityError()}}))}))},Authority.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===FU.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=Authority.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(t){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),iB.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},Authority.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var t;return __awaiter$2(this,void 0,void 0,(function(){var r,o,i,s,l,u,h,m;return __generator(this,(function(v){switch(v.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(_B.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),r=""+rL.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",o={},i=null,v.label=1;case 1:return v.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(r,o)];case 2:if(s=v.sent(),l=void 0,u=void 0,function isCloudInstanceDiscoveryResponse(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}
/*! @azure/msal-common v12.1.0 2023-04-18 */(s.body))l=s.body,u=l.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+l.tenant_discovery_endpoint);else{if(!function isCloudInstanceDiscoveryErrorResponse(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}(s.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+s.status),(l=s.body).error===rL.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+l.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+l.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),u=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),i=Authority.getCloudDiscoveryMetadataFromNetworkResponse(u,this.hostnameAndPort),[3,4];case 3:return(h=v.sent())instanceof FL?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+h.errorCode+"\nError Description: "+h.errorMessage):(m=h,this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+m.name+"\nError Description: "+m.message)),[2,null];case 4:return i||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),i=Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,i]}}))}))},Authority.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in JB?JB[this.canonicalAuthority]:null},Authority.prototype.isInKnownAuthorities=function(){var t=this;return this.authorityOptions.knownAuthorities.filter((function(r){return BB.getDomainFromUrl(r).toLowerCase()===t.hostnameAndPort})).length>0},Authority.generateAuthority=function(t,r){var o;if(r&&r.azureCloudInstance!==OU.None){var i=r.tenant?r.tenant:rL.DEFAULT_COMMON_TENANT;o=r.azureCloudInstance+"/"+i+"/"}return o||t},Authority.createCloudDiscoveryMetadataFromHost=function(t){return{preferred_network:t,preferred_cache:t,aliases:[t]}},Authority.getCloudDiscoveryMetadataFromNetworkResponse=function(t,r){for(var o=0;o<t.length;o++){var i=t[o];if(i.aliases.indexOf(r)>-1)return i}return null},Authority.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw PU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},Authority.prototype.isAlias=function(t){return this.metadata.aliases.indexOf(t)>-1},Authority.isPublicCloudAuthority=function(t){return rL.KNOWN_PUBLIC_CLOUDS.indexOf(t)>=0},Authority.buildRegionalAuthorityString=function(t,r,o){var i=new BB(t);i.validateAsUri();var s=i.getUrlComponents(),l=r+"."+s.HostNameAndPort;this.isPublicCloudAuthority(s.HostNameAndPort)&&(l=r+"."+rL.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var u=BB.constructAuthorityUriFromObject(__assign(__assign({},i.getUrlComponents()),{HostNameAndPort:l})).urlString;return o?u+"?"+o:u},Authority.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=Authority.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=Authority.buildRegionalAuthorityString(t.token_endpoint,r,rL.REGIONAL_AUTH_NON_MSI_QUERY_STRING),t.end_session_endpoint&&(t.end_session_endpoint=Authority.buildRegionalAuthorityString(t.end_session_endpoint,r)),t},Authority.transformCIAMAuthority=function(t){var r=t,o=new BB(t).getUrlComponents();0===o.PathSegments.length&&o.HostNameAndPort.endsWith(rL.CIAM_AUTH_URL)&&(r=""+r+o.HostNameAndPort.split(".")[0]+rL.AAD_TENANT_DOMAIN_SUFFIX);return r},Authority}(),dH=function(){function AuthorityFactory(){}return AuthorityFactory.createDiscoveredInstance=function(t,r,o,i,s,l,u){return __awaiter$2(this,void 0,void 0,(function(){var h,m,v;return __generator(this,(function(C){switch(C.label){case 0:null==l||l.addQueueMeasurement(_B.AuthorityFactoryCreateDiscoveredInstance,u),h=lH.transformCIAMAuthority(t),m=AuthorityFactory.createInstance(h,r,o,i,s,l,u),C.label=1;case 1:return C.trys.push([1,3,,4]),null==l||l.setPreQueueTime(_B.AuthorityResolveEndpointsAsync,u),[4,m.resolveEndpointsAsync()];case 2:return C.sent(),[2,m];case 3:throw v=C.sent(),PU.createEndpointDiscoveryIncompleteError(v);case 4:return[2]}}))}))},AuthorityFactory.createInstance=function(t,r,o,i,s,l,u){if(RU.isEmpty(t))throw iB.createUrlEmptyError();return new lH(t,r,o,i,s,l,u)},AuthorityFactory}(),uH=function(){function ServerTelemetryEntity(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return ServerTelemetryEntity.isServerTelemetryEntity=function(t,r){var o=0===t.indexOf(wL.CACHE_KEY),i=!0;return r&&(i=r.hasOwnProperty("failedRequests")&&r.hasOwnProperty("errors")&&r.hasOwnProperty("cacheHits")),o&&i},ServerTelemetryEntity}(),hH=function(){function ThrottlingEntity(){}return ThrottlingEntity.isThrottlingEntity=function(t,r){var o=!1;t&&(o=0===t.indexOf(AL));var i=!0;return r&&(i=r.hasOwnProperty("throttleTime")),o&&i},ThrottlingEntity}(),pH={sendGetRequestAsync:function(){return Promise.reject(FL.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(FL.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},fH={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},gH={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},mH=function(t){function JoseHeaderError(r,o){var i=t.call(this,r,o)||this;return i.name="JoseHeaderError",Object.setPrototypeOf(i,JoseHeaderError.prototype),i}return __extends(JoseHeaderError,t),JoseHeaderError.createMissingKidError=function(){return new JoseHeaderError(fH.code,fH.desc)},JoseHeaderError.createMissingAlgError=function(){return new JoseHeaderError(gH.code,gH.desc)},JoseHeaderError}(FL),vH=function(){function JoseHeader(t){this.typ=t.typ,this.alg=t.alg,this.kid=t.kid}return JoseHeader.getShrHeaderString=function(t){if(!t.kid)throw mH.createMissingKidError();if(!t.alg)throw mH.createMissingAlgError();var r=new JoseHeader({typ:t.typ||EL.Pop,kid:t.kid,alg:t.alg});return JSON.stringify(r)},JoseHeader}(),yH=function(){function ServerTelemetryManager(t,r){this.cacheOutcome=TL.NO_CACHE_HIT,this.cacheManager=r,this.apiId=t.apiId,this.correlationId=t.correlationId,this.wrapperSKU=t.wrapperSKU||rL.EMPTY_STRING,this.wrapperVer=t.wrapperVer||rL.EMPTY_STRING,this.telemetryCacheKey=wL.CACHE_KEY+dL.CACHE_KEY_SEPARATOR+t.clientId}return ServerTelemetryManager.prototype.generateCurrentRequestHeaderValue=function(){var t=""+this.apiId+wL.VALUE_SEPARATOR+this.cacheOutcome,r=[this.wrapperSKU,this.wrapperVer].join(wL.VALUE_SEPARATOR),o=[t,this.getRegionDiscoveryFields()].join(wL.VALUE_SEPARATOR);return[wL.SCHEMA_VERSION,o,r].join(wL.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=ServerTelemetryManager.maxErrorsToSend(t),o=t.failedRequests.slice(0,2*r).join(wL.VALUE_SEPARATOR),i=t.errors.slice(0,r).join(wL.VALUE_SEPARATOR),s=t.errors.length,l=[s,r<s?wL.OVERFLOW_TRUE:wL.OVERFLOW_FALSE].join(wL.VALUE_SEPARATOR);return[wL.SCHEMA_VERSION,t.cacheHits,o,i,l].join(wL.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.cacheFailedRequest=function(t){var r=this.getLastRequests();r.errors.length>=wL.MAX_CACHED_ERRORS&&(r.failedRequests.shift(),r.failedRequests.shift(),r.errors.shift()),r.failedRequests.push(this.apiId,this.correlationId),RU.isEmpty(t.subError)?RU.isEmpty(t.errorCode)?t&&t.toString()?r.errors.push(t.toString()):r.errors.push(wL.UNKNOWN_ERROR):r.errors.push(t.errorCode):r.errors.push(t.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)},ServerTelemetryManager.prototype.incrementCacheHits=function(){var t=this.getLastRequests();return t.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t),t.cacheHits},ServerTelemetryManager.prototype.getLastRequests=function(){var t=new uH;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||t},ServerTelemetryManager.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=ServerTelemetryManager.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var o=new uH;o.failedRequests=t.failedRequests.slice(2*r),o.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}},ServerTelemetryManager.maxErrorsToSend=function(t){var r,o=0,i=0,s=t.errors.length;for(r=0;r<s;r++){var l=t.failedRequests[2*r]||rL.EMPTY_STRING,u=t.failedRequests[2*r+1]||rL.EMPTY_STRING,h=t.errors[r]||rL.EMPTY_STRING;if(!((i+=l.toString().length+u.toString().length+h.length+3)<wL.MAX_LAST_HEADER_BYTES))break;o+=1}return o},ServerTelemetryManager.prototype.getRegionDiscoveryFields=function(){var t=[];return t.push(this.regionUsed||rL.EMPTY_STRING),t.push(this.regionSource||rL.EMPTY_STRING),t.push(this.regionOutcome||rL.EMPTY_STRING),t.join(",")},ServerTelemetryManager.prototype.updateRegionDiscoveryMetadata=function(t){this.regionUsed=t.region_used,this.regionSource=t.region_source,this.regionOutcome=t.region_outcome},ServerTelemetryManager.prototype.setCacheOutcome=function(t){this.cacheOutcome=t},ServerTelemetryManager}(),bH=function(){function PerformanceClient(t,r,o,i,s,l){this.authority=r,this.libraryName=i,this.libraryVersion=s,this.applicationTelemetry=l,this.clientId=t,this.logger=o,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return PerformanceClient.prototype.startPerformanceMeasurement=function(t,r){return{}},PerformanceClient.prototype.startPerformanceMeasuremeant=function(t,r){return{}},PerformanceClient.prototype.getIntFields=function(){return $B},PerformanceClient.prototype.getPreQueueTime=function(t,r){var o=this.preQueueTimeByCorrelationId.get(r);if(o){if(o.name===t)return o.time;this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+t+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+r+", unable to add queue measurement")},PerformanceClient.prototype.calculateQueuedTime=function(t,r){return t<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+t),0):r<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+r),0):r<t?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):r-t},PerformanceClient.prototype.addQueueMeasurement=function(t,r,o,i){if(r){if(0===o)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+t+" is "+o);else if(!o)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+t);var s={eventName:t,queueTime:o,manuallyCompleted:i},l=this.queueMeasurements.get(r);if(l)l.push(s),this.queueMeasurements.set(r,l);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+r+" to queue measurements");var u=[s];this.queueMeasurements.set(r,u)}this.preQueueTimeByCorrelationId.delete(r)}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+t+", cannot add queue measurement")},PerformanceClient.prototype.startMeasurement=function(t,r){var o,i,s=this,l=r||this.generateId();r||this.logger.info("PerformanceClient: No correlation id provided for "+t+", generating",l),this.logger.trace("PerformanceClient: Performance measurement started for "+t,l);var u=this.startPerformanceMeasuremeant(t,l);u.startMeasurement();var h={eventId:this.generateId(),status:kB.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:t,startTimeMs:Date.now(),correlationId:l,appName:null===(o=this.applicationTelemetry)||void 0===o?void 0:o.appName,appVersion:null===(i=this.applicationTelemetry)||void 0===i?void 0:i.appVersion};return this.cacheEventByCorrelationId(h),{endMeasurement:function(t){return s.endMeasurement(__assign(__assign({},h),t),u)},discardMeasurement:function(){return s.discardMeasurements(h.correlationId)},addStaticFields:function(t){return s.addStaticFields(t,h.correlationId)},increment:function(t){return s.increment(t,h.correlationId)},measurement:u,event:h}},PerformanceClient.prototype.endMeasurement=function(t,r){var o,i,s=this,l=this.eventsByCorrelationId.get(t.correlationId);if(!l)return this.logger.trace("PerformanceClient: Measurement not found for "+t.eventId,t.correlationId),null;var u=t.eventId===l.eventId,h={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};u?(h=this.getQueueInfo(t.correlationId),this.discardCache(l.correlationId)):null===(o=l.incompleteSubMeasurements)||void 0===o||o.delete(t.eventId),null==r||r.endMeasurement();var m=null==r?void 0:r.flushMeasurement();if(!m)return this.logger.trace("PerformanceClient: Performance measurement not taken",l.correlationId),null;if(this.logger.trace("PerformanceClient: Performance measurement ended for "+t.name+": "+m+" ms",t.correlationId),!u)return l[t.name+"DurationMs"]=Math.floor(m),__assign({},l);var v=__assign(__assign({},l),t),C=0;return null===(i=v.incompleteSubMeasurements)||void 0===i||i.forEach((function(r){s.logger.trace("PerformanceClient: Incomplete submeasurement "+r.name+" found for "+t.name,v.correlationId),C++})),v.incompleteSubMeasurements=void 0,v=__assign(__assign({},v),{durationMs:Math.round(m),queuedTimeMs:h.totalQueueTime,queuedCount:h.totalQueueCount,queuedManuallyCompletedCount:h.manuallyCompletedCount,status:kB.Completed,incompleteSubsCount:C}),this.truncateIntegralFields(v,this.getIntFields()),this.emitEvents([v],t.correlationId),v},PerformanceClient.prototype.addStaticFields=function(t,r){this.logger.trace("PerformanceClient: Updating static fields");var o=this.eventsByCorrelationId.get(r);o?this.eventsByCorrelationId.set(r,__assign(__assign({},o),t)):this.logger.trace("PerformanceClient: Event not found for",r)},PerformanceClient.prototype.increment=function(t,r){this.logger.trace("PerformanceClient: Updating counters");var o=this.eventsByCorrelationId.get(r);if(o)for(var i in t)o.hasOwnProperty(i)||(o[i]=0),o[i]+=t[i];else this.logger.trace("PerformanceClient: Event not found for",r)},PerformanceClient.prototype.cacheEventByCorrelationId=function(t){var r=this.eventsByCorrelationId.get(t.correlationId);r?(this.logger.trace("PerformanceClient: Performance measurement for "+t.name+" added/updated",t.correlationId),r.incompleteSubMeasurements=r.incompleteSubMeasurements||new Map,r.incompleteSubMeasurements.set(t.eventId,{name:t.name,startTimeMs:t.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+t.name+" started",t.correlationId),this.eventsByCorrelationId.set(t.correlationId,__assign({},t)))},PerformanceClient.prototype.getQueueInfo=function(t){var r=this.queueMeasurements.get(t);r||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+t);var o=0,i=0,s=0;return null==r||r.forEach((function(t){o+=t.queueTime,i++,s+=t.manuallyCompleted?1:0})),{totalQueueTime:o,totalQueueCount:i,manuallyCompletedCount:s}},PerformanceClient.prototype.discardMeasurements=function(t){this.logger.trace("PerformanceClient: Performance measurements discarded",t),this.eventsByCorrelationId.delete(t)},PerformanceClient.prototype.discardCache=function(t){this.discardMeasurements(t),this.logger.trace("PerformanceClient: QueueMeasurements discarded",t),this.queueMeasurements.delete(t),this.logger.trace("PerformanceClient: Pre-queue times discarded",t),this.preQueueTimeByCorrelationId.delete(t)},PerformanceClient.prototype.addPerformanceCallback=function(t){var r=this.generateId();return this.callbacks.set(r,t),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+r),r},PerformanceClient.prototype.removePerformanceCallback=function(t){var r=this.callbacks.delete(t);return r?this.logger.verbose("PerformanceClient: Performance callback "+t+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+t+" not removed."),r},PerformanceClient.prototype.emitEvents=function(t,r){var o=this;this.logger.verbose("PerformanceClient: Emitting performance events",r),this.callbacks.forEach((function(i,s){o.logger.trace("PerformanceClient: Emitting event to callback "+s,r),i.apply(null,[t])}))},PerformanceClient.prototype.truncateIntegralFields=function(t,r){r.forEach((function(r){r in t&&"number"==typeof t[r]&&(t[r]=Math.floor(t[r]))}))},PerformanceClient}(),wH=function(){function StubPerformanceMeasurement(){}return StubPerformanceMeasurement.prototype.startMeasurement=function(){},StubPerformanceMeasurement.prototype.endMeasurement=function(){},StubPerformanceMeasurement.prototype.flushMeasurement=function(){return null},StubPerformanceMeasurement}(),CH=function(t){function StubPerformanceClient(){return null!==t&&t.apply(this,arguments)||this}return __extends(StubPerformanceClient,t),StubPerformanceClient.prototype.generateId=function(){return"callback-id"},StubPerformanceClient.prototype.startPerformanceMeasuremeant=function(){return new wH},StubPerformanceClient.prototype.startPerformanceMeasurement=function(){return new wH},StubPerformanceClient.prototype.calculateQueuedTime=function(t,r){return 0},StubPerformanceClient.prototype.addQueueMeasurement=function(t,r,o){},StubPerformanceClient.prototype.setPreQueueTime=function(t,r){},StubPerformanceClient}(bH),_H={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},kH={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},SH={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},TH={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},EH={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},xH={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},IH={code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},AH={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},PH={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},RH={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},OH={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},NH={code:"empty_window_error",desc:"window.open returned null or undefined window object."},MH={code:"user_cancelled",desc:"User cancelled the flow."},DH={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},FH={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},LH={code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},UH={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},BH={code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},HH={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},$H={code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},qH={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},jH={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},zH={code:"no_token_request_cache_error",desc:"No token request found in cache."},GH={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},VH={code:"no_cached_authority_error",desc:"No cached authority found."},KH={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},WH={code:"invalid_cache_type",desc:"Invalid cache type"},QH={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},YH={code:"database_not_open",desc:"Database is not open!"},JH={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},XH={code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},ZH={code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},e$={code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},t$={code:"unable_to_load_token",desc:"Error loading token to cache."},r$={code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},o$={code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},n$={code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},i$={code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},s$={code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},a$={code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},c$={code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},l$={code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},d$={code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},u$={code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},h$={code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."},p$=function(t){function BrowserAuthError(r,o){var i=t.call(this,r,o)||this;return Object.setPrototypeOf(i,BrowserAuthError.prototype),i.name="BrowserAuthError",i}return __extends$1(BrowserAuthError,t),BrowserAuthError.createPkceNotGeneratedError=function(t){return new BrowserAuthError(_H.code,_H.desc+" Detail:"+t)},BrowserAuthError.createCryptoNotAvailableError=function(t){return new BrowserAuthError(kH.code,kH.desc+" Detail:"+t)},BrowserAuthError.createHttpMethodNotImplementedError=function(t){return new BrowserAuthError(SH.code,SH.desc+" Given Method: "+t)},BrowserAuthError.createEmptyNavigationUriError=function(){return new BrowserAuthError(TH.code,TH.desc)},BrowserAuthError.createEmptyHashError=function(t){return new BrowserAuthError(EH.code,EH.desc+" Given Url: "+t)},BrowserAuthError.createHashDoesNotContainStateError=function(){return new BrowserAuthError(xH.code,xH.desc)},BrowserAuthError.createHashDoesNotContainKnownPropertiesError=function(){return new BrowserAuthError(IH.code,IH.desc)},BrowserAuthError.createUnableToParseStateError=function(){return new BrowserAuthError(AH.code,AH.desc)},BrowserAuthError.createStateInteractionTypeMismatchError=function(){return new BrowserAuthError(PH.code,PH.desc)},BrowserAuthError.createInteractionInProgressError=function(){return new BrowserAuthError(RH.code,RH.desc)},BrowserAuthError.createPopupWindowError=function(t){var r=OH.desc;return r=RU.isEmpty(t)?r:r+" Details: "+t,new BrowserAuthError(OH.code,r)},BrowserAuthError.createEmptyWindowCreatedError=function(){return new BrowserAuthError(NH.code,NH.desc)},BrowserAuthError.createUserCancelledError=function(){return new BrowserAuthError(MH.code,MH.desc)},BrowserAuthError.createMonitorPopupTimeoutError=function(){return new BrowserAuthError(DH.code,DH.desc)},BrowserAuthError.createMonitorIframeTimeoutError=function(){return new BrowserAuthError(FH.code,FH.desc)},BrowserAuthError.createRedirectInIframeError=function(t){return new BrowserAuthError(LH.code,LH.desc+" (window.parent !== window) => "+t)},BrowserAuthError.createBlockReloadInHiddenIframeError=function(){return new BrowserAuthError(UH.code,UH.desc)},BrowserAuthError.createBlockAcquireTokenInPopupsError=function(){return new BrowserAuthError(BH.code,BH.desc)},BrowserAuthError.createIframeClosedPrematurelyError=function(){return new BrowserAuthError(HH.code,HH.desc)},BrowserAuthError.createSilentLogoutUnsupportedError=function(){return new BrowserAuthError($H.code,$H.desc)},BrowserAuthError.createNoAccountError=function(){return new BrowserAuthError(qH.code,qH.desc)},BrowserAuthError.createSilentPromptValueError=function(t){return new BrowserAuthError(jH.code,jH.desc+" Given value: "+t)},BrowserAuthError.createUnableToParseTokenRequestCacheError=function(){return new BrowserAuthError(GH.code,GH.desc)},BrowserAuthError.createNoTokenRequestCacheError=function(){return new BrowserAuthError(zH.code,zH.desc)},BrowserAuthError.createAuthRequestNotSetError=function(){return new BrowserAuthError(KH.code,KH.desc)},BrowserAuthError.createNoCachedAuthorityError=function(){return new BrowserAuthError(VH.code,VH.desc)},BrowserAuthError.createInvalidCacheTypeError=function(){return new BrowserAuthError(WH.code,""+WH.desc)},BrowserAuthError.createNonBrowserEnvironmentError=function(){return new BrowserAuthError(QH.code,QH.desc)},BrowserAuthError.createDatabaseNotOpenError=function(){return new BrowserAuthError(YH.code,YH.desc)},BrowserAuthError.createNoNetworkConnectivityError=function(){return new BrowserAuthError(JH.code,JH.desc)},BrowserAuthError.createPostRequestFailedError=function(t,r){return new BrowserAuthError(XH.code,XH.desc+" | Network client threw: "+t+" | Attempted to reach: "+r.split("?")[0])},BrowserAuthError.createGetRequestFailedError=function(t,r){return new BrowserAuthError(ZH.code,ZH.desc+" | Network client threw: "+t+" | Attempted to reach: "+r.split("?")[0])},BrowserAuthError.createFailedToParseNetworkResponseError=function(t){return new BrowserAuthError(e$.code,e$.desc+" | Attempted to reach: "+t.split("?")[0])},BrowserAuthError.createUnableToLoadTokenError=function(t){return new BrowserAuthError(t$.code,t$.desc+" | "+t)},BrowserAuthError.createSigningKeyNotFoundInStorageError=function(t){return new BrowserAuthError(r$.code,r$.desc+" | No match found for KeyId: "+t)},BrowserAuthError.createAuthCodeRequiredError=function(){return new BrowserAuthError(o$.code,o$.desc)},BrowserAuthError.createAuthCodeOrNativeAccountIdRequiredError=function(){return new BrowserAuthError(n$.code,n$.desc)},BrowserAuthError.createSpaCodeAndNativeAccountIdPresentError=function(){return new BrowserAuthError(i$.code,i$.desc)},BrowserAuthError.createDatabaseUnavailableError=function(){return new BrowserAuthError(s$.code,s$.desc)},BrowserAuthError.createUnableToAcquireTokenFromNativePlatformError=function(){return new BrowserAuthError(a$.code,a$.desc)},BrowserAuthError.createNativeHandshakeTimeoutError=function(){return new BrowserAuthError(c$.code,c$.desc)},BrowserAuthError.createNativeExtensionNotInstalledError=function(){return new BrowserAuthError(l$.code,l$.desc)},BrowserAuthError.createNativeConnectionNotEstablishedError=function(){return new BrowserAuthError(d$.code,d$.desc)},BrowserAuthError.createNativeBrokerCalledBeforeInitialize=function(){return new BrowserAuthError(u$.code,u$.desc)},BrowserAuthError.createNativePromptParameterNotSupportedError=function(){return new BrowserAuthError(h$.code,h$.desc)},BrowserAuthError}(FL),f$={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},g$="53ee284d-920a-4b59-9d30-a60315b26836",m$="ppnbnpeolgkicgegkbkbjmhlideopiji",v$="MATS";
/*! @azure/msal-common v12.1.0 2023-04-18 */!function(t){t.HandshakeRequest="Handshake",t.HandshakeResponse="HandshakeResponse",t.GetToken="GetToken",t.Response="Response"}(ZB||(ZB={})),function(t){t.LocalStorage="localStorage",t.SessionStorage="sessionStorage",t.MemoryStorage="memoryStorage"}(eH||(eH={})),function(t){t.GET="GET",t.POST="POST"}(tH||(tH={})),function(t){t.AUTHORITY="authority",t.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",t.SESSION_STATE="session.state",t.REQUEST_STATE="request.state",t.NONCE_IDTOKEN="nonce.id_token",t.ORIGIN_URI="request.origin",t.RENEW_STATUS="token.renew.status",t.URL_HASH="urlHash",t.REQUEST_PARAMS="request.params",t.SCOPES="scopes",t.INTERACTION_STATUS_KEY="interaction.status",t.CCS_CREDENTIAL="ccs.credential",t.CORRELATION_ID="request.correlationId",t.NATIVE_REQUEST="request.native",t.REDIRECT_CONTEXT="request.redirect.context"}(rH||(rH={})),function(t){t.ACCOUNT_KEYS="msal.account.keys",t.TOKEN_KEYS="msal.token.keys"}(oH||(oH={})),function(t){t.WRAPPER_SKU="wrapper.sku",t.WRAPPER_VER="wrapper.version"}(nH||(nH={})),function(t){t[t.acquireTokenRedirect=861]="acquireTokenRedirect",t[t.acquireTokenPopup=862]="acquireTokenPopup",t[t.ssoSilent=863]="ssoSilent",t[t.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",t[t.handleRedirectPromise=865]="handleRedirectPromise",t[t.acquireTokenByCode=866]="acquireTokenByCode",t[t.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",t[t.logout=961]="logout",t[t.logoutPopup=962]="logoutPopup"}(iH||(iH={})),function(t){t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none"}(sH||(sH={})),function(t){t.Startup="startup",t.Login="login",t.Logout="logout",t.AcquireToken="acquireToken",t.SsoSilent="ssoSilent",t.HandleRedirect="handleRedirect",t.None="none"}(aH||(aH={}));var y$,b$={scopes:oL},w$="jwk";!function(t){t.React="@azure/msal-react",t.Angular="@azure/msal-angular"}(y$||(y$={}));var C$,_$="msal.db",k$=_$+".keys";!function(t){t[t.Default=0]="Default",t[t.AccessToken=1]="AccessToken",t[t.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",t[t.RefreshToken=3]="RefreshToken",t[t.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",t[t.Skip=5]="Skip"}(C$||(C$={}));
/*! @azure/msal-browser v2.36.0 2023-04-18 */
var S$,T$,E$={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},x$={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},I$={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},A$={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},P$={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},R$={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},O$={code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."},N$=function(t){function BrowserConfigurationAuthError(r,o){var i=t.call(this,r,o)||this;return i.name="BrowserConfigurationAuthError",Object.setPrototypeOf(i,BrowserConfigurationAuthError.prototype),i}return __extends$1(BrowserConfigurationAuthError,t),BrowserConfigurationAuthError.createRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(E$.code,E$.desc)},BrowserConfigurationAuthError.createPostLogoutRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(x$.code,x$.desc)},BrowserConfigurationAuthError.createStorageNotSupportedError=function(t){return new BrowserConfigurationAuthError(I$.code,I$.desc+" Given Location: "+t)},BrowserConfigurationAuthError.createRedirectCallbacksNotSetError=function(){return new BrowserConfigurationAuthError(A$.code,A$.desc)},BrowserConfigurationAuthError.createStubPcaInstanceCalledError=function(){return new BrowserConfigurationAuthError(P$.code,P$.desc)},BrowserConfigurationAuthError.createInMemoryRedirectUnavailableError=function(){return new BrowserConfigurationAuthError(R$.code,R$.desc)},BrowserConfigurationAuthError.createEntropyNotProvided=function(){return new BrowserConfigurationAuthError(O$.code,O$.desc)},BrowserConfigurationAuthError}(FL),M$=function(){function BrowserStorage(t){this.validateWindowStorage(t),this.windowStorage=window[t]}return BrowserStorage.prototype.validateWindowStorage=function(t){if(t!==eH.LocalStorage&&t!==eH.SessionStorage)throw N$.createStorageNotSupportedError(t);if(!!!window[t])throw N$.createStorageNotSupportedError(t)},BrowserStorage.prototype.getItem=function(t){return this.windowStorage.getItem(t)},BrowserStorage.prototype.setItem=function(t,r){this.windowStorage.setItem(t,r)},BrowserStorage.prototype.removeItem=function(t){this.windowStorage.removeItem(t)},BrowserStorage.prototype.getKeys=function(){return Object.keys(this.windowStorage)},BrowserStorage.prototype.containsKey=function(t){return this.windowStorage.hasOwnProperty(t)},BrowserStorage}(),D$=function(){function MemoryStorage(){this.cache=new Map}return MemoryStorage.prototype.getItem=function(t){return this.cache.get(t)||null},MemoryStorage.prototype.setItem=function(t,r){this.cache.set(t,r)},MemoryStorage.prototype.removeItem=function(t){this.cache.delete(t)},MemoryStorage.prototype.getKeys=function(){var t=[];return this.cache.forEach((function(r,o){t.push(o)})),t},MemoryStorage.prototype.containsKey=function(t){return this.cache.has(t)},MemoryStorage.prototype.clear=function(){this.cache.clear()},MemoryStorage}(),F$=function(){function BrowserProtocolUtils(){}return BrowserProtocolUtils.extractBrowserRequestState=function(t,r){if(RU.isEmpty(r))return null;try{return UB.parseRequestState(t,r).libraryState.meta}catch(t){throw PU.createInvalidStateError(r,t)}},BrowserProtocolUtils.parseServerResponseFromHash=function(t){if(!t)return{};var r=new BB(t);return BB.getDeserializedHash(r.getHash())},BrowserProtocolUtils}(),L$=function(t){function BrowserCacheManager(r,o,i,s){var l=t.call(this,r,i,s)||this;return l.COOKIE_LIFE_MULTIPLIER=864e5,l.cacheConfig=o,l.logger=s,l.internalStorage=new D$,l.browserStorage=l.setupBrowserStorage(l.cacheConfig.cacheLocation),l.temporaryCacheStorage=l.setupTemporaryCacheStorage(l.cacheConfig.temporaryCacheLocation,l.cacheConfig.cacheLocation),o.cacheMigrationEnabled&&(l.migrateCacheEntries(),l.createKeyMaps()),l}return __extends$1(BrowserCacheManager,t),BrowserCacheManager.prototype.setupBrowserStorage=function(t){switch(t){case eH.LocalStorage:case eH.SessionStorage:try{return new M$(t)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=eH.MemoryStorage,new D$},BrowserCacheManager.prototype.setupTemporaryCacheStorage=function(t,r){switch(r){case eH.LocalStorage:case eH.SessionStorage:try{return new M$(t||eH.SessionStorage)}catch(t){return this.logger.verbose(t),this.internalStorage}case eH.MemoryStorage:default:return this.internalStorage}},BrowserCacheManager.prototype.migrateCacheEntries=function(){var t=this,r=rL.CACHE_PREFIX+"."+XF.ID_TOKEN,o=rL.CACHE_PREFIX+"."+XF.CLIENT_INFO,i=rL.CACHE_PREFIX+"."+XF.ERROR,s=rL.CACHE_PREFIX+"."+XF.ERROR_DESC,l=[this.browserStorage.getItem(r),this.browserStorage.getItem(o),this.browserStorage.getItem(i),this.browserStorage.getItem(s)];[XF.ID_TOKEN,XF.CLIENT_INFO,XF.ERROR,XF.ERROR_DESC].forEach((function(r,o){return t.migrateCacheEntry(r,l[o])}))},BrowserCacheManager.prototype.migrateCacheEntry=function(t,r){r&&this.setTemporaryCache(t,r,!0)},BrowserCacheManager.prototype.createKeyMaps=function(){var t=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var r=this.getItem(oH.ACCOUNT_KEYS),o=this.getItem(oH.TOKEN_KEYS+"."+this.clientId);r&&o?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((function(r){var o;if(t.isCredentialKey(r)&&(o=t.getItem(r))){var i=t.validateAndParseJson(o);if(i&&i.hasOwnProperty("credentialType"))switch(i.credentialType){case uL.ID_TOKEN:if(IB.isIdTokenEntity(i)){t.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+r+" found, saving key to token key map");var s=lB.toObject(new IB,i),l=t.updateCredentialCacheKey(r,s);return void t.addTokenKey(l,uL.ID_TOKEN)}t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+r);break;case uL.ACCESS_TOKEN:case uL.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(PB.isAccessTokenEntity(i)){t.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+r+" found, saving key to token key map");var u=lB.toObject(new PB,i);l=t.updateCredentialCacheKey(r,u);return void t.addTokenKey(l,uL.ACCESS_TOKEN)}t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+r);break;case uL.REFRESH_TOKEN:if(RB.isRefreshTokenEntity(i)){t.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+r+" found, saving key to token key map");var h=lB.toObject(new RB,i);l=t.updateCredentialCacheKey(r,h);return void t.addTokenKey(l,uL.REFRESH_TOKEN)}t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+r)}}if(t.isAccountKey(r)&&(o=t.getItem(r))){var m=t.validateAndParseJson(o);m&&aB.isAccountEntity(m)&&(t.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+r+" found, saving key to account key map"),t.addAccountKeyToMap(r))}}))},BrowserCacheManager.prototype.validateAndParseJson=function(t){try{var r=JSON.parse(t);return r&&"object"==typeof r?r:null}catch(t){return null}},BrowserCacheManager.prototype.getItem=function(t){return this.browserStorage.getItem(t)},BrowserCacheManager.prototype.setItem=function(t,r){this.browserStorage.setItem(t,r)},BrowserCacheManager.prototype.getAccount=function(t){this.logger.trace("BrowserCacheManager.getAccount called");var r=this.getItem(t);if(!r)return this.removeAccountKeyFromMap(t),null;var o=this.validateAndParseJson(r);return o&&aB.isAccountEntity(o)?lB.toObject(new aB,o):(this.removeAccountKeyFromMap(t),null)},BrowserCacheManager.prototype.setAccount=function(t){this.logger.trace("BrowserCacheManager.setAccount called");var r=t.generateAccountKey();this.setItem(r,JSON.stringify(t)),this.addAccountKeyToMap(r)},BrowserCacheManager.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var t=this.getItem(oH.ACCOUNT_KEYS);return t?JSON.parse(t):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},BrowserCacheManager.prototype.addAccountKeyToMap=function(t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+t);var r=this.getAccountKeys();-1===r.indexOf(t)?(r.push(t),this.setItem(oH.ACCOUNT_KEYS,JSON.stringify(r)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},BrowserCacheManager.prototype.removeAccountKeyFromMap=function(t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+t);var r=this.getAccountKeys(),o=r.indexOf(t);o>-1?(r.splice(o,1),this.setItem(oH.ACCOUNT_KEYS,JSON.stringify(r)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},BrowserCacheManager.prototype.removeAccount=function(r){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return t.prototype.removeAccount.call(this,r),this.removeAccountKeyFromMap(r),[2]}))}))},BrowserCacheManager.prototype.removeIdToken=function(r){t.prototype.removeIdToken.call(this,r),this.removeTokenKey(r,uL.ID_TOKEN)},BrowserCacheManager.prototype.removeAccessToken=function(r){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return t.prototype.removeAccessToken.call(this,r),this.removeTokenKey(r,uL.ACCESS_TOKEN),[2]}))}))},BrowserCacheManager.prototype.removeRefreshToken=function(r){t.prototype.removeRefreshToken.call(this,r),this.removeTokenKey(r,uL.REFRESH_TOKEN)},BrowserCacheManager.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var t=this.getItem(oH.TOKEN_KEYS+"."+this.clientId);if(t){var r=this.validateAndParseJson(t);if(r&&r.hasOwnProperty("idToken")&&r.hasOwnProperty("accessToken")&&r.hasOwnProperty("refreshToken"))return r;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},BrowserCacheManager.prototype.addTokenKey=function(t,r){this.logger.trace("BrowserCacheManager addTokenKey called");var o=this.getTokenKeys();switch(r){case uL.ID_TOKEN:-1===o.idToken.indexOf(t)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),o.idToken.push(t));break;case uL.ACCESS_TOKEN:-1===o.accessToken.indexOf(t)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),o.accessToken.push(t));break;case uL.REFRESH_TOKEN:-1===o.refreshToken.indexOf(t)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),o.refreshToken.push(t));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+r),PU.createUnexpectedCredentialTypeError()}this.setItem(oH.TOKEN_KEYS+"."+this.clientId,JSON.stringify(o))},BrowserCacheManager.prototype.removeTokenKey=function(t,r){this.logger.trace("BrowserCacheManager removeTokenKey called");var o=this.getTokenKeys();switch(r){case uL.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+t+" from map");var i=o.idToken.indexOf(t);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),o.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case uL.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+t+" from map");var s=o.accessToken.indexOf(t);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),o.accessToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case uL.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+t+" from map");var l=o.refreshToken.indexOf(t);l>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),o.refreshToken.splice(l,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+r),PU.createUnexpectedCredentialTypeError()}this.setItem(oH.TOKEN_KEYS+"."+this.clientId,JSON.stringify(o))},BrowserCacheManager.prototype.getIdTokenCredential=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,uL.ID_TOKEN),null;var o=this.validateAndParseJson(r);return o&&IB.isIdTokenEntity(o)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),lB.toObject(new IB,o)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,uL.ID_TOKEN),null)},BrowserCacheManager.prototype.setIdTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var r=t.generateCredentialKey();this.setItem(r,JSON.stringify(t)),this.addTokenKey(r,uL.ID_TOKEN)},BrowserCacheManager.prototype.getAccessTokenCredential=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,uL.ACCESS_TOKEN),null;var o=this.validateAndParseJson(r);return o&&PB.isAccessTokenEntity(o)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),lB.toObject(new PB,o)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,uL.ACCESS_TOKEN),null)},BrowserCacheManager.prototype.setAccessTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var r=t.generateCredentialKey();this.setItem(r,JSON.stringify(t)),this.addTokenKey(r,uL.ACCESS_TOKEN)},BrowserCacheManager.prototype.getRefreshTokenCredential=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,uL.REFRESH_TOKEN),null;var o=this.validateAndParseJson(r);return o&&RB.isRefreshTokenEntity(o)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),lB.toObject(new RB,o)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,uL.REFRESH_TOKEN),null)},BrowserCacheManager.prototype.setRefreshTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var r=t.generateCredentialKey();this.setItem(r,JSON.stringify(t)),this.addTokenKey(r,uL.REFRESH_TOKEN)},BrowserCacheManager.prototype.getAppMetadata=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var o=this.validateAndParseJson(r);return o&&jB.isAppMetadataEntity(t,o)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),lB.toObject(new jB,o)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},BrowserCacheManager.prototype.setAppMetadata=function(t){this.logger.trace("BrowserCacheManager.setAppMetadata called");var r=t.generateAppMetadataKey();this.setItem(r,JSON.stringify(t))},BrowserCacheManager.prototype.getServerTelemetry=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var o=this.validateAndParseJson(r);return o&&uH.isServerTelemetryEntity(t,o)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),lB.toObject(new uH,o)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},BrowserCacheManager.prototype.setServerTelemetry=function(t,r){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(t,JSON.stringify(r))},BrowserCacheManager.prototype.getAuthorityMetadata=function(t){var r=this.internalStorage.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var o=this.validateAndParseJson(r);return o&&XB.isAuthorityMetadataEntity(t,o)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),lB.toObject(new XB,o)):null},BrowserCacheManager.prototype.getAuthorityMetadataKeys=function(){var t=this;return this.internalStorage.getKeys().filter((function(r){return t.isAuthorityMetadata(r)}))},BrowserCacheManager.prototype.setWrapperMetadata=function(t,r){this.internalStorage.setItem(nH.WRAPPER_SKU,t),this.internalStorage.setItem(nH.WRAPPER_VER,r)},BrowserCacheManager.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(nH.WRAPPER_SKU)||rL.EMPTY_STRING,this.internalStorage.getItem(nH.WRAPPER_VER)||rL.EMPTY_STRING]},BrowserCacheManager.prototype.setAuthorityMetadata=function(t,r){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(t,JSON.stringify(r))},BrowserCacheManager.prototype.getActiveAccount=function(){var t=this.generateCacheKey(XF.ACTIVE_ACCOUNT_FILTERS),r=this.getItem(t);if(!r){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var o=this.generateCacheKey(XF.ACTIVE_ACCOUNT),i=this.getItem(o);if(!i)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var s=this.getAccountInfoByFilter({localAccountId:i})[0]||null;return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(s),s):null}var l=this.validateAndParseJson(r);return l?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:l.homeAccountId,localAccountId:l.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},BrowserCacheManager.prototype.setActiveAccount=function(t){var r=this.generateCacheKey(XF.ACTIVE_ACCOUNT_FILTERS),o=this.generateCacheKey(XF.ACTIVE_ACCOUNT);if(t){this.logger.verbose("setActiveAccount: Active account set");var i={homeAccountId:t.homeAccountId,localAccountId:t.localAccountId};this.browserStorage.setItem(r,JSON.stringify(i)),this.browserStorage.setItem(o,t.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(r),this.browserStorage.removeItem(o)},BrowserCacheManager.prototype.getAccountInfoByFilter=function(t){var r=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+r.length+" accounts found"),r.filter((function(r){return(!t.username||t.username.toLowerCase()===r.username.toLowerCase())&&((!t.homeAccountId||t.homeAccountId===r.homeAccountId)&&((!t.localAccountId||t.localAccountId===r.localAccountId)&&((!t.tenantId||t.tenantId===r.tenantId)&&(!t.environment||t.environment===r.environment))))}))},BrowserCacheManager.prototype.getAccountInfoByHints=function(t,r){var o=this.getAllAccounts().filter((function(o){if(r){var i=o.idTokenClaims&&o.idTokenClaims.sid;return r===i}return!!t&&t===o.username}));if(1===o.length)return o[0];if(o.length>1)throw PU.createMultipleMatchingAccountsInCacheError();return null},BrowserCacheManager.prototype.getThrottlingCache=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var o=this.validateAndParseJson(r);return o&&hH.isThrottlingEntity(t,o)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),lB.toObject(new hH,o)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},BrowserCacheManager.prototype.setThrottlingCache=function(t,r){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(t,JSON.stringify(r))},BrowserCacheManager.prototype.getTemporaryCache=function(t,r){var o=r?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){var i=this.getItemCookie(o);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}var s=this.temporaryCacheStorage.getItem(o);if(!s){if(this.cacheConfig.cacheLocation===eH.LocalStorage){var l=this.browserStorage.getItem(o);if(l)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),l}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s},BrowserCacheManager.prototype.setTemporaryCache=function(t,r,o){var i=o?this.generateCacheKey(t):t;this.temporaryCacheStorage.setItem(i,r),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(i,r))},BrowserCacheManager.prototype.removeItem=function(t){this.browserStorage.removeItem(t),this.temporaryCacheStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(t))},BrowserCacheManager.prototype.containsKey=function(t){return this.browserStorage.containsKey(t)||this.temporaryCacheStorage.containsKey(t)},BrowserCacheManager.prototype.getKeys=function(){return __spread(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},BrowserCacheManager.prototype.clear=function(){return __awaiter$3(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(r){switch(r.label){case 0:return[4,this.removeAllAccounts()];case 1:return r.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(r){!t.browserStorage.containsKey(r)&&!t.temporaryCacheStorage.containsKey(r)||-1===r.indexOf(rL.CACHE_PREFIX)&&-1===r.indexOf(t.clientId)||t.removeItem(r)})),this.internalStorage.clear(),[2]}}))}))},BrowserCacheManager.prototype.setItemCookie=function(t,r,o){var i=encodeURIComponent(t)+"="+encodeURIComponent(r)+";path=/;SameSite=Lax;";o&&(i+="expires="+this.getCookieExpirationTime(o)+";");this.cacheConfig.secureCookies&&(i+="Secure;"),document.cookie=i},BrowserCacheManager.prototype.getItemCookie=function(t){for(var r=encodeURIComponent(t)+"=",o=document.cookie.split(";"),i=0;i<o.length;i++){for(var s=o[i];" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(r))return decodeURIComponent(s.substring(r.length,s.length))}return rL.EMPTY_STRING},BrowserCacheManager.prototype.clearMsalCookies=function(){var t=this,r=rL.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(o){for(;" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(r)){var i=o.split("=")[0];t.clearItemCookie(i)}}))},BrowserCacheManager.prototype.clearItemCookie=function(t){this.setItemCookie(t,rL.EMPTY_STRING,-1)},BrowserCacheManager.prototype.getCookieExpirationTime=function(t){var r=new Date;return new Date(r.getTime()+t*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},BrowserCacheManager.prototype.getCache=function(){return this.browserStorage},BrowserCacheManager.prototype.setCache=function(){},BrowserCacheManager.prototype.generateCacheKey=function(t){return this.validateAndParseJson(t)?JSON.stringify(t):RU.startsWith(t,rL.CACHE_PREFIX)||RU.startsWith(t,XF.ADAL_ID_TOKEN)?t:rL.CACHE_PREFIX+"."+this.clientId+"."+t},BrowserCacheManager.prototype.generateAuthorityKey=function(t){var r=UB.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(rH.AUTHORITY+"."+r)},BrowserCacheManager.prototype.generateNonceKey=function(t){var r=UB.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(rH.NONCE_IDTOKEN+"."+r)},BrowserCacheManager.prototype.generateStateKey=function(t){var r=UB.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(rH.REQUEST_STATE+"."+r)},BrowserCacheManager.prototype.getCachedAuthority=function(t){var r=this.generateStateKey(t),o=this.getTemporaryCache(r);if(!o)return null;var i=this.generateAuthorityKey(o);return this.getTemporaryCache(i)},BrowserCacheManager.prototype.updateCacheEntries=function(t,r,o,i,s){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var l=this.generateStateKey(t);this.setTemporaryCache(l,t,!1);var u=this.generateNonceKey(t);this.setTemporaryCache(u,r,!1);var h=this.generateAuthorityKey(t);if(this.setTemporaryCache(h,o,!1),s){var m={credential:s.homeAccountId,type:yB.HOME_ACCOUNT_ID};this.setTemporaryCache(rH.CCS_CREDENTIAL,JSON.stringify(m),!0)}else if(!RU.isEmpty(i)){m={credential:i,type:yB.UPN};this.setTemporaryCache(rH.CCS_CREDENTIAL,JSON.stringify(m),!0)}},BrowserCacheManager.prototype.resetRequestCache=function(t){var r=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),RU.isEmpty(t)||this.getKeys().forEach((function(o){-1!==o.indexOf(t)&&r.removeItem(o)})),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(rH.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(rH.ORIGIN_URI)),this.removeItem(this.generateCacheKey(rH.URL_HASH)),this.removeItem(this.generateCacheKey(rH.CORRELATION_ID)),this.removeItem(this.generateCacheKey(rH.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(rH.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},BrowserCacheManager.prototype.cleanRequestByState=function(t){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),t){var r=this.generateStateKey(t),o=this.temporaryCacheStorage.getItem(r);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+o),this.resetRequestCache(o||rL.EMPTY_STRING)}this.clearMsalCookies()},BrowserCacheManager.prototype.cleanRequestByInteractionType=function(t){var r=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(o){if(-1!==o.indexOf(rH.REQUEST_STATE)){var i=r.temporaryCacheStorage.getItem(o);if(i){var s=F$.extractBrowserRequestState(r.cryptoImpl,i);s&&s.interactionType===t&&(r.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+i),r.resetRequestCache(i))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},BrowserCacheManager.prototype.cacheCodeRequest=function(t,r){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var o=r.base64Encode(JSON.stringify(t));this.setTemporaryCache(rH.REQUEST_PARAMS,o,!0)},BrowserCacheManager.prototype.getCachedRequest=function(t,r){this.logger.trace("BrowserCacheManager.getCachedRequest called");var o=this.getTemporaryCache(rH.REQUEST_PARAMS,!0);if(!o)throw p$.createNoTokenRequestCacheError();var i=this.validateAndParseJson(r.base64Decode(o));if(!i)throw p$.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(rH.REQUEST_PARAMS)),RU.isEmpty(i.authority)){var s=this.generateAuthorityKey(t),l=this.getTemporaryCache(s);if(!l)throw p$.createNoCachedAuthorityError();i.authority=l}return i},BrowserCacheManager.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var t=this.getTemporaryCache(rH.NATIVE_REQUEST,!0);if(!t)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var r=this.validateAndParseJson(t);return r||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},BrowserCacheManager.prototype.isInteractionInProgress=function(t){var r=this.getInteractionInProgress();return t?r===this.clientId:!!r},BrowserCacheManager.prototype.getInteractionInProgress=function(){var t=rL.CACHE_PREFIX+"."+rH.INTERACTION_STATUS_KEY;return this.getTemporaryCache(t,!1)},BrowserCacheManager.prototype.setInteractionInProgress=function(t){var r=rL.CACHE_PREFIX+"."+rH.INTERACTION_STATUS_KEY;if(t){if(this.getInteractionInProgress())throw p$.createInteractionInProgressError();this.setTemporaryCache(r,this.clientId,!1)}else t||this.getInteractionInProgress()!==this.clientId||this.removeItem(r)},BrowserCacheManager.prototype.getLegacyLoginHint=function(){var t=this.getTemporaryCache(XF.ADAL_ID_TOKEN);t&&(this.browserStorage.removeItem(XF.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var r=this.getTemporaryCache(XF.ID_TOKEN,!0);r&&(this.removeItem(this.generateCacheKey(XF.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var o=r||t;if(o){var i=new cB(o,this.cryptoImpl);if(i.claims&&i.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),i.claims.preferred_username;if(i.claims&&i.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),i.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},BrowserCacheManager.prototype.updateCredentialCacheKey=function(t,r){var o=r.generateCredentialKey();if(t!==o){var i=this.getItem(t);if(i)return this.removeItem(t),this.setItem(o,i),this.logger.verbose("Updated an outdated "+r.credentialType+" cache key"),o;this.logger.error("Attempted to update an outdated "+r.credentialType+" cache key but no item matching the outdated key was found in storage")}return t},BrowserCacheManager.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(rH.REDIRECT_CONTEXT,!0)},BrowserCacheManager.prototype.setRedirectRequestContext=function(t){this.setTemporaryCache(rH.REDIRECT_CONTEXT,t,!0)},BrowserCacheManager}(lB),U$="@azure/msal-browser",B$="2.36.0",H$=function(){function FetchClient(){}return FetchClient.prototype.sendGetRequestAsync=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){var o,i,s;return __generator$1(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,fetch(t,{method:tH.GET,headers:this.getFetchHeaders(r)})];case 1:return o=l.sent(),[3,3];case 2:throw i=l.sent(),window.navigator.onLine?p$.createGetRequestFailedError(i,t):p$.createNoNetworkConnectivityError();case 3:return l.trys.push([3,5,,6]),s={headers:this.getHeaderDict(o.headers)},[4,o.json()];case 4:return[2,(s.body=l.sent(),s.status=o.status,s)];case 5:throw l.sent(),p$.createFailedToParseNetworkResponseError(t);case 6:return[2]}}))}))},FetchClient.prototype.sendPostRequestAsync=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){var o,i,s,l;return __generator$1(this,(function(u){switch(u.label){case 0:o=r&&r.body||rL.EMPTY_STRING,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,fetch(t,{method:tH.POST,headers:this.getFetchHeaders(r),body:o})];case 2:return i=u.sent(),[3,4];case 3:throw s=u.sent(),window.navigator.onLine?p$.createPostRequestFailedError(s,t):p$.createNoNetworkConnectivityError();case 4:return u.trys.push([4,6,,7]),l={headers:this.getHeaderDict(i.headers)},[4,i.json()];case 5:return[2,(l.body=u.sent(),l.status=i.status,l)];case 6:throw u.sent(),p$.createFailedToParseNetworkResponseError(t);case 7:return[2]}}))}))},FetchClient.prototype.getFetchHeaders=function(t){var r=new Headers;if(!t||!t.headers)return r;var o=t.headers;return Object.keys(o).forEach((function(t){r.append(t,o[t])})),r},FetchClient.prototype.getHeaderDict=function(t){var r={};return t.forEach((function(t,o){r[o]=t})),r},FetchClient}(),$$=function(){function XhrClient(){}return XhrClient.prototype.sendGetRequestAsync=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,this.sendRequestAsync(t,tH.GET,r)]}))}))},XhrClient.prototype.sendPostRequestAsync=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,this.sendRequestAsync(t,tH.POST,r)]}))}))},XhrClient.prototype.sendRequestAsync=function(t,r,o){var i=this;return new Promise((function(s,l){var u=new XMLHttpRequest;if(u.open(r,t,!0),i.setXhrHeaders(u,o),u.onload=function(){(u.status<200||u.status>=300)&&(r===tH.POST?l(p$.createPostRequestFailedError("Failed with status "+u.status,t)):l(p$.createGetRequestFailedError("Failed with status "+u.status,t)));try{var o=JSON.parse(u.responseText),h={headers:i.getHeaderDict(u),body:o,status:u.status};s(h)}catch(r){l(p$.createFailedToParseNetworkResponseError(t))}},u.onerror=function(){window.navigator.onLine?r===tH.POST?l(p$.createPostRequestFailedError("Failed with status "+u.status,t)):l(p$.createGetRequestFailedError("Failed with status "+u.status,t)):l(p$.createNoNetworkConnectivityError())},r===tH.POST&&o&&o.body)u.send(o.body);else{if(r!==tH.GET)throw p$.createHttpMethodNotImplementedError(r);u.send()}}))},XhrClient.prototype.setXhrHeaders=function(t,r){if(r&&r.headers){var o=r.headers;Object.keys(o).forEach((function(r){t.setRequestHeader(r,o[r])}))}},XhrClient.prototype.getHeaderDict=function(t){var r=t.getAllResponseHeaders().trim().split(/[\r\n]+/),o={};return r.forEach((function(t){var r=t.split(": "),i=r.shift(),s=r.join(": ");i&&s&&(o[i]=s)})),o},XhrClient}(),q$=function(){function BrowserUtils(){}return BrowserUtils.clearHash=function(t){t.location.hash=rL.EMPTY_STRING,"function"==typeof t.history.replaceState&&t.history.replaceState(null,rL.EMPTY_STRING,""+t.location.origin+t.location.pathname+t.location.search)},BrowserUtils.replaceHash=function(t){var r=t.split("#");r.shift(),window.location.hash=r.length>0?r.join("#"):rL.EMPTY_STRING},BrowserUtils.isInIframe=function(){return window.parent!==window},BrowserUtils.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(f$.POPUP_NAME_PREFIX+".")},BrowserUtils.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},BrowserUtils.getHomepage=function(){var t=new BB(window.location.href).getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+"/"},BrowserUtils.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new H$:new $$},BrowserUtils.blockReloadInHiddenIframes=function(){if(BB.hashContainsKnownProperties(window.location.hash)&&BrowserUtils.isInIframe())throw p$.createBlockReloadInHiddenIframeError()},BrowserUtils.blockRedirectInIframe=function(t,r){var o=BrowserUtils.isInIframe();if(t===sH.Redirect&&o&&!r)throw p$.createRedirectInIframeError(o)},BrowserUtils.blockAcquireTokenInPopups=function(){if(BrowserUtils.isInPopup())throw p$.createBlockAcquireTokenInPopupsError()},BrowserUtils.blockNonBrowserEnvironment=function(t){if(!t)throw p$.createNonBrowserEnvironmentError()},BrowserUtils.blockNativeBrokerCalledBeforeInitialized=function(t,r){if(t&&!r)throw p$.createNativeBrokerCalledBeforeInitialize()},BrowserUtils.detectIEOrEdge=function(){var t=window.navigator.userAgent,r=t.indexOf("MSIE "),o=t.indexOf("Trident/"),i=t.indexOf("Edge/");return r>0||o>0||i>0},BrowserUtils}(),j$=function(){function BaseInteractionClient(t,r,o,i,s,l,u,h,m){this.config=t,this.browserStorage=r,this.browserCrypto=o,this.networkClient=this.config.system.networkClient,this.eventHandler=s,this.navigationClient=l,this.nativeMessageHandler=h,this.correlationId=m||this.browserCrypto.createNewGuid(),this.logger=i.clone(f$.MSAL_SKU,B$,this.correlationId),this.performanceClient=u}return BaseInteractionClient.prototype.clearCacheOnLogout=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){switch(r.label){case 0:if(!t)return[3,5];aB.accountInfoIsEqual(t,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(aB.generateAccountCacheKey(t))];case 2:return r.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return r.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return r.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return r.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return r.sent(),[3,9];case 8:return r.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},BaseInteractionClient.prototype.initializeBaseRequest=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s;return __generator$1(this,(function(l){switch(l.label){case 0:if(this.performanceClient.addQueueMeasurement(_B.InitializeBaseRequest,t.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),r=t.authority||this.config.auth.authority,o=__spread(t&&t.scopes||[]),(i=__assign$1(__assign$1({},t),{correlationId:this.correlationId,authority:r,scopes:o})).authenticationScheme){if(i.authenticationScheme===bL.SSH){if(!t.sshJwk)throw iB.createMissingSshJwkError();if(!t.sshKid)throw iB.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+i.authenticationScheme+'" as configured in Auth request')}else i.authenticationScheme=bL.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!t.claims||RU.isEmpty(t.claims)?[3,2]:(s=i,[4,this.browserCrypto.hashString(t.claims)]);case 1:s.requestedClaimsHash=l.sent(),l.label=2;case 2:return[2,i]}}))}))},BaseInteractionClient.prototype.getRedirectUri=function(t){this.logger.verbose("getRedirectUri called");var r=t||this.config.auth.redirectUri||q$.getCurrentUri();return BB.getAbsoluteUrl(r,q$.getCurrentUri())},BaseInteractionClient.prototype.initializeServerTelemetryManager=function(t,r){this.logger.verbose("initializeServerTelemetryManager called");var o={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:t,forceRefresh:r||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new yH(o,this.browserStorage)},BaseInteractionClient.prototype.getDiscoveredAuthority=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r;return __generator$1(this,(function(o){switch(o.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),r={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},t?(this.logger.verbose("Creating discovered authority with request authority"),[4,dH.createDiscoveredInstance(t,this.config.system.networkClient,this.browserStorage,r,this.logger)]):[3,2];case 1:case 3:return[2,o.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,dH.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,r,this.logger)]}}))}))},BaseInteractionClient}(),z$=function(t){function StandardInteractionClient(){return null!==t&&t.apply(this,arguments)||this}return __extends$1(StandardInteractionClient,t),StandardInteractionClient.prototype.initializeAuthorizationCodeRequest=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o;return __generator$1(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(_B.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),this.logger.verbose("initializeAuthorizationRequest called",t.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return r=i.sent(),o=__assign$1(__assign$1({},t),{redirectUri:t.redirectUri,code:rL.EMPTY_STRING,codeVerifier:r.verifier}),t.codeChallenge=r.challenge,t.codeChallengeMethod=rL.S256_CODE_CHALLENGE_METHOD,[2,o]}}))}))},StandardInteractionClient.prototype.initializeLogoutRequest=function(t){this.logger.verbose("initializeLogoutRequest called",null==t?void 0:t.correlationId);var r=__assign$1({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},t);if(t)if(t.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(t.account){var o=this.getLogoutHintFromIdTokenClaims(t.account);o&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),r.logoutHint=o)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return t&&null===t.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",r.correlationId):t&&t.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",r.correlationId),r.postLogoutRedirectUri=BB.getAbsoluteUrl(t.postLogoutRedirectUri,q$.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",r.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",r.correlationId),r.postLogoutRedirectUri=BB.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,q$.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",r.correlationId),r.postLogoutRedirectUri=BB.getAbsoluteUrl(q$.getCurrentUri(),q$.getCurrentUri())),r},StandardInteractionClient.prototype.getLogoutHintFromIdTokenClaims=function(t){var r=t.idTokenClaims;if(r){if(r.login_hint)return r.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},StandardInteractionClient.prototype.createAuthCodeClient=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){var i;return __generator$1(this,(function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(_B.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(_B.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,r,o)];case 1:return i=s.sent(),[2,new VB(i,this.performanceClient)]}}))}))},StandardInteractionClient.prototype.getClientConfiguration=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){var i,s;return __generator$1(this,(function(l){switch(l.label){case 0:return this.performanceClient.addQueueMeasurement(_B.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(_B.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(r,o)];case 1:return i=l.sent(),s=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:i,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:f$.MSAL_SKU,version:B$,cpu:rL.EMPTY_STRING,os:rL.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},StandardInteractionClient.prototype.validateAndExtractStateFromHash=function(t,r,o){if(this.logger.verbose("validateAndExtractStateFromHash called",o),!t.state)throw p$.createHashDoesNotContainStateError();var i=F$.extractBrowserRequestState(this.browserCrypto,t.state);if(!i)throw p$.createUnableToParseStateError();if(i.interactionType!==r)throw p$.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",o),t.state},StandardInteractionClient.prototype.getDiscoveredAuthority=function(t,r){var o;return __awaiter$3(this,void 0,void 0,(function(){var i,s,l,u;return __generator$1(this,(function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement(_B.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),i=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(_B.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),s={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},l=t||this.config.auth.authority,u=lH.generateAuthority(l,r||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(_B.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,dH.createDiscoveredInstance(u,this.config.system.networkClient,this.browserStorage,s,this.logger,this.performanceClient,this.correlationId).then((function(t){return i.endMeasurement({success:!0}),t})).catch((function(t){throw i.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))];case 1:return[2,h.sent()]}}))}))},StandardInteractionClient.prototype.initializeAuthorizationRequest=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){var o,i,s,l,u,h,m;return __generator$1(this,(function(v){switch(v.label){case 0:return this.performanceClient.addQueueMeasurement(_B.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),o=this.getRedirectUri(t.redirectUri),i={interactionType:r},s=UB.setRequestState(this.browserCrypto,t&&t.state||rL.EMPTY_STRING,i),this.performanceClient.setPreQueueTime(_B.InitializeBaseRequest,this.correlationId),u=[{}],[4,this.initializeBaseRequest(t)];case 1:return l=__assign$1.apply(void 0,[__assign$1.apply(void 0,u.concat([v.sent()])),{redirectUri:o,state:s,nonce:t.nonce||this.browserCrypto.createNewGuid(),responseMode:aL.FRAGMENT}]),(h=t.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+h.homeAccountId,this.correlationId),l.account=h),RU.isEmpty(l.loginHint)&&!h&&(m=this.browserStorage.getLegacyLoginHint())&&(l.loginHint=m),[2,l]}}))}))},StandardInteractionClient}(j$),G$=function(){function InteractionHandler(t,r,o,i,s){this.authModule=t,this.browserStorage=r,this.authCodeRequest=o,this.logger=i,this.performanceClient=s}return InteractionHandler.prototype.handleCodeResponseFromHash=function(t,r,o,i){return __awaiter$3(this,void 0,void 0,(function(){var s,l,u;return __generator$1(this,(function(h){if(this.performanceClient.addQueueMeasurement(_B.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),RU.isEmpty(t))throw p$.createEmptyHashError(t);if(s=this.browserStorage.generateStateKey(r),!(l=this.browserStorage.getTemporaryCache(s)))throw PU.createStateNotFoundError("Cached State");try{u=this.authModule.handleFragmentResponse(t,l)}catch(t){throw t instanceof bB&&t.subError===MH.code?p$.createUserCancelledError():t}return this.performanceClient.setPreQueueTime(_B.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(u,r,o,i)]}))}))},InteractionHandler.prototype.handleCodeResponseFromServer=function(t,r,o,i,s){return void 0===s&&(s=!0),__awaiter$3(this,void 0,void 0,(function(){var l,u,h,m,v,C;return __generator$1(this,(function(_){switch(_.label){case 0:if(this.performanceClient.addQueueMeasurement(_B.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),l=this.browserStorage.generateStateKey(r),!(u=this.browserStorage.getTemporaryCache(l)))throw PU.createStateNotFoundError("Cached State");return h=this.browserStorage.generateNonceKey(u),m=this.browserStorage.getTemporaryCache(h),this.authCodeRequest.code=t.code,t.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(_B.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(t.cloud_instance_host_name,o,i)]):[3,2];case 1:_.sent(),_.label=2;case 2:return s&&(t.nonce=m||void 0),t.state=u,t.client_info?this.authCodeRequest.clientInfo=t.client_info:(v=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=v),this.performanceClient.setPreQueueTime(_B.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,t)];case 3:return C=_.sent(),this.browserStorage.cleanRequestByState(r),[2,C]}}))}))},InteractionHandler.prototype.updateTokenEndpointAuthority=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){var i,s;return __generator$1(this,(function(l){switch(l.label){case 0:return this.performanceClient.addQueueMeasurement(_B.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),i="https://"+t+"/"+r.tenant+"/",[4,dH.createDiscoveredInstance(i,o,this.browserStorage,r.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return s=l.sent(),this.authModule.updateAuthority(s),[2]}}))}))},InteractionHandler.prototype.checkCcsCredentials=function(){var t=this.browserStorage.getTemporaryCache(rH.CCS_CREDENTIAL,!0);if(t)try{return JSON.parse(t)}catch(r){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+t)}return null},InteractionHandler}(),V$=function(t){function RedirectHandler(r,o,i,s,l,u){var h=t.call(this,r,o,i,s,u)||this;return h.browserCrypto=l,h}return __extends$1(RedirectHandler,t),RedirectHandler.prototype.initiateAuthRequest=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(i){switch(i.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),RU.isEmpty(t)?[3,7]:(r.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(rH.ORIGIN_URI,r.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(rH.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+t),o={apiId:iH.acquireTokenRedirect,timeout:r.redirectTimeout,noHistory:!1},"function"!=typeof r.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===r.onRedirectNavigate(t)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,r.navigationClient.navigateExternal(t,o)])));case 1:case 5:return i.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,r.navigationClient.navigateExternal(t,o)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),p$.createEmptyNavigationUriError();case 8:return[2]}}))}))},RedirectHandler.prototype.handleCodeResponseFromHash=function(t,r,o,i){return __awaiter$3(this,void 0,void 0,(function(){var s,l,u,h,m,v,C;return __generator$1(this,(function(_){switch(_.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),RU.isEmpty(t))throw p$.createEmptyHashError(t);if(this.browserStorage.setInteractionInProgress(!1),s=this.browserStorage.generateStateKey(r),!(l=this.browserStorage.getTemporaryCache(s)))throw PU.createStateNotFoundError("Cached State");try{u=this.authModule.handleFragmentResponse(t,l)}catch(t){throw t instanceof bB&&t.subError===MH.code?p$.createUserCancelledError():t}return h=this.browserStorage.generateNonceKey(l),m=this.browserStorage.getTemporaryCache(h),this.authCodeRequest.code=u.code,u.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(u.cloud_instance_host_name,o,i)]:[3,2];case 1:_.sent(),_.label=2;case 2:return u.nonce=m||void 0,u.state=l,u.client_info?this.authCodeRequest.clientInfo=u.client_info:(v=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=v),[4,this.authModule.acquireToken(this.authCodeRequest,u)];case 3:return C=_.sent(),this.browserStorage.cleanRequestByState(r),[2,C]}}))}))},RedirectHandler}(G$);!function(t){t.INITIALIZE_START="msal:initializeStart",t.INITIALIZE_END="msal:initializeEnd",t.ACCOUNT_ADDED="msal:accountAdded",t.ACCOUNT_REMOVED="msal:accountRemoved",t.LOGIN_START="msal:loginStart",t.LOGIN_SUCCESS="msal:loginSuccess",t.LOGIN_FAILURE="msal:loginFailure",t.ACQUIRE_TOKEN_START="msal:acquireTokenStart",t.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",t.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",t.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",t.SSO_SILENT_START="msal:ssoSilentStart",t.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",t.SSO_SILENT_FAILURE="msal:ssoSilentFailure",t.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",t.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",t.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",t.HANDLE_REDIRECT_START="msal:handleRedirectStart",t.HANDLE_REDIRECT_END="msal:handleRedirectEnd",t.POPUP_OPENED="msal:popupOpened",t.LOGOUT_START="msal:logoutStart",t.LOGOUT_SUCCESS="msal:logoutSuccess",t.LOGOUT_FAILURE="msal:logoutFailure",t.LOGOUT_END="msal:logoutEnd"}(S$||(S$={})),function(t){t.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",t.USER_CANCEL="USER_CANCEL",t.NO_NETWORK="NO_NETWORK",t.TRANSIENT_ERROR="TRANSIENT_ERROR",t.PERSISTENT_ERROR="PERSISTENT_ERROR",t.DISABLED="DISABLED",t.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(T$||(T$={}));var K$={code:"ContentError"},W$={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},Q$={code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"},Y$=function(t){function NativeAuthError(r,o,i){var s=t.call(this,r,o)||this;return Object.setPrototypeOf(s,NativeAuthError.prototype),s.name="NativeAuthError",s.ext=i,s}return __extends$1(NativeAuthError,t),NativeAuthError.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==T$.PERSISTENT_ERROR&&this.ext.status!==T$.DISABLED)||this.errorCode===K$.code},NativeAuthError.createError=function(t,r,o){if(o&&o.status)switch(o.status){case T$.ACCOUNT_UNAVAILABLE:return FB.createNativeAccountUnavailableError();case T$.USER_INTERACTION_REQUIRED:return new FB(t,r);case T$.USER_CANCEL:return p$.createUserCancelledError();case T$.NO_NETWORK:return p$.createNoNetworkConnectivityError()}return new NativeAuthError(t,r,o)},NativeAuthError.createUserSwitchError=function(){return new NativeAuthError(W$.code,W$.desc)},NativeAuthError.createTokensNotFoundInCacheError=function(){return new NativeAuthError(Q$.code,Q$.desc)},NativeAuthError}(FL),J$=function(t){function SilentCacheClient(){return null!==t&&t.apply(this,arguments)||this}return __extends$1(SilentCacheClient,t),SilentCacheClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l;return __generator$1(this,(function(u){switch(u.label){case 0:return r=this.performanceClient.startMeasurement(_B.SilentCacheClientAcquireToken,t.correlationId),o=this.initializeServerTelemetryManager(iH.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(o,t.authority,t.azureCloudOptions)];case 1:i=u.sent(),this.logger.verbose("Silent auth client created"),u.label=2;case 2:return u.trys.push([2,4,,5]),[4,i.acquireCachedToken(t)];case 3:return s=u.sent(),r.endMeasurement({success:!0,fromCache:!0}),[2,s];case 4:throw(l=u.sent())instanceof p$&&l.errorCode===r$.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),r.endMeasurement({errorCode:l instanceof FL&&l.errorCode||void 0,subErrorCode:l instanceof FL&&l.subError||void 0,success:!1}),l;case 5:return[2]}}))}))},SilentCacheClient.prototype.logout=function(){return Promise.reject(p$.createSilentLogoutUnsupportedError())},SilentCacheClient.prototype.createSilentFlowClient=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){var i;return __generator$1(this,(function(s){switch(s.label){case 0:return this.performanceClient.setPreQueueTime(_B.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,r,o)];case 1:return i=s.sent(),[2,new WB(i,this.performanceClient)]}}))}))},SilentCacheClient.prototype.initializeSilentRequest=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(_B.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(_B.InitializeBaseRequest,this.correlationId),o=[__assign$1({},t)],[4,this.initializeBaseRequest(t)];case 1:return[2,__assign$1.apply(void 0,[__assign$1.apply(void 0,o.concat([i.sent()])),{account:r,forceRefresh:t.forceRefresh||!1}])]}}))}))},SilentCacheClient}(z$),X$=function(t){function NativeInteractionClient(r,o,i,s,l,u,h,m,v,C,_,k){var E=t.call(this,r,o,i,s,l,u,m,v,k)||this;return E.apiId=h,E.accountId=C,E.nativeMessageHandler=v,E.nativeStorageManager=_,E.silentCacheClient=new J$(r,E.nativeStorageManager,i,s,l,u,m,v,k),E}return __extends$1(NativeInteractionClient,t),NativeInteractionClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l,u,h;return __generator$1(this,(function(m){switch(m.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),r=this.performanceClient.startMeasurement(_B.NativeInteractionClientAcquireToken,t.correlationId),o=AB.nowSeconds(),[4,this.initializeNativeRequest(t)];case 1:i=m.sent(),m.label=2;case 2:return m.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,i)];case 3:return s=m.sent(),r.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,s];case 4:return m.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return l={method:ZB.GetToken,request:i},[4,this.nativeMessageHandler.sendMessage(l)];case 6:return u=m.sent(),h=this.validateNativeResponse(u),[2,this.handleNativeResponse(h,i,o).then((function(t){return r.endMeasurement({success:!0,isNativeBroker:!0,requestId:t.requestId}),t})).catch((function(t){throw r.endMeasurement({success:!1,errorCode:t.errorCode,subErrorCode:t.subError,isNativeBroker:!0}),t}))]}}))}))},NativeInteractionClient.prototype.createSilentCacheRequest=function(t,r){return{authority:t.authority,correlationId:this.correlationId,scopes:sB.fromString(t.scope).asArray(),account:r,forceRefresh:!1}},NativeInteractionClient.prototype.acquireTokensFromCache=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){var o,i;return __generator$1(this,(function(s){switch(s.label){case 0:if(!t)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),PU.createNoAccountFoundError();if(!(o=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t})))throw PU.createNoAccountFoundError();s.label=1;case 1:return s.trys.push([1,3,,4]),i=this.createSilentCacheRequest(r,o),[4,this.silentCacheClient.acquireToken(i)];case 2:return[2,s.sent()];case 3:throw s.sent();case 4:return[2]}}))}))},NativeInteractionClient.prototype.acquireTokenRedirect=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l,u;return __generator$1(this,(function(h){switch(h.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(t)];case 1:r=h.sent(),o={method:ZB.GetToken,request:r},h.label=2;case 2:return h.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(o)];case 3:return i=h.sent(),this.validateNativeResponse(i),[3,5];case 4:if((s=h.sent())instanceof Y$&&s.isFatal())throw s;return[3,5];case 5:return this.browserStorage.setTemporaryCache(rH.NATIVE_REQUEST,JSON.stringify(r),!0),l={apiId:iH.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri),[4,this.navigationClient.navigateExternal(u,l)];case 6:return h.sent(),[2]}}))}))},NativeInteractionClient.prototype.handleRedirectPromise=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i,s,l,u,h;return __generator$1(this,(function(m){switch(m.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(t=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];r=t.prompt,o=__rest(t,["prompt"]),r&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(rH.NATIVE_REQUEST)),i={method:ZB.GetToken,request:o},s=AB.nowSeconds(),m.label=1;case 1:return m.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(i)];case 2:return l=m.sent(),this.validateNativeResponse(l),u=this.handleNativeResponse(l,o,s),this.browserStorage.setInteractionInProgress(!1),[2,u];case 3:throw h=m.sent(),this.browserStorage.setInteractionInProgress(!1),h;case 4:return[2]}}))}))},NativeInteractionClient.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},NativeInteractionClient.prototype.handleNativeResponse=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){var i,s,l,u,h,m;return __generator$1(this,(function(v){switch(v.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),t.account.id!==r.accountId)throw Y$.createUserSwitchError();return[4,this.getDiscoveredAuthority(r.authority)];case 1:return i=v.sent(),s=i.getPreferredCache(),l=this.createIdTokenObj(t),u=this.createHomeAccountIdentifier(t,l),h=this.createAccountEntity(t,u,l,s),[4,this.generateAuthenticationResult(t,r,l,h,i.canonicalAuthority,o)];case 2:return m=v.sent(),this.cacheAccount(h),this.cacheNativeTokens(t,r,u,l,m.accessToken,m.tenantId,o),[2,m]}}))}))},NativeInteractionClient.prototype.createIdTokenObj=function(t){return new cB(t.id_token||rL.EMPTY_STRING,this.browserCrypto)},NativeInteractionClient.prototype.createHomeAccountIdentifier=function(t,r){return aB.generateHomeAccountId(t.client_info||rL.EMPTY_STRING,FU.Default,this.logger,this.browserCrypto,r)},NativeInteractionClient.prototype.createAccountEntity=function(t,r,o,i){return aB.createAccount(t.client_info,r,o,void 0,void 0,void 0,i,t.account.id)},NativeInteractionClient.prototype.generateScopes=function(t,r){return t.scope?sB.fromString(t.scope):sB.fromString(r.scope)},NativeInteractionClient.prototype.generatePopAccessToken=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){var o,i;return __generator$1(this,(function(s){switch(s.label){case 0:if(r.tokenType!==bL.POP)return[3,2];if(t.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,t.shr];if(o=new qB(this.browserCrypto),i={resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,shrNonce:r.shrNonce},!r.keyId)throw PU.createKeyIdMissingError();return[4,o.signPopToken(t.access_token,r.keyId,i)];case 1:return[2,s.sent()];case 2:return[2,t.access_token]}}))}))},NativeInteractionClient.prototype.generateAuthenticationResult=function(t,r,o,i,s,l){return __awaiter$3(this,void 0,void 0,(function(){var u,h,m,v,C,_,k;return __generator$1(this,(function(E){switch(E.label){case 0:return u=this.addTelemetryFromNativeResponse(t),h=t.scope?sB.fromString(t.scope):sB.fromString(r.scope),m=t.account.properties||{},v=m.UID||o.claims.oid||o.claims.sub||rL.EMPTY_STRING,C=m.TenantId||o.claims.tid||rL.EMPTY_STRING,[4,this.generatePopAccessToken(t,r)];case 1:return _=E.sent(),k=r.tokenType===bL.POP?bL.POP:bL.BEARER,[2,{authority:s,uniqueId:v,tenantId:C,scopes:h.asArray(),account:i.getAccountInfo(),idToken:t.id_token,idTokenClaims:o.claims,accessToken:_,fromCache:!!u&&this.isResponseFromCache(u),expiresOn:new Date(1e3*Number(l+t.expires_in)),tokenType:k,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0}]}}))}))},NativeInteractionClient.prototype.cacheAccount=function(t){var r=this;this.browserStorage.setAccount(t),this.browserStorage.removeAccountContext(t).catch((function(t){r.logger.error("Error occurred while removing account context from browser storage. "+t)}))},NativeInteractionClient.prototype.cacheNativeTokens=function(t,r,o,i,s,l,u){var h=IB.createIdTokenEntity(o,r.authority,t.id_token||rL.EMPTY_STRING,r.clientId,i.claims.tid||rL.EMPTY_STRING);this.nativeStorageManager.setIdTokenCredential(h);var m=u+(r.tokenType===bL.POP?rL.SHR_NONCE_VALIDITY:("string"==typeof t.expires_in?parseInt(t.expires_in,10):t.expires_in)||0),v=this.generateScopes(t,r),C=PB.createAccessTokenEntity(o,r.authority,s,r.clientId,l,v.printScopes(),m,0,this.browserCrypto);this.nativeStorageManager.setAccessTokenCredential(C)},NativeInteractionClient.prototype.addTelemetryFromNativeResponse=function(t){var r=this.getMATSFromResponse(t);return r?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:r.broker_version,matsAccountJoinOnStart:r.account_join_on_start,matsAccountJoinOnEnd:r.account_join_on_end,matsDeviceJoin:r.device_join,matsPromptBehavior:r.prompt_behavior,matsApiErrorCode:r.api_error_code,matsUiVisible:r.ui_visible,matsSilentCode:r.silent_code,matsSilentBiSubCode:r.silent_bi_sub_code,matsSilentMessage:r.silent_message,matsSilentStatus:r.silent_status,matsHttpStatus:r.http_status,matsHttpEventCount:r.http_event_count},this.correlationId),r):null},NativeInteractionClient.prototype.validateNativeResponse=function(t){if(t.hasOwnProperty("access_token")&&t.hasOwnProperty("id_token")&&t.hasOwnProperty("client_info")&&t.hasOwnProperty("account")&&t.hasOwnProperty("scope")&&t.hasOwnProperty("expires_in"))return t;throw Y$.createUnexpectedError("Response missing expected properties.")},NativeInteractionClient.prototype.getMATSFromResponse=function(t){if(t.properties.MATS)try{return JSON.parse(t.properties.MATS)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},NativeInteractionClient.prototype.isResponseFromCache=function(t){return void 0===t.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!t.is_cached},NativeInteractionClient.prototype.initializeNativeRequest=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l,u,h,m,v,C=this;return __generator$1(this,(function(_){switch(_.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),r=t.authority||this.config.auth.authority,(o=new BB(r)).validateAsUri(),i=t.scopes,s=__rest(t,["scopes"]),(l=new sB(i||[])).appendScopes(oL),u=function(){switch(C.apiId){case iH.ssoSilent:case iH.acquireTokenSilent_silentFlow:return C.logger.trace("initializeNativeRequest: silent request sets prompt to none"),sL.NONE}if(t.prompt)switch(t.prompt){case sL.NONE:case sL.CONSENT:case sL.LOGIN:return C.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),t.prompt;default:throw C.logger.trace("initializeNativeRequest: prompt = "+t.prompt+" is not compatible with native flow"),p$.createNativePromptParameterNotSupportedError()}else C.logger.trace("initializeNativeRequest: prompt was not provided")},h=__assign$1(__assign$1({},s),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:o.urlString,scope:l.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),prompt:u(),correlationId:this.correlationId,tokenType:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:__assign$1(__assign$1(__assign$1({},t.extraQueryParameters),t.tokenQueryParameters),{telemetry:v$}),extendedExpiryToken:!1}),t.authenticationScheme!==bL.POP?[3,2]:(m={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},[4,new qB(this.browserCrypto).generateCnf(m)]);case 1:v=_.sent(),h.reqCnf=v.reqCnfHash,h.keyId=v.kid,_.label=2;case 2:return[2,h]}}))}))},NativeInteractionClient}(j$),Z$=function(){function NativeMessageHandler(t,r,o,i){this.logger=t,this.handshakeTimeoutMs=r,this.extensionId=i,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=o,this.handshakeEvent=o.startMeasurement(_B.NativeMessageHandlerHandshake)}return NativeMessageHandler.prototype.sendMessage=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o=this;return __generator$1(this,(function(i){return this.logger.trace("NativeMessageHandler - sendMessage called."),r={channel:g$,extensionId:this.extensionId,responseId:this.responseId++,body:t},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(r)),this.messageChannel.port1.postMessage(r),[2,new Promise((function(t,i){o.resolvers.set(r.responseId,{resolve:t,reject:i})}))]}))}))},NativeMessageHandler.createProvider=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){var i,s;return __generator$1(this,(function(l){switch(l.label){case 0:t.trace("NativeMessageHandler - createProvider called."),l.label=1;case 1:return l.trys.push([1,3,,5]),[4,(i=new NativeMessageHandler(t,r,o,m$)).sendHandshakeRequest()];case 2:return l.sent(),[2,i];case 3:return l.sent(),[4,(s=new NativeMessageHandler(t,r,o)).sendHandshakeRequest()];case 4:return l.sent(),[2,s];case 5:return[2]}}))}))},NativeMessageHandler.prototype.sendHandshakeRequest=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,r=this;return __generator$1(this,(function(o){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),t={channel:g$,extensionId:this.extensionId,responseId:this.responseId++,body:{method:ZB.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(t){r.onChannelMessage(t)},window.postMessage(t,window.origin,[this.messageChannel.port2]),[2,new Promise((function(o,i){r.handshakeResolvers.set(t.responseId,{resolve:o,reject:i}),r.timeoutId=window.setTimeout((function(){window.removeEventListener("message",r.windowListener,!1),r.messageChannel.port1.close(),r.messageChannel.port2.close(),r.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),i(p$.createNativeHandshakeTimeoutError()),r.handshakeResolvers.delete(t.responseId)}),r.handshakeTimeoutMs)}))]}))}))},NativeMessageHandler.prototype.onWindowMessage=function(t){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),t.source===window){var r=t.data;if(r.channel&&r.channel===g$&&(!r.extensionId||r.extensionId===this.extensionId)&&r.body.method===ZB.HandshakeRequest){this.logger.verbose(r.extensionId?"Extension with id: "+r.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var o=this.handshakeResolvers.get(r.responseId);o&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),o.reject(p$.createNativeExtensionNotInstalledError()))}}},NativeMessageHandler.prototype.onChannelMessage=function(t){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var r=t.data,o=this.resolvers.get(r.responseId),i=this.handshakeResolvers.get(r.responseId);try{var s=r.body.method;if(s===ZB.Response){if(!o)return;var l=r.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(l)),"Success"!==l.status)o.reject(Y$.createError(l.code,l.description,l.ext));else{if(!l.result)throw FL.createUnexpectedError("Event does not contain result.");l.result.code&&l.result.description?o.reject(Y$.createError(l.result.code,l.result.description,l.result.ext)):o.resolve(l.result)}this.resolvers.delete(r.responseId)}else if(s===ZB.HandshakeResponse){if(!i)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=r.extensionId,this.extensionVersion=r.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),i.resolve(),this.handshakeResolvers.delete(r.responseId)}}catch(r){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+r.toString()),this.logger.errorPii("Unable to parse "+t),o?o.reject(r):i&&i.reject(r)}},NativeMessageHandler.prototype.getExtensionId=function(){return this.extensionId},NativeMessageHandler.prototype.getExtensionVersion=function(){return this.extensionVersion},NativeMessageHandler.isNativeAvailable=function(t,r,o,i){if(r.trace("isNativeAvailable called"),!t.system.allowNativeBroker)return r.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!o)return r.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(i)switch(i){case bL.BEARER:case bL.POP:return r.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return r.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},NativeMessageHandler}(),eq=function(t){function RedirectClient(r,o,i,s,l,u,h,m,v,C){var _=t.call(this,r,o,i,s,l,u,h,v,C)||this;return _.nativeStorage=m,_}return __extends$1(RedirectClient,t),RedirectClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l,u,h,m,v,C=this;return __generator$1(this,(function(_){switch(_.label){case 0:return this.performanceClient.setPreQueueTime(_B.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,sH.Redirect)];case 1:r=_.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||rL.EMPTY_STRING,r.account||null),o=this.initializeServerTelemetryManager(iH.acquireTokenRedirect),i=function(t){t.persisted&&(C.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),C.browserStorage.cleanRequestByState(r.state))},_.label=2;case 2:return _.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(_B.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(r)];case 3:return s=_.sent(),this.performanceClient.setPreQueueTime(_B.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(o,r.authority,r.azureCloudOptions)];case 4:return l=_.sent(),this.logger.verbose("Auth code client created"),u=new V$(l,this.browserStorage,s,this.logger,this.browserCrypto,this.performanceClient),[4,l.getAuthCodeUrl(__assign$1(__assign$1({},r),{nativeBroker:Z$.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 5:return h=_.sent(),m=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: "+m),window.addEventListener("pageshow",i),[4,u.initiateAuthRequest(h,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:m,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,_.sent()];case 7:throw(v=_.sent())instanceof FL&&v.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",i),o.cacheFailedRequest(v),this.browserStorage.cleanRequestByState(r.state),v;case 8:return[2]}}))}))},RedirectClient.prototype.handleRedirectPromise=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l,u,h,m,v,C,_,k;return __generator$1(this,(function(E){switch(E.label){case 0:r=this.initializeServerTelemetryManager(iH.handleRedirectPromise),E.label=1;case 1:if(E.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(o=this.getRedirectResponseHash(t||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(sH.Redirect),[2,null];i=void 0;try{s=BB.getDeserializedHash(o),i=this.validateAndExtractStateFromHash(s,sH.Redirect),this.logger.verbose("State extracted from hash")}catch(t){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+t),this.browserStorage.cleanRequestByInteractionType(sH.Redirect),[2,null]}return l=this.browserStorage.getTemporaryCache(rH.ORIGIN_URI,!0)||rL.EMPTY_STRING,u=BB.removeHashFromUrl(l),h=BB.removeHashFromUrl(window.location.href),u===h&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(o,i,r)]):[3,3];case 2:return m=E.sent(),l.indexOf("#")>-1&&q$.replaceHash(l),[2,m];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(o,i,r)]);case 4:return q$.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(rH.URL_HASH,o,!0),v={apiId:iH.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},C=!0,l&&"null"!==l?[3,6]:(_=q$.getHomepage(),this.browserStorage.setTemporaryCache(rH.ORIGIN_URI,_,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(_,v)]));case 5:return C=E.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+l),[4,this.navigationClient.navigateInternal(l,v)];case 7:C=E.sent(),E.label=8;case 8:if(!C)return[2,this.handleHash(o,i,r)];E.label=9;case 9:return[2,null];case 10:throw(k=E.sent())instanceof FL&&k.setCorrelationId(this.correlationId),r.cacheFailedRequest(k),this.browserStorage.cleanRequestByInteractionType(sH.Redirect),k;case 11:return[2]}}))}))},RedirectClient.prototype.getRedirectResponseHash=function(t){if(this.logger.verbose("getRedirectResponseHash called"),BB.hashContainsKnownProperties(t))return q$.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),t;var r=this.browserStorage.getTemporaryCache(rH.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(rH.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),r},RedirectClient.prototype.handleHash=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){var i,s,l,u,h,m,v=this;return __generator$1(this,(function(C){switch(C.label){case 0:if(i=this.browserStorage.getCachedRequest(r,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(s=BB.getDeserializedHash(t)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw p$.createNativeConnectionNotEstablishedError();return l=new X$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,iH.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,s.accountId,this.browserStorage,i.correlationId),u=UB.parseRequestState(this.browserCrypto,r).userRequestState,[2,l.acquireToken(__assign$1(__assign$1({},i),{state:u,prompt:void 0})).finally((function(){v.browserStorage.cleanRequestByState(r)}))]}if(!(h=this.browserStorage.getCachedAuthority(r)))throw p$.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime(_B.StandardInteractionClientCreateAuthCodeClient,i.correlationId),[4,this.createAuthCodeClient(o,h)];case 1:return m=C.sent(),this.logger.verbose("Auth code client created"),wB.removeThrottle(this.browserStorage,this.config.auth.clientId,i),[4,new V$(m,this.browserStorage,i,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(t,r,m.authority,this.networkClient)];case 2:return[2,C.sent()]}}))}))},RedirectClient.prototype.logout=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l,u;return __generator$1(this,(function(h){switch(h.label){case 0:this.logger.verbose("logoutRedirect called"),r=this.initializeLogoutRequest(t),o=this.initializeServerTelemetryManager(iH.logout),h.label=1;case 1:return h.trys.push([1,10,,11]),this.eventHandler.emitEvent(S$.LOGOUT_START,sH.Redirect,t),[4,this.clearCacheOnLogout(r.account)];case 2:return h.sent(),i={apiId:iH.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(_B.StandardInteractionClientCreateAuthCodeClient,r.correlationId),[4,this.createAuthCodeClient(o,t&&t.authority)];case 3:return s=h.sent(),this.logger.verbose("Auth code client created"),l=s.getLogoutUri(r),this.eventHandler.emitEvent(S$.LOGOUT_SUCCESS,sH.Redirect,r),t&&"function"==typeof t.onRedirectNavigate?!1===t.onRedirectNavigate(l)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(l,i)]):[3,7];case 4:return h.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),h.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(l,i)];case 8:return h.sent(),[2];case 9:return[3,11];case 10:throw(u=h.sent())instanceof FL&&u.setCorrelationId(this.correlationId),o.cacheFailedRequest(u),this.eventHandler.emitEvent(S$.LOGOUT_FAILURE,sH.Redirect,null,u),this.eventHandler.emitEvent(S$.LOGOUT_END,sH.Redirect),u;case 11:return this.eventHandler.emitEvent(S$.LOGOUT_END,sH.Redirect),[2]}}))}))},RedirectClient.prototype.getRedirectStartPage=function(t){var r=t||window.location.href;return BB.getAbsoluteUrl(r,q$.getCurrentUri())},RedirectClient}(z$),tq=function(t){function PopupClient(r,o,i,s,l,u,h,m,v,C){var _=t.call(this,r,o,i,s,l,u,h,v,C)||this;return _.unloadWindow=_.unloadWindow.bind(_),_.nativeStorage=m,_}return __extends$1(PopupClient,t),PopupClient.prototype.acquireToken=function(t){try{var r=this.generatePopupName(t.scopes||oL,t.authority||this.config.auth.authority),o=t.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,r,o);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var i=this.openSizedPopup("about:blank",r,o);return this.acquireTokenPopupAsync(t,r,o,i)}catch(t){return Promise.reject(t)}},PopupClient.prototype.logout=function(t){try{this.logger.verbose("logoutPopup called");var r=this.initializeLogoutRequest(t),o=this.generateLogoutPopupName(r),i=t&&t.authority,s=t&&t.mainWindowRedirectUri,l=(null==t?void 0:t.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(r,o,l,i,void 0,s);this.logger.verbose("asyncPopup set to false, opening popup");var u=this.openSizedPopup("about:blank",o,l);return this.logoutPopupAsync(r,o,l,i,u,s)}catch(t){return Promise.reject(t)}},PopupClient.prototype.acquireTokenPopupAsync=function(t,r,o,i){return __awaiter$3(this,void 0,void 0,(function(){var s,l,u,h,m,v,C,_,k,E,R,N,M,B,H,$,q=this;return __generator$1(this,(function(j){switch(j.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),s=this.initializeServerTelemetryManager(iH.acquireTokenPopup),this.performanceClient.setPreQueueTime(_B.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,sH.Popup)];case 1:l=j.sent(),this.browserStorage.updateCacheEntries(l.state,l.nonce,l.authority,l.loginHint||rL.EMPTY_STRING,l.account||null),j.label=2;case 2:return j.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(_B.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(l)];case 3:return u=j.sent(),this.performanceClient.setPreQueueTime(_B.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(s,l.authority,l.azureCloudOptions)];case 4:return h=j.sent(),this.logger.verbose("Auth code client created"),m=Z$.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme),v=void 0,m&&(v=this.performanceClient.startMeasurement(_B.FetchAccountIdWithNativeBroker,t.correlationId)),[4,h.getAuthCodeUrl(__assign$1(__assign$1({},l),{nativeBroker:m}))];case 5:return C=j.sent(),_=new G$(h,this.browserStorage,u,this.logger,this.performanceClient),k={popup:i,popupName:r,popupWindowAttributes:o},E=this.initiateAuthRequest(C,k),this.eventHandler.emitEvent(S$.POPUP_OPENED,sH.Popup,{popupWindow:E},null),[4,this.monitorPopupForHash(E)];case 6:if(R=j.sent(),N=BB.getDeserializedHash(R),M=this.validateAndExtractStateFromHash(N,sH.Popup,l.correlationId),wB.removeThrottle(this.browserStorage,this.config.auth.clientId,u),N.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),v&&v.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw p$.createNativeConnectionNotEstablishedError();return B=new X$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,iH.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,N.accountId,this.nativeStorage,l.correlationId),H=UB.parseRequestState(this.browserCrypto,M).userRequestState,[2,B.acquireToken(__assign$1(__assign$1({},l),{state:H,prompt:void 0})).finally((function(){q.browserStorage.cleanRequestByState(M)}))]}return[4,_.handleCodeResponseFromHash(R,M,h.authority,this.networkClient)];case 7:return[2,j.sent()];case 8:throw $=j.sent(),i&&i.close(),$ instanceof FL&&$.setCorrelationId(this.correlationId),s.cacheFailedRequest($),this.browserStorage.cleanRequestByState(l.state),$;case 9:return[2]}}))}))},PopupClient.prototype.logoutPopupAsync=function(t,r,o,i,s,l){return __awaiter$3(this,void 0,void 0,(function(){var u,h,m,v,C,_,k;return __generator$1(this,(function(E){switch(E.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(S$.LOGOUT_START,sH.Popup,t),u=this.initializeServerTelemetryManager(iH.logoutPopup),E.label=1;case 1:return E.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(t.account)];case 2:return E.sent(),this.performanceClient.setPreQueueTime(_B.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(u,i)];case 3:return h=E.sent(),this.logger.verbose("Auth code client created"),m=h.getLogoutUri(t),this.eventHandler.emitEvent(S$.LOGOUT_SUCCESS,sH.Popup,t),v=this.openPopup(m,{popupName:r,popupWindowAttributes:o,popup:s}),this.eventHandler.emitEvent(S$.POPUP_OPENED,sH.Popup,{popupWindow:v},null),[4,this.waitForLogoutPopup(v)];case 4:return E.sent(),l?(C={apiId:iH.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},_=BB.getAbsoluteUrl(l,q$.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+_),this.navigationClient.navigateInternal(_,C)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw k=E.sent(),s&&s.close(),k instanceof FL&&k.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(S$.LOGOUT_FAILURE,sH.Popup,null,k),this.eventHandler.emitEvent(S$.LOGOUT_END,sH.Popup),u.cacheFailedRequest(k),k;case 6:return this.eventHandler.emitEvent(S$.LOGOUT_END,sH.Popup),[2]}}))}))},PopupClient.prototype.initiateAuthRequest=function(t,r){if(RU.isEmpty(t))throw this.logger.error("Navigate url is empty"),p$.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+t),this.openPopup(t,r)},PopupClient.prototype.monitorPopupForHash=function(t){var r=this;return new Promise((function(o,i){var s=r.config.system.windowHashTimeout/r.config.system.pollIntervalMilliseconds,l=0;r.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var u=setInterval((function(){if(t.closed)return r.logger.error("PopupHandler.monitorPopupForHash - window closed"),r.cleanPopup(),clearInterval(u),void i(p$.createUserCancelledError());var h=rL.EMPTY_STRING,m=rL.EMPTY_STRING;try{h=t.location.href,m=t.location.hash}catch(t){}RU.isEmpty(h)||"about:blank"===h||(r.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),l++,m?(r.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(u),r.cleanPopup(t),BB.hashContainsKnownProperties(m)?(r.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),o(m)):(r.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),r.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+m),i(p$.createHashDoesNotContainKnownPropertiesError()))):l>s&&(r.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(u),i(p$.createMonitorPopupTimeoutError())))}),r.config.system.pollIntervalMilliseconds)}))},PopupClient.prototype.waitForLogoutPopup=function(t){var r=this;return new Promise((function(o){r.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var i=setInterval((function(){t.closed&&(r.logger.error("PopupHandler.waitForLogoutPopup - window closed"),r.cleanPopup(),clearInterval(i),o());var s=rL.EMPTY_STRING;try{s=t.location.href}catch(t){}RU.isEmpty(s)||"about:blank"===s||(r.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(i),r.cleanPopup(t),o())}),r.config.system.pollIntervalMilliseconds)}))},PopupClient.prototype.openPopup=function(t,r){try{var o=void 0;if(r.popup?(o=r.popup,this.logger.verbosePii("Navigating popup window to: "+t),o.location.assign(t)):void 0===r.popup&&(this.logger.verbosePii("Opening popup window to: "+t),o=this.openSizedPopup(t,r.popupName,r.popupWindowAttributes)),!o)throw p$.createEmptyWindowCreatedError();return o.focus&&o.focus(),this.currentWindow=o,window.addEventListener("beforeunload",this.unloadWindow),o}catch(t){throw this.logger.error("error opening popup "+t.message),this.browserStorage.setInteractionInProgress(!1),p$.createPopupWindowError(t.toString())}},PopupClient.prototype.openSizedPopup=function(t,r,o){var i,s,l,u,h=window.screenLeft?window.screenLeft:window.screenX,m=window.screenTop?window.screenTop:window.screenY,v=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,C=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,_=null===(i=o.popupSize)||void 0===i?void 0:i.width,k=null===(s=o.popupSize)||void 0===s?void 0:s.height,E=null===(l=o.popupPosition)||void 0===l?void 0:l.top,R=null===(u=o.popupPosition)||void 0===u?void 0:u.left;return(!_||_<0||_>v)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),_=f$.POPUP_WIDTH),(!k||k<0||k>C)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),k=f$.POPUP_HEIGHT),(!E||E<0||E>C)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),E=Math.max(0,C/2-f$.POPUP_HEIGHT/2+m)),(!R||R<0||R>v)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),R=Math.max(0,v/2-f$.POPUP_WIDTH/2+h)),window.open(t,r,"width="+_+", height="+k+", top="+E+", left="+R+", scrollbars=yes")},PopupClient.prototype.unloadWindow=function(t){this.browserStorage.cleanRequestByInteractionType(sH.Popup),this.currentWindow&&this.currentWindow.close(),t.preventDefault()},PopupClient.prototype.cleanPopup=function(t){t&&t.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},PopupClient.prototype.generatePopupName=function(t,r){return f$.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+t.join("-")+"."+r+"."+this.correlationId},PopupClient.prototype.generateLogoutPopupName=function(t){var r=t.account&&t.account.homeAccountId;return f$.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+r+"."+this.correlationId},PopupClient}(z$),rq=function(){function NavigationClient(){}return NavigationClient.prototype.navigateInternal=function(t,r){return NavigationClient.defaultNavigateWindow(t,r)},NavigationClient.prototype.navigateExternal=function(t,r){return NavigationClient.defaultNavigateWindow(t,r)},NavigationClient.defaultNavigateWindow=function(t,r){return r.noHistory?window.location.replace(t):window.location.assign(t),new Promise((function(t){setTimeout((function(){t(!0)}),r.timeout)}))},NavigationClient}(),oq=6e3;
/*! @azure/msal-browser v2.36.0 2023-04-18 */
var nq,iq=function(t){function SilentHandler(r,o,i,s,l,u){var h=t.call(this,r,o,i,s,u)||this;return h.navigateFrameWait=l.navigateFrameWait,h.pollIntervalMilliseconds=l.pollIntervalMilliseconds,h}return __extends$1(SilentHandler,t),SilentHandler.prototype.initiateAuthRequest=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){switch(r.label){case 0:if(this.performanceClient.addQueueMeasurement(_B.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),RU.isEmpty(t))throw this.logger.info("Navigate url is empty"),p$.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(_B.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(t)]):[3,2];case 1:return[2,r.sent()];case 2:return[2,this.loadFrameSync(t)]}}))}))},SilentHandler.prototype.monitorIframeForHash=function(t,r){var o=this;return this.performanceClient.addQueueMeasurement(_B.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise((function(i,s){r<oq&&o.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+r+"ms) than the default ("+oq+"ms). This may result in timeouts.");var l=window.performance.now()+r,u=setInterval((function(){if(window.performance.now()>l)return o.removeHiddenIframe(t),clearInterval(u),void s(p$.createMonitorIframeTimeoutError());var r=rL.EMPTY_STRING,h=t.contentWindow;try{r=h?h.location.href:rL.EMPTY_STRING}catch(t){}if(!RU.isEmpty(r)){var m=h?h.location.hash:rL.EMPTY_STRING;return BB.hashContainsKnownProperties(m)?(o.removeHiddenIframe(t),clearInterval(u),void i(m)):void 0}}),o.pollIntervalMilliseconds)}))},SilentHandler.prototype.loadFrame=function(t){var r=this;return this.performanceClient.addQueueMeasurement(_B.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise((function(o,i){var s=r.createHiddenIframe();setTimeout((function(){s?(s.src=t,o(s)):i("Unable to load iframe")}),r.navigateFrameWait)}))},SilentHandler.prototype.loadFrameSync=function(t){var r=this.createHiddenIframe();return r.src=t,r},SilentHandler.prototype.createHiddenIframe=function(){var t=document.createElement("iframe");return t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(t),t},SilentHandler.prototype.removeHiddenIframe=function(t){document.body===t.parentNode&&document.body.removeChild(t)},SilentHandler}(G$),sq=function(t){function SilentIframeClient(r,o,i,s,l,u,h,m,v,C,_){var k=t.call(this,r,o,i,s,l,u,m,C,_)||this;return k.apiId=h,k.nativeStorage=v,k}return __extends$1(SilentIframeClient,t),SilentIframeClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l;return __generator$1(this,(function(u){switch(u.label){case 0:if(this.performanceClient.addQueueMeasurement(_B.SilentIframeClientAcquireToken,t.correlationId),this.logger.verbose("acquireTokenByIframe called"),r=this.performanceClient.startMeasurement(_B.SilentIframeClientAcquireToken,t.correlationId),RU.isEmpty(t.loginHint)&&RU.isEmpty(t.sid)&&(!t.account||RU.isEmpty(t.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==sL.NONE&&t.prompt!==sL.NO_SESSION)throw r.endMeasurement({success:!1}),p$.createSilentPromptValueError(t.prompt);return this.performanceClient.setPreQueueTime(_B.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(__assign$1(__assign$1({},t),{prompt:t.prompt||sL.NONE}),sH.Silent)];case 1:o=u.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||rL.EMPTY_STRING,o.account||null),i=this.initializeServerTelemetryManager(this.apiId),u.label=2;case 2:return u.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(_B.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(i,o.authority,o.azureCloudOptions)];case 3:return s=u.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(_B.SilentIframeClientTokenHelper,t.correlationId),[4,this.silentTokenHelper(s,o).then((function(t){return r.endMeasurement({success:!0,fromCache:!1,requestId:t.requestId}),t}))];case 4:return[2,u.sent()];case 5:throw(l=u.sent())instanceof FL&&l.setCorrelationId(this.correlationId),i.cacheFailedRequest(l),this.browserStorage.cleanRequestByState(o.state),r.endMeasurement({errorCode:l instanceof FL&&l.errorCode||void 0,subErrorCode:l instanceof FL&&l.subError||void 0,success:!1}),l;case 6:return[2]}}))}))},SilentIframeClient.prototype.logout=function(){return Promise.reject(p$.createSilentLogoutUnsupportedError())},SilentIframeClient.prototype.silentTokenHelper=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){var o,i,s,l,u,h,m,v,C,_=this;return __generator$1(this,(function(k){switch(k.label){case 0:return this.performanceClient.addQueueMeasurement(_B.SilentIframeClientTokenHelper,r.correlationId),this.performanceClient.setPreQueueTime(_B.StandardInteractionClientInitializeAuthorizationCodeRequest,r.correlationId),[4,this.initializeAuthorizationCodeRequest(r)];case 1:return o=k.sent(),this.performanceClient.setPreQueueTime(_B.GetAuthCodeUrl,r.correlationId),[4,t.getAuthCodeUrl(__assign$1(__assign$1({},r),{nativeBroker:Z$.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,r.authenticationScheme)}))];case 2:return i=k.sent(),s=new iq(t,this.browserStorage,o,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(_B.SilentHandlerInitiateAuthRequest,r.correlationId),[4,s.initiateAuthRequest(i)];case 3:return l=k.sent(),this.performanceClient.setPreQueueTime(_B.SilentHandlerMonitorIframeForHash,r.correlationId),[4,s.monitorIframeForHash(l,this.config.system.iframeHashTimeout)];case 4:if(u=k.sent(),h=BB.getDeserializedHash(u),m=this.validateAndExtractStateFromHash(h,sH.Silent,o.correlationId),h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw p$.createNativeConnectionNotEstablishedError();return v=new X$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,h.accountId,this.browserStorage,this.correlationId),C=UB.parseRequestState(this.browserCrypto,m).userRequestState,[2,v.acquireToken(__assign$1(__assign$1({},r),{state:C,prompt:r.prompt||sL.NONE})).finally((function(){_.browserStorage.cleanRequestByState(m)}))]}return this.performanceClient.setPreQueueTime(_B.HandleCodeResponseFromHash,r.correlationId),[2,s.handleCodeResponseFromHash(u,m,t.authority,this.networkClient)]}}))}))},SilentIframeClient}(z$),aq=function(t){function SilentRefreshClient(){return null!==t&&t.apply(this,arguments)||this}return __extends$1(SilentRefreshClient,t),SilentRefreshClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l,u=this;return __generator$1(this,(function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement(_B.SilentRefreshClientAcquireToken,t.correlationId),this.performanceClient.setPreQueueTime(_B.InitializeBaseRequest,t.correlationId),o=[__assign$1({},t)],[4,this.initializeBaseRequest(t)];case 1:return r=__assign$1.apply(void 0,o.concat([h.sent()])),i=this.performanceClient.startMeasurement(_B.SilentRefreshClientAcquireToken,r.correlationId),s=this.initializeServerTelemetryManager(iH.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(s,r.authority,r.azureCloudOptions)];case 2:return l=h.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(_B.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),[2,l.acquireTokenByRefreshToken(r).then((function(t){return i.endMeasurement({success:!0,fromCache:t.fromCache,requestId:t.requestId}),t})).catch((function(t){throw t instanceof FL&&t.setCorrelationId(u.correlationId),s.cacheFailedRequest(t),i.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},SilentRefreshClient.prototype.logout=function(){return Promise.reject(p$.createSilentLogoutUnsupportedError())},SilentRefreshClient.prototype.createRefreshTokenClient=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){var i;return __generator$1(this,(function(s){switch(s.label){case 0:return this.performanceClient.setPreQueueTime(_B.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,r,o)];case 1:return i=s.sent(),[2,new KB(i,this.performanceClient)]}}))}))},SilentRefreshClient}(z$),cq=function(){function EventHandler(t,r){this.eventCallbacks=new Map,this.logger=t,this.browserCrypto=r,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return EventHandler.prototype.addEventCallback=function(t){if("undefined"!=typeof window){var r=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(r,t),this.logger.verbose("Event callback registered with id: "+r),r}return null},EventHandler.prototype.removeEventCallback=function(t){this.eventCallbacks.delete(t),this.logger.verbose("Event callback "+t+" removed.")},EventHandler.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},EventHandler.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},EventHandler.prototype.emitEvent=function(t,r,o,i){var s=this;if("undefined"!=typeof window){var l={eventType:t,interactionType:r||null,payload:o||null,error:i||null,timestamp:Date.now()};this.logger.info("Emitting event: "+t),this.eventCallbacks.forEach((function(r,o){s.logger.verbose("Emitting event to callback "+o+": "+t),r.apply(null,[l])}))}},EventHandler.prototype.handleAccountCacheChange=function(t){try{var r=t.newValue||t.oldValue;if(!r)return;var o=JSON.parse(r);if("object"!=typeof o||!aB.isAccountEntity(o))return;var i=lB.toObject(new aB,o).getAccountInfo();!t.oldValue&&t.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(S$.ACCOUNT_ADDED,void 0,i)):!t.newValue&&t.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(S$.ACCOUNT_REMOVED,void 0,i))}catch(t){return}},EventHandler}(),lq=function(){function MathUtils(){}return MathUtils.decimalToHex=function(t){for(var r=t.toString(16);r.length<2;)r="0"+r;return r},MathUtils}(),dq=function(){function GuidGenerator(t){this.cryptoObj=t}return GuidGenerator.prototype.generateGuid=function(){try{var t=new Uint8Array(16);return this.cryptoObj.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,lq.decimalToHex(t[0])+lq.decimalToHex(t[1])+lq.decimalToHex(t[2])+lq.decimalToHex(t[3])+"-"+lq.decimalToHex(t[4])+lq.decimalToHex(t[5])+"-"+lq.decimalToHex(t[6])+lq.decimalToHex(t[7])+"-"+lq.decimalToHex(t[8])+lq.decimalToHex(t[9])+"-"+lq.decimalToHex(t[10])+lq.decimalToHex(t[11])+lq.decimalToHex(t[12])+lq.decimalToHex(t[13])+lq.decimalToHex(t[14])+lq.decimalToHex(t[15])}catch(t){for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,s=rL.EMPTY_STRING,l=0;l<36;l++)"-"!==r[l]&&"4"!==r[l]&&(i=16*Math.random()|0),"x"===r[l]?s+=o[i]:"y"===r[l]?(i&=3,s+=o[i|=8]):s+=r[l];return s}},GuidGenerator.prototype.isGuid=function(t){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)},GuidGenerator}(),uq=function(){function BrowserStringUtils(){}return BrowserStringUtils.stringToUtf8Arr=function(t){for(var r,o=0,i=t.length,s=0;s<i;s++)o+=(r=t.charCodeAt(s))<128?1:r<2048?2:r<65536?3:r<2097152?4:r<67108864?5:6;for(var l=new Uint8Array(o),u=0,h=0;u<o;h++)(r=t.charCodeAt(h))<128?l[u++]=r:r<2048?(l[u++]=192+(r>>>6),l[u++]=128+(63&r)):r<65536?(l[u++]=224+(r>>>12),l[u++]=128+(r>>>6&63),l[u++]=128+(63&r)):r<2097152?(l[u++]=240+(r>>>18),l[u++]=128+(r>>>12&63),l[u++]=128+(r>>>6&63),l[u++]=128+(63&r)):r<67108864?(l[u++]=248+(r>>>24),l[u++]=128+(r>>>18&63),l[u++]=128+(r>>>12&63),l[u++]=128+(r>>>6&63),l[u++]=128+(63&r)):(l[u++]=252+(r>>>30),l[u++]=128+(r>>>24&63),l[u++]=128+(r>>>18&63),l[u++]=128+(r>>>12&63),l[u++]=128+(r>>>6&63),l[u++]=128+(63&r));return l},BrowserStringUtils.stringToArrayBuffer=function(t){for(var r=new ArrayBuffer(t.length),o=new Uint8Array(r),i=0;i<t.length;i++)o[i]=t.charCodeAt(i);return r},BrowserStringUtils.utf8ArrToString=function(t){for(var r=rL.EMPTY_STRING,o=void 0,i=t.length,s=0;s<i;s++)o=t[s],r+=String.fromCharCode(o>251&&o<254&&s+5<i?1073741824*(o-252)+(t[++s]-128<<24)+(t[++s]-128<<18)+(t[++s]-128<<12)+(t[++s]-128<<6)+t[++s]-128:o>247&&o<252&&s+4<i?(o-248<<24)+(t[++s]-128<<18)+(t[++s]-128<<12)+(t[++s]-128<<6)+t[++s]-128:o>239&&o<248&&s+3<i?(o-240<<18)+(t[++s]-128<<12)+(t[++s]-128<<6)+t[++s]-128:o>223&&o<240&&s+2<i?(o-224<<12)+(t[++s]-128<<6)+t[++s]-128:o>191&&o<224&&s+1<i?(o-192<<6)+t[++s]-128:o);return r},BrowserStringUtils.getSortedObjectString=function(t){return JSON.stringify(t,Object.keys(t).sort())},BrowserStringUtils}(),hq=function(){function Base64Encode(){}return Base64Encode.prototype.urlEncode=function(t){return encodeURIComponent(this.encode(t).replace(/=/g,rL.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},Base64Encode.prototype.urlEncodeArr=function(t){return this.base64EncArr(t).replace(/=/g,rL.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},Base64Encode.prototype.encode=function(t){var r=uq.stringToUtf8Arr(t);return this.base64EncArr(r)},Base64Encode.prototype.base64EncArr=function(t){for(var r=(3-t.length%3)%3,o=rL.EMPTY_STRING,i=void 0,s=t.length,l=0,u=0;u<s;u++)i=u%3,l|=t[u]<<(16>>>i&24),2!==i&&t.length-u!=1||(o+=String.fromCharCode(this.uint6ToB64(l>>>18&63),this.uint6ToB64(l>>>12&63),this.uint6ToB64(l>>>6&63),this.uint6ToB64(63&l)),l=0);return 0===r?o:o.substring(0,o.length-r)+(1===r?"=":"==")},Base64Encode.prototype.uint6ToB64=function(t){return t<26?t+65:t<52?t+71:t<62?t-4:62===t?43:63===t?47:65},Base64Encode}(),pq=function(){function Base64Decode(){}return Base64Decode.prototype.decode=function(t){var r=t.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("Invalid base64 string")}var o=this.base64DecToArr(r);return uq.utf8ArrToString(o)},Base64Decode.prototype.base64DecToArr=function(t,r){for(var o=t.replace(/[^A-Za-z0-9\+\/]/g,rL.EMPTY_STRING),i=o.length,s=r?Math.ceil((3*i+1>>>2)/r)*r:3*i+1>>>2,l=new Uint8Array(s),u=void 0,h=void 0,m=0,v=0,C=0;C<i;C++)if(h=3&C,m|=this.b64ToUint6(o.charCodeAt(C))<<18-6*h,3===h||i-C==1){for(u=0;u<3&&v<s;u++,v++)l[v]=m>>>(16>>>u&24)&255;m=0}return l},Base64Decode.prototype.b64ToUint6=function(t){return t>64&&t<91?t-65:t>96&&t<123?t-71:t>47&&t<58?t+4:43===t?62:47===t?63:0},Base64Decode}(),fq=function(){function PkceGenerator(t){this.base64Encode=new hq,this.cryptoObj=t}return PkceGenerator.prototype.generateCodes=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,r;return __generator$1(this,(function(o){switch(o.label){case 0:return t=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(t)];case 1:return r=o.sent(),[2,{verifier:t,challenge:r}]}}))}))},PkceGenerator.prototype.generateCodeVerifier=function(){try{var t=new Uint8Array(32);return this.cryptoObj.getRandomValues(t),this.base64Encode.urlEncodeArr(t)}catch(t){throw p$.createPkceNotGeneratedError(t)}},PkceGenerator.prototype.generateCodeChallengeFromVerifier=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o;return __generator$1(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(t)];case 1:return r=i.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(r))];case 2:throw o=i.sent(),p$.createPkceNotGeneratedError(o);case 3:return[2]}}))}))},PkceGenerator}(),gq=function(){function ModernBrowserCrypto(){}return ModernBrowserCrypto.prototype.getRandomValues=function(t){return window.crypto.getRandomValues(t)},ModernBrowserCrypto.prototype.generateKey=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(i){return[2,window.crypto.subtle.generateKey(t,r,o)]}))}))},ModernBrowserCrypto.prototype.exportKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){return[2,window.crypto.subtle.exportKey(w$,t)]}))}))},ModernBrowserCrypto.prototype.importKey=function(t,r,o,i){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,window.crypto.subtle.importKey(w$,t,r,o,i)]}))}))},ModernBrowserCrypto.prototype.sign=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(i){return[2,window.crypto.subtle.sign(t,r,o)]}))}))},ModernBrowserCrypto.prototype.digest=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,window.crypto.subtle.digest(t,r)]}))}))},ModernBrowserCrypto}(),mq=function(){function MsrBrowserCrypto(){}return MsrBrowserCrypto.prototype.initPrng=function(t){return window.msrCrypto.initPrng(__spread(t))},MsrBrowserCrypto.prototype.getRandomValues=function(t){return window.msrCrypto.getRandomValues(t)},MsrBrowserCrypto.prototype.generateKey=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(i){return[2,window.msrCrypto.subtle.generateKey(t,r,o)]}))}))},MsrBrowserCrypto.prototype.exportKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){return[2,window.msrCrypto.subtle.exportKey(w$,t)]}))}))},MsrBrowserCrypto.prototype.importKey=function(t,r,o,i){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,window.msrCrypto.subtle.importKey(w$,t,r,o,i)]}))}))},MsrBrowserCrypto.prototype.sign=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(i){return[2,window.msrCrypto.subtle.sign(t,r,o)]}))}))},MsrBrowserCrypto.prototype.digest=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,window.msrCrypto.subtle.digest(t,r)]}))}))},MsrBrowserCrypto}(),vq=function(){function MsBrowserCrypto(){}return MsBrowserCrypto.prototype.getRandomValues=function(t){return window.msCrypto.getRandomValues(t)},MsBrowserCrypto.prototype.generateKey=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(i){return[2,new Promise((function(i,s){var l=window.msCrypto.subtle.generateKey(t,r,o);l.addEventListener("complete",(function(t){i(t.target.result)})),l.addEventListener("error",(function(t){s(t)}))}))]}))}))},MsBrowserCrypto.prototype.exportKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){return[2,new Promise((function(r,o){var i=window.msCrypto.subtle.exportKey(w$,t);i.addEventListener("complete",(function(t){var i=t.target.result,s=uq.utf8ArrToString(new Uint8Array(i)).replace(/\r/g,rL.EMPTY_STRING).replace(/\n/g,rL.EMPTY_STRING).replace(/\t/g,rL.EMPTY_STRING).split(" ").join(rL.EMPTY_STRING).replace("\0",rL.EMPTY_STRING);try{r(JSON.parse(s))}catch(t){o(t)}})),i.addEventListener("error",(function(t){o(t)}))}))]}))}))},MsBrowserCrypto.prototype.importKey=function(t,r,o,i){return __awaiter$3(this,void 0,void 0,(function(){var s,l;return __generator$1(this,(function(u){return s=uq.getSortedObjectString(t),l=uq.stringToArrayBuffer(s),[2,new Promise((function(t,s){var u=window.msCrypto.subtle.importKey(w$,l,r,o,i);u.addEventListener("complete",(function(r){t(r.target.result)})),u.addEventListener("error",(function(t){s(t)}))}))]}))}))},MsBrowserCrypto.prototype.sign=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(i){return[2,new Promise((function(i,s){var l=window.msCrypto.subtle.sign(t,r,o);l.addEventListener("complete",(function(t){i(t.target.result)})),l.addEventListener("error",(function(t){s(t)}))}))]}))}))},MsBrowserCrypto.prototype.digest=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,new Promise((function(o,i){var s=window.msCrypto.subtle.digest(t,r.buffer);s.addEventListener("complete",(function(t){o(t.target.result)})),s.addEventListener("error",(function(t){i(t)}))}))]}))}))},MsBrowserCrypto}(),yq="SHA-256",bq=new Uint8Array([1,0,1]),wq=function(){function BrowserCrypto(t,r){var o,i;if(this.logger=t,this.cryptoOptions=r,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new gq;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new vq;else{if(!this.hasMsrCrypto()||!(null===(o=this.cryptoOptions)||void 0===o?void 0:o.useMsrCrypto))throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),p$.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new mq}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(null===(i=this.cryptoOptions)||void 0===i?void 0:i.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),N$.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:yq,modulusLength:2048,publicExponent:bq}}return BrowserCrypto.prototype.hasIECrypto=function(){return"msCrypto"in window},BrowserCrypto.prototype.hasBrowserCrypto=function(){return"crypto"in window},BrowserCrypto.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},BrowserCrypto.prototype.sha256Digest=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r;return __generator$1(this,(function(o){return r=uq.stringToUtf8Arr(t),[2,this.subtleCrypto.digest({name:yq},r)]}))}))},BrowserCrypto.prototype.getRandomValues=function(t){return this.subtleCrypto.getRandomValues(t)},BrowserCrypto.prototype.generateKeyPair=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,t,r)]}))}))},BrowserCrypto.prototype.exportJwk=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){return[2,this.subtleCrypto.exportKey(t)]}))}))},BrowserCrypto.prototype.importJwk=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(i){return[2,this.subtleCrypto.importKey(t,this.keygenAlgorithmOptions,r,o)]}))}))},BrowserCrypto.prototype.sign=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,t,r)]}))}))},BrowserCrypto}(),Cq=function(){function DatabaseStorage(){this.dbName=_$,this.version=1,this.tableName=k$,this.dbOpen=!1}return DatabaseStorage.prototype.open=function(){return __awaiter$3(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(r){return[2,new Promise((function(r,o){var i=window.indexedDB.open(t.dbName,t.version);i.addEventListener("upgradeneeded",(function(r){r.target.result.createObjectStore(t.tableName)})),i.addEventListener("success",(function(o){var i=o;t.db=i.target.result,t.dbOpen=!0,r()})),i.addEventListener("error",(function(){return o(p$.createDatabaseUnavailableError())}))}))]}))}))},DatabaseStorage.prototype.closeConnection=function(){var t=this.db;t&&this.dbOpen&&(t.close(),this.dbOpen=!1)},DatabaseStorage.prototype.validateDbIsOpen=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){switch(t.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,t.sent()];case 2:return[2]}}))}))},DatabaseStorage.prototype.getItem=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r=this;return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise((function(o,i){if(!r.db)return i(p$.createDatabaseNotOpenError());var s=r.db.transaction([r.tableName],"readonly").objectStore(r.tableName).get(t);s.addEventListener("success",(function(t){var i=t;r.closeConnection(),o(i.target.result)})),s.addEventListener("error",(function(t){r.closeConnection(),i(t)}))}))]}}))}))},DatabaseStorage.prototype.setItem=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){var o=this;return __generator$1(this,(function(i){switch(i.label){case 0:return[4,this.validateDbIsOpen()];case 1:return i.sent(),[2,new Promise((function(i,s){if(!o.db)return s(p$.createDatabaseNotOpenError());var l=o.db.transaction([o.tableName],"readwrite").objectStore(o.tableName).put(r,t);l.addEventListener("success",(function(){o.closeConnection(),i()})),l.addEventListener("error",(function(t){o.closeConnection(),s(t)}))}))]}}))}))},DatabaseStorage.prototype.removeItem=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r=this;return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise((function(o,i){if(!r.db)return i(p$.createDatabaseNotOpenError());var s=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).delete(t);s.addEventListener("success",(function(){r.closeConnection(),o()})),s.addEventListener("error",(function(t){r.closeConnection(),i(t)}))}))]}}))}))},DatabaseStorage.prototype.getKeys=function(){return __awaiter$3(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,o){if(!t.db)return o(p$.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).getAllKeys();i.addEventListener("success",(function(o){var i=o;t.closeConnection(),r(i.target.result)})),i.addEventListener("error",(function(r){t.closeConnection(),o(r)}))}))]}}))}))},DatabaseStorage.prototype.containsKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r=this;return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise((function(o,i){if(!r.db)return i(p$.createDatabaseNotOpenError());var s=r.db.transaction([r.tableName],"readonly").objectStore(r.tableName).count(t);s.addEventListener("success",(function(t){var i=t;r.closeConnection(),o(1===i.target.result)})),s.addEventListener("error",(function(t){r.closeConnection(),i(t)}))}))]}}))}))},DatabaseStorage.prototype.deleteDatabase=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise((function(t,r){var o=window.indexedDB.deleteDatabase(_$);o.addEventListener("success",(function(){return t(!0)})),o.addEventListener("blocked",(function(){return t(!0)})),o.addEventListener("error",(function(){return r(!1)}))}))]}))}))},DatabaseStorage}(),_q=function(){function AsyncMemoryStorage(t,r){this.inMemoryCache=new D$,this.indexedDBCache=new Cq,this.logger=t,this.storeName=r}return AsyncMemoryStorage.prototype.handleDatabaseAccessError=function(t){if(!(t instanceof p$&&t.errorCode===s$.code))throw t;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},AsyncMemoryStorage.prototype.getItem=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o;return __generator$1(this,(function(i){switch(i.label){case 0:if(r=this.inMemoryCache.getItem(t))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(t)];case 2:return[2,i.sent()];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2,r]}}))}))},AsyncMemoryStorage.prototype.setItem=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(i){switch(i.label){case 0:this.inMemoryCache.setItem(t,r),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(t,r)];case 2:return i.sent(),[3,4];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2]}}))}))},AsyncMemoryStorage.prototype.removeItem=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r;return __generator$1(this,(function(o){switch(o.label){case 0:this.inMemoryCache.removeItem(t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(t)];case 2:return o.sent(),[3,4];case 3:return r=o.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}}))}))},AsyncMemoryStorage.prototype.getKeys=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,r;return __generator$1(this,(function(o){switch(o.label){case 0:if(0!==(t=this.inMemoryCache.getKeys()).length)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,o.sent()];case 3:return r=o.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},AsyncMemoryStorage.prototype.containsKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o;return __generator$1(this,(function(i){switch(i.label){case 0:if(r=this.inMemoryCache.containsKey(t))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(t)];case 2:return[2,i.sent()];case 3:return o=i.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2,r]}}))}))},AsyncMemoryStorage.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},AsyncMemoryStorage.prototype.clearPersistent=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,r;return __generator$1(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(t=o.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,t];case 2:return r=o.sent(),this.handleDatabaseAccessError(r),[2,!1];case 3:return[2]}}))}))},AsyncMemoryStorage}();
/*! @azure/msal-browser v2.36.0 2023-04-18 */!function(t){t.asymmetricKeys="asymmetricKeys",t.symmetricKeys="symmetricKeys"}(nq||(nq={}));var kq,Sq=function(){function CryptoKeyStore(t){this.logger=t,this.asymmetricKeys=new _q(this.logger,nq.asymmetricKeys),this.symmetricKeys=new _q(this.logger,nq.symmetricKeys)}return CryptoKeyStore.prototype.clear=function(){return __awaiter$3(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(r){switch(r.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return r.sent(),[2,!0];case 3:return(t=r.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+t.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},CryptoKeyStore}(),Tq=function(){function CryptoOps(t,r,o){this.logger=t,this.browserCrypto=new wq(this.logger,o),this.b64Encode=new hq,this.b64Decode=new pq,this.guidGenerator=new dq(this.browserCrypto),this.pkceGenerator=new fq(this.browserCrypto),this.cache=new Sq(this.logger),this.performanceClient=r}return CryptoOps.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},CryptoOps.prototype.base64Encode=function(t){return this.b64Encode.encode(t)},CryptoOps.prototype.base64Decode=function(t){return this.b64Decode.decode(t)},CryptoOps.prototype.generatePkceCodes=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){return[2,this.pkceGenerator.generateCodes()]}))}))},CryptoOps.prototype.getPublicKeyThumbprint=function(t){var r;return __awaiter$3(this,void 0,void 0,(function(){var o,i,s,l,u,h,m,v;return __generator$1(this,(function(C){switch(C.label){case 0:return o=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(_B.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(CryptoOps.EXTRACTABLE,CryptoOps.POP_KEY_USAGES)];case 1:return i=C.sent(),[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return s=C.sent(),l={e:s.e,kty:s.kty,n:s.n},u=uq.getSortedObjectString(l),[4,this.hashString(u)];case 3:return h=C.sent(),[4,this.browserCrypto.exportJwk(i.privateKey)];case 4:return m=C.sent(),[4,this.browserCrypto.importJwk(m,!1,["sign"])];case 5:return v=C.sent(),[4,this.cache.asymmetricKeys.setItem(h,{privateKey:v,publicKey:i.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return C.sent(),o&&o.endMeasurement({success:!0}),[2,h]}}))}))},CryptoOps.prototype.removeTokenBindingKey=function(t){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(r){switch(r.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(t)];case 1:return r.sent(),[4,this.cache.asymmetricKeys.containsKey(t)];case 2:return[2,!r.sent()]}}))}))},CryptoOps.prototype.clearKeystore=function(){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(t){switch(t.label){case 0:return[4,this.cache.clear()];case 1:return[2,t.sent()]}}))}))},CryptoOps.prototype.signJwt=function(t,r,o){var i;return __awaiter$3(this,void 0,void 0,(function(){var s,l,u,h,m,v,C,_,k,E,R,N,M;return __generator$1(this,(function(B){switch(B.label){case 0:return s=null===(i=this.performanceClient)||void 0===i?void 0:i.startMeasurement(_B.CryptoOptsSignJwt,o),[4,this.cache.asymmetricKeys.getItem(r)];case 1:if(!(l=B.sent()))throw p$.createSigningKeyNotFoundInStorageError(r);return[4,this.browserCrypto.exportJwk(l.publicKey)];case 2:return u=B.sent(),h=uq.getSortedObjectString(u),m=this.b64Encode.urlEncode(JSON.stringify({kid:r})),v=vH.getShrHeaderString({kid:m,alg:u.alg}),C=this.b64Encode.urlEncode(v),t.cnf={jwk:JSON.parse(h)},_=this.b64Encode.urlEncode(JSON.stringify(t)),k=C+"."+_,E=uq.stringToArrayBuffer(k),[4,this.browserCrypto.sign(l.privateKey,E)];case 3:return R=B.sent(),N=this.b64Encode.urlEncodeArr(new Uint8Array(R)),M=k+"."+N,s&&s.endMeasurement({success:!0}),[2,M]}}))}))},CryptoOps.prototype.hashString=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o;return __generator$1(this,(function(i){switch(i.label){case 0:return[4,this.browserCrypto.sha256Digest(t)];case 1:return r=i.sent(),o=new Uint8Array(r),[2,this.b64Encode.urlEncodeArr(o)]}}))}))},CryptoOps.POP_KEY_USAGES=["sign","verify"],CryptoOps.EXTRACTABLE=!0,CryptoOps}(),Eq=function(){function BrowserPerformanceMeasurement(t,r){this.correlationId=r,this.measureName=BrowserPerformanceMeasurement.makeMeasureName(t,r),this.startMark=BrowserPerformanceMeasurement.makeStartMark(t,r),this.endMark=BrowserPerformanceMeasurement.makeEndMark(t,r)}return BrowserPerformanceMeasurement.makeMeasureName=function(t,r){return"msal.measure."+t+"."+r},BrowserPerformanceMeasurement.makeStartMark=function(t,r){return"msal.start."+t+"."+r},BrowserPerformanceMeasurement.makeEndMark=function(t,r){return"msal.end."+t+"."+r},BrowserPerformanceMeasurement.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},BrowserPerformanceMeasurement.flushMeasurements=function(t,r){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{r.forEach((function(r){var o=BrowserPerformanceMeasurement.makeMeasureName(r.name,t);window.performance.getEntriesByName(o,"measure").length>0&&(window.performance.clearMeasures(o),window.performance.clearMarks(BrowserPerformanceMeasurement.makeStartMark(o,t)),window.performance.clearMarks(BrowserPerformanceMeasurement.makeEndMark(o,t)))}))}catch(t){}},BrowserPerformanceMeasurement.prototype.startMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(t){}},BrowserPerformanceMeasurement.prototype.endMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(t){}},BrowserPerformanceMeasurement.prototype.flushMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{var t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){var r=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),r}}catch(t){}return null},BrowserPerformanceMeasurement}(),xq=function(t){function BrowserPerformanceClient(r,o,i,s,l,u,h){var m=t.call(this,r,o,i,s,l,u)||this;return m.browserCrypto=new wq(m.logger,h),m.guidGenerator=new dq(m.browserCrypto),m}return __extends$1(BrowserPerformanceClient,t),BrowserPerformanceClient.prototype.startPerformanceMeasuremeant=function(t,r){return new Eq(t,r)},BrowserPerformanceClient.prototype.generateId=function(){return this.guidGenerator.generateGuid()},BrowserPerformanceClient.prototype.getPageVisibility=function(){var t;return(null===(t=document.visibilityState)||void 0===t?void 0:t.toString())||null},BrowserPerformanceClient.prototype.deleteIncompleteSubMeasurements=function(t){var r=this.eventsByCorrelationId.get(t.event.correlationId),o=r&&r.eventId===t.event.eventId,i=[];o&&(null==r?void 0:r.incompleteSubMeasurements)&&r.incompleteSubMeasurements.forEach((function(t){i.push(__assign$1({},t))})),i.length>0&&Eq.flushMeasurements(t.event.correlationId,i)},BrowserPerformanceClient.prototype.supportsBrowserPerformanceNow=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now},BrowserPerformanceClient.prototype.startMeasurement=function(r,o){var i=this,s=this.getPageVisibility(),l=t.prototype.startMeasurement.call(this,r,o);return __assign$1(__assign$1({},l),{endMeasurement:function(t){var r=l.endMeasurement(__assign$1({startPageVisibility:s,endPageVisibility:i.getPageVisibility()},t));return i.deleteIncompleteSubMeasurements(l),r},discardMeasurement:function(){l.discardMeasurement(),i.deleteIncompleteSubMeasurements(l),l.measurement.flushMeasurement()}})},BrowserPerformanceClient.prototype.setPreQueueTime=function(t,r){if(this.supportsBrowserPerformanceNow())if(r){var o=this.preQueueTimeByCorrelationId.get(r);o&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+o.name+" found",r),this.addQueueMeasurement(o.name,r,void 0,!0)),this.preQueueTimeByCorrelationId.set(r,{name:t,time:window.performance.now()})}else this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to set telemetry queue time");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+t)},BrowserPerformanceClient.prototype.addQueueMeasurement=function(r,o,i,s){if(this.supportsBrowserPerformanceNow())if(o){var l=t.prototype.getPreQueueTime.call(this,r,o);if(l){var u=window.performance.now(),h=i||t.prototype.calculateQueuedTime.call(this,l,u);return t.prototype.addQueueMeasurement.call(this,r,o,h,s)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+r+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+r)},BrowserPerformanceClient}(bH),Iq=function(){function TokenCache(t,r,o,i){this.isBrowserEnvironment="undefined"!=typeof window,this.config=t,this.storage=r,this.logger=o,this.cryptoObj=i}return TokenCache.prototype.loadExternalTokens=function(t,r,o){if(this.logger.info("TokenCache - loadExternalTokens called"),!r.id_token)throw p$.createUnableToLoadTokenError("Please ensure server response includes id token.");var i,s,l=new cB(r.id_token,this.cryptoObj);if(t.account){var u=this.loadAccount(l,t.account.environment,void 0,void 0,t.account.homeAccountId);i=new LB(u,this.loadIdToken(l,u.homeAccountId,t.account.environment,t.account.tenantId),this.loadAccessToken(t,r,u.homeAccountId,t.account.environment,t.account.tenantId,o),this.loadRefreshToken(t,r,u.homeAccountId,t.account.environment))}else{if(!t.authority)throw p$.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var h=lH.generateAuthority(t.authority,t.azureCloudOptions),m={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(s=new lH(h,this.config.system.networkClient,this.storage,m,this.logger),o.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");u=this.loadAccount(l,s.hostnameAndPort,o.clientInfo,s.authorityType);i=new LB(u,this.loadIdToken(l,u.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(t,r,u.homeAccountId,s.hostnameAndPort,s.tenant,o),this.loadRefreshToken(t,r,u.homeAccountId,s.hostnameAndPort))}else{if(!r.client_info)throw p$.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response");u=this.loadAccount(l,s.hostnameAndPort,r.client_info,s.authorityType);i=new LB(u,this.loadIdToken(l,u.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(t,r,u.homeAccountId,s.hostnameAndPort,s.tenant,o),this.loadRefreshToken(t,r,u.homeAccountId,s.hostnameAndPort))}}return this.generateAuthenticationResult(t,l,i,s)},TokenCache.prototype.loadAccount=function(t,r,o,i,s){var l;if(s?l=s:void 0!==i&&o&&(l=aB.generateHomeAccountId(o,i,this.logger,this.cryptoObj,t)),!l)throw p$.createUnableToLoadTokenError("Unexpected missing homeAccountId");var u=o?aB.createAccount(o,l,t,void 0,void 0,void 0,r):aB.createGenericAccount(l,t,void 0,void 0,void 0,r);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(u),u;throw p$.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.loadIdToken=function(t,r,o,i){var s=IB.createIdTokenEntity(r,o,t.rawToken,this.config.auth.clientId,i);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(s),s;throw p$.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.loadAccessToken=function(t,r,o,i,s,l){if(!r.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!r.expires_in)throw p$.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!l.extendedExpiresOn)throw p$.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var u=new sB(t.scopes).printScopes(),h=l.expiresOn||r.expires_in+(new Date).getTime()/1e3,m=l.extendedExpiresOn,v=PB.createAccessTokenEntity(o,i,r.access_token,this.config.auth.clientId,s,u,h,m,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(v),v;throw p$.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.loadRefreshToken=function(t,r,o,i){if(!r.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var s=RB.createRefreshTokenEntity(o,i,r.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(s),s;throw p$.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.generateAuthenticationResult=function(t,r,o,i){var s,l,u,h,m=rL.EMPTY_STRING,v=[],C=null;(null==o?void 0:o.accessToken)&&(m=o.accessToken.secret,v=sB.fromString(o.accessToken.target).asArray(),C=new Date(1e3*Number(o.accessToken.expiresOn)),h=new Date(1e3*Number(o.accessToken.extendedExpiresOn)));var _=(null==r?void 0:r.claims.oid)||(null==r?void 0:r.claims.sub)||rL.EMPTY_STRING,k=(null==r?void 0:r.claims.tid)||rL.EMPTY_STRING;return{authority:i?i.canonicalAuthority:rL.EMPTY_STRING,uniqueId:_,tenantId:k,scopes:v,account:(null==o?void 0:o.account)?o.account.getAccountInfo():null,idToken:r?r.rawToken:rL.EMPTY_STRING,idTokenClaims:r?r.claims:{},accessToken:m,fromCache:!0,expiresOn:C,correlationId:t.correlationId||rL.EMPTY_STRING,requestId:rL.EMPTY_STRING,extExpiresOn:h,familyId:rL.EMPTY_STRING,tokenType:(null===(s=null==o?void 0:o.accessToken)||void 0===s?void 0:s.tokenType)||rL.EMPTY_STRING,state:rL.EMPTY_STRING,cloudGraphHostName:(null===(l=null==o?void 0:o.account)||void 0===l?void 0:l.cloudGraphHostName)||rL.EMPTY_STRING,msGraphHost:(null===(u=null==o?void 0:o.account)||void 0===u?void 0:u.msGraphHost)||rL.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},TokenCache}(),Aq=function(t){function HybridSpaAuthorizationCodeClient(r){var o=t.call(this,r)||this;return o.includeRedirectUri=!1,o}return __extends$1(HybridSpaAuthorizationCodeClient,t),HybridSpaAuthorizationCodeClient}(VB),Pq=function(t){function SilentAuthCodeClient(r,o,i,s,l,u,h,m,v,C){var _=t.call(this,r,o,i,s,l,u,m,v,C)||this;return _.apiId=h,_}return __extends$1(SilentAuthCodeClient,t),SilentAuthCodeClient.prototype.acquireToken=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l,u;return __generator$1(this,(function(h){switch(h.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!t.code)throw p$.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime(_B.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,sH.Silent)];case 1:r=h.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||rL.EMPTY_STRING,r.account||null),o=this.initializeServerTelemetryManager(this.apiId),h.label=2;case 2:return h.trys.push([2,4,,5]),i=__assign$1(__assign$1({},r),{code:t.code}),this.performanceClient.setPreQueueTime(_B.StandardInteractionClientGetClientConfiguration,t.correlationId),[4,this.getClientConfiguration(o,r.authority)];case 3:return s=h.sent(),l=new Aq(s),this.logger.verbose("Auth code client created"),[2,new iq(l,this.browserStorage,i,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},r.state,l.authority,this.networkClient,!1)];case 4:throw(u=h.sent())instanceof FL&&u.setCorrelationId(this.correlationId),o.cacheFailedRequest(u),this.browserStorage.cleanRequestByState(r.state),u;case 5:return[2]}}))}))},SilentAuthCodeClient.prototype.logout=function(){return Promise.reject(p$.createSilentLogoutUnsupportedError())},SilentAuthCodeClient}(z$),Rq=function(){function ClientApplication(t){var r,o,i;this.isBrowserEnvironment="undefined"!=typeof window,this.config=function buildConfiguration(t,r){var o=t.auth,i=t.cache,s=t.system,l=t.telemetry,u={clientId:rL.EMPTY_STRING,authority:""+rL.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:rL.EMPTY_STRING,authorityMetadata:rL.EMPTY_STRING,redirectUri:rL.EMPTY_STRING,postLogoutRedirectUri:rL.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:QB.AAD,azureCloudOptions:{azureCloudInstance:OU.None,tenant:rL.EMPTY_STRING},skipAuthorityMetadataCache:!1},h={cacheLocation:eH.SessionStorage,temporaryCacheLocation:eH.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!i||i.cacheLocation!==eH.LocalStorage)},m={loggerCallback:function(){},logLevel:NL.Info,piiLoggingEnabled:!1},v=__assign$1(__assign$1({},uB),{loggerOptions:m,networkClient:r?q$.getBrowserNetworkClient():pH,navigationClient:new rq,loadFrameTimeout:0,windowHashTimeout:(null==s?void 0:s.loadFrameTimeout)||6e4,iframeHashTimeout:(null==s?void 0:s.loadFrameTimeout)||oq,navigateFrameWait:r&&q$.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==s?void 0:s.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:f$.DEFAULT_POLL_INTERVAL_MS,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),C=__assign$1(__assign$1({},s),{loggerOptions:(null==s?void 0:s.loggerOptions)||m}),_={application:{appName:rL.EMPTY_STRING,appVersion:rL.EMPTY_STRING}};return{auth:__assign$1(__assign$1({},u),o),cache:__assign$1(__assign$1({},h),i),system:__assign$1(__assign$1({},v),C),telemetry:__assign$1(__assign$1({},_),l)}}(t,this.isBrowserEnvironment),this.initialized=!1,this.logger=new NU(this.config.system.loggerOptions,U$,B$),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new xq(this.config.auth.clientId,this.config.auth.authority,this.logger,U$,B$,this.config.telemetry.application,this.config.system.cryptoOptions):new CH(this.config.auth.clientId,this.config.auth.authority,this.logger,U$,B$,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new Tq(this.logger,this.performanceClient,this.config.system.cryptoOptions):LL,this.eventHandler=new cq(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new L$(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(r=this.config.auth.clientId,o=this.logger,i={cacheLocation:eH.MemoryStorage,temporaryCacheLocation:eH.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1},new L$(r,i,LL,o));var s={cacheLocation:eH.MemoryStorage,temporaryCacheLocation:eH.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1};this.nativeInternalStorage=new L$(this.config.auth.clientId,s,this.browserCrypto,this.logger),this.tokenCache=new Iq(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return ClientApplication.prototype.initialize=function(){return __awaiter$3(this,void 0,void 0,(function(){var t,r,o,i;return __generator$1(this,(function(s){switch(s.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(t=this.config.system.allowNativeBroker,r=this.performanceClient.startMeasurement(_B.InitializeClientApplication),this.eventHandler.emitEvent(S$.INITIALIZE_START),!t)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),o=this,[4,Z$.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return o.nativeExtensionProvider=s.sent(),[3,4];case 3:return i=s.sent(),this.logger.verbose(i),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(S$.INITIALIZE_END),r.endMeasurement({allowNativeBroker:t,success:!0}),[2]}}))}))},ClientApplication.prototype.handleRedirectPromise=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l,u,h,m,v=this;return __generator$1(this,(function(C){return this.logger.verbose("handleRedirectPromise called"),q$.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),r=this.getAllAccounts(),this.isBrowserEnvironment?(o=t||rL.EMPTY_STRING,void 0===(i=this.redirectResponse.get(o))?(this.eventHandler.emitEvent(S$.HANDLE_REDIRECT_START,sH.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),s=this.browserStorage.getCachedNativeRequest(),l=void 0,s&&Z$.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!t?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),u=new X$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,iH.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,s.accountId,this.nativeInternalStorage,s.correlationId),l=u.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),h=this.browserStorage.getTemporaryCache(rH.CORRELATION_ID,!0)||rL.EMPTY_STRING,m=this.createRedirectClient(h),l=m.handleRedirectPromise(t)),i=l.then((function(t){t&&(r.length<v.getAllAccounts().length?(v.eventHandler.emitEvent(S$.LOGIN_SUCCESS,sH.Redirect,t),v.logger.verbose("handleRedirectResponse returned result, login success")):(v.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_SUCCESS,sH.Redirect,t),v.logger.verbose("handleRedirectResponse returned result, acquire token success")));return v.eventHandler.emitEvent(S$.HANDLE_REDIRECT_END,sH.Redirect),t})).catch((function(t){throw r.length>0?v.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_FAILURE,sH.Redirect,null,t):v.eventHandler.emitEvent(S$.LOGIN_FAILURE,sH.Redirect,null,t),v.eventHandler.emitEvent(S$.HANDLE_REDIRECT_END,sH.Redirect),t})),this.redirectResponse.set(o,i)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,i]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},ClientApplication.prototype.acquireTokenRedirect=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l,u=this;return __generator$1(this,(function(h){return r=this.getRequestCorrelationId(t),this.logger.verbose("acquireTokenRedirect called",r),this.preflightBrowserEnvironmentCheck(sH.Redirect),(o=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_START,sH.Redirect,t):this.eventHandler.emitEvent(S$.LOGIN_START,sH.Redirect,t),this.nativeExtensionProvider&&this.canUseNative(t)?(s=new X$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,iH.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId),i=s.acquireTokenRedirect(t).catch((function(r){if(r instanceof Y$&&r.isFatal())return u.nativeExtensionProvider=void 0,u.createRedirectClient(t.correlationId).acquireToken(t);if(r instanceof FB)return u.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),u.createRedirectClient(t.correlationId).acquireToken(t);throw u.browserStorage.setInteractionInProgress(!1),r}))):(l=this.createRedirectClient(t.correlationId),i=l.acquireToken(t)),[2,i.catch((function(t){throw o?u.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_FAILURE,sH.Redirect,null,t):u.eventHandler.emitEvent(S$.LOGIN_FAILURE,sH.Redirect,null,t),t}))]}))}))},ClientApplication.prototype.acquireTokenPopup=function(t){var r=this,o=this.getRequestCorrelationId(t),i=this.performanceClient.startMeasurement(_B.AcquireTokenPopup,o);try{this.logger.verbose("acquireTokenPopup called",o),this.preflightBrowserEnvironmentCheck(sH.Popup)}catch(t){return Promise.reject(t)}var s,l=this.getAllAccounts();(l.length>0?this.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_START,sH.Popup,t):this.eventHandler.emitEvent(S$.LOGIN_START,sH.Popup,t),this.canUseNative(t))?s=this.acquireTokenNative(t,iH.acquireTokenPopup).then((function(t){return r.browserStorage.setInteractionInProgress(!1),i.endMeasurement({success:!0,isNativeBroker:!0,requestId:t.requestId}),t})).catch((function(o){if(o instanceof Y$&&o.isFatal())return r.nativeExtensionProvider=void 0,r.createPopupClient(t.correlationId).acquireToken(t);if(o instanceof FB)return r.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),r.createPopupClient(t.correlationId).acquireToken(t);throw r.browserStorage.setInteractionInProgress(!1),o})):s=this.createPopupClient(t.correlationId).acquireToken(t);return s.then((function(t){return l.length<r.getAllAccounts().length?r.eventHandler.emitEvent(S$.LOGIN_SUCCESS,sH.Popup,t):r.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_SUCCESS,sH.Popup,t),i.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),i.endMeasurement({success:!0,requestId:t.requestId}),t})).catch((function(t){return l.length>0?r.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_FAILURE,sH.Popup,null,t):r.eventHandler.emitEvent(S$.LOGIN_FAILURE,sH.Popup,null,t),i.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),Promise.reject(t)}))},ClientApplication.prototype.trackPageVisibilityWithMeasurement=function(){var t=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;t&&(this.logger.info("Perf: Visibility change detected in ",t.event.name),t.increment({visibilityChangeCount:1}))},ClientApplication.prototype.ssoSilent=function(t){var r;return __awaiter$3(this,void 0,void 0,(function(){var o,i,s,l,u=this;return __generator$1(this,(function(h){return o=this.getRequestCorrelationId(t),i=__assign$1(__assign$1({},t),{prompt:t.prompt,correlationId:o}),this.preflightBrowserEnvironmentCheck(sH.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(_B.SsoSilent,o),null===(r=this.ssoSilentMeasurement)||void 0===r||r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",o),this.eventHandler.emitEvent(S$.SSO_SILENT_START,sH.Silent,i),this.canUseNative(i)?s=this.acquireTokenNative(i,iH.ssoSilent).catch((function(t){if(t instanceof Y$&&t.isFatal())return u.nativeExtensionProvider=void 0,u.createSilentIframeClient(i.correlationId).acquireToken(i);throw t})):(l=this.createSilentIframeClient(i.correlationId),s=l.acquireToken(i)),[2,s.then((function(t){var r,o;return u.eventHandler.emitEvent(S$.SSO_SILENT_SUCCESS,sH.Silent,t),null===(r=u.ssoSilentMeasurement)||void 0===r||r.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),null===(o=u.ssoSilentMeasurement)||void 0===o||o.endMeasurement({success:!0,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){var r;throw u.eventHandler.emitEvent(S$.SSO_SILENT_FAILURE,sH.Silent,null,t),null===(r=u.ssoSilentMeasurement)||void 0===r||r.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((function(){document.removeEventListener("visibilitychange",u.trackPageVisibilityWithMeasurement)}))]}))}))},ClientApplication.prototype.acquireTokenByCode=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l=this;return __generator$1(this,(function(u){r=this.getRequestCorrelationId(t),this.preflightBrowserEnvironmentCheck(sH.Silent),this.logger.trace("acquireTokenByCode called",r),this.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_BY_CODE_START,sH.Silent,t),o=this.performanceClient.startMeasurement(_B.AcquireTokenByCode,t.correlationId);try{if(t.code&&t.nativeAccountId)throw p$.createSpaCodeAndNativeAccountIdPresentError();if(t.code)return i=t.code,(s=this.hybridAuthCodeResponses.get(i))?(this.logger.verbose("Existing acquireTokenByCode request found",t.correlationId),o.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",r),s=this.acquireTokenByCodeAsync(__assign$1(__assign$1({},t),{correlationId:r})).then((function(t){return l.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_BY_CODE_SUCCESS,sH.Silent,t),l.hybridAuthCodeResponses.delete(i),o.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),o.endMeasurement({success:!0,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){throw l.hybridAuthCodeResponses.delete(i),l.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_BY_CODE_FAILURE,sH.Silent,null,t),o.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})),this.hybridAuthCodeResponses.set(i,s)),[2,s];if(t.nativeAccountId){if(this.canUseNative(t,t.nativeAccountId))return[2,this.acquireTokenNative(t,iH.acquireTokenByCode,t.nativeAccountId).catch((function(t){throw t instanceof Y$&&t.isFatal()&&(l.nativeExtensionProvider=void 0),t}))];throw p$.createUnableToAcquireTokenFromNativePlatformError()}throw p$.createAuthCodeOrNativeAccountIdRequiredError()}catch(t){throw this.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_BY_CODE_FAILURE,sH.Silent,null,t),o.endMeasurement({errorCode:t instanceof FL&&t.errorCode||void 0,subErrorCode:t instanceof FL&&t.subError||void 0,success:!1}),t}return[2]}))}))},ClientApplication.prototype.acquireTokenByCodeAsync=function(t){var r;return __awaiter$3(this,void 0,void 0,(function(){var o=this;return __generator$1(this,(function(i){switch(i.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",t.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(_B.AcquireTokenByCodeAsync,t.correlationId),null===(r=this.acquireTokenByCodeAsyncMeasurement)||void 0===r||r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(t.correlationId).acquireToken(t).then((function(t){var r;return null===(r=o.acquireTokenByCodeAsyncMeasurement)||void 0===r||r.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){var r;throw null===(r=o.acquireTokenByCodeAsyncMeasurement)||void 0===r||r.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((function(){document.removeEventListener("visibilitychange",o.trackPageVisibilityWithMeasurement)}))];case 1:return[2,i.sent()]}}))}))},ClientApplication.prototype.acquireTokenFromCache=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(i){switch(this.performanceClient.addQueueMeasurement(_B.AcquireTokenFromCache,r.correlationId),o.cacheLookupPolicy){case C$.Default:case C$.AccessToken:case C$.AccessTokenAndRefreshToken:return[2,t.acquireToken(r)];default:throw PU.createRefreshRequiredError()}return[2]}))}))},ClientApplication.prototype.acquireTokenByRefreshToken=function(t,r){return __awaiter$3(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(i){switch(this.performanceClient.addQueueMeasurement(_B.AcquireTokenByRefreshToken,t.correlationId),r.cacheLookupPolicy){case C$.Default:case C$.AccessTokenAndRefreshToken:case C$.RefreshToken:case C$.RefreshTokenAndNetwork:return o=this.createSilentRefreshClient(t.correlationId),this.performanceClient.setPreQueueTime(_B.SilentRefreshClientAcquireToken,t.correlationId),[2,o.acquireToken(t)];default:throw PU.createRefreshRequiredError()}return[2]}))}))},ClientApplication.prototype.acquireTokenBySilentIframe=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r;return __generator$1(this,(function(o){return this.performanceClient.addQueueMeasurement(_B.AcquireTokenBySilentIframe,t.correlationId),r=this.createSilentIframeClient(t.correlationId),this.performanceClient.setPreQueueTime(_B.SilentIframeClientAcquireToken,t.correlationId),[2,r.acquireToken(t)]}))}))},ClientApplication.prototype.logout=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r;return __generator$1(this,(function(o){return r=this.getRequestCorrelationId(t),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",r),[2,this.logoutRedirect(__assign$1({correlationId:r},t))]}))}))},ClientApplication.prototype.logoutRedirect=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r;return __generator$1(this,(function(o){return r=this.getRequestCorrelationId(t),this.preflightBrowserEnvironmentCheck(sH.Redirect),[2,this.createRedirectClient(r).logout(t)]}))}))},ClientApplication.prototype.logoutPopup=function(t){try{var r=this.getRequestCorrelationId(t);return this.preflightBrowserEnvironmentCheck(sH.Popup),this.createPopupClient(r).logout(t)}catch(t){return Promise.reject(t)}},ClientApplication.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},ClientApplication.prototype.getAccountByUsername=function(t){if(this.logger.trace("getAccountByUsername called"),!t)return this.logger.warning("getAccountByUsername: No username provided"),null;var r=this.browserStorage.getAccountInfoFilteredBy({username:t});return r?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+t),r):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},ClientApplication.prototype.getAccountByHomeId=function(t){if(this.logger.trace("getAccountByHomeId called"),!t)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;var r=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:t});return r?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+t),r):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},ClientApplication.prototype.getAccountByLocalId=function(t){if(this.logger.trace("getAccountByLocalId called"),!t)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;var r=this.browserStorage.getAccountInfoFilteredBy({localAccountId:t});return r?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+t),r):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},ClientApplication.prototype.setActiveAccount=function(t){this.browserStorage.setActiveAccount(t)},ClientApplication.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},ClientApplication.prototype.preflightBrowserEnvironmentCheck=function(t,r){if(void 0===r&&(r=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),q$.blockNonBrowserEnvironment(this.isBrowserEnvironment),q$.blockRedirectInIframe(t,this.config.system.allowRedirectInIframe),q$.blockReloadInHiddenIframes(),q$.blockAcquireTokenInPopups(),q$.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t===sH.Redirect&&this.config.cache.cacheLocation===eH.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw N$.createInMemoryRedirectUnavailableError();t!==sH.Redirect&&t!==sH.Popup||this.preflightInteractiveRequest(r)},ClientApplication.prototype.preflightInteractiveRequest=function(t){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),q$.blockReloadInHiddenIframes(),t&&this.browserStorage.setInteractionInProgress(!0)},ClientApplication.prototype.acquireTokenNative=function(t,r,o){return __awaiter$3(this,void 0,void 0,(function(){return __generator$1(this,(function(i){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw p$.createNativeConnectionNotEstablishedError();return[2,new X$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,r,this.performanceClient,this.nativeExtensionProvider,o||this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId).acquireToken(t)]}))}))},ClientApplication.prototype.canUseNative=function(t,r){if(this.logger.trace("canUseNative called"),!Z$.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(t.prompt)switch(t.prompt){case sL.NONE:case sL.CONSENT:case sL.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+t.prompt+" is not compatible with native flow, returning false"),!1}return!(!r&&!this.getNativeAccountId(t))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},ClientApplication.prototype.getNativeAccountId=function(t){var r=t.account||this.browserStorage.getAccountInfoByHints(t.loginHint,t.sid)||this.getActiveAccount();return r&&r.nativeAccountId||""},ClientApplication.prototype.createPopupClient=function(t){return new tq(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)},ClientApplication.prototype.createRedirectClient=function(t){return new eq(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentIframeClient=function(t){return new sq(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,iH.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentCacheClient=function(t){return new J$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentRefreshClient=function(t){return new aq(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentAuthCodeClient=function(t){return new Pq(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,iH.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,t)},ClientApplication.prototype.addEventCallback=function(t){return this.eventHandler.addEventCallback(t)},ClientApplication.prototype.removeEventCallback=function(t){this.eventHandler.removeEventCallback(t)},ClientApplication.prototype.addPerformanceCallback=function(t){return this.performanceClient.addPerformanceCallback(t)},ClientApplication.prototype.removePerformanceCallback=function(t){return this.performanceClient.removePerformanceCallback(t)},ClientApplication.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},ClientApplication.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},ClientApplication.prototype.getTokenCache=function(){return this.tokenCache},ClientApplication.prototype.getLogger=function(){return this.logger},ClientApplication.prototype.setLogger=function(t){this.logger=t},ClientApplication.prototype.initializeWrapperLibrary=function(t,r){this.browserStorage.setWrapperMetadata(t,r)},ClientApplication.prototype.setNavigationClient=function(t){this.navigationClient=t},ClientApplication.prototype.getConfiguration=function(){return this.config},ClientApplication.prototype.getRequestCorrelationId=function(t){return(null==t?void 0:t.correlationId)?t.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():rL.EMPTY_STRING},ClientApplication}(),Oq=function(t){function PublicClientApplication(r){var o=t.call(this,r)||this;return o.astsAsyncMeasurement=void 0,o.activeSilentTokenRequests=new Map,o.trackPageVisibility=o.trackPageVisibility.bind(o),o}return __extends$1(PublicClientApplication,t),PublicClientApplication.prototype.loginRedirect=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r;return __generator$1(this,(function(o){return r=this.getRequestCorrelationId(t),this.logger.verbose("loginRedirect called",r),[2,this.acquireTokenRedirect(__assign$1({correlationId:r},t||b$))]}))}))},PublicClientApplication.prototype.loginPopup=function(t){var r=this.getRequestCorrelationId(t);return this.logger.verbose("loginPopup called",r),this.acquireTokenPopup(__assign$1({correlationId:r},t||b$))},PublicClientApplication.prototype.acquireTokenSilent=function(t){return __awaiter$3(this,void 0,void 0,(function(){var r,o,i,s,l,u,h,m=this;return __generator$1(this,(function(v){if(r=this.getRequestCorrelationId(t),(o=this.performanceClient.startMeasurement(_B.AcquireTokenSilent,r)).addStaticFields({cacheLookupPolicy:t.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(sH.Silent),this.logger.verbose("acquireTokenSilent called",r),!(i=t.account||this.getActiveAccount()))throw p$.createNoAccountError();return s={clientId:this.config.auth.clientId,authority:t.authority||rL.EMPTY_STRING,scopes:t.scopes,homeAccountIdentifier:i.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},l=JSON.stringify(s),void 0===(u=this.activeSilentTokenRequests.get(l))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),this.performanceClient.setPreQueueTime(_B.AcquireTokenSilentAsync,r),h=this.acquireTokenSilentAsync(__assign$1(__assign$1({},t),{correlationId:r}),i).then((function(r){return m.activeSilentTokenRequests.delete(l),o.addStaticFields({accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length}),o.endMeasurement({success:!0,fromCache:r.fromCache,isNativeBroker:r.fromNativeBroker,cacheLookupPolicy:t.cacheLookupPolicy,requestId:r.requestId}),r})).catch((function(t){throw m.activeSilentTokenRequests.delete(l),o.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})),this.activeSilentTokenRequests.set(l,h),[2,h]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),o.discardMeasurement(),[2,u])}))}))},PublicClientApplication.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},PublicClientApplication.prototype.acquireTokenSilentAsync=function(t,r){var o;return __awaiter$3(this,void 0,void 0,(function(){var i,s,l,u,h,m=this;return __generator$1(this,(function(v){switch(v.label){case 0:return this.performanceClient.addQueueMeasurement(_B.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_START,sH.Silent,t),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(_B.AcquireTokenSilentAsync,t.correlationId),null===(o=this.astsAsyncMeasurement)||void 0===o||o.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),Z$.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)&&r.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),s=__assign$1(__assign$1({},t),{account:r}),i=this.acquireTokenNative(s,iH.acquireTokenSilent_silentFlow).catch((function(r){return __awaiter$3(m,void 0,void 0,(function(){return __generator$1(this,(function(o){if(r instanceof Y$&&r.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(t.correlationId).acquireToken(t)];throw r}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),l=this.createSilentCacheClient(t.correlationId),this.performanceClient.setPreQueueTime(_B.InitializeSilentRequest,t.correlationId),[4,l.initializeSilentRequest(t,r)];case 2:u=v.sent(),h=__assign$1(__assign$1({},t),{cacheLookupPolicy:t.cacheLookupPolicy||C$.Default}),this.performanceClient.setPreQueueTime(_B.AcquireTokenFromCache,u.correlationId),i=this.acquireTokenFromCache(l,u,h).catch((function(r){if(h.cacheLookupPolicy===C$.AccessToken)throw r;return q$.blockReloadInHiddenIframes(),m.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_NETWORK_START,sH.Silent,u),m.performanceClient.setPreQueueTime(_B.AcquireTokenByRefreshToken,u.correlationId),m.acquireTokenByRefreshToken(u,h).catch((function(r){var o=r instanceof bB,i=r instanceof FB,s=r.errorCode===f$.INVALID_GRANT_ERROR;if((!o||!s||i||h.cacheLookupPolicy===C$.AccessTokenAndRefreshToken||h.cacheLookupPolicy===C$.RefreshToken)&&h.cacheLookupPolicy!==C$.Skip)throw r;return m.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",t.correlationId),m.performanceClient.setPreQueueTime(_B.AcquireTokenBySilentIframe,u.correlationId),m.acquireTokenBySilentIframe(u)}))})),v.label=3;case 3:return[2,i.then((function(t){var r;return m.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_SUCCESS,sH.Silent,t),null===(r=m.astsAsyncMeasurement)||void 0===r||r.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){var r;throw m.eventHandler.emitEvent(S$.ACQUIRE_TOKEN_FAILURE,sH.Silent,null,t),null===(r=m.astsAsyncMeasurement)||void 0===r||r.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((function(){document.removeEventListener("visibilitychange",m.trackPageVisibility)}))]}}))}))},PublicClientApplication}(Rq),__awaiter$1=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};
/*! @azure/msal-browser v2.36.0 2023-04-18 */exports.PromptType=void 0,(kq=exports.PromptType||(exports.PromptType={})).SELECT_ACCOUNT="select_account",kq.LOGIN="login",kq.CONSENT="consent";class Msal2Provider extends IProvider{get publicClientApplication(){return this._publicClientApplication}get name(){return"MgtMsal2Provider"}constructor(t){super(),this.sessionStorageRequestedScopesKey="mgt-requested-scopes",this.sessionStorageDeniedScopesKey="mgt-denied-scopes",this.homeAccountKey="275f3731-e4a4-468a-bf9c-baca24b31e26",this.initProvider(t)}initProvider(t){return __awaiter$1(this,void 0,void 0,(function*(){const r=t.options||{auth:{clientId:""}};if(this.ms_config=r,this.ms_config.cache=r.cache||{},this.ms_config.cache.cacheLocation=r.cache.cacheLocation||"localStorage",void 0!==this.ms_config.cache.storeAuthStateInCookie&&null!==this.ms_config.cache.storeAuthStateInCookie||(this.ms_config.cache.storeAuthStateInCookie=!0),this.ms_config.system=r.system||{},this.ms_config.system.iframeHashTimeout=r.system.iframeHashTimeout||1e4,t.authority&&(this.ms_config.auth.authority=t.authority),t.redirectUri&&(this.ms_config.auth.redirectUri=t.redirectUri),"clientId"in t){if(!t.clientId)throw new Error("clientId must be provided");this.ms_config.auth.clientId=t.clientId,this._publicClientApplication=new Oq(this.ms_config)}else{if(!("publicClientApplication"in t))throw new Error("either clientId or publicClientApplication must be provided");if(!t.publicClientApplication)throw new Error("publicClientApplication must be provided");this._publicClientApplication=t.publicClientApplication}this._loginType=void 0!==t.loginType?t.loginType:exports.LoginType.Redirect,this._loginHint=void 0!==t.loginHint?t.loginHint:null,this._sid=void 0!==t.sid?t.sid:null,this.isIncrementalConsentDisabled=void 0!==t.isIncrementalConsentDisabled&&t.isIncrementalConsentDisabled,this._domainHint=void 0!==t.domainHint?t.domainHint:null,this.scopes=void 0!==t.scopes?t.scopes:["user.read"],this._prompt=void 0!==t.prompt?t.prompt:exports.PromptType.SELECT_ACCOUNT,this.graph=createFromProvider(this);try{const t=yield this._publicClientApplication.handleRedirectPromise();null!==t?this.handleResponse(null==t?void 0:t.account):this.trySilentSignIn()}catch(t){throw t}}))}trySilentSignIn(){return __awaiter$1(this,void 0,void 0,(function*(){let t={scopes:this.scopes,domainHint:this._domainHint};if(this._sid||this._loginHint){t.sid=this._sid,t.loginHint=this._loginHint;try{this.setState(exports.ProviderState.Loading);const r=yield this._publicClientApplication.ssoSilent(t);r&&this.handleResponse(null==r?void 0:r.account)}catch(t){this.setState(exports.ProviderState.SignedOut)}}else{const t=this.getAccount();if(t&&(yield this.getAccessToken(null)))return void this.handleResponse(t);this.setState(exports.ProviderState.SignedOut)}}))}login(){return __awaiter$1(this,void 0,void 0,(function*(){const t={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint};if(this._loginType==exports.LoginType.Popup){const r=yield this._publicClientApplication.loginPopup(t);this.handleResponse(null==r?void 0:r.account)}else{const r=Object.assign({},t);this._publicClientApplication.loginRedirect(r)}}))}getAllAccounts(){let t=[];return this._publicClientApplication.getAllAccounts().forEach((r=>{t.push({username:r.username,id:r.homeAccountId})})),t}setActiveAccount(t){this._publicClientApplication.setActiveAccount(this._publicClientApplication.getAccountByHomeId(t.id)),this.setStoredAccount(),super.setActiveAccount(t)}handleResponse(t){null!==t?(this.setActiveAccount({username:t.name,id:t.homeAccountId}),this.setState(exports.ProviderState.SignedIn)):this.setState(exports.ProviderState.SignedOut),this.clearRequestedScopes()}setStoredAccount(){this.clearStoredAccount(),window[this.ms_config.cache.cacheLocation].setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}getStoredAccount(){let t=null;return t=window[this.ms_config.cache.cacheLocation].getItem(this.homeAccountKey),this._publicClientApplication.getAccountByHomeId(t)}clearStoredAccount(){window[this.ms_config.cache.cacheLocation].removeItem(this.homeAccountKey)}setRequestedScopes(t){t&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(t))}addDeniedScopes(t){if(t){let r=this.getDeniedScopes()||[];r=r.concat(t);let o=r.indexOf("openid");-1!==o&&r.splice(o,1),o=r.indexOf("profile"),-1!==o&&r.splice(o,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(r))}}getDeniedScopes(){const t=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return t?JSON.parse(t):null}areScopesDenied(t){if(t){const r=this.getDeniedScopes();if(r&&r.filter((r=>-1!==t.indexOf(r))).length>0)return!0}return!1}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}getAccount(){const t=this.getStoredAccount();return t||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}logout(){return __awaiter$1(this,void 0,void 0,(function*(){const t={account:this._publicClientApplication.getActiveAccount()};this.clearStoredAccount(),this._loginType==exports.LoginType.Redirect?(this._publicClientApplication.logoutRedirect(t),this.setState(exports.ProviderState.SignedOut)):(yield this._publicClientApplication.logoutPopup(Object.assign({},t)),this.setState(exports.ProviderState.SignedOut))}))}getAccessToken(t){return __awaiter$1(this,void 0,void 0,(function*(){const r=t&&t.scopes||this.scopes,o={scopes:r,account:this.getAccount()};try{const t=o;return(yield this._publicClientApplication.acquireTokenSilent(t)).accessToken}catch(t){if(t instanceof FB){if(this.isIncrementalConsentDisabled)return null;if(this._loginType===exports.LoginType.Redirect){if(this.areScopesDenied(r))throw t;this.setRequestedScopes(r),this._publicClientApplication.acquireTokenRedirect(o)}else try{return(yield this._publicClientApplication.acquireTokenPopup(o)).accessToken}catch(t){throw t}}else this.setState(exports.ProviderState.SignedOut)}throw null}))}}var __decorate$1=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata$1=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};exports.MgtMsal2Provider=class MgtMsal2Provider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const t={clientId:this.clientId};if(this.loginType&&this.loginType.length>1){let r=this.loginType.toLowerCase();r=r[0].toUpperCase()+r.slice(1);const o=exports.LoginType[r];t.loginType=o}if(this.authority&&(t.authority=this.authority),this.scopes){const r=this.scopes.split(",");r&&r.length>0&&(t.scopes=r)}if(this.redirectUri&&(t.redirectUri=this.redirectUri),this.prompt){let r=this.prompt.toUpperCase();const o=exports.PromptType[r];t.prompt=o}this.isIncrementalConsentDisabled&&(t.isIncrementalConsentDisabled=!0),this.provider=new Msal2Provider(t),Providers.globalProvider=this.provider}}},__decorate$1([property({attribute:"client-id",type:String}),__metadata$1("design:type",Object)],exports.MgtMsal2Provider.prototype,"clientId",void 0),__decorate$1([property({attribute:"login-type",type:String}),__metadata$1("design:type",Object)],exports.MgtMsal2Provider.prototype,"loginType",void 0),__decorate$1([property(),__metadata$1("design:type",Object)],exports.MgtMsal2Provider.prototype,"authority",void 0),__decorate$1([property({attribute:"scopes",type:String}),__metadata$1("design:type",Object)],exports.MgtMsal2Provider.prototype,"scopes",void 0),__decorate$1([property({attribute:"redirect-uri",type:String}),__metadata$1("design:type",Object)],exports.MgtMsal2Provider.prototype,"redirectUri",void 0),__decorate$1([property({attribute:"prompt",type:String}),__metadata$1("design:type",String)],exports.MgtMsal2Provider.prototype,"prompt",void 0),__decorate$1([property({attribute:"incremental-consent-disabled",type:Boolean}),__metadata$1("design:type",Boolean)],exports.MgtMsal2Provider.prototype,"isIncrementalConsentDisabled",void 0),exports.MgtMsal2Provider=__decorate$1([customElement$1("mgt-msal2-provider")],exports.MgtMsal2Provider);var Nq,__awaiter=function(t,r,o,i){return new(o||(o=Promise))((function(s,l){function fulfilled(t){try{step(i.next(t))}catch(t){l(t)}}function rejected(t){try{step(i.throw(t))}catch(t){l(t)}}function step(t){t.done?s(t.value):function adopt(t){return t instanceof o?t:new o((function(r){r(t)}))}(t.value).then(fulfilled,rejected)}step((i=i.apply(t,r||[])).next())}))};exports.HttpMethod=void 0,(Nq=exports.HttpMethod||(exports.HttpMethod={})).GET="GET",Nq.POST="POST";class TeamsMsal2Provider extends Msal2Provider{static get isAvailable(){return TeamsHelper.isAvailable}static get microsoftTeamsLib(){return TeamsHelper.microsoftTeamsLib}static set microsoftTeamsLib(t){TeamsHelper.microsoftTeamsLib=t}get name(){return"MgtTeamsMsal2Provider"}static handleAuth(){return __awaiter(this,void 0,void 0,(function*(){const t=TeamsHelper.microsoftTeamsLib;if(!t)return void console.error("Make sure you have referenced the Microsoft Teams sdk before using the TeamsMsal2Provider");t.initialize(),sessionStorage.getItem(this._sessionStorageLogoutInProgress)&&t.authentication.notifySuccess();const r=new URL(window.location.href).searchParams.get("signout"),o=localStorage.getItem(this._localStorageParametersKey);let i;if(i=o?JSON.parse(o):{},!i.clientId)return void t.authentication.notifyFailure("no clientId provided");const s=i.scopes?i.scopes.split(","):null,l=i.isConsent?exports.PromptType.CONSENT:exports.PromptType.SELECT_ACCOUNT,u=i.options||{auth:{clientId:i.clientId}};u.system=u.system||{},u.system.loadFrameTimeout=1e4;const h=new Msal2Provider({clientId:i.clientId,options:u,scopes:s,loginHint:i.loginHint,prompt:l}),handleProviderState=()=>__awaiter(this,void 0,void 0,(function*(){if(h.state===exports.ProviderState.SignedOut){if(r)return void t.authentication.notifySuccess();if(!sessionStorage.getItem(this._sessionStorageLoginInProgress)){window.parent!==window?console.warn("handleProviderState - Is in iframe... will try to login anyway... but will not set session storage variable"):sessionStorage.setItem(this._sessionStorageLoginInProgress,"true"),h.login()}}else if(h.state===exports.ProviderState.SignedIn){if(r)return sessionStorage.setItem(this._sessionStorageLogoutInProgress,"true"),void(yield h.logout());try{const r=yield h.getAccessTokenForScopes(...h.scopes);t.authentication.notifySuccess(r)}catch(r){t.authentication.notifyFailure(r)}}}));h.onStateChanged(handleProviderState),handleProviderState()}))}constructor(t){super({clientId:t.clientId,loginType:exports.LoginType.Redirect,options:t.msalOptions,scopes:t.scopes}),this.clientId=t.clientId,this._msalOptions=t.msalOptions,this._authPopupUrl=t.authPopupUrl,this._ssoUrl=t.ssoUrl,this._autoConsent=void 0===t.autoConsent||t.autoConsent,this._httpMethod=void 0!==t.httpMethod?t.httpMethod:exports.HttpMethod.GET;TeamsHelper.microsoftTeamsLib.initialize(),this._ssoUrl&&this.internalLogin()}login(){return __awaiter(this,void 0,void 0,(function*(){if(this._ssoUrl&&!this._needsConsent)return;this.setState(exports.ProviderState.Loading);const t=TeamsHelper.microsoftTeamsLib;return new Promise(((r,o)=>{t.getContext((i=>{this.teamsContext=i;const s={clientId:this.clientId,loginHint:i.loginHint,options:this._msalOptions,scopes:this.scopes.join(","),isConsent:this._autoConsent};localStorage.setItem(TeamsMsal2Provider._localStorageParametersKey,JSON.stringify(s));const l=new URL(this._authPopupUrl,new URL(window.location.href));t.authentication.authenticate({failureCallback:t=>{this.setState(exports.ProviderState.SignedOut),o()},successCallback:t=>{this._ssoUrl?(this.setState(exports.ProviderState.SignedIn),r()):(this.trySilentSignIn(),r())},url:l.href})}))}))}))}logout(){return __awaiter(this,void 0,void 0,(function*(){if(this._ssoUrl)return;const t=TeamsHelper.microsoftTeamsLib;return new Promise(((r,o)=>{t.getContext((i=>{this.teamsContext=i;const s=new URL(this._authPopupUrl,new URL(window.location.href));s.searchParams.append("signout","true"),t.authentication.authenticate({failureCallback:t=>{this.trySilentSignIn(),o()},successCallback:t=>{this.trySilentSignIn(),r()},url:s.href})}))}))}))}getAccessToken(t){return __awaiter(this,void 0,void 0,(function*(){if(!this.teamsContext&&TeamsHelper.microsoftTeamsLib){TeamsHelper.microsoftTeamsLib.initialize(),this.teamsContext=yield this.getTeamsContext()}const r=t&&t.scopes||this.scopes;if(!this._ssoUrl)return new Promise(((t,o)=>__awaiter(this,void 0,void 0,(function*(){const i={scopes:r,account:this.getAccount()};try{const r=yield this.publicClientApplication.acquireTokenSilent(i);t(r.accessToken)}catch(r){r instanceof FB?t(null):o(r)}}))));{const t=yield this.getClientToken();let o,i=new URL(this._ssoUrl,new URL(window.location.href));if(this._httpMethod===exports.HttpMethod.GET){const s=new URLSearchParams({ssoToken:t,scopes:r.join(","),clientId:this.clientId});o=yield fetch(`${i.href}?${s}`,{method:"GET",mode:"cors",cache:"default"})}else o=yield fetch(i.href,{method:"POST",headers:{"Content-Type":"application/json",authorization:`Bearer ${t}`},body:JSON.stringify({scopes:r,clientid:this.clientId}),mode:"cors",cache:"default"});const s=yield o.json().catch(this.unhandledFetchError);if(o.ok||"consent_required"!==s.error){if(o.ok)return this._needsConsent=!1,s.access_token;throw s}this._needsConsent=!0}}))}internalLogin(){return __awaiter(this,void 0,void 0,(function*(){if(yield this.getAccessToken(null))this.setState(exports.ProviderState.SignedIn);else if(this._needsConsent){if(this._autoConsent){if(this.scopes)return void this.login();throw new Error("For auto consent, scopes must be provided")}throw new Error("Auto consent is not configured. You need to consent to additional scopes")}}))}getClientToken(){return __awaiter(this,void 0,void 0,(function*(){const t=TeamsHelper.microsoftTeamsLib;return new Promise(((r,o)=>{t.authentication.getAuthToken({successCallback:t=>{r(t)},failureCallback:t=>{this.setState(exports.ProviderState.SignedOut),o()}})}))}))}getTeamsContext(){return __awaiter(this,void 0,void 0,(function*(){return new Promise((t=>{const r=TeamsHelper.microsoftTeamsLib;r.initialize(),r.getContext((r=>{t(r)}))}))}))}unhandledFetchError(t){console.error(`There was an error during the server side token exchange:Â ${t}`)}}TeamsMsal2Provider._localStorageParametersKey="msg-TeamsMsal2Provider-auth-parameters",TeamsMsal2Provider._sessionStorageLoginInProgress="msg-TeamsMsal2Provider-login-in-progress",TeamsMsal2Provider._sessionStorageLogoutInProgress="msg-TeamsMsal2Provider-logout-in-progress";var __decorate=function(t,r,o,i){var s,l=arguments.length,u=l<3?r:null===i?i=Object.getOwnPropertyDescriptor(r,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,o,i);else for(var h=t.length-1;h>=0;h--)(s=t[h])&&(u=(l<3?s(u):l>3?s(r,o,u):s(r,o))||u);return l>3&&u&&Object.defineProperty(r,o,u),u},__metadata=function(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)};exports.MgtTeamsMsal2Provider=class MgtTeamsMsal2Provider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId="",this.authPopupUrl="",this.ssoUrl=""}get isAvailable(){return TeamsMsal2Provider.isAvailable}initializeProvider(){if(this.clientId&&this.authPopupUrl){const t={authPopupUrl:this.authPopupUrl,clientId:this.clientId};if(this.scopes){const r=this.scopes.split(",");r&&r.length>0&&(t.scopes=r)}if(this.authority){const r={auth:{authority:this.authority,clientId:this.clientId}};t.msalOptions=r}if(this.ssoUrl&&(t.ssoUrl=this.ssoUrl),this.isAutoConsentDisabled&&(t.autoConsent=!1),this.httpMethod){let r=this.httpMethod.toUpperCase();const o=exports.HttpMethod[r];t.httpMethod=o}this.provider=new TeamsMsal2Provider(t),Providers.globalProvider=this.provider}}},__decorate([property({attribute:"client-id",type:String}),__metadata("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"clientId",void 0),__decorate([property({attribute:"auth-popup-url",type:String}),__metadata("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"authPopupUrl",void 0),__decorate([property({attribute:"sso-url",type:String}),__metadata("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"ssoUrl",void 0),__decorate([property(),__metadata("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"authority",void 0),__decorate([property({attribute:"scopes",type:String}),__metadata("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"scopes",void 0),__decorate([property({attribute:"auto-consent-disabled",type:Boolean}),__metadata("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"isAutoConsentDisabled",void 0),__decorate([property({attribute:"http-method",type:String}),__metadata("design:type",Object)],exports.MgtTeamsMsal2Provider.prototype,"httpMethod",void 0),exports.MgtTeamsMsal2Provider=__decorate([customElement$1("mgt-teams-msal2-provider")],exports.MgtTeamsMsal2Provider),exports.BatchResponse=BatchResponse,exports.BetaGraph=BetaGraph,exports.CacheService=CacheService,exports.CacheStore=CacheStore,exports.EventDispatcher=EventDispatcher,exports.Graph=Graph,exports.GraphPageIterator=GraphPageIterator,exports.IProvider=IProvider,exports.LocalizationHelper=LocalizationHelper,exports.MICROSOFT_GRAPH_DEFAULT_ENDPOINT=Ex,exports.MICROSOFT_GRAPH_ENDPOINTS=Tx,exports.MgtBaseComponent=MgtBaseComponent,exports.MgtBaseProvider=MgtBaseProvider,exports.MgtTemplatedComponent=MgtTemplatedComponent,exports.MockProvider=MockProvider,exports.Msal2Provider=Msal2Provider,exports.MsalProvider=MsalProvider,exports.PACKAGE_VERSION=hP,exports.Providers=Providers,exports.ProxyProvider=ProxyProvider,exports.SharePointProvider=class SharePointProvider extends IProvider{get provider(){return this._provider}get isLoggedIn(){return!!this._idToken}get name(){return"MgtSharePointProvider"}constructor(t){super(),t.aadTokenProviderFactory.getTokenProvider().then((t=>{this._provider=t,this.graph=createFromProvider(this),this.internalLogin()}))}getAccessToken(){return __awaiter$4(this,void 0,void 0,(function*(){let t;try{t=yield this.provider.getToken("https://graph.microsoft.com")}catch(t){throw t}return t}))}updateScopes(t){this.scopes=t}internalLogin(){return __awaiter$4(this,void 0,void 0,(function*(){this._idToken=yield this.getAccessToken(),this.setState(this._idToken?exports.ProviderState.SignedIn:exports.ProviderState.SignedOut)}))}},exports.SimpleProvider=class SimpleProvider extends IProvider{get name(){return"MgtSimpleProvider"}constructor(t,r,o){super(),this._getAccessTokenHandler=t,this._loginHandler=r,this._logoutHandler=o,this.graph=createFromProvider(this)}getAccessToken(t){return this._getAccessTokenHandler(null==t?void 0:t.scopes)}login(){return this._loginHandler()}logout(){return this._logoutHandler()}},exports.TeamsHelper=TeamsHelper,exports.TeamsMsal2Provider=TeamsMsal2Provider,exports.TeamsProvider=TeamsProvider,exports.TemplateHelper=TemplateHelper,exports.arraysAreEqual=arraysAreEqual,exports.chainMiddleware=chainMiddleware,exports.createFromProvider=createFromProvider,exports.equals=equals,exports.prepScopes=prepScopes,exports.validateBaseURL=validateBaseURL;
//# sourceMappingURL=index.js.map
